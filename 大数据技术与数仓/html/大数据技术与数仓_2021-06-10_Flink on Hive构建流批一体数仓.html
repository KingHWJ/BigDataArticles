<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与数仓","title":"Flink on Hive构建流批一体数仓","time":"2021-06-10 09:55:00","timeStamp":"1623290100"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU2ODQ3NjYyMA==&mid=2247486752&idx=2&sn=05727eae27e7f311b054b394bc636fac&chksm=fc8c1b83cbfb92957549dc64a4c393d74953dc4964ae49ae76a87ac77293f53f764305c93755#rd" target="_blank">Flink on Hive构建流批一体数仓</a></h1><div id="meta_content" class="rich_media_meta_list"><span id="copyright_logo" class="wx_tap_link js_wx_tap_highlight rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_text">西贝&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与数仓&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-06-10 09:55:00</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU2ODQ3NjYyMA==&action=getalbum&album_id=1502493234823020547#wechat_redirect" title="Hive" target="_blank">#Hive</a><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU2ODQ3NjYyMA==&action=getalbum&album_id=1337154238136549376#wechat_redirect" title="Flink" target="_blank">#Flink</a><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU2ODQ3NjYyMA==&action=getalbum&album_id=1344435576086560769#wechat_redirect" title="数仓" target="_blank">#数仓</a><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU2ODQ3NjYyMA==&action=getalbum&album_id=1516633651147554819#wechat_redirect" title="OLAP" target="_blank">#OLAP</a></p></div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink使用HiveCatalog可以通过<strong>批</strong>或者<strong>流</strong>的方式来处理Hive中的表。这就意味着Flink既可以作为Hive的一个批处理引擎，也可以通过流处理的方式来读写Hive中的表，从而为实时数仓的应用和流批一体的落地实践奠定了坚实的基础。本文将以Flink1.12为例，介绍Flink集成Hive的另外一个非常重要的方面——<strong>Hive维表JOIN(Temporal Table Join)与Flink读写Hive表的方式</strong>。以下是全文，希望本文对你有所帮助。</p><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">Flink写入Hive表</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink支持以<strong>批处理(Batch)</strong>和<strong>流处理(Streaming)</strong>的方式写入Hive表。当以批处理的方式写入Hive表时，只有当写入作业结束时，才可以看到写入的数据。<strong>批处理的方式写入支持append模式和overwrite模式</strong>。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>批处理模式写入<span style="display: none;"></span></h3><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">向非分区表写入数据</section></li></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;">Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">use</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">catalog</span>&nbsp;myhive;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用catalog</span><br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">INSERT</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">INTO</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">users</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;<span style="color: #008080;line-height: 26px;">2</span>,<span style="color: #d14;line-height: 26px;">'tom'</span>;<br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">set</span>&nbsp;execution.type=batch;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用批处理模式</span><br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">INSERT</span>&nbsp;OVERWRITE&nbsp;<span style="font-weight: bold;line-height: 26px;">users</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;<span style="color: #008080;line-height: 26px;">2</span>,<span style="color: #d14;line-height: 26px;">'tom'</span>;<br  /></code></pre><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">向分区表写入数据</section></li></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;向静态分区表写入数据</span><br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">INSERT</span>&nbsp;OVERWRITE&nbsp;myparttable&nbsp;<span style="font-weight: bold;line-height: 26px;">PARTITION</span>&nbsp;(my_type=<span style="color: #d14;line-height: 26px;">'type_1'</span>,&nbsp;my_date=<span style="color: #d14;line-height: 26px;">'2019-08-08'</span>)&nbsp;<span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;<span style="color: #d14;line-height: 26px;">'Tom'</span>,&nbsp;<span style="color: #008080;line-height: 26px;">25</span>;<br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;向动态分区表写入数据</span><br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">INSERT</span>&nbsp;OVERWRITE&nbsp;myparttable&nbsp;<span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;<span style="color: #d14;line-height: 26px;">'Tom'</span>,&nbsp;<span style="color: #008080;line-height: 26px;">25</span>,&nbsp;<span style="color: #d14;line-height: 26px;">'type_1'</span>,&nbsp;<span style="color: #d14;line-height: 26px;">'2019-08-08'</span>;<br  /><br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>流处理模式写入<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">流式写入Hive表，不支持**Insert overwrite **方式，否则报如下错误：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;">[ERROR]&nbsp;Could&nbsp;not&nbsp;execute&nbsp;SQL&nbsp;statement.&nbsp;Reason:<br  />java.lang.IllegalStateException:&nbsp;Streaming&nbsp;mode&nbsp;not&nbsp;support&nbsp;overwrite.<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">下面的示例是将kafka的数据流式写入Hive的分区表</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用流处理模式</span><br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">set</span>&nbsp;execution.type=streaming;<br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用Hive方言</span><br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=hive;&nbsp;<br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;创建一张Hive分区表</span><br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;user_behavior_hive_tbl&nbsp;(<br  />&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`user_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`item_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;商品id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`cat_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;品类id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`action`</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户行为</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`province`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">INT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户所在的省份</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`ts`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户行为发生的时间戳</span><br  />)&nbsp;PARTITIONED&nbsp;<span style="font-weight: bold;line-height: 26px;">BY</span>&nbsp;(dt&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,hr&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,mi&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>)&nbsp;<span style="font-weight: bold;line-height: 26px;">STORED</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;parquet&nbsp;&nbsp;TBLPROPERTIES&nbsp;(<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'partition.time-extractor.timestamp-pattern'</span>=<span style="color: #d14;line-height: 26px;">'$dt&nbsp;$hr:$mi:00'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'sink.partition-commit.trigger'</span>=<span style="color: #d14;line-height: 26px;">'partition-time'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'sink.partition-commit.delay'</span>=<span style="color: #d14;line-height: 26px;">'0S'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'sink.partition-commit.policy.kind'</span>=<span style="color: #d14;line-height: 26px;">'metastore,success-file'</span><br  />);<br  /><br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用默认SQL方言</span><br  />Flink&nbsp;SQL&gt;&nbsp;<span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=<span style="font-weight: bold;line-height: 26px;">default</span>;&nbsp;<br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;创建一张kafka数据源表</span><br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;user_behavior&nbsp;(&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`user_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`item_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;商品id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`cat_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;品类id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`action`</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户行为</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`province`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">INT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户所在的省份</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`ts`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户行为发生的时间戳</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`proctime`</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;PROCTIME(),&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;通过计算列产生一个处理时间列</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`eventTime`</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;TO_TIMESTAMP(FROM_UNIXTIME(ts,&nbsp;<span style="color: #d14;line-height: 26px;">'yyyy-MM-dd&nbsp;HH:mm:ss'</span>)),&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;事件时间</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WATERMARK&nbsp;<span style="font-weight: bold;line-height: 26px;">FOR</span>&nbsp;eventTime&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;eventTime&nbsp;-&nbsp;<span style="color: #0086b3;line-height: 26px;">INTERVAL</span>&nbsp;<span style="color: #d14;line-height: 26px;">'5'</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">SECOND</span>&nbsp;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;定义watermark</span><br  />&nbsp;)&nbsp;<span style="font-weight: bold;line-height: 26px;">WITH</span>&nbsp;(&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'connector'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'kafka'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用&nbsp;kafka&nbsp;connector</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'topic'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'user_behaviors'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;kafka主题</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'scan.startup.mode'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'earliest-offset'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;偏移量</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'properties.group.id'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'group1'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;消费者组</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'properties.bootstrap.servers'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'kms-2:9092,kms-3:9092,kms-4:9092'</span>,&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'format'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'json'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;数据源格式为json</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'json.fail-on-missing-field'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'true'</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'json.ignore-parse-errors'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'false'</span><br  />);<br  /><br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">关于Hive表的一些属性解释：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>partition.time-extractor.timestamp-pattern</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：(none)</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：分区时间抽取器，与 DDL 中的分区字段保持一致,如果是按天分区，则可以是<strong>$dt</strong>，如果是按年(year)月(month)日(day)时(hour)进行分区，则该属性值为：<strong>$year-$month-$day $hour:00:00，如果是按天时进行分区，则该属性值为：$day $hour:00:00;</strong></section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>sink.partition-commit.trigger</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong style="color: black;">process-time</strong>：不需要时间提取器和水位线，当当前时间大于分区创建时间 + sink.partition-commit.delay 中定义的时间，提交分区；</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong style="color: black;">partition-time</strong>：需要 Source 表中定义 watermark，当 watermark &gt; 提取到的分区时间 +sink.partition-commit.delay 中定义的时间，提交分区；</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：<strong style="color: black;">process-time</strong></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：分区触发器类型，可选 <strong style="color: black;">process-time 或partition-time</strong>。</section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>sink.partition-commit.delay</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：0S</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：分区提交的延时时间，如果是按天分区，则该属性的值为：<strong style="color: black;">1d</strong>，如果是按小时分区，则该属性值为<strong style="color: black;">1h</strong>;</section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>sink.partition-commit.policy.kind</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong style="color: black;">metastore</strong>：添加分区的元数据信息，仅Hive表支持该值配置</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong style="color: black;">success-file</strong>：在表的存储路径下添加一个<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">_SUCCESS</code>文件</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">默认值：(none)</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">解释：提交分区的策略，用于通知下游的应用该分区已经完成了写入，也就是说该分区的数据可以被访问读取。可选的值如下：</p><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">可以同时配置上面的两个值，比如<strong>metastore,success-file</strong></p></section></li></ul></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">执行流式写入Hive表</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;streaming&nbsp;sql,将数据写入Hive表</span><br  /><span style="font-weight: bold;line-height: 26px;">INSERT</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">INTO</span>&nbsp;user_behavior_hive_tbl&nbsp;<br  /><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;user_id,<br  />&nbsp;&nbsp;&nbsp;&nbsp;item_id,<br  />&nbsp;&nbsp;&nbsp;&nbsp;cat_id,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-weight: bold;line-height: 26px;">action</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;province,<br  />&nbsp;&nbsp;&nbsp;&nbsp;ts,<br  />&nbsp;&nbsp;&nbsp;&nbsp;FROM_UNIXTIME(ts,&nbsp;<span style="color: #d14;line-height: 26px;">'yyyy-MM-dd'</span>),<br  />&nbsp;&nbsp;&nbsp;&nbsp;FROM_UNIXTIME(ts,&nbsp;<span style="color: #d14;line-height: 26px;">'HH'</span>),<br  />&nbsp;&nbsp;&nbsp;&nbsp;FROM_UNIXTIME(ts,&nbsp;<span style="color: #d14;line-height: 26px;">'mm'</span>)<br  /><span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;user_behavior;<br  /><br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;batch&nbsp;sql,查询Hive表的分区数据</span><br  /><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;*&nbsp;<span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;user_behavior_hive_tbl&nbsp;<span style="font-weight: bold;line-height: 26px;">WHERE</span>&nbsp;dt=<span style="color: #d14;line-height: 26px;">'2021-01-04'</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">AND</span>&nbsp;&nbsp;hr=<span style="color: #d14;line-height: 26px;">'16'</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">AND</span>&nbsp;mi&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'46'</span>;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">同时查看Hive表的分区数据：</p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.225" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_png/PL10rfzHicshO3kbnEYPq3iaDFEK9SDagMmaQHvK1Wgia7sbtuXJFRUBLWLDZeK8tB8BI4xZ6oDa2dcnRxPruKW8A/640?wx_fmt=png" data-type="png" data-w="1280" style=""  /></p><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">尖叫提示：</p><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">1.Flink读取Hive表默认使用的是batch模式，如果要使用流式读取Hive表，需要而外指定一些参数，见下文。</p><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">2.只有在完成 Checkpoint 之后，文件才会从 In-progress 状态变成 Finish 状态，同时生成<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">_SUCCESS</code>文件，所以，Flink流式写入Hive表需要开启并配置 Checkpoint。对于Flink SQL Client而言，需要在flink-conf.yaml中开启CheckPoint，配置内容为：</p><section style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: normal;"><span style="font-size: 13px;color: rgb(255, 104, 39);">state.backend: filesystem&nbsp;</span></section><section style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: normal;"><span style="font-size: 13px;color: rgb(255, 104, 39);">execution.checkpointing.externalized-checkpoint-retention:RETAIN_ON_CANCELLATION</span></section><section style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: normal;"><span style="font-size: 13px;color: rgb(255, 104, 39);">execution.checkpointing.interval: 60s&nbsp;</span></section><section style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: normal;"><span style="font-size: 13px;color: rgb(255, 104, 39);">execution.checkpointing.mode: EXACTLY_ONCE&nbsp;</span></section><section style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: normal;"><span style="font-size: 13px;color: rgb(255, 104, 39);">state.savepoints.dir: hdfs://kms-1:8020/flink-savepoints</span></section></blockquote><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">Flink读取Hive表</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink支持以<strong>批处理</strong>(Batch)和<strong>流处理</strong>(Streaming)的方式读取Hive中的表。批处理的方式与Hive的本身查询类似，即只在提交查询的时刻查询一次Hive表。流处理的方式将会持续地监控Hive表，并且会增量地提取新的数据。<strong>默认情况下，Flink是以批处理的方式读取Hive表</strong>。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">关于流式读取Hive表，Flink既支持分区表又支持非分区表。对于分区表而言，Flink将会监控新产生的分区数据，并以增量的方式读取这些数据。对于非分区表，Flink会监控Hive表存储路径文件夹里面的新文件，并以增量的方式读取新的数据。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink读取Hive表可以配置一下参数：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>streaming-source.enable</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：<strong style="color: black;">false</strong></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：是否开启流式读取 Hive 表，默认不开启。</section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>streaming-source.partition.include</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：<strong style="color: black;">all</strong></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：配置读取Hive的分区，包括两种方式：<strong style="color: black;">all和latest</strong>。all意味着读取所有分区的数据，latest表示只读取最新的分区数据。值得注意的是，latest方式只能用于开启了流式读取Hive表，并用于维表JOIN的场景。</section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>streaming-source.monitor-interval</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：<strong style="color: black;">None</strong></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：持续监控Hive表分区或者文件的时间间隔。值得注意的是，当以流的方式读取Hive表时，该参数的默认值是<strong style="color: black;">1m</strong>，即1分钟。当temporal join时，默认的值是<strong style="color: black;">60m</strong>，即1小时。另外，该参数配置不宜过短 ，最短是1 个小时，因为目前的实现是每个 task 都会查询 metastore，高频的查可能会对metastore 产生过大的压力。</section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>streaming-source.partition-order</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：<strong style="color: black;">partition-name</strong></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：streaming source的分区顺序。默认的是<strong style="color: black;">partition-name</strong>，表示使用默认分区名称顺序加载最新分区，也是推荐使用的方式。除此之外还有两种方式，分别为：<strong style="color: black;">create-time和partition-time</strong>。其中create-time表示使用分区文件创建时间顺序。partition-time表示使用分区时间顺序。指的注意的是，对于非分区表，该参数的默认值为：<strong style="color: black;">create-time</strong>。</section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>streaming-source.consume-start-offset</strong></p></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：<strong style="color: black;">None</strong></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：流式读取Hive表的起始偏移量。</section></li></ul><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><h5 style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;color: black;"><span style="display: none;"></span>partition.time-extractor.kind<span style="display: none;"></span></h5></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：default</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">分区时间提取器类型。用于从分区中提取时间，支持default和自定义。如果使用default，则需要通过参数<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">partition.time-extractor.timestamp-pattern</code>配置时间戳提取的正则表达式。</section></li></ul></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在 SQL Client 中需要显示地开启 SQL Hint 功能</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;">Flink&nbsp;SQL&gt;&nbsp;<span style="color: #0086b3;line-height: 26px;">set</span>&nbsp;table.dynamic-table-options.enabled=&nbsp;<span style="color: #008080;line-height: 26px;">true</span>;&nbsp;&nbsp;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">使用SQLHint流式查询Hive表</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;*&nbsp;<span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;user_behavior_hive_tbl&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">/*+&nbsp;OPTIONS('streaming-source.enable'='true',&nbsp;'streaming-source.consume-start-offset'='2021-01-03')&nbsp;*/</span>;<br  /></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">Hive维表JOIN</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink 1.12 支持了 Hive 最新的分区作为时态表的功能，可以通过 SQL 的方式直接关联 Hive 分区表的最新分区，并且会自动监听最新的 Hive 分区，当监控到新的分区后，会自动地做维表数据的全量替换。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink支持的是processing-time的temporal join，也就是说总是与最新版本的时态表进行JOIN。另外，Flink既支持非分区表的temporal join，又支持分区表的temporal join。对于分区表而言，Flink会监听Hive表的最新分区数据。值得注意的是，Flink尚不支持 event-time temporal join。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>Temporal Join最新分区<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">对于一张随着时间变化的Hive分区表，Flink可以读取该表的数据作为一个无界流。<strong>如果Hive分区表的每个分区都包含全量的数据，那么每个分区将做为一个时态表的版本数据</strong>，即将最新的分区数据作为一个全量维表数据。值得注意的是，该功能特点仅支持Flink的STREAMING模式。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">使用 Hive 最新分区作为 Tempmoral table 之前，需要设置必要的两个参数：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="color: #d14;line-height: 26px;">'streaming-source.enable'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'true'</span>,&nbsp;&nbsp;<br  /><span style="color: #d14;line-height: 26px;">'streaming-source.partition.include'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'latest'</span><br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">除此之外还有一些其他的参数，关于参数的解释见上面的分析。<strong>我们在使用Hive维表的时候，既可以在创建Hive表时指定具体的参数，也可以使用SQL Hint的方式动态指定参数</strong>。一个Hive维表的创建模板如下：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用Hive的sql方言</span><br  /><span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=hive;<br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;dimension_table&nbsp;(<br  />&nbsp;&nbsp;product_id&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;product_name&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;unit_price&nbsp;<span style="color: #0086b3;line-height: 26px;">DECIMAL</span>(<span style="color: #008080;line-height: 26px;">10</span>,&nbsp;<span style="color: #008080;line-height: 26px;">4</span>),<br  />&nbsp;&nbsp;pv_count&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,<br  />&nbsp;&nbsp;like_count&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,<br  />&nbsp;&nbsp;comment_count&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,<br  />&nbsp;&nbsp;update_time&nbsp;<span style="color: #0086b3;line-height: 26px;">TIMESTAMP</span>(<span style="color: #008080;line-height: 26px;">3</span>),<br  />&nbsp;&nbsp;update_user&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;...<br  />)&nbsp;PARTITIONED&nbsp;<span style="font-weight: bold;line-height: 26px;">BY</span>&nbsp;(pt_year&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,&nbsp;pt_month&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,&nbsp;pt_day&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>)&nbsp;TBLPROPERTIES&nbsp;(<br  />&nbsp;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;方式1：按照分区名排序来识别最新分区(推荐使用该种方式)</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.enable'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'true'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;开启Streaming&nbsp;source</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition.include'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'latest'</span>,<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;选择最新分区</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.monitor-interval'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'12&nbsp;h'</span>,<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;每12小时加载一次最新分区数据</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition-order'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'partition-name'</span>,&nbsp;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;按照分区名排序</span><br  /><br  />&nbsp;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;方式2:分区文件的创建时间排序来识别最新分区</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.enable'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'true'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition.include'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'latest'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition-order'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'create-time'</span>,<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;分区文件的创建时间排序</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.monitor-interval'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'12&nbsp;h'</span><br  /><br  />&nbsp;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;方式3:按照分区时间排序来识别最新分区</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.enable'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'true'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition.include'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'latest'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.monitor-interval'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'12&nbsp;h'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition-order'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'partition-time'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;按照分区时间排序</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'partition.time-extractor.kind'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'default'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'partition.time-extractor.timestamp-pattern'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'$pt_year-$pt_month-$pt_day&nbsp;00:00:00'</span>&nbsp;<br  />);<br  /><br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">有了上面的Hive维表，我们就可以使用该维表与Kafka的实时流数据进行JOIN，得到相应的宽表数据。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用default&nbsp;sql方言</span><br  /><span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=<span style="font-weight: bold;line-height: 26px;">default</span>;<br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;kafka实时流数据表</span><br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;orders_table&nbsp;(<br  />&nbsp;&nbsp;order_id&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;order_amount&nbsp;<span style="font-weight: bold;line-height: 26px;">DOUBLE</span>,<br  />&nbsp;&nbsp;product_id&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;log_ts&nbsp;<span style="color: #0086b3;line-height: 26px;">TIMESTAMP</span>(<span style="color: #008080;line-height: 26px;">3</span>),<br  />&nbsp;&nbsp;proctime&nbsp;<span style="font-weight: bold;line-height: 26px;">as</span>&nbsp;PROCTIME()<br  />)&nbsp;<span style="font-weight: bold;line-height: 26px;">WITH</span>&nbsp;(...);<br  /><br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;将流表与hive最新分区数据关联&nbsp;</span><br  /><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;*<br  /><span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;orders_table&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;orders<br  /><span style="font-weight: bold;line-height: 26px;">JOIN</span>&nbsp;dimension_table&nbsp;<span style="font-weight: bold;line-height: 26px;">FOR</span>&nbsp;SYSTEM_TIME&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">OF</span>&nbsp;orders.proctime&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;dim&nbsp;<br  /><span style="font-weight: bold;line-height: 26px;">ON</span>&nbsp;orders.product_id&nbsp;=&nbsp;dim.product_id;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">除了在定义Hive维表时指定相关的参数，我们还可以通过SQL Hint的方式动态指定相关的参数，具体方式如下：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;*<br  /><span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;orders_table&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;orders<br  /><span style="font-weight: bold;line-height: 26px;">JOIN</span>&nbsp;dimension_table<br  /><span style="color: #998;font-style: italic;line-height: 26px;">/*+&nbsp;OPTIONS('streaming-source.enable'='true',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;'streaming-source.partition.include'&nbsp;=&nbsp;'latest',<br  />&nbsp;&nbsp;&nbsp;&nbsp;'streaming-source.monitor-interval'&nbsp;=&nbsp;'1&nbsp;h',<br  />&nbsp;&nbsp;&nbsp;&nbsp;'streaming-source.partition-order'&nbsp;=&nbsp;'partition-name')&nbsp;*/</span><br  /><span style="font-weight: bold;line-height: 26px;">FOR</span>&nbsp;SYSTEM_TIME&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">OF</span>&nbsp;orders.proctime&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;dim&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;时态表(维表)</span><br  /><span style="font-weight: bold;line-height: 26px;">ON</span>&nbsp;orders.product_id&nbsp;=&nbsp;dim.product_id;<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>Temporal Join最新表<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">对于Hive的非分区表，当使用temporal join时，整个Hive表会被缓存到Slot内存中，然后根据流中的数据对应的key与其进行匹配。使用最新的Hive表进行temporal join不需要进行额外的配置，我们只需要配置一个Hive表缓存的TTL时间，该时间的作用是：当缓存过期时，就会重新扫描Hive表并加载最新的数据。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><strong>lookup.join.cache.ttl</strong></p><blockquote style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">尖叫提示：</p><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">当使用此种方式时，Hive表必须是有界的lookup表，即非Streaming Source的时态表，换句话说，该表的属性<strong>streaming-source.enable = false</strong>。</p><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">如果要使用Streaming Source的时态表，记得配置<strong>streaming-source.monitor-interval</strong>的值，即数据更新的时间间隔。</p></blockquote></section></li><ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: square;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">默认值：60min</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">解释：表示缓存时间。由于 Hive 维表会把维表所有数据缓存在 TM 的内存中，当维表数据量很大时，很容易造成 OOM。当然TTL的时间也不能太短，因为会频繁地加载数据，从而影响性能。</section></li></ul></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;Hive维表数据使用批处理的方式按天装载</span><br  /><span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=hive;<br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;dimension_table&nbsp;(<br  />&nbsp;&nbsp;product_id&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;product_name&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;unit_price&nbsp;<span style="color: #0086b3;line-height: 26px;">DECIMAL</span>(<span style="color: #008080;line-height: 26px;">10</span>,&nbsp;<span style="color: #008080;line-height: 26px;">4</span>),<br  />&nbsp;&nbsp;pv_count&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,<br  />&nbsp;&nbsp;like_count&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,<br  />&nbsp;&nbsp;comment_count&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,<br  />&nbsp;&nbsp;update_time&nbsp;<span style="color: #0086b3;line-height: 26px;">TIMESTAMP</span>(<span style="color: #008080;line-height: 26px;">3</span>),<br  />&nbsp;&nbsp;update_user&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;...<br  />)&nbsp;TBLPROPERTIES&nbsp;(<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.enable'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'false'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;关闭streaming&nbsp;source</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition.include'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'all'</span>,&nbsp;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;读取所有数据</span><br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'lookup.join.cache.ttl'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'12&nbsp;h'</span><br  />);<br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;kafka事实表</span><br  /><span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=<span style="font-weight: bold;line-height: 26px;">default</span>;<br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;orders_table&nbsp;(<br  />&nbsp;&nbsp;order_id&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;order_amount&nbsp;<span style="font-weight: bold;line-height: 26px;">DOUBLE</span>,<br  />&nbsp;&nbsp;product_id&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;log_ts&nbsp;<span style="color: #0086b3;line-height: 26px;">TIMESTAMP</span>(<span style="color: #008080;line-height: 26px;">3</span>),<br  />&nbsp;&nbsp;proctime&nbsp;<span style="font-weight: bold;line-height: 26px;">as</span>&nbsp;PROCTIME()<br  />)&nbsp;<span style="font-weight: bold;line-height: 26px;">WITH</span>&nbsp;(...);<br  /><br  /><span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;Hive维表join，Flink会加载该维表的所有数据到内存中</span><br  /><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;*<br  /><span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;orders_table&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;orders<br  /><span style="font-weight: bold;line-height: 26px;">JOIN</span>&nbsp;dimension_table&nbsp;<span style="font-weight: bold;line-height: 26px;">FOR</span>&nbsp;SYSTEM_TIME&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">OF</span>&nbsp;orders.proctime&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;dim<br  /><span style="font-weight: bold;line-height: 26px;">ON</span>&nbsp;orders.product_id&nbsp;=&nbsp;dim.product_id;<br  /></code></pre><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">尖叫提示：</p><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">1.每一个子任务都需要缓存一份维表的全量数据，一定要确保TM的task Slot 大小能够容纳维表的数据量；</p><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">2.推荐将streaming-source.monitor-interval和lookup.join.cache.ttl的值设为一个较大的数，因为频繁的更新和加载数据会影响性能。</p><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">3.当缓存的维表数据需要重新刷新时，目前的做法是将整个表进行加载，因此不能够将新数据与旧数据区分开来。</p></blockquote><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>Hive维表JOIN示例<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">假设维表的数据是通过批处理的方式(比如每天)装载至Hive中，而Kafka中的事实流数据需要与该维表进行JOIN，从而构建一个宽表数据，这个时候就可以使用Hive的维表JOIN。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">创建一张kafka数据源表,实时流</section></li></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=<span style="font-weight: bold;line-height: 26px;">default</span>;<br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;fact_user_behavior&nbsp;(&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`user_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`item_id`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;商品id</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`action`</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户行为</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`province`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">INT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户所在的省份</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`ts`</span>&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;用户行为发生的时间戳</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`proctime`</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;PROCTIME(),&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;通过计算列产生一个处理时间列</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">`eventTime`</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;TO_TIMESTAMP(FROM_UNIXTIME(ts,&nbsp;<span style="color: #d14;line-height: 26px;">'yyyy-MM-dd&nbsp;HH:mm:ss'</span>)),&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;事件时间</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WATERMARK&nbsp;<span style="font-weight: bold;line-height: 26px;">FOR</span>&nbsp;eventTime&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;eventTime&nbsp;-&nbsp;<span style="color: #0086b3;line-height: 26px;">INTERVAL</span>&nbsp;<span style="color: #d14;line-height: 26px;">'5'</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">SECOND</span>&nbsp;&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;定义watermark</span><br  />&nbsp;)&nbsp;<span style="font-weight: bold;line-height: 26px;">WITH</span>&nbsp;(&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'connector'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'kafka'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;使用&nbsp;kafka&nbsp;connector</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'topic'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'user_behaviors'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;kafka主题</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'scan.startup.mode'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'earliest-offset'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;偏移量</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'properties.group.id'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'group1'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;消费者组</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'properties.bootstrap.servers'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'kms-2:9092,kms-3:9092,kms-4:9092'</span>,&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'format'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'json'</span>,&nbsp;<span style="color: #998;font-style: italic;line-height: 26px;">--&nbsp;数据源格式为json</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'json.fail-on-missing-field'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'true'</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'json.ignore-parse-errors'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'false'</span><br  />);<br  /></code></pre><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">创建一张Hive维表</section></li></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="font-weight: bold;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=hive;<br  /><span style="font-weight: bold;line-height: 26px;">CREATE</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">TABLE</span>&nbsp;dim_item&nbsp;(<br  />&nbsp;&nbsp;item_id&nbsp;<span style="color: #0086b3;line-height: 26px;">BIGINT</span>,<br  />&nbsp;&nbsp;item_name&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;unit_price&nbsp;<span style="color: #0086b3;line-height: 26px;">DECIMAL</span>(<span style="color: #008080;line-height: 26px;">10</span>,&nbsp;<span style="color: #008080;line-height: 26px;">4</span>)<br  />)&nbsp;PARTITIONED&nbsp;<span style="font-weight: bold;line-height: 26px;">BY</span>&nbsp;(dt&nbsp;<span style="font-weight: bold;line-height: 26px;">STRING</span>)&nbsp;TBLPROPERTIES&nbsp;(<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.enable'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'true'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition.include'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'latest'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.monitor-interval'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'12&nbsp;h'</span>,<br  />&nbsp;&nbsp;<span style="color: #d14;line-height: 26px;">'streaming-source.partition-order'</span>&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'partition-name'</span><br  />);<br  /></code></pre><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">关联Hive维表的最新数据</section></li></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;fact.item_id,<br  />&nbsp;&nbsp;&nbsp;&nbsp;dim.item_name,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-weight: bold;line-height: 26px;">count</span>(*)&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;buy_cnt<br  /><span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;fact_user_behavior&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;fact<br  /><span style="font-weight: bold;line-height: 26px;">LEFT</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">JOIN</span>&nbsp;dim_item&nbsp;<span style="font-weight: bold;line-height: 26px;">FOR</span>&nbsp;SYSTEM_TIME&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">OF</span>&nbsp;fact.proctime&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;dim<br  /><span style="font-weight: bold;line-height: 26px;">ON</span>&nbsp;fact.item_id&nbsp;=&nbsp;dim.item_id<br  /><span style="font-weight: bold;line-height: 26px;">WHERE</span>&nbsp;fact.action&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'buy'</span><br  /><span style="font-weight: bold;line-height: 26px;">GROUP</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">BY</span>&nbsp;fact.item_id,dim.item_name;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">使用SQL Hint方式，关联非分区的Hive维表：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;"><code style="overflow-x: auto;padding: 16px;color: #333;background: #f8f8f8;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;border-radius: 0px;font-size: 12px;-webkit-overflow-scrolling: touch;"><span style="font-weight: bold;line-height: 26px;">set</span>&nbsp;table.dynamic-<span style="font-weight: bold;line-height: 26px;">table</span>-options.enabled=&nbsp;<span style="color: #008080;line-height: 26px;">true</span>;&nbsp;<br  /><span style="font-weight: bold;line-height: 26px;">SELECT</span>&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;fact.item_id,<br  />&nbsp;&nbsp;&nbsp;&nbsp;dim.item_name,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-weight: bold;line-height: 26px;">count</span>(*)&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;buy_cnt<br  /><span style="font-weight: bold;line-height: 26px;">FROM</span>&nbsp;fact_user_behavior&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;fact<br  /><span style="font-weight: bold;line-height: 26px;">LEFT</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">JOIN</span>&nbsp;dim_item1<br  /><span style="color: #998;font-style: italic;line-height: 26px;">/*+&nbsp;OPTIONS('streaming-source.enable'='false',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;'streaming-source.partition.include'&nbsp;=&nbsp;'all',<br  />&nbsp;&nbsp;&nbsp;&nbsp;'lookup.join.cache.ttl'&nbsp;=&nbsp;'12&nbsp;h')&nbsp;*/</span><br  /><span style="font-weight: bold;line-height: 26px;">FOR</span>&nbsp;SYSTEM_TIME&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">OF</span>&nbsp;fact.proctime&nbsp;<span style="font-weight: bold;line-height: 26px;">AS</span>&nbsp;dim<br  /><span style="font-weight: bold;line-height: 26px;">ON</span>&nbsp;fact.item_id&nbsp;=&nbsp;dim.item_id<br  /><span style="font-weight: bold;line-height: 26px;">WHERE</span>&nbsp;fact.action&nbsp;=&nbsp;<span style="color: #d14;line-height: 26px;">'buy'</span><br  /><span style="font-weight: bold;line-height: 26px;">GROUP</span>&nbsp;<span style="font-weight: bold;line-height: 26px;">BY</span>&nbsp;fact.item_id,dim.item_name;<br  /></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">总结</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">本文以最新版本的Flink1.12为例，介绍了Flink读写Hive的不同方式，并对每种方式给出了相应的使用示例。在实际应用中，通常有将实时数据流与 Hive 维表 join 来构造宽表的需求，Flink提供了Hive维表JOIN，可以简化用户使用的复杂度。本文在最后详细说明了Flink进行Hive维表JOIN的基本步骤以及使用示例，希望对你有所帮助。</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;"><strong><span style="color: rgb(255, 104, 39);">【大数据技术与数仓】社群提供给大家一个开放的交流平台，扫描下方二维码加好友入技术交流群</span></strong></p></blockquote></section><p style="text-align: center;"><img class="rich_pages" data-ratio="1.2952127659574468" data-s="300,640" src="https://mmbiz.qpic.cn/mmbiz_jpg/PL10rfzHicsgSwyuFAHrIHib40RYaGkyQxVn7629suCCWxJO5heFibm2q46Uz3thXuFDNciaunNiaXSdoiaPC3lFPlRw/640?wx_fmt=jpeg" data-type="jpeg" data-w="752" style=""  /></p></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="93709"><section style="border-style: solid;border-width: 2px;padding: 5px;"><section style="border-style: dashed;border-width: 1px;padding: 15px;"><section style="text-align: center;"><span data-role="width" style="display: inline-block;width: 80%;" data-width="80%"><img border="0" data-ratio="0.08658008658008658" src="https://mmbiz.qpic.cn/mmbiz_gif/7QRTvkK2qC7IHABFmuMlWQkSSzOMicicfBLfsdIjkOnDvssu6Znx4TTPsH8yZZNZ17hSbD95ww43fs5OFEppRTWg/640?wx_fmt=gif" data-type="gif" data-w="462" data-width="80%" height="" style="box-sizing: border-box;width: 100%;" title="" width="80%"  /></span></section><p style="text-align:justify;margin-top: 10px;margin-bottom: 5px;padding-right: 0em;padding-left: 0em;letter-spacing: 1.5px;line-height: normal;color: rgb(136, 136, 136);font-size: 13px;">●<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU2ODQ3NjYyMA==&amp;mid=2247485978&amp;idx=2&amp;sn=483f16979ad914f998b815f4d5ab7d88&amp;chksm=fc8c1cb9cbfb95afdc69f1d05a49f25835353073c01af1e60210808a4589bb1f031dfe3fd1b9&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">Flink集成Hive之Hive Catalog与Hive Dialect--以Flink1.12为例</a></p><p style="text-align:justify;margin-top: 5px;margin-bottom: 5px;padding-right: 0em;padding-left: 0em;letter-spacing: 1.5px;line-height: normal;color: rgb(136, 136, 136);font-size: 13px;">●<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU2ODQ3NjYyMA==&amp;mid=2247485969&amp;idx=2&amp;sn=506b65ccf0ac3a63f6f0b32a7d3fba32&amp;chksm=fc8c1cb2cbfb95a478428ce67b1c3815a9e3f6584db4c29ce1f5d0178a2c62ea9e63998f74c6&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">Flink集成Hive之快速入门--以Flink1.12为例</a></p><p style="text-align:justify;margin-top: 5px;margin-bottom: 5px;padding-right: 0em;padding-left: 0em;letter-spacing: 1.5px;line-height: normal;color: rgb(136, 136, 136);font-size: 13px;">●<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU2ODQ3NjYyMA==&amp;mid=2247484489&amp;idx=1&amp;sn=5990725c4d675093a030d9444b7dbdc9&amp;chksm=fc8c12eacbfb9bfc8d1e1993da8ddb176eae6c3cd92274a3b1f104978e54d2e296fc356430a2&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">实时数仓|Flink SQL之维表join</a></p><p style="text-align:justify;margin-top: 5px;margin-bottom: 5px;padding-right: 0em;padding-left: 0em;letter-spacing: 1.5px;line-height: normal;color: rgb(136, 136, 136);font-size: 13px;">●<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU2ODQ3NjYyMA==&amp;mid=2247484891&amp;idx=2&amp;sn=5fcf4ec7c4519cf69528d66caccbdd95&amp;chksm=fc8c1378cbfb9a6ee3c1de84ee6e9ef1d272dd7cd92d4a504d5298282e51a91fe6aa32bf57f7&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">Flink1.11中的CDC Connectors操作实践</a></p></section></section></section><section data-role="paragraph"><p><br  /></p></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;"><span style="color: rgb(61, 167, 66);">如果觉得本文对你有所帮助，请分享转发，感谢支持</span></p></blockquote></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="98929"><section style="display:flex;justify-content: space-between;align-items: flex-end;margin:10px auto;"><section style="display:flex;justify-content:center;align-items: flex-end;"><section style="width: auto;"><section style="width: 26px;margin-right: auto;margin-left: auto;"><img data-ratio="0.958904109589041" src="https://mmbiz.qpic.cn/mmbiz_png/PL10rfzHicshO3kbnEYPq3iaDFEK9SDagMSGPNQibQ3k5Eiap8Xlj0r5jQ5ueoicrVrcYpJnc1SohLXHMrHBsKrju6w/640?wx_fmt=png" data-type="png" data-w="73" data-width="100%" style="box-sizing:border-box;width:100%;display:block;"  /></section><section data-brushtype="text" style="text-align:center;font-size:14px;letter-spacing: 1.5px;color: #000;font-weight: bold;">点分享</section></section><section style="width: auto;margin-left: 10px;"><section style="width: 26px;margin-right: auto;margin-left: auto;"><img data-ratio="0.9594594594594594" src="https://mmbiz.qpic.cn/mmbiz_png/PL10rfzHicshO3kbnEYPq3iaDFEK9SDagM1ThFt6BiaVp8kTOMA6OBo5vL5h3iclia2diaKTWJrUgxZRzoRdcTdjibSBw/640?wx_fmt=png" data-type="png" data-w="74" data-width="100%" style="box-sizing:border-box;width:100%;display:block;"></section><section data-brushtype="text" style="text-align:center;font-size:14px;letter-spacing: 1.5px;color: #000;font-weight: bold;">点收藏</section></section></section><section style="display:flex;justify-content:center;align-items: flex-end;"><section style="width: auto;"><section style="width: 26px;margin-right: auto;margin-left: auto;"><img data-ratio="0.958904109589041" src="https://mmbiz.qpic.cn/mmbiz_png/PL10rfzHicshO3kbnEYPq3iaDFEK9SDagMicPVcaiclQlLlPrl8PicGofflKIH2GH2pJdGLDek0gYlAgVtahm2OjVTg/640?wx_fmt=png" data-type="png" data-w="73" data-width="100%" style="box-sizing:border-box;width:100%;display:block;"  /></section><section data-brushtype="text" style="text-align:center;font-size:14px;letter-spacing: 1.5px;color: #000;font-weight: bold;">点点赞</section></section><section style="width: auto;margin-left: 10px;"><section style="width: 26px;margin-right: auto;margin-left: auto;"><img data-ratio="0.9594594594594594" src="https://mmbiz.qpic.cn/mmbiz_png/PL10rfzHicshO3kbnEYPq3iaDFEK9SDagMowZn4ZKeiamk3bPpQWkdfcOeJ8XJuIsy3QUgfibk0mFnNib8pO6hdS8icg/640?wx_fmt=png" data-type="png" data-w="74" data-width="100%" style="box-sizing:border-box;width:100%;display:block;"  /></section><section data-brushtype="text" style="text-align:center;font-size:14px;letter-spacing: 1.5px;color: #000;font-weight: bold;">点在看</section></section></section></section></section></section><div class="msg_source_url"><a href="https://t.1yb.co/dkIa" target="_blank">阅读原文</a></div></content><div class="msg_source_url"><a href="https://t.1yb.co/dkIa" target="_blank">阅读原文</a></div>
</div>
</body>
</html>