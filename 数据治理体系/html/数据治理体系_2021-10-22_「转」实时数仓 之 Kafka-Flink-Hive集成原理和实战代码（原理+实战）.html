<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"数据治理体系","title":"实时数仓 之 Kafka-Flink-Hive集成原理和实战代码（原理+实战）","time":"2021-10-22 12:00:20","timeStamp":"1634875220"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzA3NjIzNjMwOA==&mid=2247484548&idx=1&sn=a3aab8d6b21295695be8c4a704c8953a&chksm=9f6517ffa8129ee9058e62b569a90e5d545e452db8ad6ebdad5d8f44fd0d63953201763c5de9#rd" target="_blank">实时数仓 之 Kafka-Flink-Hive集成原理和实战代码（原理+实战）</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">在IT中穿梭旅行&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">数据治理体系&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-10-22 12:00:20</em></div><content><div class="reprint"><p>转自公众号：3分钟秒懂大数据<br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5NDY3NzIwMA==&mid=2247497251&idx=1&sn=e6b87fe99c916bb38a4c50f3dc3fc538" target="_blank" title="阅读原文">http://mp.weixin.qq.com/s?__biz=Mzg5NDY3NzIwMA==&mid=2247497251&idx=1&sn=e6b87fe99c916bb38a4c50f3dc3fc538</a></p></div><section style="font-size: 16px;"><pre style="margin-bottom: 1rem;outline: 0px;letter-spacing: 0.544px;font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;font-size: 14.875px;overflow: auto;color: rgb(33, 37, 41);text-align: left;background-color: rgb(255, 255, 255);" data-mpa-powered-by="yiban.io"><p style="margin-right: 8px;margin-left: 8px;outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;white-space: normal;font-size: 14px;letter-spacing: 1px;text-align: center;">关注并标星&nbsp;<strong style="outline: 0px;"><span style="outline: 0px;color: rgb(255, 0, 0);">3分钟秒懂大数据</span></strong><br style="outline: 0px;"  /></p><p style="margin-right: 8px;margin-left: 8px;outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;white-space: normal;font-size: 14px;letter-spacing: 1px;text-align: center;"><span style="outline: 0px;color: rgb(62, 62, 62);">每天1次，打卡阅读</span></p><p style="margin-right: 8px;margin-left: 8px;outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;white-space: normal;font-size: 14px;letter-spacing: 1px;text-align: center;"><span style="outline: 0px;color: rgb(62, 62, 62);">获取AI、大数据技术和面经</span></p></pre><section class="mp_profile_iframe_wrp"><mpprofile class="js_uneditable custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzU4NjY4NDU0MQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8ODLj6gb1ooPOCy6SgyuHHqr4nIKd9UPXvzcPedPNBRA37Vfsbjkhzem06AibibggLatT97td0N1PdA/0?wx_fmt=png" data-nickname="3分钟秒懂大数据" data-alias="three-m-u-bigdata" data-signature="专注于大数据、AB融合、python数据分析、AI等技术博文的分享，提供最前沿的技术博客!" data-from="0"></mpprofile></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">大家好，我是土哥。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">目前在某互联网大厂担任大数据算法工程师。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">今天有位粉丝在群里发信息，问有没有<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Flink DDL</code>的使用资料，说自己是Flink刚入门的学习者。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.5879629629629629" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69zVMvnpx8V3CvZtAMic8VicKKSPDSSjUhsMrgXrNTyFObSOQMQPC5aPRA/640?wx_fmt=png" data-type="png" data-w="1080" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">为了让这位粉丝快速学会 <code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Flink DDL</code> 使用步骤，下面我将通过<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Kafka - Flink -Hive</code>这个案例，讲解一下原理，并附上实战代码。</p><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">1、Flink-Hive理论</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>1.1、Flink-Hive介绍<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Flink 1.11</code> 版本中，社区新增了一大功能是实时数仓，可以通过<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">kafka</code>,将<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">kafka sink</code>端的数据实时写入到<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Hive</code>中。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">为实现这个功能、<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Flink1.11</code> 版本主要做了以下改变：</p><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">将 FlieSystemStreaming Sink 重新修改，增加了分区提交和滚动策略机制。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">让HiveStreaming &nbsp;sink 重新使用文件系统流作为接收器。</section></li></ol><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以通过Flink社区，查看<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">FLIP-85 Filesystem connector in Table</code>的设计思路。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>1.2、Flink-Hive集成原理<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink与Hive集成原理图如下：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><img data-ratio="0.2861111111111111" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69CMdazTaXvRNyPynDvZ0FbUnSRyMPjbCH83OB2OZbFDJFEmiaWSIBcibQ/640?wx_fmt=png" data-type="png" data-w="1080" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  />主要包含三部分内容：</p><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">HiveDialect。<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Flink1.1</code>新引入了<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Hive</code>方言，所以在Flink SQL中可以编写HIve语法，即Hive Dialect。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">编写HIve SQL后，<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">FlinkSQL Planner</code> 会将<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">SQL</code>进行解析，验证，转换成逻辑计划，物理计划，最终变成<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Jobgraph</code>。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">HiveCatalog。<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">HiveCatalog</code>作为<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Flink</code> 和<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Hive</code>的持久化介质，会将不同会话的<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Flink</code>元数据存储到<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Hive Metastore</code>中。</section></li></ol><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>1.3、Flink-Hive版本支持<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink目前支持Hive的1.x、2.x、3.x，每个大的版本对于的Flink依赖如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.5657370517928287" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69ibZWUTG5fAF13W8n5icszSe2PGKpzOKseEJnibwgcgZticpDdaJKFAxiaZw/640?wx_fmt=png" data-type="png" data-w="502" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>1.4、Flink SQL支持Hive语言<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink SQL支持两种SQL语言，分别为<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">default</code>和<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hive</code>。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">配置方式也包含两种，配置如下图所示：</p><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">通过客户端配置。</section></li></ol><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.227765726681128" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69XCFm0oJGibibHASlC8TXlFoqXEHvwdSicP47icYpodKZo5iaXe8p9dWsEiaQ/640?wx_fmt=png" data-type="png" data-w="922" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><ol start="2" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">通过SQL配置。</section></li></ol><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.24121405750798722" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69Ljwk3fGRI7ucWLaTmbnk84S46bHpajdy1EaH3p1Uh6NhDYq26Llp9g/640?wx_fmt=png" data-type="png" data-w="626" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">2、kafka-Flink-Hive 集群配置</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">需求：实时将<span style="font-size: 14px;background-color: rgba(27, 31, 35, 0.05);font-family: &#39;Operator Mono&#39;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">kafka</span>中的数据通过<span style="font-size: 14px;background-color: rgba(27, 31, 35, 0.05);font-family: &#39;Operator Mono&#39;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">flink Sql </span>计算 存储到hive数据仓库中。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>2.1集群部署<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">配置信息如下：</p><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Hadoop: hadoop2.6.4</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Kafka: kafka_2.11-2.2.0</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Flink: flink1.13.0</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Hive: hive-2.3.4-bin</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Zookeeper: zookeeper-3.4.5</section></li></ol><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.355525965379494" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69aQRNQZqwv4hmPGhDI6sQoboIbd8kfptzG0LPicJD9LAqTHCf1UyUPzg/640?wx_fmt=png" data-type="png" data-w="751" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>2.2 查询结果要求<span style="display: none;"></span></h3><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">希望Flink Sql 查询kafka输入的数据的表结构如下：</section></li></ol><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.24026845637583893" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69IvtDp9q3KTrRhh2VK9PZhdYmHXgHDtFIWaOicib7CLap3qItgzib8OXHw/640?wx_fmt=png" data-type="png" data-w="745" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><ol start="2" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">希望FlinkSQL实时将kafka中的数据插入Hive 查询的结果根据分区查询如下：</section></li></ol><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.16129032258064516" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69libkqhHfxthhrUVnibmjpdEC1w4eHEBGibvP6ZzzXUWy706rdkhX38vSg/640?wx_fmt=png" data-type="png" data-w="930" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>2.3 kafka启动命令<span style="display: none;"></span></h3><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">kafka启动</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">nohup&nbsp;./kafka-server-start.sh&nbsp;../config/server.properties&nbsp;&amp;<br  /></code></pre><ol start="2" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">查看kafka Topic</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">./kafka-topics.sh&nbsp;--list&nbsp;--bootstrap-server&nbsp;192.168.244.161:9092&nbsp;&nbsp;&nbsp;&nbsp;//查看是否有需要用到的topic主题<br  /></code></pre><ol start="3" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">创建kafka Topic</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">kafka-topics.sh&nbsp;--create&nbsp;--bootstrap-server&nbsp;192.168.244.161:9092&nbsp;--topic&nbsp;test&nbsp;&nbsp;--partitions&nbsp;10&nbsp;--replication-factor&nbsp;1<br  /></code></pre><ol start="4" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">启动kafka生产者 &nbsp; 让批量传输数据</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">kafka-console-producer.sh&nbsp;--broker-list&nbsp;192.168.244.161:9092&nbsp;--topic&nbsp;test<br  /></code></pre><ol start="5" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">往kafka中批量传入的数据源</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"1"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"124.5"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"38.4"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;11:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"3"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"176.9"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-25&nbsp;13:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"4"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"302"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-25&nbsp;14:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"5"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"124.5"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-26&nbsp;14:26:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"6"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"38.4"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-26&nbsp;15:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"7"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"176.9"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-27&nbsp;16:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"8"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"302"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-27&nbsp;17:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"9"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"124.5"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:20:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"10"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"124.6"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:21:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"11"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"124.7"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:22:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"12"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"124.8"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:23:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"13"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"124.9"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:24:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"14"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"125.5"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:25:15"</span>}<br  />{<span style="color: #d19a66;line-height: 26px;">"user_id"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"15"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"order_amount"</span>:<span style="color: #98c379;line-height: 26px;">"126.5"</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">"log_ts"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2020-08-24&nbsp;10:26:15"</span>}<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>2.4 Hive集成Flink<span style="display: none;"></span></h3><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">hive安装 &nbsp; 修改hive-env.sh</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #61aeee;line-height: 26px;">#</span><span style="line-height: 26px;">&nbsp;Set&nbsp;HADOOP_HOME&nbsp;to&nbsp;point&nbsp;to&nbsp;a&nbsp;specific&nbsp;hadoop&nbsp;install&nbsp;directory</span><br  />HADOOP_HOME=/root/sd/hadoop-2.6.4<br  /><span style="color: #61aeee;line-height: 26px;"><br  />#</span><span style="line-height: 26px;">&nbsp;Hive&nbsp;Configuration&nbsp;Directory&nbsp;can&nbsp;be&nbsp;controlled&nbsp;by:</span><br  />export&nbsp;HIVE_CONF_DIR=/root/sd/apache-hive-2.3.4-bin/conf<br  /><span style="color: #61aeee;line-height: 26px;"><br  />#</span><span style="line-height: 26px;">&nbsp;Folder&nbsp;containing&nbsp;extra&nbsp;libraries&nbsp;required&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;hive&nbsp;compilation/execution&nbsp;can&nbsp;be&nbsp;controlled&nbsp;by:</span><br  />export&nbsp;HIVE_AUX_JARS_PATH=/root/sd/apache-hive-2.3.4-bin/lib<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">由于hive的文件本身就在hdfs中保存的，所以需要指定Hadoop_Home的路径，同时指定配置文件路径和依赖包的路径。</p><ol start="2" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">修改hive-site.xml文件</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #5c6370;font-style: italic;line-height: 26px;">&lt;!--指定mysql数据库连接的database--&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>jdbc:mysql://192.168.244.161:3306/hive?createDatabaseIfNotExist=true<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>JDBC&nbsp;connect&nbsp;string&nbsp;for&nbsp;a&nbsp;JDBC&nbsp;metastore<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>com.mysql.jdbc.Driver<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>Driver&nbsp;class&nbsp;name&nbsp;for&nbsp;a&nbsp;JDBC&nbsp;metastore<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>root<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>username&nbsp;to&nbsp;use&nbsp;against&nbsp;metastore&nbsp;database<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>123456<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>password&nbsp;to&nbsp;use&nbsp;against&nbsp;metastore&nbsp;database<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>hive.metastore.uris<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>thrift://hlink163:9083<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>Thrift&nbsp;URI&nbsp;for&nbsp;the&nbsp;remote&nbsp;metastore.&nbsp;Used&nbsp;by&nbsp;metastore&nbsp;client&nbsp;to&nbsp;connect&nbsp;to&nbsp;remote&nbsp;metastore.<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>datanucleus.schema.autoCreateAll<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>true<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>hive.server2.logging.operation.log.location<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>/root/sd/apache-hive-2.3.4-bin/tmp/operation_logs<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>Top&nbsp;level&nbsp;directory&nbsp;where&nbsp;operation&nbsp;logs&nbsp;are&nbsp;stored&nbsp;if&nbsp;logging&nbsp;functionality&nbsp;is&nbsp;enabled<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  /><span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>hive.exec.scratchdir<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>/root/sd/apache-hive-2.3.4-bin/tmp/hive<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>HDFS&nbsp;root&nbsp;scratch&nbsp;dir&nbsp;for&nbsp;Hive&nbsp;jobs&nbsp;which&nbsp;gets&nbsp;created&nbsp;with&nbsp;write&nbsp;all&nbsp;(733)&nbsp;permission.&nbsp;For&nbsp;each&nbsp;connecting&nbsp;user,&nbsp;an&nbsp;HDFS&nbsp;scratch&nbsp;dir:&nbsp;${hive.exec.scratchdir}/<span style="color: #61aeee;line-height: 26px;">&amp;lt;</span>username<span style="color: #61aeee;line-height: 26px;">&amp;gt;</span>&nbsp;is&nbsp;created,&nbsp;with&nbsp;${hive.scratch.dir.permission}.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  />&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  />&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>hive.exec.local.scratchdir<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>/root/sd/apache-hive-2.3.4-bin/tmp/hive/local<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>Local&nbsp;scratch&nbsp;space&nbsp;for&nbsp;Hive&nbsp;jobs<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  />&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /><br  />&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span>hive.downloaded.resources.dir<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">name</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span>/root/sd/apache-hive-2.3.4-bin/tmp/hive/resources<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">value</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span>Temporary&nbsp;local&nbsp;directory&nbsp;for&nbsp;added&nbsp;resources&nbsp;in&nbsp;the&nbsp;remote&nbsp;file&nbsp;system.<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">description</span>&gt;</span><br  />&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: #e06c75;line-height: 26px;">property</span>&gt;</span><br  /></code></pre><ol start="3" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">添加Flink与Hadoop的依赖 &nbsp;在flink-conf.yaml 中添加hadoop依赖.</section></li></ol><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.13038793103448276" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69ib1icBcdvjhsB3MnPqNdMorcGLzmgrrv9xUP5BANC0SyhYuicWnT82zxg/640?wx_fmt=png" data-type="png" data-w="928" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>2.5 Hive集群启动<span style="display: none;"></span></h3><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">启动hive服务器</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">hive&nbsp;--service&nbsp;metastore&nbsp;&nbsp;&nbsp;&nbsp;//端口号9083&nbsp;&nbsp;&nbsp;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以使用命令查询一下，看是否启动成功</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">&nbsp;netstat&nbsp;-ntpl&nbsp;|&nbsp;grep&nbsp;9083</code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>2.6 Flink集群启动<span style="display: none;"></span></h3><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">启动Flink SQL(在bin目录下)</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">./sql-client.sh&nbsp;embedded&nbsp;-d&nbsp;../conf/sql-client-defaults.yaml<br  /></code></pre><ol start="2" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">在flink sql 下查看hive的catalogs</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">show&nbsp;catalogs&nbsp;&nbsp;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">结果如下：<img data-ratio="0.3466666666666667" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk69VAyLfG7IicLRgnkCfPtVTx2HsHOpj5dxF1yImUFzCVpfoUuplG58OAg/640?wx_fmt=png" data-type="png" data-w="675" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></p><ol start="3" data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">使用myhive catalog</section></li></ol><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">use&nbsp;catalog&nbsp;myhive;&nbsp;<br  />show&nbsp;tables;&nbsp;<br  /></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">3、kafka-Flink-Hive DDL</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>3.1、创建flink读取kafka的表（source）<span style="display: none;"></span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;指定使用flink&nbsp;sql默认的语言</span><br  /><span style="color: #c678dd;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=<span style="color: #c678dd;line-height: 26px;">default</span>;<br  /><span style="color: #c678dd;line-height: 26px;">CREATE</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">TABLE</span>&nbsp;log_kafka&nbsp;(<br  />&nbsp;&nbsp;user_id&nbsp;<span style="color: #c678dd;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;order_amount&nbsp;<span style="color: #c678dd;line-height: 26px;">DOUBLE</span>,<br  />&nbsp;&nbsp;log_ts&nbsp;<span style="color: #e6c07b;line-height: 26px;">TIMESTAMP</span>(<span style="color: #d19a66;line-height: 26px;">3</span>),<br  />&nbsp;&nbsp;WATERMARK&nbsp;<span style="color: #c678dd;line-height: 26px;">FOR</span>&nbsp;log_ts&nbsp;<span style="color: #c678dd;line-height: 26px;">AS</span>&nbsp;log_ts&nbsp;-&nbsp;<span style="color: #e6c07b;line-height: 26px;">INTERVAL</span>&nbsp;<span style="color: #98c379;line-height: 26px;">'5'</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">SECOND</span><br  />)&nbsp;<span style="color: #c678dd;line-height: 26px;">WITH</span>&nbsp;(<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'connector'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'kafka'</span>,<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'topic'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'test'</span>,<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'properties.bootstrap.servers'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'192.168.244.161:9092'</span>,<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'scan.startup.mode'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'earliest-offset'</span>,<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'format'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'json'</span>,<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'json.ignore-parse-errors'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'true'</span>,&nbsp;<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'json.fail-on-missing-field'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'false'</span>,<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'properties.group.id'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'flink1'</span><br  />);<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">kafka消费的启动模式有
'earliest-offset'，
'latest-offset'，
'group-offsets'，
'timestamp'，
'specific-offsets'等</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>3.2、创建flink写入hive表（sink）<span style="display: none;"></span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #c678dd;line-height: 26px;">SET</span>&nbsp;table.sql-dialect=hive;<br  /><span style="color: #c678dd;line-height: 26px;">CREATE</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">TABLE</span>&nbsp;log_hive&nbsp;(<br  />&nbsp;&nbsp;user_id&nbsp;<span style="color: #c678dd;line-height: 26px;">STRING</span>,<br  />&nbsp;&nbsp;order_amount&nbsp;<span style="color: #c678dd;line-height: 26px;">DOUBLE</span><br  />)&nbsp;PARTITIONED&nbsp;<span style="color: #c678dd;line-height: 26px;">BY</span>&nbsp;(dt&nbsp;<span style="color: #c678dd;line-height: 26px;">STRING</span>,&nbsp;hr&nbsp;<span style="color: #c678dd;line-height: 26px;">STRING</span>)&nbsp;<span style="color: #c678dd;line-height: 26px;">STORED</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">AS</span>&nbsp;parquet&nbsp;TBLPROPERTIES&nbsp;(<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'partition.time-extractor.timestamp-pattern'</span>=<span style="color: #98c379;line-height: 26px;">'$dt&nbsp;$hr:00:00'</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.partition-commit.trigger'</span>=<span style="color: #98c379;line-height: 26px;">'partition-time'</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.partition-commit.delay'</span>=<span style="color: #98c379;line-height: 26px;">'1min'</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.semantic'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'exactly-once'</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.rolling-policy.file-size'</span>=<span style="color: #98c379;line-height: 26px;">'128MB'</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.rolling-policy.rollover-interval'</span>&nbsp;=<span style="color: #98c379;line-height: 26px;">'1min'</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.rolling-policy.check-interval'</span>=<span style="color: #98c379;line-height: 26px;">'1min'</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.partition-commit.policy.kind'</span>=<span style="color: #98c379;line-height: 26px;">'metastore,success-file'</span><br  />);<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">配置解释：</p><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-2"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">'sink.partition-commit.trigger'='partition-time'</code>,<br  />-- 使用partition中抽取时间，加上watermark决定partiton commit的时机</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">'partition.time-extractor.timestamp-pattern'='$dt $hour:00:00'</code>,<br  />-- 配置hour级别的partition时间抽取策略，这个例子中dt字段是yyyy-MM-dd格式的天，hour是0-23的小时，timestamp-pattern定义了如何从这两个partition字段推出完整的timestamp</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">'sink.partition-commit.delay'='1 min'</code>,<br  />-- 配置dalay为分钟级，当 watermark &gt; partition时间 + 1分钟，会commit这个partition</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">'sink.partition-commit.policy.kind’='metastore,success-file'</code><br  />-- partitiion commit的策略是：先更新metastore(addPartition)，再写SUCCESS文件</p></section></li></ol><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>3.3、将数据插入hive中<span style="display: none;"></span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #c678dd;line-height: 26px;">INSERT</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">INTO</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">TABLE</span>&nbsp;log_hive&nbsp;<span style="color: #c678dd;line-height: 26px;">SELECT</span>&nbsp;user_id,&nbsp;order_amount,<span style="color: #c678dd;line-height: 26px;">DATE_FORMAT</span>(log_ts,&nbsp;<span style="color: #98c379;line-height: 26px;">'yyyy-MM-dd'</span>),&nbsp;<span style="color: #c678dd;line-height: 26px;">DATE_FORMAT</span>(log_ts,&nbsp;<span style="color: #98c379;line-height: 26px;">'HH'</span>)&nbsp;<span style="color: #c678dd;line-height: 26px;">FROM</span>&nbsp;log_kafka;&nbsp;&nbsp;&nbsp;&nbsp;<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>3.4、查询结果<span style="display: none;"></span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #5c6370;font-style: italic;line-height: 26px;">--&nbsp;batch&nbsp;sql,&nbsp;select&nbsp;with&nbsp;partition&nbsp;pruning</span><br  /><span style="color: #c678dd;line-height: 26px;">SELECT</span>&nbsp;*&nbsp;<span style="color: #c678dd;line-height: 26px;">FROM</span>&nbsp;hive_table&nbsp;<span style="color: #c678dd;line-height: 26px;">WHERE</span>&nbsp;dt=<span style="color: #98c379;line-height: 26px;">'2020-08-25'</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">and</span>&nbsp;hr=<span style="color: #98c379;line-height: 26px;">'16'</span>;&nbsp;&nbsp;<br  /></code></pre><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.16170212765957448" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk696CRSs1UziadtiamHBYwYQpnPWtvDhF3fPdnGBtwuC5FzvfmhDkY3siaHQ/640?wx_fmt=png" data-type="png" data-w="940" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">4、kafka-Flink-Hive Table API编写</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span></h3><h3 style="margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 20px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);">4.1 pom.xml配置</h3><pre style="font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(171, 178, 191);background: rgb(40, 44, 52);border-radius: 5px;"><span style="color: rgb(97, 174, 238);line-height: 26px;">&lt;?xml&nbsp;version="1.0"&nbsp;encoding="UTF-8"?&gt;</span><br  /><span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">project</span>&nbsp;<span style="color: rgb(209, 154, 102);line-height: 26px;">xmlns</span>=<span style="color: rgb(152, 195, 121);line-height: 26px;">"http://maven.apache.org/POM/4.0.0"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(209, 154, 102);line-height: 26px;">xmlns:xsi</span>=<span style="color: rgb(152, 195, 121);line-height: 26px;">"http://www.w3.org/2001/XMLSchema-instance"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(209, 154, 102);line-height: 26px;">xsi:schemaLocation</span>=<span style="color: rgb(152, 195, 121);line-height: 26px;">"http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">modelVersion</span>&gt;</span>4.0.0<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">modelVersion</span>&gt;</span><br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>com.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flinkhive<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">packaging</span>&gt;</span>jar<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">packaging</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>1.0-SNAPSHOT<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">properties</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">scala.bin.version</span>&gt;</span>2.11<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">scala.bin.version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">flink.version</span>&gt;</span>1.13.0<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">flink.version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">hadoop.version</span>&gt;</span>2.6.4<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">hadoop.version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">hive.version</span>&gt;</span>2.3.4<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">hive.version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">properties</span>&gt;</span><br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependencies</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-streaming-scala_${scala.bin.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-streaming-java_${scala.binary.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-clients_${scala.bin.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-table-common<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-table-api-scala-bridge_${scala.bin.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-table-planner-blink_${scala.bin.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-connector-hive_${scala.bin.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-sql-connector-kafka_${scala.bin.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.flink<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>flink-json<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${flink.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.hadoop<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>hadoop-common<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${hadoop.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.hadoop<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>hadoop-hdfs<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${hadoop.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.hadoop<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>hadoop-yarn-client<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${hadoop.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.hadoop<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>hadoop-mapreduce-client-core<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${hadoop.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span>org.apache.hive<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">groupId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span>hive-exec<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">artifactId</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span>${hive.version}<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">version</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependency</span>&gt;</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">dependencies</span>&gt;</span><br  /><span style="line-height: 26px;">&lt;/<span style="color: rgb(224, 108, 117);line-height: 26px;">project</span>&gt;</span><br  /></code></pre><h3 style="margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 20px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);">4.2 代码存放路径截图</h3><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img data-ratio="0.9092558983666061" src="https://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8OW3163oEtiaGroyZlMcjk696eNksbsiaGw2J6hz5pOrN4U1arz5GAcILn7ITSWDvUJR0W6AcoSHfDw/640?wx_fmt=png" data-type="png" data-w="551" style="display: block;margin-right: auto;margin-left: auto;height: auto !important;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Scala版本代码:</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/aXUpZVUYfjwNMrV9gvcCWzKPXFeicRCnxC7LJFicX7kRmnlMxcHPJRJLdUjIlPhmowiaBGib8c5eBWA0iaia9t0B2rhq4dHVK6f6cX/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #c678dd;line-height: 26px;">import</span>&nbsp;java.time.<span style="color: #d19a66;line-height: 26px;">Duration</span><br  /><br  /><span style="color: #c678dd;line-height: 26px;">import</span>&nbsp;org.apache.flink.streaming.api.{<span style="color: #d19a66;line-height: 26px;">CheckpointingMode</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">TimeCharacteristic</span>}<br  /><span style="color: #c678dd;line-height: 26px;">import</span>&nbsp;org.apache.flink.streaming.api.environment.<span style="color: #d19a66;line-height: 26px;">ExecutionCheckpointingOptions</span><br  /><span style="color: #c678dd;line-height: 26px;">import</span>&nbsp;org.apache.flink.streaming.api.scala.<span style="color: #d19a66;line-height: 26px;">StreamExecutionEnvironment</span><br  /><span style="color: #c678dd;line-height: 26px;">import</span>&nbsp;org.apache.flink.table.api.{<span style="color: #d19a66;line-height: 26px;">EnvironmentSettings</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">SqlDialect</span>}<br  /><span style="color: #c678dd;line-height: 26px;">import</span>&nbsp;org.apache.flink.table.api.bridge.scala.<span style="color: #d19a66;line-height: 26px;">StreamTableEnvironment</span><br  /><span style="color: #c678dd;line-height: 26px;">import</span>&nbsp;org.apache.flink.table.catalog.hive.<span style="color: #d19a66;line-height: 26px;">HiveCatalog</span><br  /><br  /><span style="line-height: 26px;"><span style="color: #c678dd;line-height: 26px;">object</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">KafkaToHive</span>&nbsp;</span>{<br  />&nbsp;&nbsp;<span style="line-height: 26px;"><span style="color: #c678dd;line-height: 26px;">def</span>&nbsp;<span style="color: #61aeee;line-height: 26px;">main</span></span>(args:&nbsp;<span style="color: #d19a66;line-height: 26px;">Array</span>[<span style="color: #d19a66;line-height: 26px;">String</span>]):&nbsp;<span style="color: #d19a66;line-height: 26px;">Unit</span>&nbsp;=&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">val</span>&nbsp;streamEnv&nbsp;=&nbsp;<span style="color: #d19a66;line-height: 26px;">StreamExecutionEnvironment</span>.getExecutionEnvironment<br  />&nbsp;&nbsp;&nbsp;&nbsp;streamEnv.setStreamTimeCharacteristic(<span style="color: #d19a66;line-height: 26px;">TimeCharacteristic</span>.<span style="color: #d19a66;line-height: 26px;">EventTime</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;streamEnv.setParallelism(<span style="color: #d19a66;line-height: 26px;">3</span>)<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">val</span>&nbsp;tableEnvSettings&nbsp;=&nbsp;<span style="color: #d19a66;line-height: 26px;">EnvironmentSettings</span>.newInstance()<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.useBlinkPlanner()<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.inStreamingMode()<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.build()<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">val</span>&nbsp;tableEnv&nbsp;=&nbsp;<span style="color: #d19a66;line-height: 26px;">StreamTableEnvironment</span>.create(streamEnv,&nbsp;tableEnvSettings)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig.getConfiguration.set(<span style="color: #d19a66;line-height: 26px;">ExecutionCheckpointingOptions</span>.<span style="color: #d19a66;line-height: 26px;">CHECKPOINTING_MODE</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">CheckpointingMode</span>.<span style="color: #d19a66;line-height: 26px;">EXACTLY_ONCE</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig.getConfiguration.set(<span style="color: #d19a66;line-height: 26px;">ExecutionCheckpointingOptions</span>.<span style="color: #d19a66;line-height: 26px;">CHECKPOINTING_INTERVAL</span>,&nbsp;<span style="color: #d19a66;line-height: 26px;">Duration</span>.ofSeconds(<span style="color: #d19a66;line-height: 26px;">20</span>))<br  /><br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">val</span>&nbsp;catalogName&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"my_catalog"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">val</span>&nbsp;catalog&nbsp;=&nbsp;<span style="color: #c678dd;line-height: 26px;">new</span>&nbsp;<span style="color: #d19a66;line-height: 26px;">HiveCatalog</span>(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catalogName,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">//&nbsp;catalog&nbsp;name</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"default"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">//&nbsp;default&nbsp;database</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"./src/main/resources"</span>,&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">//&nbsp;Hive&nbsp;config&nbsp;(hive-site.xml)&nbsp;directory</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"2.3.4"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">//&nbsp;Hive&nbsp;version</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.registerCatalog(catalogName,&nbsp;catalog)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.useCatalog(catalogName)<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: #98c379;line-height: 26px;">"CREATE&nbsp;DATABASE&nbsp;IF&nbsp;NOT&nbsp;EXISTS&nbsp;stream_tmp"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: #98c379;line-height: 26px;">"DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;stream_tmp.log_kafka"</span>)<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">""</span><span style="color: #98c379;line-height: 26px;">"<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|CREATE&nbsp;TABLE&nbsp;stream_tmp.log_kafka&nbsp;(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;user_id&nbsp;STRING,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;order_amount&nbsp;DOUBLE,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;log_ts&nbsp;TIMESTAMP(3),<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;WATERMARK&nbsp;FOR&nbsp;log_ts&nbsp;AS&nbsp;log_ts&nbsp;-&nbsp;INTERVAL&nbsp;'5'&nbsp;SECOND<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|)&nbsp;WITH&nbsp;(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'connector'&nbsp;=&nbsp;'kafka',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'topic'&nbsp;=&nbsp;'test',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'properties.bootstrap.servers'&nbsp;=&nbsp;'hlink163:9092',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'properties.group.id'&nbsp;=&nbsp;'flink1',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'scan.startup.mode'&nbsp;=&nbsp;'earliest-offset',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'format'&nbsp;=&nbsp;'json',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'json.fail-on-missing-field'&nbsp;=&nbsp;'false',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'json.ignore-parse-errors'&nbsp;=&nbsp;'true'<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span style="color: #98c379;line-height: 26px;">""</span>.stripMargin<br  />&nbsp;&nbsp;&nbsp;&nbsp;)<br  /><br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig.setSqlDialect(<span style="color: #d19a66;line-height: 26px;">SqlDialect</span>.<span style="color: #d19a66;line-height: 26px;">HIVE</span>)<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: #98c379;line-height: 26px;">"CREATE&nbsp;DATABASE&nbsp;IF&nbsp;NOT&nbsp;EXISTS&nbsp;hive_tmp"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: #98c379;line-height: 26px;">"DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;hive_tmp.log_hive"</span>)<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">""</span><span style="color: #98c379;line-height: 26px;">"<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|CREATE&nbsp;TABLE&nbsp;hive_tmp.log_hive&nbsp;(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;user_id&nbsp;STRING,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;order_amount&nbsp;DOUBLE<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|)&nbsp;PARTITIONED&nbsp;BY&nbsp;(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;dt&nbsp;STRING,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;hr&nbsp;STRING<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|)&nbsp;STORED&nbsp;AS&nbsp;PARQUET<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|TBLPROPERTIES&nbsp;(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'sink.partition-commit.trigger'&nbsp;=&nbsp;'partition-time',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'sink.partition-commit.delay'&nbsp;=&nbsp;'1&nbsp;min',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'format'&nbsp;=&nbsp;'json',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'sink.partition-commit.policy.kind'&nbsp;=&nbsp;'metastore,success-file',<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;'partition.time-extractor.timestamp-pattern'='$dt&nbsp;$hr:00:00'<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span style="color: #98c379;line-height: 26px;">""</span>.stripMargin<br  />&nbsp;&nbsp;&nbsp;&nbsp;)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig.setSqlDialect(<span style="color: #d19a66;line-height: 26px;">SqlDialect</span>.<span style="color: #d19a66;line-height: 26px;">DEFAULT</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">""</span><span style="color: #98c379;line-height: 26px;">"<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|INSERT&nbsp;INTO&nbsp;hive_tmp.log_hive<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|SELECT<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;user_id,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;order_amount,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;DATE_FORMAT(log_ts,&nbsp;'yyyy-MM-dd'),&nbsp;DATE_FORMAT(log_ts,&nbsp;'HH')<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;FROM&nbsp;stream_tmp.log_kafka<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span style="color: #98c379;line-height: 26px;">""</span>.stripMargin<br  />&nbsp;&nbsp;&nbsp;&nbsp;)<br  /><br  />&nbsp;&nbsp;}<br  />}<br  /><br  /></code></pre></section><section style="outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 14px;"><br  /></span></section><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);">java版本代码:</p><pre style="font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(171, 178, 191);background: rgb(40, 44, 52);border-radius: 5px;"><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.streaming.api.CheckpointingMode;<br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.streaming.api.TimeCharacteristic;<br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.streaming.api.environment.ExecutionCheckpointingOptions;<br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;<br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.table.api.EnvironmentSettings;<br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.table.api.SqlDialect;<br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.table.api.bridge.java.StreamTableEnvironment;<br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;org.apache.flink.table.catalog.hive.HiveCatalog;<br  /><br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">import</span>&nbsp;java.time.Duration;<br  /><br  /><span style="color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">/**<br  />&nbsp;*&nbsp;类描述：<br  />&nbsp;*<br  />&nbsp;*&nbsp;<span style="color: rgb(198, 120, 221);line-height: 26px;">@ClassName</span>&nbsp;KafkaToHive<br  />&nbsp;*&nbsp;<span style="color: rgb(198, 120, 221);line-height: 26px;">@Description</span>:<br  />&nbsp;*&nbsp;<span style="color: rgb(198, 120, 221);line-height: 26px;">@Author</span>:&nbsp;lyz<br  />&nbsp;*&nbsp;<span style="color: rgb(198, 120, 221);line-height: 26px;">@Date</span>:&nbsp;2021/9/6&nbsp;下午9:50<br  />&nbsp;*/</span><br  /><span style="color: rgb(198, 120, 221);line-height: 26px;">public</span>&nbsp;<span style="line-height: 26px;"><span style="color: rgb(198, 120, 221);line-height: 26px;">class</span>&nbsp;<span style="color: rgb(230, 192, 123);line-height: 26px;">KafkaToHive</span>&nbsp;</span>{<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 26px;"><span style="color: rgb(198, 120, 221);line-height: 26px;">public</span>&nbsp;<span style="color: rgb(198, 120, 221);line-height: 26px;">static</span>&nbsp;<span style="color: rgb(198, 120, 221);line-height: 26px;">void</span>&nbsp;<span style="color: rgb(97, 174, 238);line-height: 26px;">main</span><span style="line-height: 26px;">(String[]&nbsp;args)</span>&nbsp;</span>{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StreamExecutionEnvironment&nbsp;senv&nbsp;=&nbsp;StreamExecutionEnvironment.getExecutionEnvironment();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;senv.setStreamTimeCharacteristic(TimeCharacteristic.EventTime);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;senv.setParallelism(<span style="color: rgb(209, 154, 102);line-height: 26px;">3</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnvironmentSettings&nbsp;tableEnvSettings&nbsp;=&nbsp;EnvironmentSettings.newInstance().useBlinkPlanner().inStreamingMode()<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.build();<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StreamTableEnvironment&nbsp;tableEnv&nbsp;=&nbsp;StreamTableEnvironment.create(senv,&nbsp;tableEnvSettings);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">//</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig().getConfiguration().set(ExecutionCheckpointingOptions.CHECKPOINTING_MODE,&nbsp;CheckpointingMode.EXACTLY_ONCE);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig().getConfiguration().set(ExecutionCheckpointingOptions.CHECKPOINTING_INTERVAL,&nbsp;Duration.ofSeconds(<span style="color: rgb(209, 154, 102);line-height: 26px;">20</span>));<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;catalogName&nbsp;=&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"my_catalog"</span>;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HiveCatalog&nbsp;catalog&nbsp;=&nbsp;<span style="color: rgb(198, 120, 221);line-height: 26px;">new</span>&nbsp;HiveCatalog(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catalogName,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">//&nbsp;catalog&nbsp;name</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"default"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">//&nbsp;default&nbsp;database</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"./src/main/resources"</span>,&nbsp;&nbsp;<span style="color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">//&nbsp;Hive&nbsp;config&nbsp;(hive-site.xml)&nbsp;directory</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"2.3.4"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">//&nbsp;Hive&nbsp;version</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.registerCatalog(catalogName,&nbsp;catalog);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.useCatalog(catalogName);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: rgb(152, 195, 121);line-height: 26px;">"CREATE&nbsp;DATABASE&nbsp;IF&nbsp;NOT&nbsp;EXISTS&nbsp;stream_tmp"</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: rgb(152, 195, 121);line-height: 26px;">"DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;stream_tmp.log_kafka"</span>);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: rgb(152, 195, 121);line-height: 26px;">"create&nbsp;table&nbsp;stream_tmp.log_kafka("</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"user_id&nbsp;String,\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"order_amount&nbsp;Double,\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"log_ts&nbsp;Timestamp(3),\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"WATERMARK&nbsp;FOR&nbsp;log_ts&nbsp;AS&nbsp;log_ts&nbsp;-INTERVAL&nbsp;'5'&nbsp;SECOND"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">")WITH("</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;'connector'&nbsp;=&nbsp;'kafka',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"'topic'&nbsp;=&nbsp;'test',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;'properties.bootstrap.servers'&nbsp;=&nbsp;'192.168.244.161:9092',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"'properties.group.id'&nbsp;=&nbsp;'flink1',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"'scan.startup.mode'&nbsp;=&nbsp;'earliest-offset',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"'format'&nbsp;=&nbsp;'json',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"'json.fail-on-missing-field'&nbsp;=&nbsp;'false',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"'json.ignore-parse-errors'&nbsp;=&nbsp;'true'"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">")"</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig().setSqlDialect(SqlDialect.HIVE);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: rgb(152, 195, 121);line-height: 26px;">"CREATE&nbsp;DATABASE&nbsp;IF&nbsp;NOT&nbsp;EXISTS&nbsp;hive_tmp"</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: rgb(152, 195, 121);line-height: 26px;">"DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;hive_tmp.log_hive"</span>);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;CREATE&nbsp;TABLE&nbsp;hive_tmp.log_hive&nbsp;(\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_id&nbsp;STRING,\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order_amount&nbsp;DOUBLE\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;PARTITIONED&nbsp;BY&nbsp;(\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt&nbsp;STRING,\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hr&nbsp;STRING\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;STORED&nbsp;AS&nbsp;PARQUET\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TBLPROPERTIES&nbsp;(\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'sink.partition-commit.trigger'&nbsp;=&nbsp;'partition-time',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'sink.partition-commit.delay'&nbsp;=&nbsp;'1&nbsp;min',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'format'&nbsp;=&nbsp;'json',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'sink.partition-commit.policy.kind'&nbsp;=&nbsp;'metastore,success-file',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'partition.time-extractor.timestamp-pattern'='$dt&nbsp;$hr:00:00'"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)"</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.getConfig().setSqlDialect(SqlDialect.DEFAULT);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableEnv.executeSql(<span style="color: rgb(152, 195, 121);line-height: 26px;">""</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;INTO&nbsp;hive_tmp.log_hive\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_id,\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order_amount,\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE_FORMAT(log_ts,&nbsp;'yyyy-MM-dd'),&nbsp;DATE_FORMAT(log_ts,&nbsp;'HH')\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;stream_tmp.log_kafka"</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  />}<br  /></code></pre><pre style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 0, 0);"><strong>以上就是Kafka-Flink-Hive的所有内容！觉得好的，点赞，在看，分享三连击，谢谢！！！</strong></span></p><p style="margin-right: 8px;margin-left: 8px;outline: 0px;white-space: normal;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><br style="outline: 0px;"  /></p><section style="margin-right: 8px;margin-left: 8px;outline: 0px;white-space: normal;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><section data-mid="" mpa-from-tpl="t" style="outline: 0px;display: flex;justify-content: center;align-items: center;width: 677px;"><section data-mid="" mpa-from-tpl="t" style="outline: 0px;display: flex;justify-content: flex-start;align-items: center;flex-direction: column;"><section data-mid="" mpa-from-tpl="t" style="margin-right: 5px;margin-bottom: -21.1px;outline: 0px;width: 20px;height: 21px;display: flex;justify-content: center;align-items: center;align-self: flex-end;z-index: 1;"><img class="__bg_gif" data-ratio="1.0128205128205128" src="https://mmbiz.qpic.cn/mmbiz_gif/Duic8KIkR1rPHkHEsIlgD7EDXBYsibgbDmvTuicQpZlOyh1jkuuvCibCFhd5SssEZhsy1ibdvaB4mrUQc7T5icLFtSxA/640?wx_fmt=gif" data-type="gif" data-w="78" style="outline: 0px;box-sizing: border-box !important;visibility: visible !important;width: 78px !important;height: auto !important;"  /></section><section data-mid="" mpa-from-tpl="t" style="outline: 0px;display: flex;justify-content: flex-start;align-items: center;flex-direction: column;"><section data-mid="" mpa-from-tpl="t" style="padding-right: 26px;padding-left: 8px;outline: 0px;text-align: center;"><p data-mid="" style=" outline: 0px;font-size: 16px; color: rgb(255, 255, 255);line-height: 22px;letter-spacing: 4px;text-shadow: rgb(47, 47, 47) 1px 1px 0px, rgb(47, 47, 47) 1px 0px 0px, rgb(47, 47, 47) -1px 0px 0px, rgb(47, 47, 47) 0px -1px 0px, rgb(47, 47, 47) 0px 1px 0px, rgb(47, 47, 47) -1px -1px 0px, rgb(47, 47, 47) -1px 1px 0px, rgb(47, 47, 47) 1px -1px 0px, rgb(176, 206, 202) 3px 2px 0px, rgb(176, 206, 202) 1px 2px 0px, rgb(176, 206, 202) 2px 1px 0px, rgb(176, 206, 202) 2px 3px 0px, rgb(176, 206, 202) 1px 1px 0px, rgb(176, 206, 202) 1px 3px 0px, rgb(176, 206, 202) 3px 1px 0px, rgb(176, 206, 202) 3px 3px 0px, rgb(176, 206, 202) 2px 2px 0px; ">End<br style="outline: 0px;"  /></p></section><section data-mid="" mpa-from-tpl="t" style="outline: 0px;width: 76.15px;height: 3px;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/Vw5ZNjwEsibNn5KnVZicibTFDxyvCwtMzzVibPHnc0exsxibBBLUnKxGNYbReLUKpCkOxb71ibBRK1hM1XCfDFOtkoBQ/640?wx_fmt=png&quot;);background-size: 100% 100%;"><br style="outline: 0px;"  /></section></section></section></section></section><section style="margin-right: 8px;margin-left: 8px;outline: 0px;white-space: normal;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><br style="outline: 0px;"  /></section><section style="margin-right: 8px;margin-left: 8px;outline: 0px;white-space: normal;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><span style="outline: 0px;color: rgb(61, 170, 214);"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 14px;">最近整理了一份计算机类的书籍，包含python、java、大数据、人工智能、算法等，种类特别齐全。</span></strong></span></section><section style="margin-right: 8px;margin-left: 8px;outline: 0px;white-space: normal;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><span style="outline: 0px;color: rgb(61, 170, 214);"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 14px;">获取方式：</span></strong></span><span style="letter-spacing: 0.544px;outline: 0px;color: rgb(61, 170, 214);"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 14px;">关注公众号：</span></strong></span><span style="letter-spacing: 0.544px;outline: 0px;color: rgb(255, 76, 0);"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 14px;">3分钟秒懂大数据</span></strong></span><span style="letter-spacing: 0.544px;outline: 0px;color: rgb(61, 170, 214);"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 14px;">，回复：</span></strong></span><strong style="letter-spacing: 0.544px;outline: 0px;"><span style="outline: 0px;color: rgb(255, 76, 65);font-size: 14px;">福利，</span></strong><span style="letter-spacing: 0.544px;outline: 0px;color: rgb(61, 170, 214);"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 14px;">就可以获得这份超级大礼！</span></strong></span></section><section class="mp_profile_iframe_wrp"><mpprofile class="js_uneditable custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzU4NjY4NDU0MQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/nEEdkvXCJ8ODLj6gb1ooPOCy6SgyuHHqr4nIKd9UPXvzcPedPNBRA37Vfsbjkhzem06AibibggLatT97td0N1PdA/0?wx_fmt=png" data-nickname="3分钟秒懂大数据" data-alias="three-m-u-bigdata" data-signature="专注于大数据、AB融合、python数据分析、AI等技术博文的分享，提供最前沿的技术博客!" data-from="0"></mpprofile></section><section data-recommend-type="list-title" data-recommend-tid="6" data-mpa-template="t" data-mid="" data-from="yb-recommend" style="outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);width: 657px;display: flex;justify-content: center;align-items: center;"><section data-mid="" style="padding: 14px;outline: 0px;width: 657px;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;border-radius: 3px;border-width: 1px;border-style: solid;border-color: rgb(232, 232, 235);"><section data-mid="" style="outline: 0px;width: 627px;display: flex;justify-content: center;align-items: flex-end;"><section data-mid="" style="margin-bottom: -14px;padding: 4px 22px;outline: 0px;height: 28px;font-size: 14px;color: rgb(19, 52, 86);line-height: 20px;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/sUbvrqLicbpzB81mjeBxPuxnYdalGxNnJo30L2Hq3WwGficcq8w5YJkLeXnsNHocN53k55TfN5mBpCdicGRyfDg1g/640?wx_fmt=png&quot;);background-repeat: no-repeat;background-size: 100% 100%;z-index: 10;"><p data-mid="" style="outline: 0px;">往期推荐</p></section></section><section data-mid="" style="padding: 17px 16px 9px;outline: 0px;width: 627px;border-width: 1px;border-style: solid;border-color: rgb(198, 226, 255);"><section data-mpa-template="t" data-recommend-article-type="list-title" data-recomment-template-id="6" data-recommend-article-id="2247486018_1" data-recommend-article-time="1627864500" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/2vOI7k3wdyBztRl3dF3I38VKfkoy7HTevfqMaNNWw7ZXyzQEUEUxKQeMOOYtxU9DdAUXVNnNW0fJMtaQtWctQQ/0?wx_fmt=jpeg" data-recommend-article-title="没有Linux服务器，该如何学习Linux呢？" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzIwMjc3NjE1NQ==&amp;mid=2247486018&amp;idx=1&amp;sn=2e9d4cd4ea4a956659b692883e0ba2f4&amp;chksm=96d8c176a1af4860bc49dfd7ff5bd44d040756b57f2c5b027ae0f548acadab4c1967d29164b3#rd" style="outline: 0px;"><section data-recommend-title="t" data-recommend-content="t" data-mid="" style="padding: 6px;outline: 0px;width: 593px;display: flex;justify-content: center;align-items: center;flex-wrap: nowrap;border-bottom: 1px dashed rgb(198, 226, 255);font-size: 13px;color: rgb(44, 95, 149);line-height: 18px;"><section data-recommend-type="list-title" data-recommend-tid="6" data-mpa-template="t" data-mid="" data-from="yb-recommend" style="outline: 0px;width: 581px;display: flex;justify-content: center;align-items: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjY4NDU0MQ==&amp;mid=2247494470&amp;idx=1&amp;sn=1ee968c33f1ea33ec59d5525ad6b154d&amp;chksm=fdf52a54ca82a342238cfc0a6d43cb21c0fb37dbd95a57c8fc3569085cece97aa2ff95522650&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1" style="outline: 0px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjY4NDU0MQ==&amp;mid=2247496772&amp;idx=1&amp;sn=da96d733b26055f40fe800922ea24921&amp;chksm=fdf53556ca82bc40ef9b944caea2be6ad50f7858d7bb53eba210d71b35accc92fa28a1ed6c9e&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" style="display: inline !important;" data-linktype="2">史上最全干货！Flink面试大全总结（全文6万字、110个知识点、160张图）</a></section><p style="outline: 0px;"><br style="outline: 0px;"  /></p></section></section><section data-mpa-template="t" data-recommend-article-type="list-title" data-recomment-template-id="6" data-recommend-article-id="2247485983_1" data-recommend-article-time="1621988653" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/2vOI7k3wdyDiasgPykwZy0pIMBV1uPElPa6y95nvz71yzBUV2FAs9zs5mDLUUW4DkdCibbQ8HDbahIcUK0shYQzA/0?wx_fmt=jpeg" data-recommend-article-title="大厂的产品研发流程，你知道么？" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzIwMjc3NjE1NQ==&amp;mid=2247485983&amp;idx=1&amp;sn=81fafa6d0ea36fd2b13d4d06b00e16a3&amp;chksm=96d8c12ba1af483d36985cc6b548abb6f4903b64f20d279762bbfe13ed850d760716c98c7a03#rd" style="outline: 0px;"><a href="http://mp.weixin.qq.com/s?__biz=MzIwMjc3NjE1NQ==&amp;mid=2247485983&amp;idx=1&amp;sn=81fafa6d0ea36fd2b13d4d06b00e16a3&amp;chksm=96d8c12ba1af483d36985cc6b548abb6f4903b64f20d279762bbfe13ed850d760716c98c7a03&amp;scene=21#wechat_redirect" data-linktype="2" wah-hotarea="click" style="outline: 0px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;"><section data-recommend-title="t" data-recommend-content="t" data-mid="" style="padding: 6px;outline: 0px;width: 593px;display: flex;justify-content: center;align-items: center;flex-wrap: nowrap;border-bottom: 1px dashed rgb(198, 226, 255);font-size: 13px;color: rgb(44, 95, 149);line-height: 18px;"><p data-mid="" style="outline: 0px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"><br style="outline: 0px;"  /></p></section></a><section data-recommend-title="t" data-recommend-content="t" data-mid="" style="padding: 6px;outline: 0px;width: 593px;display: flex;justify-content: center;align-items: center;flex-wrap: nowrap;border-bottom: 1px dashed rgb(198, 226, 255);font-size: 13px;color: rgb(44, 95, 149);line-height: 18px;"><p data-mid="" style="outline: 0px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjY4NDU0MQ==&amp;mid=2247494425&amp;idx=1&amp;sn=cd23895cdce2768050bdf2805189fd63&amp;chksm=fdf52a0bca82a31d3c52cbd9f1e1d81712b799ece9f33c88c3b7d5a93cc56d54410bc37385de&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1" style="outline: 0px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">送书192本经典计算机书籍，免费领取！</a><br style="outline: 0px;"  /></p></section><a href="http://mp.weixin.qq.com/s?__biz=MzIwMjc3NjE1NQ==&amp;mid=2247485983&amp;idx=1&amp;sn=81fafa6d0ea36fd2b13d4d06b00e16a3&amp;chksm=96d8c12ba1af483d36985cc6b548abb6f4903b64f20d279762bbfe13ed850d760716c98c7a03&amp;scene=21#wechat_redirect" data-linktype="2" wah-hotarea="click" style="outline: 0px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;"><section data-recommend-title="t" data-recommend-content="t" data-mid="" style="padding: 6px;outline: 0px;width: 593px;display: flex;justify-content: center;align-items: center;flex-wrap: nowrap;border-bottom: 1px dashed rgb(198, 226, 255);font-size: 13px;color: rgb(44, 95, 149);line-height: 18px;"><p data-mid="" style="outline: 0px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"><br style="outline: 0px;"  /></p></section></a></section><section data-mpa-template="t" data-recommend-article-type="list-title" data-recomment-template-id="6" data-recommend-article-id="2247485961_1" data-recommend-article-time="1621738974" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/2vOI7k3wdyDbYB1YRRBN1TraEnKsKkmwE4hp1s25lwhlkicNt9XFrHexv7MXLGDLlssGUQGsjfXdCwUprtG3tXw/0?wx_fmt=jpeg" data-recommend-article-title="上海有哪些互联网,你都知道么？" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzIwMjc3NjE1NQ==&amp;mid=2247485961&amp;idx=1&amp;sn=4ee4c22f635d2a1616a7af540295bba5&amp;chksm=96d8c13da1af482bcb7712ab90c5aedb9917dccf32bb4dd901a73c6be4ec5eb22254333eaec0#rd" style="outline: 0px;"><section data-recommend-title="t" data-recommend-content="t" data-mid="" style="padding: 6px;outline: 0px;width: 593px;display: flex;justify-content: center;align-items: center;flex-wrap: nowrap;font-size: 13px;color: rgb(44, 95, 149);line-height: 18px;border-bottom: none !important;"><p data-mid="" style="outline: 0px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjY4NDU0MQ==&amp;mid=2247491660&amp;idx=1&amp;sn=d4b1d7527dcd9425b20d268a613b2b37&amp;chksm=fdf5215eca82a848a8bdb77c8c3516997988149e3b2d4ccf276906bc9ae69b96a20b895ba5a3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1" style="outline: 0px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">2021年Windows下安装GPU版本的Tensorflow和Pytorch</a></p></section></section></section></section></section></pre></section></content>
</div>
</body>
</html>