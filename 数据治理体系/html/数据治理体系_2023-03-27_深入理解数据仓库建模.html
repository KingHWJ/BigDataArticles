<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"数据治理体系","title":"深入理解数据仓库建模","time":"2023-03-27 07:29:13","timeStamp":"1679873353"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzA3NjIzNjMwOA==&mid=2247494079&idx=1&sn=3833410bc51d1c00ca226afe1d1b11eb&chksm=9f66fac4a81173d2097624edd75da9c18dd696dfd554b18d62b140150873841352fdd4b704e5#rd" target="_blank">深入理解数据仓库建模</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">数据治理体系&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-03-27 07:29:13</em></div><content><section data-mpa-powered-by="yiban.io"><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-weuitheme="light" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、数字体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。" data-from="0" data-weui-theme="light"></mp-common-profile></section><section style="line-height: 2em;visibility: visible;text-indent: 0em;"><span style="font-size: 18px;"><strong><span style="visibility: visible;"></span></strong></span></section><section style="line-height: 2em;visibility: visible;text-indent: 0em;"><span style="font-size: 18px;color: rgb(0, 128, 255);" data-darkreader-inline-color=""><strong><span style="font-weight: bold;visibility: visible;">一、数据仓库建模的意义</span></strong></span><span style="font-weight: bold;font-size: 15px;visibility: visible;"><br style="visibility: visible;"  /></span></section><section style="line-height: 2em;text-indent: 2em;margin-bottom: 24px;"><span style="font-size: 16px;">如果把数据看作图书馆里的书，我们希望看到它们在书架上分门别类地放置；如果把数据看作城市的建筑，我们希望城市规划布局合理；如果把数据看作电脑文件和文件夹，我们希望按照自己的习惯有很好的文件夹组织方式，而不是糟糕混乱的桌面，经常为找一个文件而不知所措。<br  /></span></section><section style="line-height: 2em;text-indent: 2em;margin-bottom: 24px;"><span style="font-size: 16px;">数据模型就是数据组织和存储方法，它强调从业务、数据存取和使用角度合理存储数据。Linux的创始人Torvalds有一段关于“什么才是优秀程序员”的话：“烂程序员关心的是代码，好程序员关心的是数据结构和它们之间的关系”，最能够说明数据模型的重要性。</span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">只有数据模型将数据有序的组织和存储起来之后，大数据才能得到高性能、低成本、高效率、高质量的使用。<br  /></span></p><section style="line-height: 2em;text-indent: 2em;margin-bottom: 8px;"><span style="font-size: 16px;"><span style="font-weight: bold;">性能</span>：帮助我们快速查询所需要的数据，减少数据的I/O吞吐，提高使用数据的效率，如宽表。<br  /></span></section><section style="line-height: 2em;text-indent: 2em;margin-bottom: 8px;"><span style="font-size: 16px;"><span style="font-weight: bold;">成本</span>：极大地减少不必要的数据冗余，也能实现计算结果复用，极大地降低存储和计算成本。<br  /></span></section><section style="line-height: 2em;text-indent: 2em;margin-bottom: 8px;"><span style="font-size: 16px;"><span style="font-weight: bold;">效率</span>：在业务或系统发生变化时，可以保持稳定或很容易扩展，提高数据稳定性和连续性。</span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">质量</span>：良好的数据模型能改善数据统计口径的不一致性，减少数据计算错误的可能性。</span></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">数据模型能够促进业务与技术进行有效沟通，形成对主要业务定义和术语的统一认识，具有跨部门、中性的特征，可以表达和涵盖所有的业务。</span><span style="font-size: 15px;"><br  /></span></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 15px;">大数据系统需要数据模型方法来帮助更好地组织和存储数据，以便在<strong>性能、成本、效率和质量</strong>之间取得最佳平衡！</span><br  /></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 15px;">下图是个示例，通过统一数据模型，屏蔽数据源变化对业务的影响，保证业务的稳定，表述了数据仓库模型的一种价值：</span></p><p style="line-height: 2em;text-indent: 2em;"><img class="rich_pages wxw-img" data-backh="330" data-backw="574" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZC392TMFfvBo15AuIXGhbiaT3CibaGS9ZShhdcaKaIay7uNHb03d5PEMQ/0?wx_fmt=png" data-ratio="0.5742574257425742" data-s="300,640" data-type="png" data-w="909" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZC392TMFfvBo15AuIXGhbiaT3CibaGS9ZShhdcaKaIay7uNHb03d5PEMQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /><span style="font-weight: bold;font-size: 18px;"><br  /></span></p><section style="line-height: 2em;text-indent: 0em;"><span style="font-weight: bold;font-size: 18px;color: rgb(0, 128, 255);" data-darkreader-inline-color="">二、数据仓库分层的设计</span></section><p style="line-height: 2em;text-indent: 0em;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.4948665297741273" data-s="300,640" data-type="png" data-w="974" style="height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/UrEB9rwE2dKUj2kagnj6Ad90z8JiaAShicyv4zMUZLiap79zHgDyvCRicgVSsLyF3ibJJ1q0MonN5XboF6vXWoCHGOA/640?wx_fmt=png"  /><br  /></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">以下是我们的一种分层设计方法，数据缓冲区（ODS）的数据结构与源系统完全一致。基础数据模型(DWD)和融合数据模型（DWI与DWA）是大数据平台重点建设的数据模型。应用层模型由各应用按需自行建设，其中基础数据模型一般采用ER模型，融合数据模型采用维度建模思路。</span></p><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-backh="447" data-backw="574" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2Z7YaFia4Tqw6NMSiaHPEHibZnqmAQMAWkzS94LaI36uVn5ReMlFMkX6AJQ/0?wx_fmt=png" data-ratio="0.7784172661870503" data-s="300,640" data-type="png" data-w="695" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2Z7YaFia4Tqw6NMSiaHPEHibZnqmAQMAWkzS94LaI36uVn5ReMlFMkX6AJQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;"><span style="font-weight: bold;font-size: 18px;color: rgb(0, 128, 255);" data-darkreader-inline-color="">三、两种经典的数据仓库建模方法</span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">前面的分层设计中你会发现有两种设计方法，关系建模和维度建模，下面分别简单介绍其特点和适用场景。<br  /></span></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">当今的数据处理方式大致可以分成两大类：联机事务处理OLTP（on-line transaction processing）、联机分析处理OLAP（On-Line Analytical Processing）。OLTP是传统的关系型数据库的主要应用，主要是基本的、日常的事务处理，例如银行交易。OLAP是数据仓库系统的主要应用，支持复杂的分析操作，侧重决策支持，并且提供直观易懂的查询结果。二者的主要区别对比如下表所示</span></p><section style="line-height: 2em;text-indent: 0em;"><span style="font-size: 16px;"><strong><span style="font-weight: bold;">1、维度建模</span></strong></span></section><section style="line-height: 2em;text-indent: 0em;"><span style="font-weight: bold;font-size: 16px;">（1）定义</span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">维度模型是数据仓库领域另一位大师Ralph Kimball 所倡导的。维度建模以分析决策的需求出发构建模型，构建的数据模型为分析需求服务，因此它重点解决用户如何更快速完成分析需求，同时还有较好的大规模复杂查询的响应性能，更直接面向业务。</span></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">在维度建模的基础上又分为三种模型：星型模型、雪花模型、星座模型。</span></p><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.33611111111111114" data-s="300,640" data-type="png" data-w="1080" style="height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/UrEB9rwE2dKUj2kagnj6Ad90z8JiaAShicrnPvkmp6KRfI0WJDJpsU5UhqFNJAPpkj3pb7CD3C5onGVW9c3kCbMQ/640?wx_fmt=png"  /></p><section style="line-height: 2em;text-align: center;"><span style="font-size: 16px;"></span></section><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.6296296296296297" data-s="300,640" data-type="png" data-w="1080" style="height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/UrEB9rwE2dKUj2kagnj6Ad90z8JiaAShicojdUAYsqSt4e4rIBfiaJlnG3icPWyzXy6hhuq9vswmATYLdK1A39WF8Q/640?wx_fmt=png"  /></p><p style="line-height: 2em;text-align: left;text-indent: 2em;"><span style="font-size: 16px;"></span><span style="font-size: 16px;">星座模型与前两种情况的区别是事实表的数量，星座模型是基于多个事实表<br  />基本上是很多数据仓库的常态，因为很多数据仓库都是多个事实表的。所以星座不星座只反映是否有多个事实表，他们之间是否共享一些维度表。所以星座模型并不和前两个模型冲突</span><br  /></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">星型模型由一个事实表和一组维表组成。每个维表都有一个维作为主键，所有这些维的主键组合成事实表的主键。强调的是对维度进行预处理，将多个维度集合到一个事实表，形成一个宽表。<br  /></span></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">首先就是星座不星座这个只跟数据和需求有关系，跟设计没关系，不用选择。<br  />星型还是雪花，取决于性能优先，还是灵活更优先目前实际企业开发中，不会绝对选择一种，根据情况灵活组合，甚至并存 (一层维度和多层维度都保存) 。但是整体来看，更倾向于维度更少的星型模型。尤其是Hadoop体系，减少Join就是减少Shuffle，性能差距很大(关系型数据可以依靠强大的主键索引)</span></p><section style="line-height: 2em;"><strong><span style="font-weight: bold;font-size: 16px;">（2）建模方法</span></strong><span style="font-weight: bold;font-size: 16px;"><br  /></span></section><p style="line-height: 2em;text-indent: 2em;"><span style="color: rgb(0, 128, 255);" data-darkreader-inline-color=""><strong><span style="color: rgb(0, 128, 255);font-size: 16px;" data-darkreader-inline-color="">选择业务过程→声明粒度→确认维度→确认事实</span></strong></span></p><section style="line-height: 2em;text-indent: 0em;"><span style="font-size: 16px;color: rgb(0, 128, 255);" data-darkreader-inline-color="">（a）选择业务过程</span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">在业务系统中，挑选我们感兴趣的业务线，比如下单业务，支付业务，退款业务，物流业务，一条业务线对应一张事实表。</span></p><section style="text-indent: 2em;"><span style="font-size: 16px;">如果是中小公司，尽量把所有业务过程都选择。如果是大公司（1000多张表），选择和需求相关的业务线。</span><span style="font-family: &quot;Times New Roman&quot;;color: rgb(255, 0, 0);font-size: 10.5pt;" data-darkreader-inline-color=""></span></section><section style="text-indent: 0em;"><span style="font-size: 16px;color: rgb(0, 128, 255);" data-darkreader-inline-color="">（b）声明粒度</span></section><p style="text-indent: 2em;"><span style="font-size: 16px;">数据粒度指数据仓库的数据中保存数据的细化程度或综合程度的级别。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px;">声明粒度意味着精确定义事实表中的一行数据表示什么，应该尽可能选择最小粒度，以此来应各种各样的需求。</span></p><section style="text-indent: 0em;"><strong><span style="font-size: 16px;">典型的粒度声明如下：</span></strong></section><ul style="list-style-type: disc;" class="list-paddingleft-1"><li><section style="text-indent: 0em;"><span style="font-size: 16px;">订单当中的每个商品项作为下单事实表中的一行，粒度为每次。</span></section></li><li><section style="text-indent: 0em;"><span style="font-size: 16px;">每周的订单次数作为一行，粒度为每周。</span></section></li><li><section style="text-indent: 0em;"><span style="font-size: 16px;">每月的订单次数作为一行，粒度为每月。</span></section></li><li><p style="text-indent: 0em;margin-bottom: 24px;"><span style="font-size: 16px;">如果在DWD层粒度就是每周或者每月，那么后续就没有办法统计细粒度的指标了。所以建议采用最小粒度。</span></p></li></ul><section style="text-indent: 0em;"><span style="font-size: 16px;color: rgb(0, 128, 255);" data-darkreader-inline-color="">（c）确定维度</span></section><p style="text-indent: 2em;"><span style="font-size: 16px;">维度的主要作用是描述业务是事实，主要表示的是“谁，何处，何时”等信息。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px;">确定维度的原则是：后续需求中是否要分析相关维度的指标。例如，需要统计，什么时间下的订单多，哪个地区下的订单多，哪个用户下的订单多。需要确定的维度就包括：时间维度、地区维度、用户维度。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px;">维度表：需要根据维度建模中的星型模型原则进行维度退化。</span></p><section style="text-indent: 0em;"><span style="font-size: 16px;color: rgb(0, 128, 255);" data-darkreader-inline-color="">（d）确定事实</span></section><p style="text-indent: 2em;"><span style="font-size: 16px;">此处的“事实”一词，指的是业务中的度量值（次数、个数、件数、金额，可以进行累加），例如订单金额、下单次数等。</span></p><p><span style="font-size: 16px;">在DWD层，以业务过程为建模驱动，基于每个具体业务过程的特点，构建最细粒度的明细层事实表。事实表可做适当的宽表化处理</span><span style=""><span style="font-family:宋体;">。</span></span></p><section style="text-align: left;margin-left: 8px;margin-right: 8px;"><br  /><img class="rich_pages wxw-img" data-backh="166" data-backw="505" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2Z1M68XERklEScp7L9eXx82562E8P8prVWGYeqE71Itiabgibke96e6jSw/0?wx_fmt=png" data-ratio="0.3287128712871287" data-s="300,640" data-type="png" data-w="505" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2Z1M68XERklEScp7L9eXx82562E8P8prVWGYeqE71Itiabgibke96e6jSw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;"><span style="font-size: 16px;">以下是阿里的OneData的建模工作流</span></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-backh="999" data-backw="548" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_jpg/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZlicFBmNacBbUgwPyPv4xBW1M7BLUSCTicjFtRIvju0TEPg02Hu3eM3fg/0?wx_fmt=jpeg" data-ratio="1.822992700729927" data-s="300,640" data-type="jpeg" data-w="548" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_jpg/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZlicFBmNacBbUgwPyPv4xBW1M7BLUSCTicjFtRIvju0TEPg02Hu3eM3fg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;"><span style="font-weight: bold;font-size: 16px;">（3）优缺点</span></section><section style="line-height: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">优点</span>：技术要求不高，快速上手，敏捷迭代，快速交付；更快速完成分析需求，较好的大规模复杂查询的响应性能</span></section><section style="line-height: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">缺点</span>：维度表的冗余会较多，视野狭窄</span></section><section style="line-height: 2em;"><strong><span style="font-weight: bold;font-size: 16px;">2、关系建模</span></strong><span style="font-weight: bold;font-size: 16px;"><br  /></span></section><section style="line-height: 2em;"><span style="font-weight: bold;font-size: 16px;">（1）定义</span></section><p style="line-height: 2em;margin-bottom: 24px;text-indent: 0em;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.577259475218659" data-s="300,640" data-type="png" data-w="686" style="height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/UrEB9rwE2dKUj2kagnj6Ad90z8JiaAShic99TLfBPibcuDYQX5a4xkOtibmib7Etx7JLKVdywrADk5xT7ccf67Ca49Q/640?wx_fmt=png"  /><span style="font-size: 16px;"><br  /></span></p><p style="line-height: 2em;text-indent: 2em;margin-bottom: 24px;"><span style="font-size: 16px;">关系模型如图所示，严格遵循第三范式（3NF），从图中可以看出，较为松散、零碎，物理表数量多，而数据冗余程度低。由于数据分布于众多的表中，这些数据可以更为灵活地被应用，功能性较强。关系模型主要应用与OLTP系统中，为了保证数据的一致性以及避免冗余，所以大部分业务系统的表都是遵循第三范式的。</span></p><section style="text-indent: 2em;"><span style="font-size: 16px;">它更多是面向数据的整合和一致性治理，正如Inmon所希望达到的“single version of the truth”。</span><br  /></section><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.7941176470588235" data-s="300,640" data-type="png" data-w="646" style="height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/UrEB9rwE2dKUj2kagnj6Ad90z8JiaAShicZhiaia3q4c6gItBskD2D6munPMlbH30cE4fXpcbbwIH5ibg7xQsUlM01Q/640?wx_fmt=png"  /></p><section style="text-indent: 2em;"><span style="font-size: 16px;">关系模型虽然冗余少，但是在大规模数据，跨表分析统计查询过程中，会造成多表关联，这会大大降低执行效率。所以在数据仓库系统里面我们通常采用维度模型建模，把相关各种表整理成两种：事实表和维度表两种</span><span style="font-size: 16px;">。</span><span style=""></span><span style="font-size: 16px;"></span></section><section style="line-height: 2em;"><span style="font-weight: bold;font-size: 16px;">（2）建模方法<br  /></span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">关系建模要从整体进行考虑，也就是说要对业务有全面的了解和把控，要对上游业务系统的进行信息调研，以做到对其业务和数据的基本了解，要做到主题划分，让模型有清晰合理的实体关系体系，以下是方法的示意：</span></p><p style="line-height: 2em;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-backh="426" data-backw="457" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZVEeMiabRLUcdbwKFQ8zACy0pMKD1B5Guvibl6icbFnVGicibB4M5I5Eh2icA/0?wx_fmt=png" data-oversubscription-url="http://mmbiz.qpic.cn/mmbiz_jpg/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZXqpZ6baicZt10Y6wUCia1eiaicw3y7MDucEP896mKgbT8OAadnzP6ibuIeQ/0?wx_fmt=jpeg" data-ratio="0.9321663019693655" data-s="300,640" data-type="jpeg" data-w="914" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_jpg/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZXqpZ6baicZt10Y6wUCia1eiaicw3y7MDucEP896mKgbT8OAadnzP6ibuIeQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /><br  /></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">以下是中国移动的概念模型的一种示例，如果没有自顶向下的视野，基本是总结不出来的：</span></p><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-backh="370" data-backw="559" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZMXQnlu29YH9UibGicFvq6kia5qo3IQ23ad4x1joAmgRugqhwvG7pQvfyw/0?wx_fmt=png" data-ratio="0.6618962432915921" data-s="300,640" data-type="png" data-w="559" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZMXQnlu29YH9UibGicFvq6kia5qo3IQ23ad4x1joAmgRugqhwvG7pQvfyw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;"><span style="font-weight: bold;font-size: 16px;">（3）优缺点</span></section><section style="line-height: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">优点</span>：规范性较好，冗余小，数据集成和数据一致性方面得到重视，比如运营商可以参考国际电信运营业务流程规范（ETOM），有所谓的最佳实践。</span></section><section style="line-height: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">缺点</span>：需要全面了解企业业务、数据和关系；实施周期非常长，成本昂贵；对建模人员的能力要求也非常高，容易烂尾。现在一般企业中大部分都是使用维度建模来进行数仓模型的设计。</span></section><section style="line-height: 2em;"><strong><span style="font-weight: bold;font-size: 16px;">3、建模方法比较</span></strong><span style="font-weight: bold;font-size: 16px;"><br  /></span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">一般来讲，维度模型简单直观，适合业务模式快速变化的行业，关系模型实现复杂，适合业务模式比较成熟的行业，在现在业务快速的发展变化，关系建模来不及快速的响应和改变。</span></p><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">运营商以前都是关系建模，现在其实边界越来越模糊，很多大数据业务变化很快，采用维度建模也比较方便，不需要顶层设计。</span></p><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-backh="422" data-backw="574" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZTh4YELV9HGia8SooVQKu6wFSPcYzqGtlXoceYuEhbqMZ7fgaTqt2IibA/0?wx_fmt=png" data-ratio="0.7349042709867453" data-s="300,640" data-type="png" data-w="679" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZTh4YELV9HGia8SooVQKu6wFSPcYzqGtlXoceYuEhbqMZ7fgaTqt2IibA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;"><span style="font-weight: bold;font-size: 18px;color: rgb(0, 128, 255);" data-darkreader-inline-color="">四、企业建模的三点经验</span><span style="font-weight: bold;font-size: 16px;"><br  /></span></section><p style="line-height: 2em;text-indent: 2em;"><span style="font-size: 16px;">维度建模就不说了，只要能理解业务过程和其中涉及的相关数据、维度就可以，但自顶向下的关系建模难度很大，以下是关系建模的三个建设要点。</span></p><section style="line-height: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">1、业务的理解</span>：找到企业内最理解业务和源系统的人，梳理出现状，比如运营商就要深刻理解三域（O/B/M），概念建模的挑战就很大，现在做到B域的概念建模已经很不容易。</span><br  /></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-backh="350" data-backw="574" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZUdwvKU8u1aSBQEdbpyIfBXac9l4RCFn7PAicq2tOdRibYEVbVH4ibJkEw/0?wx_fmt=png" data-ratio="0.6100217864923747" data-s="300,640" data-type="png" data-w="918" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZUdwvKU8u1aSBQEdbpyIfBXac9l4RCFn7PAicq2tOdRibYEVbVH4ibJkEw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">2、数据及关系的理解</span>：各个域的系统建设的时候没有统一文档和规范，要梳理出逻辑模型不容易，比如运营商的事件主题下的逻辑模型就非常复杂。</span></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-backh="297" data-backw="574" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZMNQbbonMt3Aiaj5lnrk6vDYLIsVkZAb2GKpta3SIfMrmUeSpjsfl2Uw/0?wx_fmt=png" data-ratio="0.5166666666666667" data-s="300,640" data-type="png" data-w="1080" style="display: initial;width: 100% !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2ZMNQbbonMt3Aiaj5lnrk6vDYLIsVkZAb2GKpta3SIfMrmUeSpjsfl2Uw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;"><span style="font-size: 16px;"><span style="font-weight: bold;">3、标准化的推进</span>：数据仓库建模的任何实体都需要标准化命名，否则未来的管理成本巨大，也是后续数据有效治理的基础，以下是我们的一个命名规范示例：</span></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-before-oversubscription-url="https://mmbiz.qlogo.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2Z5slZY9Lceia1ZyarGVmnhnn5Khp7tmWfQ5vTNvn4GkMcjtsbySk5vKA/0?wx_fmt=png" data-ratio="0.6831140350877193" data-s="300,640" data-type="png" data-w="912" style="display: initial;width: 574px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/hFm2L5m7fBsJsWzxCnPS9nJD8npPXB2Z5slZY9Lceia1ZyarGVmnhnn5Khp7tmWfQ5vTNvn4GkMcjtsbySk5vKA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></section><section style="line-height: 2em;" data-content-utf8-length="1"><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp;&nbsp;总而言之，你可以把这篇文章当成一个指引，具体还是要结合企业的实际去推进，始终要明白的一个原则就是：即数据如何摆布才能提高支撑应用的效率，手段上不用区分什么先进不先进，好用就成。<br  /></span></section><section><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-weuitheme="light" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、数字体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。" data-from="0" data-weui-theme="light"></mp-common-profile><span style="font-size: 16px;"></span>​</section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>