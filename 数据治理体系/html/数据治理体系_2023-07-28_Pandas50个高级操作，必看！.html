<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"数据治理体系","title":"Pandas50个高级操作，必看！","time":"2023-07-28 06:50:20","timeStamp":"1690498220"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzA3NjIzNjMwOA==&mid=2247495961&idx=1&sn=177232ba87351d34f621c3bce6a990ce&chksm=9f66e262a8116b7406db021787ee950d3519c8961a41e76d79c870e9af4090ac9f5da6fe313d#rd" target="_blank">Pandas50个高级操作，必看！</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">数据治理体系&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-07-28 06:50:20</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3NjIzNjMwOA==&action=getalbum&album_id=2260374267555004423#wechat_redirect" title="数据分析" target="_blank">#数据分析</a></p></div><section class="mp_profile_iframe_wrp" data-mpa-powered-by="yiban.io"><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、指标体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。关注我，和您一起终身学习。" data-from="0" data-weui-theme="light"></mp-common-profile></section><section style="margin-right: 16px;margin-bottom: 0px;margin-left: 16px;white-space: normal;caret-color: rgba(0, 0, 0, 0);outline: 0px;letter-spacing: 0.544px;color: rgb(34, 34, 34);background-color: rgb(255, 255, 255);text-align: center;visibility: visible;line-height: 1.75em;font-family: system-ui, -apple-system, BlinkMacSystemFont, Arial, sans-serif;"><section style="margin-right: 16px;margin-left: 16px;outline: 0px;visibility: visible;"><br  /></section></section><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;">在数据分析和数据建模的过程中需要对数据进行清洗和整理等工作，有时需要对数据增删字段。下面为大家介绍Pandas对数据的<strong style="outline: 0px;visibility: visible;">复杂查询、数据类型转换、数据排序、数据的修改、数据迭代以及函数的使用</strong></span></p><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 1.3em;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);border-bottom: 2px solid rgb(239, 112, 96);visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;"><span style="margin-right: 3px;padding: 3px 10px 1px;outline: 0px;display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);border-top-right-radius: 3px;border-top-left-radius: 3px;visibility: visible;"><strong style="outline: 0px;color: black;visibility: visible;">01、复杂查询</strong></span><span style="outline: 0px;display: inline-block;vertical-align: bottom;border-bottom: 36px solid rgb(239, 235, 233);border-right: 20px solid transparent;visibility: visible;"></span></span></h2><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;">实际业务需求往往需要按照一定的条件甚至复杂的组合条件来查询数据,接下来为大家介绍如何发挥Pandas数据筛选的无限可能，随心所欲地取用数据。</span></p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;">1、逻辑运算</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;visibility: visible;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;"># Q1成绩大于36<br style="outline: 0px;visibility: visible;"  />df.Q1&gt; 36<br style="outline: 0px;visibility: visible;"  /># Q1成绩不小于60分，并且是C组成员<br style="outline: 0px;visibility: visible;"  />~(df.Q1&lt; 60) &amp; (df['team'] == 'C')<br style="outline: 0px;visibility: visible;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;">2、逻辑筛选数据</span></h3><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;">切片（[ ]）、.loc[ ]和.iloc[ ]均支持上文所介绍的逻辑表达式。</span></p><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;"><strong style="outline: 0px;visibility: visible;">以下是切片（[ ]）的逻辑筛选示例：</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;visibility: visible;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;visibility: visible;"><span style="outline: 0px;font-size: 15px;visibility: visible;">df[df['Q1']== 8] # Q1等于8<br style="outline: 0px;visibility: visible;"  />df[~(df['Q1']== 8)] # 不等于8<br style="outline: 0px;visibility: visible;"  />df[df.name== 'Ben'] # 姓名为Ben<br style="outline: 0px;"  />df[df.Q1&gt; df.Q2]<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">以下是.loc[ ]和.lic[ ]示例：</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 表达式与切片一致<br style="outline: 0px;"  />df.loc[df['Q1']&gt; 90, 'Q1':] # Q1大于90，只显示Q1<br style="outline: 0px;"  />df.loc[(df.Q1&gt; 80) &amp; (df.Q2 &lt; 15)] # and关系<br style="outline: 0px;"  />df.loc[(df.Q1&gt; 90) | (df.Q2 &lt; 90)] # or关系<br style="outline: 0px;"  />df.loc[df['Q1']== 8] # 等于8<br style="outline: 0px;"  />df.loc[df.Q1== 8] # 等于8<br style="outline: 0px;"  />df.loc[df['Q1']&gt; 90, 'Q1':] # Q1大于90，显示Q1及其后所有列<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">3、函数筛选</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 查询最大索引的值<br style="outline: 0px;"  />df.Q1[lambdas: max(s.index)] # 值为21<br style="outline: 0px;"  /># 计算最大值<br style="outline: 0px;"  />max(df.Q1.index)<br style="outline: 0px;"  /># 99<br style="outline: 0px;"  />df.Q1[df.index==99]<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">4、比较函数</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 以下相当于 df[df.Q1 == 60]<br style="outline: 0px;"  />df[df.Q1.eq(60)]<br style="outline: 0px;"  />df.ne() # 不等于 !=<br style="outline: 0px;"  />df.le() # 小于等于 &lt;=<br style="outline: 0px;"  />df.lt() # 小于 &lt;<br style="outline: 0px;"  />df.ge() # 大于等于 &gt;=<br style="outline: 0px;"  />df.gt() # 大于 &gt;<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">5、查询df.query()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.query('Q1 &gt; Q2 &gt; 90') # 直接写类型SQL where语句<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">还支持使用@符引入变量</span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 支持传入变量，如大于平均分40分的<br style="outline: 0px;"  />a = df.Q1.mean()<br style="outline: 0px;"  />df.query('Q1 &gt; @a+40')<br style="outline: 0px;"  />df.query('Q1 &gt; `Q2`+@a')<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">df.eval()与df.query()类似，也可以用于表达式筛选。</span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># df.eval()用法与df.query类似<br style="outline: 0px;"  />df[df.eval("Q1 &gt; 90 &gt; Q3 &gt;10")]<br style="outline: 0px;"  />df[df.eval("Q1 &gt; `Q2`+@a")]<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">6、筛选df.filter()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.filter(items=['Q1', 'Q2']) # 选择两列<br style="outline: 0px;"  />df.filter(regex='Q', axis=1) # 列名包含Q的列<br style="outline: 0px;"  />df.filter(regex='e$', axis=1) # 以e结尾的列<br style="outline: 0px;"  />df.filter(regex='1$', axis=0) # 正则，索引名以1结尾<br style="outline: 0px;"  />df.filter(like='2', axis=0) # 索引中有2的<br style="outline: 0px;"  /># 索引中以2开头、列名有Q的<br style="outline: 0px;"  />df.filter(regex='^2',axis=0).filter(like='Q', axis=1)<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">7、按数据类型查询</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.select_dtypes(include=['float64']) # 选择float64型数据<br style="outline: 0px;"  />df.select_dtypes(include='bool')<br style="outline: 0px;"  />df.select_dtypes(include=['number']) # 只取数字型<br style="outline: 0px;"  />df.select_dtypes(exclude=['int']) # 排除int类型<br style="outline: 0px;"  />df.select_dtypes(exclude=['datetime64'])<br style="outline: 0px;"  /></span></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 1.3em;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);border-bottom: 2px solid rgb(239, 112, 96);"><span style="outline: 0px;font-size: 15px;"><span style="margin-right: 3px;padding: 3px 10px 1px;outline: 0px;display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);border-top-right-radius: 3px;border-top-left-radius: 3px;"><strong style="outline: 0px;color: black;">02、数据类型转换</strong></span><span style="outline: 0px;display: inline-block;vertical-align: bottom;border-bottom: 36px solid rgb(239, 235, 233);border-right: 20px solid transparent;"></span></span></h2><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">在开始数据分析前，我们需要为数据分配好合适的类型，这样才能够高效地处理数据。不同的数据类型适用于不同的处理方法。</span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 对所有字段指定统一类型<br style="outline: 0px;"  />df = pd.DataFrame(data, dtype='float32')<br style="outline: 0px;"  /># 对每个字段分别指定<br style="outline: 0px;"  />df = pd.read_excel(data, dtype={'team':'string', 'Q1': 'int32'})<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">1、推断类型</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 自动转换合适的数据类型<br style="outline: 0px;"  />df.infer_objects() # 推断后的DataFrame<br style="outline: 0px;"  />df.infer_objects().dtypes<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">2、指定类型</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 按大体类型推定<br style="outline: 0px;"  />m = ['1', 2, 3]<br style="outline: 0px;"  />s = pd.to_numeric(s) # 转成数字<br style="outline: 0px;"  />pd.to_datetime(m) # 转成时间<br style="outline: 0px;"  />pd.to_timedelta(m) # 转成时间差<br style="outline: 0px;"  />pd.to_datetime(m, errors='coerce') # 错误处理<br style="outline: 0px;"  />pd.to_numeric(m, errors='ignore')<br style="outline: 0px;"  />pd.to_numeric(m errors='coerce').fillna(0) # 兜底填充<br style="outline: 0px;"  />pd.to_datetime(df[['year', 'month', 'day']])<br style="outline: 0px;"  /># 组合成日期<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">3、类型转换astype()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.Q1.astype('int32').dtypes<br style="outline: 0px;"  /># dtype('int32')<br style="outline: 0px;"  />df.astype({'Q1': 'int32','Q2':'int32'}).dtypes<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">4、转为时间类型</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">t = pd.Series(['20200801', '20200802'])<br style="outline: 0px;"  /></span></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 1.3em;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);border-bottom: 2px solid rgb(239, 112, 96);"><span style="outline: 0px;font-size: 15px;"><span style="margin-right: 3px;padding: 3px 10px 1px;outline: 0px;display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);border-top-right-radius: 3px;border-top-left-radius: 3px;"><strong style="outline: 0px;color: black;">03、数据排序</strong></span><span style="outline: 0px;display: inline-block;vertical-align: bottom;border-bottom: 36px solid rgb(239, 235, 233);border-right: 20px solid transparent;"></span></span></h2><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">数据排序是指按一定的顺序将数据重新排列，帮助使用者发现数据的变化趋势，同时提供一定的业务线索，还具有对数据纠错、分类等作用。</span></p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">1、索引排序df.sort_index()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">s.sort_index() # 升序排列<br style="outline: 0px;"  />df.sort_index() # df也是按索引进行排序<br style="outline: 0px;"  />df.team.sort_index()s.sort_index(ascending=False)# 降序排列<br style="outline: 0px;"  />s.sort_index(inplace=True) # 排序后生效，改变原数据<br style="outline: 0px;"  /># 索引重新0-(n-1)排，很有用，可以得到它的排序号<br style="outline: 0px;"  />s.sort_index(ignore_index=True)<br style="outline: 0px;"  />s.sort_index(na_position='first') # 空值在前，另'last'表示空值在后<br style="outline: 0px;"  />s.sort_index(level=1) # 如果多层，排一级<br style="outline: 0px;"  />s.sort_index(level=1, sort_remaining=False) #这层不排<br style="outline: 0px;"  /># 行索引排序，表头排序<br style="outline: 0px;"  />df.sort_index(axis=1) # 会把列按列名顺序排列<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">2、数值排序sort_values()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.Q1.sort_values()<br style="outline: 0px;"  />df.sort_values('Q4')<br style="outline: 0px;"  />df.sort_values(by=['team', 'name'],ascending=[True, False])<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">其他方法：</span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">s.sort_values(ascending=False) # 降序<br style="outline: 0px;"  />s.sort_values(inplace=True) # 修改生效<br style="outline: 0px;"  />s.sort_values(na_position='first') # 空值在前<br style="outline: 0px;"  /># df按指定字段排列<br style="outline: 0px;"  />df.sort_values(by=['team'])<br style="outline: 0px;"  />df.sort_values('Q1')<br style="outline: 0px;"  /># 按多个字段，先排team，在同team内再看Q1<br style="outline: 0px;"  />df.sort_values(by=['team', 'Q1'])<br style="outline: 0px;"  /># 全降序<br style="outline: 0px;"  />df.sort_values(by=['team', 'Q1'], ascending=False)<br style="outline: 0px;"  /># 对应指定team升Q1降<br style="outline: 0px;"  />df.sort_values(by=['team', 'Q1'],ascending=[True, False])<br style="outline: 0px;"  /># 索引重新0-(n-1)排<br style="outline: 0px;"  />df.sort_values('team', ignore_index=True)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">3、混合排序</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.set_index('name', inplace=True) # 设置name为索引<br style="outline: 0px;"  />df.index.names = ['s_name'] # 给索引起名<br style="outline: 0px;"  />df.sort_values(by=['s_name', 'team']) # 排序<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">4、按值大小排序nsmallest()和nlargest()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">s.nsmallest(3) # 最小的3个<br style="outline: 0px;"  />s.nlargest(3) # 最大的3个<br style="outline: 0px;"  /># 指定列<br style="outline: 0px;"  />df.nlargest(3, 'Q1')<br style="outline: 0px;"  />df.nlargest(5, ['Q1', 'Q2'])<br style="outline: 0px;"  />df.nsmallest(5, ['Q1', 'Q2'])<br style="outline: 0px;"  /></span></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 1.3em;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);border-bottom: 2px solid rgb(239, 112, 96);"><span style="outline: 0px;font-size: 15px;"><span style="margin-right: 3px;padding: 3px 10px 1px;outline: 0px;display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);border-top-right-radius: 3px;border-top-left-radius: 3px;"><strong style="outline: 0px;color: black;">04、添加修改</strong></span><span style="outline: 0px;display: inline-block;vertical-align: bottom;border-bottom: 36px solid rgb(239, 235, 233);border-right: 20px solid transparent;"></span></span></h2><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">数据的修改、增加和删除在数据整理过程中时常发生。修改的情况一般是修改错误、格式转换，数据的类型修改等。</span></p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">1、修改数值</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.iloc[0,0] # 查询值<br style="outline: 0px;"  /># 'Liver'<br style="outline: 0px;"  />df.iloc[0,0] = 'Lily' # 修改值<br style="outline: 0px;"  />df.iloc[0,0] # 查看结果<br style="outline: 0px;"  /># 'Lily'<br style="outline: 0px;"  /><br style="outline: 0px;"  /># 将小于60分的成绩修改为60<br style="outline: 0px;"  />df[df.Q1 &lt; 60] = 60<br style="outline: 0px;"  /># 查看<br style="outline: 0px;"  />df.Q1<br style="outline: 0px;"  /><br style="outline: 0px;"  /># 生成一个长度为100的列表<br style="outline: 0px;"  />v = [1, 3, 5, 7, 9] * 20<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">2、替换数据</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">s.replace(0, 5) # 将列数据中的0换为5<br style="outline: 0px;"  />df.replace(0, 5) # 将数据中的所有0换为5<br style="outline: 0px;"  />df.replace([0, 1, 2, 3], 4) # 将0～3全换成4<br style="outline: 0px;"  />df.replace([0, 1, 2, 3], [4, 3, 2, 1]) # 对应修改<br style="outline: 0px;"  />s.replace([1, 2], method='bfill') # 向下填充<br style="outline: 0px;"  />df.replace({0: 10, 1: 100}) # 字典对应修改<br style="outline: 0px;"  />df.replace({'Q1': 0, 'Q2': 5}, 100) # 将指定字段的指定值修改为100<br style="outline: 0px;"  />df.replace({'Q1': {0: 100, 4: 400}}) # 将指定列里的指定值替换为另一个指定的值<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">3、填充空值</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.fillna(0) # 将空值全修改为0<br style="outline: 0px;"  /># {'backfill', 'bfill', 'pad', 'ffill',None}, 默认为None<br style="outline: 0px;"  />df.fillna(method='ffill') # 将空值都修改为其前一个值<br style="outline: 0px;"  />values = {'A': 0, 'B': 1, 'C': 2, 'D': 3}<br style="outline: 0px;"  />df.fillna(value=values) # 为各列填充不同的值<br style="outline: 0px;"  />df.fillna(value=values, limit=1) # 只替换第一个<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">4、修改索引名</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.rename(columns={'team':'class'})<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">常用方法如下：</span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.rename(columns={"Q1":"a", "Q2": "b"}) # 对表头进行修改<br style="outline: 0px;"  />df.rename(index={0: "x", 1:"y", 2: "z"}) # 对索引进行修改<br style="outline: 0px;"  />df.rename(index=str) # 对类型进行修改<br style="outline: 0px;"  />df.rename(str.lower, axis='columns') # 传索引类型<br style="outline: 0px;"  />df.rename({1: 2, 2: 4}, axis='index')<br style="outline: 0px;"  /><br style="outline: 0px;"  /># 对索引名进行修改<br style="outline: 0px;"  />s.rename_axis("animal")<br style="outline: 0px;"  />df.rename_axis("animal") # 默认是列索引<br style="outline: 0px;"  />df.rename_axis("limbs",axis="columns") # 指定行索引<br style="outline: 0px;"  /><br style="outline: 0px;"  /># 索引为多层索引时可以将type修改为class<br style="outline: 0px;"  />df.rename_axis(index={'type': 'class'})<br style="outline: 0px;"  /><br style="outline: 0px;"  /># 可以用set_axis进行设置修改<br style="outline: 0px;"  />s.set_axis(['a', 'b', 'c'], axis=0)<br style="outline: 0px;"  />df.set_axis(['I', 'II'], axis='columns')<br style="outline: 0px;"  />df.set_axis(['i', 'ii'], axis='columns',inplace=True)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">5、增加列</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df['foo'] = 100 # 增加一列foo，所有值都是100<br style="outline: 0px;"  />df['foo'] = df.Q1 + df.Q2 # 新列为两列相加<br style="outline: 0px;"  />df['foo'] = df['Q1'] + df['Q2'] # 同上<br style="outline: 0px;"  /># 把所有为数字的值加起来<br style="outline: 0px;"  />df['total'] =df.select_dtypes(include=['int']).sum(1)df['total'] =<br style="outline: 0px;"  />df.loc[:,'Q1':'Q4'].apply(lambda x: sum(x), axis='columns')<br style="outline: 0px;"  />df.loc[:, 'Q10'] = '我是新来的' # 也可以<br style="outline: 0px;"  /># 增加一列并赋值，不满足条件的为NaN<br style="outline: 0px;"  />df.loc[df.num &gt;= 60, '成绩'] = '合格'<br style="outline: 0px;"  />df.loc[df.num &lt; 60, '成绩'] = '不合格'<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">6、插入列df.insert()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 在第三列的位置上插入新列total列，值为每行的总成绩<br style="outline: 0px;"  />df.insert(2, 'total', df.sum(1))<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">7、指定列df.assign()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 增加total列<br style="outline: 0px;"  />df.assign(total=df.sum(1))<br style="outline: 0px;"  /># 增加两列<br style="outline: 0px;"  />df.assign(total=df.sum(1), Q=100)<br style="outline: 0px;"  />df.assign(total=df.sum(1)).assign(Q=100)<br style="outline: 0px;"  />其他使用示例：<br style="outline: 0px;"  />df.assign(Q5=[100]*100) # 新增加一列Q5<br style="outline: 0px;"  />df = df.assign(Q5=[100]*100) # 赋值生效<br style="outline: 0px;"  />df.assign(Q6=df.Q2/df.Q1) # 计算并增加Q6<br style="outline: 0px;"  />df.assign(Q7=lambda d: d.Q1 * 9 / 5 + 32) # 使用lambda# 添加一列，值为表达式结果：True或False<br style="outline: 0px;"  />df.assign(tag=df.Q1&gt;df.Q2)<br style="outline: 0px;"  /># 比较计算，True为1，False为0<br style="outline: 0px;"  />df.assign(tag=(df.Q1&gt;df.Q2).astype(int))<br style="outline: 0px;"  /># 映射文案<br style="outline: 0px;"  />df.assign(tag=(df.Q1&gt;60).map({True:'及格',False:'不及格'}))<br style="outline: 0px;"  /># 增加多个<br style="outline: 0px;"  />df.assign(Q8=lambda d: d.Q1*5,<br style="outline: 0px;"  />          Q9=lambda d: d.Q8+1) # Q8没有生效，不能直接用df.Q8<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">8、执行表达式df.eval()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 传入求总分表达式<br style="outline: 0px;"  />df.eval('total = Q1+Q3+Q3+Q4')<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">其他方法：</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df['C1'] = df.eval('Q2 + Q3')<br style="outline: 0px;"  />df.eval('C2 = Q2 + Q3') # 计算<br style="outline: 0px;"  />a = df.Q1.mean()df.eval("C3 =`Q3`+@a") # 使用变量<br style="outline: 0px;"  />df.eval("C3 = Q2 &gt; (`Q3`+@a)") #加一个布尔值<br style="outline: 0px;"  />df.eval('C4 = name + team', inplace=True) # 立即生效<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">9、增加行</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 新增索引为100的数据<br style="outline: 0px;"  />df.loc[100] = ['tom', 'A', 88, 88, 88, 88]<br style="outline: 0px;"  /></span></code></pre><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">其他方法：</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.loc[101]={'Q1':88,'Q2':99} # 指定列，无数据列值为NaN<br style="outline: 0px;"  />df.loc[df.shape[0]+1] = {'Q1':88,'Q2':99} # 自动增加索引<br style="outline: 0px;"  />df.loc[len(df)+1] = {'Q1':88,'Q2':99}<br style="outline: 0px;"  /># 批量操作，可以使用迭代<br style="outline: 0px;"  />rows = [[1,2],[3,4],[5,6]]<br style="outline: 0px;"  />for row in rows:<br style="outline: 0px;"  />    df.loc[len(df)] = row<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">10、追加合并</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df = pd.DataFrame([[1, 2], [3, 4]],columns=list('AB'))<br style="outline: 0px;"  />df2 = pd.DataFrame([[5, 6], [7, 8]],columns=list('AB'))<br style="outline: 0px;"  />df.append(df2)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">11、删除</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 删除索引为3的数据<br style="outline: 0px;"  />s.pop(3)<br style="outline: 0px;"  /># 93s<br style="outline: 0px;"  />s<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">12、删除空值</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.dropna() # 一行中有一个缺失值就删除<br style="outline: 0px;"  />df.dropna(axis='columns') # 只保留全有值的列<br style="outline: 0px;"  />df.dropna(how='all') # 行或列全没值才删除<br style="outline: 0px;"  />df.dropna(thresh=2) # 至少有两个空值时才删除<br style="outline: 0px;"  />df.dropna(inplace=True) # 删除并使替换生效<br style="outline: 0px;"  /></span></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 1.3em;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);border-bottom: 2px solid rgb(239, 112, 96);"><span style="outline: 0px;font-size: 15px;"><span style="margin-right: 3px;padding: 3px 10px 1px;outline: 0px;display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);border-top-right-radius: 3px;border-top-left-radius: 3px;"><strong style="outline: 0px;color: black;">05、高级过滤</strong></span><span style="outline: 0px;display: inline-block;vertical-align: bottom;border-bottom: 36px solid rgb(239, 235, 233);border-right: 20px solid transparent;"></span></span></h2><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;">介绍几个非常好用的复杂数据处理的数据过滤输出方法。</span></p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">1、df.where()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 数值大于70<br style="outline: 0px;"  />df.where(df &gt; 70)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">2、np.where()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 小于60分为不及格<br style="outline: 0px;"  />np.where(df&gt;=60, '合格', '不合格')<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">3、df.mask()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 符合条件的为NaN<br style="outline: 0px;"  />df.mask(s &gt; 80)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">4、df.lookup()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 行列相同数量，返回一个array<br style="outline: 0px;"  />df.lookup([1,3,4], ['Q1','Q2','Q3']) # array([36, 96, 61])<br style="outline: 0px;"  />df.lookup([1], ['Q1']) # array([36])<br style="outline: 0px;"  /></span></code></pre><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 1.3em;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);border-bottom: 2px solid rgb(239, 112, 96);"><span style="outline: 0px;font-size: 15px;"><span style="margin-right: 3px;padding: 3px 10px 1px;outline: 0px;display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);border-top-right-radius: 3px;border-top-left-radius: 3px;"><strong style="outline: 0px;color: black;">06、数据迭代</strong></span><span style="outline: 0px;display: inline-block;vertical-align: bottom;border-bottom: 36px solid rgb(239, 235, 233);border-right: 20px solid transparent;"></span></span></h2><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">1、迭代Series</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 迭代指定的列<br style="outline: 0px;"  />for i in df.name:<br style="outline: 0px;"  />      print(i)<br style="outline: 0px;"  /># 迭代索引和指定的两列<br style="outline: 0px;"  />for i,n,q in zip(df.index, df.name,df.Q1):<br style="outline: 0px;"  />    print(i, n, q)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">2、df.iterrows()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 迭代，使用name、Q1数据<br style="outline: 0px;"  />for index, row in df.iterrows():<br style="outline: 0px;"  />    print(index, row['name'], row.Q1)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">3、df.itertuples()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">for row in df.itertuples():<br style="outline: 0px;"  />    print(row)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">4、df.items()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># Series取前三个<br style="outline: 0px;"  />for label, ser in df.items():<br style="outline: 0px;"  />    print(label)<br style="outline: 0px;"  />    print(ser[:3], end='\n\n')<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">5、按列迭代</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 直接对DataFrame迭代<br style="outline: 0px;"  />for column in df:<br style="outline: 0px;"  />    print(column)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">07、函数应用</span></h3><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">1、pipe()</span></h3><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">应用在整个DataFrame或Series上。</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 对df多重应用多个函数<br style="outline: 0px;"  />f(g(h(df), arg1=a), arg2=b, arg3=c)<br style="outline: 0px;"  /># 用pipe可以把它们连接起来<br style="outline: 0px;"  />(df.pipe(h)<br style="outline: 0px;"  />    .pipe(g, arg1=a)<br style="outline: 0px;"  />    .pipe(f, arg2=b, arg3=c)<br style="outline: 0px;"  />)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">2、apply()</span></h3><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">应用在DataFrame的行或列中，默认为列。</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 将name全部变为小写<br style="outline: 0px;"  />df.name.apply(lambda x: x.lower())<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">3、applymap()</span></h3><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">应用在DataFrame的每个元素中。</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 计算数据的长度<br style="outline: 0px;"  />def mylen(x):<br style="outline: 0px;"  />    return len(str(x))<br style="outline: 0px;"  />df.applymap(lambda x:mylen(x)) # 应用函数<br style="outline: 0px;"  />df.applymap(mylen) # 效果同上<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">4、map()</span></h3><p data-tool="mdnice编辑器" style="margin-bottom: 0px;padding-top: 8px;padding-bottom: 8px;outline: 0px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);line-height: 26px;"><span style="outline: 0px;font-size: 15px;"><strong style="outline: 0px;">应用在Series或DataFrame的一列的每个元素中。</strong></span></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.team.map({'A':'一班', 'B':'二班','C':'三班', 'D':'四班',})# 枚举替换<br style="outline: 0px;"  />df['name'].map(f)<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">5、agg()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;"># 每列的最大值<br style="outline: 0px;"  />df.agg('max')<br style="outline: 0px;"  /># 将所有列聚合产生sum和min两行<br style="outline: 0px;"  />df.agg(['sum', 'min'])<br style="outline: 0px;"  /># 序列多个聚合<br style="outline: 0px;"  />df.agg({'Q1' : ['sum', 'min'], 'Q2' : ['min','max']})<br style="outline: 0px;"  /># 分组后聚合<br style="outline: 0px;"  />df.groupby('team').agg('max')<br style="outline: 0px;"  />df.Q1.agg(['sum', 'mean'])<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">6、transform()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">df.transform(lambda x: x*2) # 应用匿名函数<br style="outline: 0px;"  />df.transform([np.sqrt, np.exp]) # 调用多个函数<br style="outline: 0px;"  /></span></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 20px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: normal;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="outline: 0px;font-size: 15px;">7、copy()</span></h3><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;color: rgb(0, 0, 0);font-size: 16px;letter-spacing: normal;text-align: left;background-color: rgb(255, 255, 255);border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;font-size: 15px;">s = pd.Series([1, 2], index=["a","b"])<br style="outline: 0px;"  />s_1 = s<br style="outline: 0px;"  />s_copy = s.copy()<br style="outline: 0px;"  />s_1 is s # True<br style="outline: 0px;"  />s_copy is s # False</span><span style="color: rgb(34, 34, 34);font-family: system-ui, -apple-system, BlinkMacSystemFont, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;font-size: var(--articleFontsize);"></span></code></pre><section class="mp_profile_iframe_wrp"><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、指标体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。关注我，和您一起终身学习。" data-from="0" data-weui-theme="light"></mp-common-profile><span style="text-align: center;font-size: var(--articleFontsize);letter-spacing: 0.034em;"></span></section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>