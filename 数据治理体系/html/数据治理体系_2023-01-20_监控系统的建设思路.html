<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"数据治理体系","title":"监控系统的建设思路","time":"2023-01-20 08:59:29","timeStamp":"1674176369"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzA3NjIzNjMwOA==&mid=2247492641&idx=1&sn=d4d1e8c477e176779177a952d3dc2d11&chksm=9f66f75aa8117e4c19619f25b59d48c1d0b5addd13584d632d6c6822b8d38f3f709cb992b648#rd" target="_blank">监控系统的建设思路</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">ITIL之家&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">数据治理体系&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-01-20 08:59:29</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3NjIzNjMwOA==&action=getalbum&album_id=1908216570263158791#wechat_redirect" title="数据治理体系" target="_blank">#数据治理体系</a><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3NjIzNjMwOA==&action=getalbum&album_id=2759122774052634627#wechat_redirect" title="监控系统" target="_blank">#监控系统</a></p></div><section data-mpa-powered-by="yiban.io"><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-weuitheme="light" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、数字体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。" data-from="0" data-is_biz_ban="0" data-weui-theme="light"></mp-common-profile></section><p mp-original-font-size="17" mp-original-line-height="29.75" style="margin-bottom: 5px;outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;text-align: left;line-height: 29.75px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);font-weight: bold;visibility: visible;line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">一、起始<br mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;visibility: visible;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;"  /></span></p><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;visibility: visible;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);visibility: visible;line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">在实际的性能分析中，一个很常见的现象是，明明发生了性能瓶颈，但当你登录到服务器中想要排查的时候，却发现瓶颈已经消失了。或者说，性能问题总是时不时地发生，但却很难找出发生规律，也很难重现。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;visibility: visible;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);visibility: visible;line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">而要解决这个问题，就要搭建监控系统，把系统和应用程序的运行状况监控起来，并定义一系列的策略，在发生问题时第一时间告警通知。一个好的监控系统，不仅可以实时暴露系统的各种问题，更可以根据这些监控到的状态，自动分析和定位大致的瓶颈来源，从而更精确地把问题汇报给相关团队处理。要做好监控，最核心的就是全面的、可量化的指标，这包括系统和应用两个方面。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;visibility: visible;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);visibility: visible;line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">从系统来说，监控系统要涵盖系统的整体资源使用情况，比如我们前面讲过的 CPU、内存、磁盘和文件系统、网络等各种系统资源。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">而从应用程序来说，监控系统要涵盖应用程序内部的运行状态，这既包括进程的 CPU、磁盘 I/O 等整体运行状况，更需要包括诸如接口调用耗时、执行过程中的错误、内部对象的内存使用等应用程序内部的运行状况。</span></section><h2 mp-original-font-size="23.799999237060547" mp-original-line-height="41.64999771118164" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 23.8px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;border-bottom: 1px solid rgb(238, 238, 238);line-height: 41.65px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 41.65px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">二、系统监控</span></h2><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">1、USE 法</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">在开始监控系统之前，你肯定最想知道，怎么才能用简洁的方法，来描述系统资源的使用情况。你当然可以使用专栏中学到的各种性能工具，来分别收集各种资源的使用情况。不过不要忘记，每种资源的性能指标可都有很多，使用过多指标本身耗时耗力不说，也不容易为你建立起系统整体的运行状况。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;text-align: left;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">在这里，我为你介绍一种专门用于性能监控的 USE（Utilization Saturation and Errors）法。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="margin-bottom: 10px;outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">USE 法把系统资源的性能指标，简化成了三个类别，即使用率、饱和度以及错误数。</span></section><ul class="list-paddingleft-1" mp-original-font-size="17" mp-original-line-height="27.200000762939453" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 27.2px;overflow-wrap: break-word !important;"><li style="outline: 0px;max-width: 100%;line-height: 27.2px;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;"><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">使用率，表示资源用于服务的时间或容量百分比。100% 的使用率，表示容量已经用尽或者全部时间都用于服务。</span></section></li><li style="outline: 0px;max-width: 100%;line-height: 27.2px;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;"><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">饱和度，表示资源的繁忙程度，通常与等待队列的长度相关。100% 的饱和度，表示资源无法接受更多的请求。</span></section></li><li style="outline: 0px;max-width: 100%;line-height: 27.2px;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;"><section mp-original-font-size="17" mp-original-line-height="29.75" style="margin-bottom: 10px;outline: 0px;max-width: 100%;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">错误数表示发生错误的事件个数。错误数越多，表明系统的问题越严重。</span></section></li></ul><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">这三个类别的指标，涵盖了系统资源的常见性能瓶颈，所以常被用来快速定位系统资源的性能瓶颈。这样，无论是对 CPU、内存、磁盘和文件系统、网络等硬件资源，还是对文件描述符数、连接数、连接跟踪数等软件资源，USE 方法都可以帮你快速定位出，是哪一种系统资源出现了性能瓶颈。</span></section><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">2、性能指标</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">那么，对于每一种系统资源，又有哪些常见的性能指标呢？回忆一下我们讲过的各种系统资源原理，并不难想到相关的性能指标。这里，我把常见的性能指标画了一张表格，方便你在需要时查看。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-type="png" data-w="1080" style="outline: 0px;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/ufWcjcomw8ZoZuxyDNk5ls6qpY6yDxqicS4uJH8nK7yGDvriaR2uoEpDX86ALYoiaNuyxKypEwQUcicNwg3YGdnFwg/640?wx_fmt=png"  /></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">不过，需要注意的是，USE 方法只关注能体现系统资源性能</span><span data-change-font="1">​</span><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">瓶颈的核心指标，但这并不是说其他指标不重要。诸如系统日志、进程资源使用量、缓存使用量等其他各类指标，也都需要我们监控起来。只不过，它们通常用作辅助性能分析，而 USE 方法的指标，则直接表明了系统的资源瓶颈。</span></section><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">3、监控系统</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">掌握 USE 方法以及需要监控的性能指标后，接下来要做的，就是建立监控系统，把这些指标保存下来；然后，根据这些监控到的状态，自动分析和定位大致的瓶颈来源；最后，再通过告警系统，把问题及时汇报给相关团队处理。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">可以看出，一个完整的监控系统通常由数据采集、数据存储、数据查询和处理、告警以及可视化展示等多个模块组成。所以，要从头搭建一个监控系统，其实也是一个很大的系统工程。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;text-align: left;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">不过，幸运的是，现在已经有很多开源的监控工具可以直接使用，比如最常见的 Zabbix、Nagios、Prometheus 等等。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">下面，我就以 Prometheus</span><span data-change-font="1">​</span><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;"> 为例，为你介绍这几个组件的基本原理。如下图所示，就是 Prometheus 的基本架构：</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-type="png" data-w="1080" style="outline: 0px;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/ufWcjcomw8ZoZuxyDNk5ls6qpY6yDxqicadKxaW5lV28YWL8Gfk15Pa6cIlt4SOFNul2wlHVdsmLpqfjpkxnXcQ/640?wx_fmt=png"  /></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">先看数据采集模块。最左边的 Prometheus targets 就是数据采集的对象，而 Retrieval 则负责采集这些数据。从图中你也可以看到，Prometheus 同时支持 Push 和 Pull 两种数据采集模式。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">Pull 模式，由服务器端的采集模块来触发采集。只要采集目标提供了 HTTP 接口，就可以自由接入（这也是最常用的采集模式）。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">Push 模式，则是由各个采集目标主动向 Push Gateway（用于防止数据丢失）推送指标，再由服务器端从 Gateway 中拉取过去（这是移动应用中最常用的采集模式）。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">第二个是数据存储模块。为了保持监控数据的持久化，图中的 TSDB（Time series database）模块，负责将采集到的数据持久化到 SSD 等磁盘设备中。TSDB 是专门为时间序列数据设计的一种数据库，特点是以时间为索引、数据量大并且以追加的方式写入。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">第三个是数据查询和处理模块。刚才提到的 TSDB，在存储数据的同时，其实还提供了数据查询和基本的数据处理功能，而这也就是 PromQL 语言。PromQL 提供了简洁的查询、过滤功能，并且支持基本的数据处理方法，是告警系统和可视化展示的基础。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">第四个是告警模块。右上角的 AlertManager 提供了告警的功能，包括基于 PromQL 语言的触发条件、告警规则的配置管理以及告警的发送等。不过，虽然告警是必要的，但过于频繁的告警显然也不可取。所以，AlertManager 还支持通过分组、抑制或者静默等多种方式来聚合同类告警，并减少告警数量。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">最后一个是可视化展示模块。Prometheus 的 web UI 提供了简单的可视化界面，用于执行 PromQL 查询语句，但结果的展示比较单调。不过，一旦配合 Grafana，就可以构建非常强大的图形界面了。介绍完了这些组件，想必你对每个模块都有了比较清晰的认识。接下来，我们再来继续深入了解这些组件结合起来的整体功能。比如，以刚才提到的 USE 方法为例，我使用 Prometheus，可以收集 <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0Mjc0MDU2NQ==&amp;mid=2247484108&amp;idx=1&amp;sn=949b5d71d529e23fb3c225eaf7cbcaad&amp;chksm=e976fef6de0177e0844f8782260ef94ffea1c976671527d7246af3c8e6fa41f1dd2c0deffb34&amp;scene=21#wechat_redirect" textvalue="Linux" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Linux</a> 服务器的 CPU、内存、磁盘、网络等各类资源的使用率、饱和度和错误数指标。然后，通过 Grafana 以及 PromQL 查询语句，就可以把它们以图形界面的方式直观展示出来。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-type="png" data-w="1080" style="outline: 0px;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/ufWcjcomw8ZoZuxyDNk5ls6qpY6yDxqichibicz9vgKCodXPQoDsfU6dXlPibdLXq822yOHIlwCEvx3jFkaibaxial3Q/640?wx_fmt=png"  /></section><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">4、最后总结</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">系统监控的核心是资源的使用情况，这既包括 <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0Mjc0MDU2NQ==&amp;mid=2247484108&amp;idx=1&amp;sn=949b5d71d529e23fb3c225eaf7cbcaad&amp;chksm=e976fef6de0177e0844f8782260ef94ffea1c976671527d7246af3c8e6fa41f1dd2c0deffb34&amp;scene=21#wechat_redirect" textvalue="CPU" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">CPU</a>、内存、磁盘、文件系统、网络等硬件资源，也包括文件描述符数、连接数、连接跟踪数等软件资源。而要描述这些资源瓶颈，最简单有效的方法就是 USE 法。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">USE 法把系统资源的性能指标，简化为了三个类别：使用率、饱和度以及错误数。当这三者之中任一类别的指标过高时，都代表相对应的系统资源可能存在性能瓶颈。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">基于 USE 法建立性能指标后，我们还需要通过一套完整的监控系统，把这些指标从采集、存储、查询、处理，再到告警和可视化展示等贯穿起来。这样，不仅可以将系统资源的瓶颈快速暴露出来，还可以借助监控的历史数据，来追踪定位性能问题的根源。</span></section><h2 mp-original-font-size="23.799999237060547" mp-original-line-height="41.64999771118164" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 23.8px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;border-bottom: 1px solid rgb(238, 238, 238);line-height: 41.65px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 41.65px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">三、应用监控</span></h2><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">1、应用监控指标</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">跟系统监控一样，在构建应用程序的监控系统之前，首先也需要确定，到底需要监控哪些指标。特别是要清楚，有哪些指标可以用来快速确认应用程序的性能问题。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">应用程序的核心指标，不再是资源的使用情况，而是请求数、错误率和响应时间。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">这些指标不仅直接关系到用户的使用体验，还反映应用整体的可用性和可靠性。有了请求数、错误率和响应时间这三个黄金指标之后，我们就可以快速知道，应用是否发生了性能问题。但是，只有这些指标显然还是不够的，因为发生性能问题后，我们还希望能够快速定位“性能瓶颈区”。所以，在我看来，下面几种指标，也是监控应用程序时必不可少的。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">第一个，是应用进程的资源使用情况，比如进程占用的 CPU、内存、磁盘 I/O、网络等。使用过多的系统资源，导致应用程序响应缓慢或者错误数升高，是一个最常见的性能问题。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">第二个，是应用程序之间调用情况，比如调用频率、错误数、延时等。由于应用程序并不是孤立的，如果其依赖的其他应用出现了性能问题，应用自身性能也会受到影响。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">第三个，是应用程序内部核心逻辑的运行情况，比如关键环节的耗时以及执行过程中的错误等。由于这是应用程序内部的状态，从外部通常无法直接获取到详细的性能数据。所以，应用程序在设计和开发时，就应该把这些指标提供出来，以便监控系统可以了解其内部运行状态。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">有了应用进程的资源使用指标，你就可以把系统资源的瓶颈跟应用程序关联起来，从而迅速定位因系统资源不足而导致的性能问题；</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">有了应用程序之间的调用指标，你可以迅速分析出一个请求处理的调用链中，到底哪个组件才是导致性能问题的罪魁祸首；</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">而有了应用程序内部核心逻辑的运行性能，你就可以更进一步，直接进入应用程序的内部，定位到底是哪个处理环节的函数导致了性能问题。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">基于这些思路，我相信你就可以构建出，描述应用程序运行状态的性能指标。再将这些指标纳入我们上一期提到的监控系统（比如 Prometheus + Grafana）中，就可以跟系统监控一样，一方面通过告警系统，把问题及时汇报给相关团队处理；另一方面，通过直观的图形界面，动态展示应用程序的整体性能。</span></section><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">2、全链路监控</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">业务系统通常会涉及到一连串的多个服务，形成一个复杂的分布式调用链。为了迅速定位这类跨应用的性能瓶颈，你还可以使用 Zipkin、Jaeger、Pinpoint 等各类开源工具，来构建全链路跟踪系统。比如，下图就是一个 Jaeger 调用链跟踪的示例。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-type="png" data-w="1080" style="outline: 0px;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/ufWcjcomw8ZoZuxyDNk5ls6qpY6yDxqicGjVCB3obN57ic6XjHNrnS38WNz9p7BB20AyC2tLPXfO0ZRpohvXdfHg/640?wx_fmt=png"  /></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">全链路跟踪可以帮你迅速定位出，在一个请求处理过程中，哪个环节才是问题根源。比如，从上图中，你就可以很容易看到，这是 Redis 超时导致的问题。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">全链路跟踪除了可以帮你快速定位跨应用的性能问题外，还可以帮你生成线上系统的调用拓扑图。这些直观的拓扑图，在分析复杂系统（比如微服务）时尤其有效。</span></section><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">3、日志监控</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">性能指标的监控，可以让你迅速定位发生瓶颈的位置，不过只有指标的话往往还不够。比如，同样的一个接口，当请求传入的参数不同时，就可能会导致完全不同的性能问题。所以，除了指标外，我们还需要对这些指标的上下文信息进行监控，而日志正是这些上下文的最佳来源。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">对比来看，指标是特定时间段的数值型测量数据，通常以时间序列的方式处理，适合于实时监控。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">而日志则完全不同，日志都是某个时间点的字符串消息，通常需要对搜索引擎进行索引后，才能进行查询和汇总分析。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">对日志监控来说，最经典的方法，就是使用 ELK 技术栈，即使用 Elasticsearch、Logstash 和 Kibana 这三个组件的组合。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">如下图所示，就是一个经典的 ELK 架构图：</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-type="png" data-w="1080" style="outline: 0px;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/ufWcjcomw8ZoZuxyDNk5ls6qpY6yDxqiclTsNgnaAPHxqLMrQvReoCVM3m4KiaraPpiaBWTZhj01icj5LPQFJfXBIg/640?wx_fmt=png"  /></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">Logstash 负责对从各个日志源采集日志，然后进行预处理，最后再把初步处理过的日志，发送给 Elasticsearch 进行索引。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;text-align: left;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">Elasticsearch 负责对日志进行索引，并提供了一个完整的全文搜索引擎，这样就可以方便你从日志中检索需要的数据。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">Kibana 则负责对日志进行可视化分析，包括日志搜索、处理以及绚丽的仪表板展示等。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">下面这张图，就是一个 Kibana 仪表板的示例，它直观展示了 Apache 的访问概况。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-type="png" data-w="1080" style="outline: 0px;line-height: 29.75px;box-sizing: border-box !important;overflow-wrap: break-word !important;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/ufWcjcomw8ZoZuxyDNk5ls6qpY6yDxqicV3GRtZWuvzNia9JNNTuATQxoQL2H6NpBKfUCY1GF6GsB8SJK4zUDWQQ/640?wx_fmt=png"  /></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">值得注意的是，ELK 技术栈中的 Logstash 资源消耗比较大。所以，在资源紧张的环境中，我们往往使用资源消耗更低的 Fluentd，来替代 Logstash（也就是所谓的 EFK 技术栈）。</span></section><h3 mp-original-font-size="22.100000381469727" mp-original-line-height="38.67499923706055" style="margin-top: 1.3em;margin-bottom: 1em;outline: 0px;font-weight: bold;font-size: 22.1px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 38.675px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 38.675px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">4、最后总结</span></h3><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">应用程序的监控，可以分为指标监控和日志监控两大部分：</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">指标监控主要是对一定时间段内性能指标进行测量，然后再通过时间序列的方式，进行处理、存储和告警。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">日志监控则可以提供更详细的上下文信息，通常通过 ELK 技术栈来进行收集、索引和图形化展示。</span></section><section mp-original-font-size="17" mp-original-line-height="29.75" style="outline: 0px;max-width: 100%;caret-color: rgb(34, 34, 34);color: rgb(34, 34, 34);font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-size-adjust: auto;line-height: 29.75px;margin-bottom: 1.2em !important;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(68, 68, 68);line-height: 29.75px;font-size: 15px;box-sizing: border-box !important;overflow-wrap: break-word !important;">在跨多个不同应用的复杂业务场景中，你还可以构建全链路跟踪系统。这样可以动态跟踪调用链中各个组件的性能，生成整个流程的调用拓扑图，从而加快定位复杂应用的性能问题。</span></section><p><br  /></p><hr style="border-style: solid;border-width: 1px 0 0;border-color: rgba(0,0,0,0.1);-webkit-transform-origin: 0 0;-webkit-transform: scale(1, 0.5);transform-origin: 0 0;transform: scale(1, 0.5);"  /><p><span style="font-size: 15px;"><strong style="margin: 0px;padding: 0px;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, &quot;system-ui&quot;, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;letter-spacing: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;"><span style="margin: 0px;padding: 0px;">免责声明：</span></strong><span style="margin: 0px;padding: 0px;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-style: initial;text-decoration-color: initial;">本公众号所发布的文章为本公众号原创，或者是在网络搜索到的优秀文章进行的编辑整理，文章版权归原作者所有，仅供读者朋友们学习、参考。对于分享的非原创文章，有些因为无法找到真正来源，如果标错来源或者对于文章中所使用的图片、连接等所包含但不限于软件、资料等，如有侵权，请直接联系后台，说明具体的文章，后台会尽快删除。给您带来的不便，深表歉意。</span></span></p><section><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-weuitheme="light" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、数字体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。" data-from="0" data-is_biz_ban="0" data-weui-theme="light"></mp-common-profile></section><section style="margin-top: 24px;"><br  /></section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>