<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"数据治理体系","title":"超详细的 SQL 优化大全 ！","time":"2023-07-14 12:56:10","timeStamp":"1689310570"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzA3NjIzNjMwOA==&mid=2247495907&idx=1&sn=f76a3a50f854aae34835bc3ddf05a73e&chksm=9f66e398a8116a8e69db8958cfbf133f2bd2b4f7def4fbbacc5f85b159d96a010a73c91f6a11#rd" target="_blank">超详细的 SQL 优化大全 ！</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">数据治理体系&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-07-14 12:56:10</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3NjIzNjMwOA==&action=getalbum&album_id=2260374267555004423#wechat_redirect" title="数据分析" target="_blank">#数据分析</a></p></div><section class="mp_profile_iframe_wrp" data-mpa-powered-by="yiban.io"><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、指标体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。关注我，和您一起终身学习。" data-from="0" data-weui-theme="light"></mp-common-profile></section><p style="outline: 0px;font-family: system-ui, -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: left;"><span style="outline: 0px;color: black;font-family: Helvetica;font-size: 16px;letter-spacing: 0px;">`</span><span style="color: black;font-family: Helvetica;font-size: 16px;letter-spacing: 0px;">两分钟，跑数两小时？</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="padding-right: 10px;padding-left: 10px;outline: 0px;white-space: normal;background-color: rgb(255, 255, 255);font-size: 16px;color: black;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Helvetica;"><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">在使用SQL过程中不仅要关注数据结果，同样要注意SQL语句的执行效率。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">本文涉及三部分：</p><ul data-tool="mdnice编辑器" class="list-paddingleft-1" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;outline: 0px;"><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">SQL介绍</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">SQL优化方法</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">SQL优化实例</section></li></ul><h1 data-tool="mdnice编辑器" style="margin-top: 16px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 24px;"><span style="outline: 0px;font-size: 18px;">1、MySQL的基本架构</span></h1><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">1）MySQL的基础架构图</strong></p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5642076502732241" data-type="jpeg" data-w="732" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_jpg/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRac0pq5WnQHMQRMNH2XERKichicl2f6Yibs4nhI2sRpicQia2eUERC47e9PA/640?wx_fmt=jpeg&amp;wxfrom=13&amp;tp=wxpic"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">左边的client可以看成是客户端，客户端有很多，像我们经常你使用的CMD黑窗口，像我们经常用于学习的WorkBench，像企业经常使用的Navicat工具，它们都是一个客户端。右边的这一大堆都可以看成是Server(MySQL的服务端)，我们将Server在细分为sql层和存储引擎层。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当查询出数据以后，会返回给执行器。执行器一方面将结果写到查询缓存里面，当你下次再次查询的时候，就可以直接从查询缓存中获取到数据了。另一方面，直接将结果响应回客户端。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">2）查询数据库的引擎</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① show engines;</strong></p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4746317512274959" data-type="png" data-w="611" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 611px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRNwA6UUa9QChSIB47Afkg0iaibgIZKo9iaP9GJVbEibC3U1pQXKcUVLRbUw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② show variables like “%storage_engine%”;</strong></p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4691689008042895" data-type="png" data-w="373" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 373px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWROyeX5x7ga6l8D2CbiaoE2X3h22BuSIgRDKicOhIIyzehQFSpliaLQvqZA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">3）指定数据库对象的存储引擎</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">create&nbsp;table&nbsp;tb(<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;int(4)&nbsp;auto_increment,<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;varchar(5),<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;dept&nbsp;varchar(5),<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;key(id)<br style="outline: 0px;"  />)&nbsp;engine=myISAM&nbsp;auto_increment=1&nbsp;default&nbsp;charset=utf8;<br style="outline: 0px;"  /></code></pre><h1 data-tool="mdnice编辑器" style="margin-top: 16px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 24px;"><span style="outline: 0px;font-size: 18px;">SQL优化</span></h1><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">1）为什么需要进行SQL优化？</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">在进行多表连接查询、子查询等操作的时候，由于你写出的SQL语句欠佳，导致的服务器执行时间太长，我们等待结果的时间太长。基于此，我们需要学习怎么优化SQL。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">2）mysql的编写过程和解析过程</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 编写过程</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">select&nbsp;dinstinct&nbsp;&nbsp;..from&nbsp;&nbsp;..join&nbsp;..on&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;..group&nbsp;by&nbsp;..having&nbsp;..order&nbsp;by&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">limit</span>&nbsp;..<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 解析过程</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">from&nbsp;..&nbsp;on..&nbsp;join&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;..group&nbsp;by&nbsp;..having&nbsp;..select&nbsp;dinstinct&nbsp;..order&nbsp;by&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">limit</span>&nbsp;..<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">提供一个网站，详细说明了mysql解析过程：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">https://www.cnblogs.com/annsshadow/p/5037667.html</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">3）SQL优化—主要就是优化索引</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">优化SQL，最重要的就是优化SQL索引。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">索引相当于字典的目录。利用字典目录查找汉字的过程，就相当于利用SQL索引查找某条记录的过程。有了索引，就可以很方便快捷的定位某条记录。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 什么是索引？</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">索引就是帮助MySQL高效获取数据的一种【数据结构】。索引是一种树结构，MySQL中一般用的是【B+树】。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 索引图示说明(这里用二叉树来帮助我们理解索引)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">树形结构的特点是：子元素比父元素小的，放在左侧；子元素比父元素大的，放在右侧。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">这个图示只是为了帮我们简单理解索引的，真实的关于【B+树】的说明，我们会在下面进行说明。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.39814814814814814" data-type="png" data-w="1080" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRFTXXvJRNTUuf7ciblRxd6wpctkS8mcAd8ibaMd6ZvnprX3tP9rePfs1A/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">索引是怎么查找数据的呢？两个字【指向】，上图中我们给age列指定了一个索引，即类似于右侧的这种树形结构。mysql表中的每一行记录都有一个硬件地址，例如索引中的age=50，指向的就是源表中该行的标识符(“硬件地址”)。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">也就是说，树形索引建立了与源表中每行记录硬件地址的映射关系，当你指定了某个索引，这种映射关系也就建成了，这就是为什么我们可以通过索引快速定位源表中记录的原因。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">以【select * from student where age=33】查询语句为例。当我们不加索引的时候，会从上到下扫描源表，当扫描到第5行的时候，找到了我们想要找到了元素，一共是查询了5次。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当添加了索引以后，就直接在树形结构中进行查找，33比50小，就从左侧查询到了23，33大于23，就又查询到了右侧，这下找到了33，整个索引结束，一共进行了3次查找。是不是很方便，假如我们此时需要查找age=62，你再想想“添加索引”前后，查找次数的变化情况。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">4）索引的弊端</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">1.当数据量很大的时候，索引也会很大(当然相比于源表来说，还是相当小的)，也需要存放在内存/硬盘中(通常存放在硬盘中)，占据一定的内存空间/物理空间。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">2.索引并不适用于所有情况：a.少量数据；b.频繁进行改动的字段，不适合做索引；c.很少使用的字段，不需要加索引；</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">3.索引会提高数据查询效率，但是会降低“增、删、改”的效率。当不使用索引的时候，我们进行数据的增删改，只需要操作源表即可，但是当我们添加索引后，不仅需要修改源表，也需要再次修改索引，很麻烦。尽管是这样，添加索引还是很划算的，因为我们大多数使用的就是查询，“查询”对于程序的性能影响是很大的。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">5）索引的优势</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">1.提高查询效率(降低了IO使用率)。当创建了索引后，查询次数减少了。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">2.降低CPU使用率。比如说【…order by age desc】这样一个操作，当不加索引，会把源表加载到内存中做一个排序操作，极大的消耗了资源。但是使用了索引以后，第一索引本身就小一些，第二索引本身就是排好序的，左边数据最小，右边数据最大。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">6）B+树图示说明</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">MySQL中索引使用的就是B+树结构。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5716535433070866" data-type="jpeg" data-w="635" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 635px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_jpg/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRb3bItTolRVicv7CnuIHNXjmSasTcPuK8zNktWT0yweboXFRgm2Z6ZtA/640?wx_fmt=jpeg&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">关于B+树的说明：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">首先，Btree一般指的都是【B+树】，数据全部存放在叶子节点中。对于上图来说，最下面的第3层，属于叶子节点，真实数据部份都是存放在叶子节点当中的。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">那么对于第1、2层中的数据又是干嘛的呢？答：用于分割指针块儿的，比如说小于26的找P1，介于26-30之间的找P2，大于30的找P3。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">其次，三层【B+树】可以存放上百万条数据。这么多数据怎么放的呢？增加“节点数”。图中我们只有三个节点。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">最后，【B+树】中查询任意数据的次数，都是n次，n表示的是【B+树】的高度。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">3、索引的分类与创建</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">1）索引分类</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">单值索引</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">唯一索引</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">复合索引</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 单值索引</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">利用表中的某一个字段创建单值索引。一张表中往往有多个字段，也就是说每一列其实都可以创建一个索引，这个根据我们实际需求来进行创建。还需要注意的一点就是，一张表可以创建多个“单值索引”。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">假如某一张表既有age字段，又有name字段，我们可以分别对age、name创建一个单值索引，这样一张表就有了两个单值索引。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 唯一索引</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">也是利用表中的某一个字段创建单值索引，与单值索引不同的是：创建唯一索引的字段中的数据，不能有重复值。像age肯定有很多人的年龄相同，像name肯定有些人是重名的，因此都不适合创建“唯一索引”。像编号id、学号sid，对于每个人都不一样，因此可以用于创建唯一索引。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ 复合索引</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">多个列共同构成的索引。比如说我们创建这样一个“复合索引”(name,age)，先利用name进行索引查询，当name相同的时候，我们利用age再进行一次筛选。注意：复合索引的字段并不是非要都用完，当我们利用name字段索引出我们想要的结果以后，就不需要再使用age进行再次筛选了。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">2）创建索引</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 语法</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">语法：create 索引类型 索引名 on 表(字段);</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">建表语句如下：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">查询表结构如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.3812785388127854" data-type="png" data-w="438" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 438px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWReAGFRqYCZArIQVVxtbWEbZgSJvdU1JjcucCnUc6OWrGswoou9KyXDw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 创建索引的第一种方式</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">Ⅰ 创建单值索引</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">create&nbsp;index&nbsp;dept_index&nbsp;on&nbsp;tb(dept);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">Ⅱ 创建唯一索引：这里我们假定name字段中的值都是唯一的</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">create&nbsp;unique&nbsp;index&nbsp;name_index&nbsp;on&nbsp;tb(name);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">Ⅲ 创建复合索引</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">create&nbsp;index&nbsp;dept_name_index&nbsp;on&nbsp;tb(dept,name);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ 创建索引的第二种方式</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">先删除之前创建的索引以后，再进行这种创建索引方式的测试；</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">语法：alter table 表名 add 索引类型 索引名(字段)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">Ⅰ 创建单值索引</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">alter&nbsp;table&nbsp;tb&nbsp;add&nbsp;index&nbsp;dept_index(dept);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">Ⅱ 创建唯一索引：这里我们假定name字段中的值都是唯一的</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">alter&nbsp;table&nbsp;tb&nbsp;add&nbsp;unique&nbsp;index&nbsp;name_index(name);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">Ⅲ 创建复合索引</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">alter&nbsp;table&nbsp;tb&nbsp;add&nbsp;index&nbsp;dept_name_index(dept,name);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">④ 补充说明</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">如果某个字段是primary key，那么该字段默认就是主键索引。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">主键索引和唯一索引非常相似。相同点：该列中的数据都不能有相同值；不同点：主键索引不能有null值，但是唯一索引可以有null值。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">3）索引删除和索引查询</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 索引删除</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">语法：drop index 索引名 on 表名;</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">drop&nbsp;index&nbsp;name_index&nbsp;on&nbsp;tb;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 索引查询</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">语法：show index from 表名;</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">show&nbsp;index&nbsp;from&nbsp;tb;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.22954303931987247" data-type="png" data-w="941" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRNlkk8vdMVzibqFGUFUgQXWqA76hoyOPWyAAETqPKVQ4boFAR7dgWHyA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">4、SQL性能问题的探索</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">人为优化：</strong>&nbsp;需要我们使用explain分析SQL的执行计划。该执行计划可以模拟SQL优化器执行SQL语句，可以帮助我们了解到自己编写SQL的好坏。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">SQL优化器自动优化：</strong>&nbsp;最开始讲述MySQL执行原理的时候，我们已经知道MySQL有一个优化器，当你写了一个SQL语句的时候，SQL优化器如果认为你写的SQL语句不够好，就会自动写一个好一些的等价SQL去执行。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">SQL优化器自动优化功能【会干扰】我们的人为优化功能。当我们查看了SQL执行计划以后，如果写的不好，我们会去优化自己的SQL。当我们以为自己优化的很好的时候，最终的执行计划，并不是按照我们优化好的SQL语句来执行的，而是有时候将我们优化好的SQL改变了，去执行。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">SQL优化是一种概率问题，有时候系统会按照我们优化好的SQL去执行结果(优化器觉得你写的差不多，就不会动你的SQL)。有时候优化器仍然会修改我们优化好的SQL，然后再去执行。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">1）查看执行计划</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">语法：explain + SQL语句</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">eg：explain select * from tb;</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">2）“执行计划”中需要知道的几个“关键字”</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">id ：编号</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">select_type ：查询类型</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">table ：表</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">type ：类型</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">possible_keys ：预测用到的索引</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">key ：实际使用的索引</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">key_len ：实际使用索引的长度</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">ref ：表之间的引用</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">rows ：通过索引查询到的数据量</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">Extra ：额外的信息</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">建表语句和插入数据：</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;建表语句</span><br style="outline: 0px;"  />create&nbsp;table&nbsp;course<br style="outline: 0px;"  />(&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;cid&nbsp;int(3),&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;cname&nbsp;varchar(20),&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;tid&nbsp;int(3)<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><br style="outline: 0px;"  />create&nbsp;table&nbsp;teacher<br style="outline: 0px;"  />(&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;tid&nbsp;int(3),&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;tname&nbsp;varchar(20),&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;tcid&nbsp;int(3)<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><br style="outline: 0px;"  />create&nbsp;table&nbsp;teacherCard<br style="outline: 0px;"  />(&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;tcid&nbsp;int(3),&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;tcdesc&nbsp;varchar(200)<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;插入数据</span><br style="outline: 0px;"  />insert&nbsp;into&nbsp;course&nbsp;values(1,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'java'</span>,1);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;course&nbsp;values(2,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'html'</span>,1);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;course&nbsp;values(3,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'sql'</span>,2);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;course&nbsp;values(4,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'web'</span>,3);<br style="outline: 0px;"  /><br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher&nbsp;values(1,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tz'</span>,1);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher&nbsp;values(2,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tw'</span>,2);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher&nbsp;values(3,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tl'</span>,3);<br style="outline: 0px;"  /><br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacherCard&nbsp;values(1,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tzdesc'</span>)&nbsp;;<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacherCard&nbsp;values(2,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'twdesc'</span>)&nbsp;;<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacherCard&nbsp;values(3,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tldesc'</span>)&nbsp;;<br style="outline: 0px;"  /></code></pre><h1 data-tool="mdnice编辑器" style="margin-top: 16px;margin-bottom: 15px;outline: 0px;font-weight: bold;font-size: 24px;"><span style="outline: 0px;font-size: 18px;">explain执行计划常用关键字详解</span></h1><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">1）id关键字的使用说明</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 案例：查询课程编号为2 或 教师证编号为3 的老师信息：</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;t.*<br style="outline: 0px;"  />from&nbsp;teacher&nbsp;t,course&nbsp;c,teacherCard&nbsp;tc<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;t.tid&nbsp;=&nbsp;c.tid&nbsp;and&nbsp;t.tcid&nbsp;=&nbsp;tc.tcid<br style="outline: 0px;"  />and&nbsp;(c.cid&nbsp;=&nbsp;2&nbsp;or&nbsp;tc.tcid&nbsp;=&nbsp;3);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.1301518438177874" data-type="png" data-w="922" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRYsVwEXRs6KRqd7KVgh7gDkQFSdbQOBLF9txhKhqpibwoJjYkpjIuakw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">接着，在往teacher表中增加几条数据。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">insert&nbsp;into&nbsp;teacher&nbsp;values(4,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'ta'</span>,4);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher&nbsp;values(5,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tb'</span>,5);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher&nbsp;values(6,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tc'</span>,6);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">再次查看执行计划。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;t.*<br style="outline: 0px;"  />from&nbsp;teacher&nbsp;t,course&nbsp;c,teacherCard&nbsp;tc<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;t.tid&nbsp;=&nbsp;c.tid&nbsp;and&nbsp;t.tcid&nbsp;=&nbsp;tc.tcid<br style="outline: 0px;"  />and&nbsp;(c.cid&nbsp;=&nbsp;2&nbsp;or&nbsp;tc.tcid&nbsp;=&nbsp;3);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.16251638269986893" data-type="png" data-w="763" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR5n6NNGBffx6P4nlMFDCu1PjGk1PZ2CuONmoTUJC0YoAY1Qialv8nfEQ/640?wx_fmt=png"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">表的执行顺序 ，因表数量改变而改变的原因：笛卡尔积。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">a&nbsp;&nbsp;&nbsp;b&nbsp;&nbsp;&nbsp;c<br style="outline: 0px;"  />2&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;4<br style="outline: 0px;"  />最终：2 * 3 * 4 &nbsp;= 6 * 4 = 24<br style="outline: 0px;"  />c&nbsp;&nbsp;&nbsp;b&nbsp;&nbsp;&nbsp;a<br style="outline: 0px;"  />4&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;2<br style="outline: 0px;"  />最终：4 * 3 * 2 = 12 * 2 = 24<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">分析：最终执行的条数，虽然是一致的。但是中间过程，有一张临时表是6，一张临时表是12，很明显6 &lt; 12，对于内存来说，数据量越小越好，因此优化器肯定会选择第一种执行顺序。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结论：id值相同，从上往下顺序执行。表的执行顺序因表数量的改变而改变。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 案例：查询教授SQL课程的老师的描述(desc)</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;tc.tcdesc&nbsp;from&nbsp;teacherCard&nbsp;tc&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tc.tcid&nbsp;=&nbsp;<br style="outline: 0px;"  />(&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;t.tcid&nbsp;from&nbsp;teacher&nbsp;t&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;&nbsp;t.tid&nbsp;=&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;(select&nbsp;c.tid&nbsp;from&nbsp;course&nbsp;c&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;c.cname&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'sql'</span>)<br style="outline: 0px;"  />);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.13631406761177753" data-type="png" data-w="917" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRIcibpUXy3gKyB74ZicY5KL7bhiakGFc0OV3LaqwibInmo1orkwiaEXpfp9w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结论：id值不同，id值越大越优先查询。这是由于在进行嵌套子查询时，先查内层，再查外层。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ 针对②做一个简单的修改</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;t.tname&nbsp;,tc.tcdesc&nbsp;from&nbsp;teacher&nbsp;t,teacherCard&nbsp;tc&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;t.tcid=&nbsp;tc.tcid<br style="outline: 0px;"  />and&nbsp;t.tid&nbsp;=&nbsp;(select&nbsp;c.tid&nbsp;from&nbsp;course&nbsp;c&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;cname&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'sql'</span>)&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.13034188034188035" data-type="png" data-w="936" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR8AAzugKLb1ZrYIibbWS8X5bOTpGEQMaibYDT1Ibld20JCOTg47WRxtgg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结论：id值有相同，又有不同。id值越大越优先；id值相同，从上往下顺序执行。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">2）select_type关键字的使用说明：查询类型</strong></p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.8908045977011494" data-type="png" data-w="174" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 174px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR7ucQLQmpicib17zTNlIYAAzVoYXicewzVB9jw8zibD9vl8wKe65dwanttg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① simple：简单查询</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">不包含子查询，不包含union查询。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.14097968936678615" data-type="png" data-w="837" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRFhWiccl1icDTnQV2KXoF64XnHwX0vlY4hcic2q5Q6VrvAkxyOO6Du1P3g/640?wx_fmt=png"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② primary：包含子查询的主查询(最外层)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ subquery：包含子查询的主查询(非最外层)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">④ derived：衍生查询(用到了临时表)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">a.在from子查询中，只有一张表；</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">b.在from子查询中，如果table1 union table2，则table1就是derived表；</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;&nbsp;cr.cname&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />from&nbsp;(&nbsp;select&nbsp;*&nbsp;from&nbsp;course&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tid&nbsp;=&nbsp;1&nbsp;&nbsp;union&nbsp;select&nbsp;*&nbsp;from&nbsp;course&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tid&nbsp;=&nbsp;2&nbsp;)&nbsp;cr&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.16609783845278725" data-type="png" data-w="879" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRU3JKh0byiabVfsiamXeezCH3CTWHcObHzUK474v8rj0GHejUL1HKHTqw/640?wx_fmt=png"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑤ union：union之后的表称之为union表，如上例</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑥ union result：告诉我们，哪些表之间使用了union查询</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">3）type关键字的使用说明：索引类型</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">system、const只是理想状况，实际上只能优化到index --&gt; range --&gt; ref这个级别。要对type进行优化的前提是，你得创建索引。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.0918580375782881" data-type="png" data-w="479" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 479px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRHicgnicpbyRvS5yqTURic12g3hlJloLzhdgHgGRbzR3qHYmIHibAxeEibSA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① system</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">源表只有一条数据(实际中，基本不可能)；</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">衍生表只有一条数据的主查询(偶尔可以达到)。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② const</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">仅仅能查到一条数据的SQL ,仅针对Primary key或unique索引类型有效。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;tid&nbsp;from&nbsp;test01&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tid&nbsp;=1&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.1356297093649085" data-type="png" data-w="929" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRaMILvWL1oZPyKPO3X1ibRw73phY0FTN7dDibibRzfHLMw4MxBKC0tQ10w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">删除以前的主键索引后，此时我们添加一个其他的普通索引：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">create&nbsp;index&nbsp;test01_index&nbsp;on&nbsp;test01(tid)&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;再次查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;tid&nbsp;from&nbsp;test01&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tid&nbsp;=1&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.12134344528710726" data-type="png" data-w="923" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRCcf1kVicmmzsprk9mRF3EvbcpcD78Hnvibe2p13cAa8WtIFw5MdzLIxw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ eq_ref</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">唯一性索引，对于每个索引键的查询，返回匹配唯一行数据（有且只有1个，不能多 、不能0），并且查询结果和数据条数必须一致。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">此种情况常见于唯一索引和主键索引。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">delete&nbsp;from&nbsp;teacher&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tcid&nbsp;&gt;=&nbsp;4;<br style="outline: 0px;"  />alter&nbsp;table&nbsp;teacherCard&nbsp;add&nbsp;constraint&nbsp;pk_tcid&nbsp;primary&nbsp;key(tcid);<br style="outline: 0px;"  />alter&nbsp;table&nbsp;teacher&nbsp;add&nbsp;constraint&nbsp;uk_tcid&nbsp;unique&nbsp;index(tcid)&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;t.tcid&nbsp;from&nbsp;teacher&nbsp;t,teacherCard&nbsp;tc&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;t.tcid&nbsp;=&nbsp;tc.tcid&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.14776274713839752" data-type="png" data-w="961" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRxN8djARcuBzAT3vq7dCEkqZ34tfBQtxHXOD3lmCtjHTmoiceHy3ciaoA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">总结：以上SQL，用到的索引是t.tcid，即teacher表中的tcid字段；如果teacher表的数据个数和连接查询的数据个数一致（都是3条数据），则有可能满足eq_ref级别；否则无法满足。条件很苛刻，很难达到。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">④ ref</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">非唯一性索引，对于每个索引键的查询，返回匹配的所有行（可以0，可以1，可以多）</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">准备数据：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><img class="rich_pages wxw-img" data-ratio="1.0975" data-type="png" data-w="400" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 400px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRbPicvjMXiahD9zvh8I031cFPiboGo55A8EM0VdUibjqvSbiaiaiaAtXHEfib4Q/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">创建索引，并查看执行计划：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;添加索引</span><br style="outline: 0px;"  />alter&nbsp;table&nbsp;teacher&nbsp;add&nbsp;index&nbsp;index_name&nbsp;(tname)&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tz'</span>;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.13149171270718232" data-type="png" data-w="905" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRQ3tjYTBib20icdlQku7JgpMrnyOJztM2ZCKnvFVFVfshB6Cqlcn9k9GQ/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑤ range</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">检索指定范围的行 ,where后面是一个范围查询(between, &gt;, &lt;, &gt;=, in)</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">in有时候会失效，从而转为无索引时候的ALL</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;添加索引</span><br style="outline: 0px;"  />alter&nbsp;table&nbsp;teacher&nbsp;add&nbsp;index&nbsp;tid_index&nbsp;(tid)&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划：以下写了一种等价SQL写法，查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;t.*&nbsp;from&nbsp;teacher&nbsp;t&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;t.tid&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">in</span>&nbsp;(1,2)&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;t.*&nbsp;from&nbsp;teacher&nbsp;t&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;t.tid&nbsp;&lt;3&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><img class="rich_pages wxw-img" data-ratio="0.3111111111111111" data-type="png" data-w="1080" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRwcAYl6GoPgKWSS3ZxodbXtXoUKhy8og7ECVcvTXJn7UJfFibUakia78g/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑥ index</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">查询全部索引中的数据(扫描整个索引)</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑦ ALL</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">查询全部源表中的数据(暴力扫描全表)</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.5416267942583732" data-type="png" data-w="1045" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRNpveicZqFGS60QqBuIKN7z2Zdkz99qT9CGsfc7FlAG68NH1VokPHlOg/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">注意：cid是索引字段，因此查询索引字段，只需要扫描索引表即可。但是tid不是索引字段，查询非索引字段，需要暴力扫描整个源表，会消耗更多的资源。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">4）possible_keys和key</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">possible_keys可能用到的索引。是一种预测，不准。了解一下就好。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">key指的是实际使用的索引。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;先给course表的cname字段，添加一个索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;cname_index&nbsp;on&nbsp;course(cname);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;t.tname&nbsp;,tc.tcdesc&nbsp;from&nbsp;teacher&nbsp;t,teacherCard&nbsp;tc<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;t.tcid=&nbsp;tc.tcid<br style="outline: 0px;"  />and&nbsp;t.tid&nbsp;=&nbsp;(select&nbsp;c.tid&nbsp;from&nbsp;course&nbsp;c&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;cname&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'sql'</span>)&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.18500948766603414" data-type="png" data-w="1054" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRiaE1g4gWc3F92Jv1NqSehiaqeYbfxchzfdu8Syf6KIZ7Ky9RGicotf4tg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">有一点需要注意的是：如果possible_key/key是NULL，则说明没用索引。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">5）key_len</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">索引的长度，用于判断复合索引是否被完全使用(a,b,c)。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 新建一张新表，用于测试</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建表</span><br style="outline: 0px;"  />create&nbsp;table&nbsp;test_kl<br style="outline: 0px;"  />(&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;name&nbsp;char(20)&nbsp;not&nbsp;null&nbsp;default&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span><br style="outline: 0px;"  />);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;添加索引</span><br style="outline: 0px;"  />alter&nbsp;table&nbsp;test_kl&nbsp;add&nbsp;index&nbsp;index_name(name)&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test_kl&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;name&nbsp;=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;;&nbsp;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.3702064896755162" data-type="png" data-w="678" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRRH3iakVmeGicdB1qKq5xBTTUCT417zN5dYP3yhAFiaYKdrUYogOpr4kNA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果分析：因为我没有设置服务端的字符集，因此默认的字符集使用的是latin1，对于latin1一个字符代表一个字节，因此这列的key_len的长度是20，表示使用了name这个索引。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 给test_kl表，新增name1列，该列没有设置“not null”</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.2973372781065089" data-type="png" data-w="676" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 676px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRWmVjaHWheDkDWU9p2ZjTDkNo6jPdF70Q9PEmbWtJrrhy4WrhER8riaw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果分析：如果索引字段可以为null，则mysql底层会使用1个字节用于标识。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ 删除原来的索引name和name1，新增一个复合索引</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;删除原来的索引name和name1</span><br style="outline: 0px;"  />drop&nbsp;index&nbsp;index_name&nbsp;on&nbsp;test_kl&nbsp;;<br style="outline: 0px;"  />drop&nbsp;index&nbsp;index_name1&nbsp;on&nbsp;test_kl&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;增加一个复合索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;name_name1_index&nbsp;on&nbsp;test_kl(name,name1);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test_kl&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;name1&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;;&nbsp;--121<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test_kl&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;name&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;;&nbsp;--60<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.45322793148880103" data-type="png" data-w="759" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRUmzStdtSUQbVln5niaiauj4bkZoyNs8tdice2Lv2nw8NgDH3MF8xpeqog/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;对于下面这个执行计划，可以看到我们只使用了复合索引的第一个索引字段name，因此key_len是20，这个很清楚。再看上面这个执行计划，我们虽然仅仅在where后面使用了复合索引字段中的name1字段，但是你要使用复合索引的第2个索引字段，会默认使用了复合索引的第1个索引字段name，由于name1可以是null，因此key_len = 20 + 20 + 1 = 41呀！</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">④ 再次怎加一个name2字段，并为该字段创建一个索引。</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">不同的是：该字段数据类型是varchar</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;新增一个字段name2，name2可以为null</span><br style="outline: 0px;"  />alter&nbsp;table&nbsp;test_kl&nbsp;add&nbsp;column&nbsp;name2&nbsp;varchar(20)&nbsp;;&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;给name2字段，设置为索引字段</span><br style="outline: 0px;"  />alter&nbsp;table&nbsp;test_kl&nbsp;add&nbsp;index&nbsp;name2_index(name2)&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test_kl&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;name2&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;;&nbsp;&nbsp;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.2503419972640219" data-type="png" data-w="731" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRmooKV9saQezGTlS9rxakMc8h2BYL1iamRH2Zz4Tnrx4PCasa5icnbr8w/640?wx_fmt=png"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;key_len = 20 + 1 + 2，这个20 + 1我们知道，这个2又代表什么呢？原来varchar属于可变长度，在mysql底层中，用2个字节标识可变长度。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">6）ref</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">这里的ref的作用，指明当前表所参照的字段。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">注意与type中的ref值区分。在type中，ref只是type类型的一种选项值。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;给course表的tid字段，添加一个索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;tid_index&nbsp;on&nbsp;course(tid);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;course&nbsp;c,teacher&nbsp;t&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;c.tid&nbsp;=&nbsp;t.tid&nbsp;&nbsp;<br style="outline: 0px;"  />and&nbsp;t.tname&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tw'</span>;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.2546583850931677" data-type="png" data-w="805" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRv8Y0KQj9HyGdJXpyicgiaLRiaITCot3TTHkiaictb9IRSRdFoM0tHXFJvYQ/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;有两个索引，c表的c.tid引用的是t表的tid字段，因此可以看到显示结果为【数据库名.t.tid】，t表的t.name引用的是一个常量"tw"，因此可以看到结果显示为const，表示一个常量。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">7）rows(这个目前还是有点疑惑)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">被索引优化查询的数据个数 (实际通过索引而查询到的数据个数)</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;*<br style="outline: 0px;"  />from&nbsp;course&nbsp;c,teacher&nbsp;t&nbsp;&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;c.tid&nbsp;=&nbsp;t.tid<br style="outline: 0px;"  />and&nbsp;t.tname&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tz'</span>&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5542168674698795" data-type="png" data-w="830" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWREgPGlTHgt8cqLSiaKF35jK81eibkmf0jgrs2FoibpjYUibyZyUSfoMicn7A/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">8）extra</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">表示其他的一些说明，也很有用。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① using filesort：针对单索引的情况</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当出现了这个词，表示你当前的SQL性能消耗较大。表示进行了一次“额外”的排序。常见于order by语句中。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">Ⅰ 什么是“额外”的排序？</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">为了讲清楚这个，我们首先要知道什么是排序。我们为了给某一个字段进行排序的时候，首先你得先查询到这个字段，然后在将这个字段进行排序。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">紧接着，我们查看如下两个SQL语句的执行计划。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;新建一张表，建表同时创建索引</span><br style="outline: 0px;"  />create&nbsp;table&nbsp;test02<br style="outline: 0px;"  />(&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;a1&nbsp;char(3),&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;a2&nbsp;char(3),&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;a3&nbsp;char(3),&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;index&nbsp;idx_a1(a1),&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;index&nbsp;idx_a2(a2),&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;index&nbsp;idx_a3(a3)<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1&nbsp;=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;order&nbsp;by&nbsp;a1&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1&nbsp;=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;order&nbsp;by&nbsp;a2&nbsp;;&nbsp;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.29782359679266895" data-type="png" data-w="873" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRE9AZQ83LtiblhzeU7XOhuoWtOMlVE2zDW1micIpwfr2AicMzJdXNdlxNg/640?wx_fmt=png"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;对于第一个执行计划，where后面我们先查询了a1字段，然后再利用a1做了依次排序，这个很轻松。但是对于第二个执行计划，where后面我们查询了a1字段，然而利用的却是a2字段进行排序，此时myql底层会进行一次查询，进行“额外”的排序。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">总结：对于单索引，如果排序和查找是同一个字段，则不会出现using filesort；如果排序和查找不是同一个字段，则会出现using filesort；因此where哪些字段，就order by哪些些字段。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② using filesort：针对复合索引的情况</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">不能跨列(官方术语：最佳左前缀)</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;删除test02的索引</span><br style="outline: 0px;"  />drop&nbsp;index&nbsp;idx_a1&nbsp;on&nbsp;test02;<br style="outline: 0px;"  />drop&nbsp;index&nbsp;idx_a2&nbsp;on&nbsp;test02;<br style="outline: 0px;"  />drop&nbsp;index&nbsp;idx_a3&nbsp;on&nbsp;test02;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建一个复合索引</span><br style="outline: 0px;"  />alter&nbsp;table&nbsp;test02&nbsp;add&nbsp;index&nbsp;idx_a1_a2_a3&nbsp;(a1,a2,a3)&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看下面SQL语句的执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;order&nbsp;by&nbsp;a3&nbsp;;&nbsp;&nbsp;--using&nbsp;filesort<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a2=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;order&nbsp;by&nbsp;a3&nbsp;;&nbsp;--using&nbsp;filesort<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;order&nbsp;by&nbsp;a2&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.5684931506849316" data-type="png" data-w="876" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR88swtFueO8NicNHnhibicWGw6ZQIkvvzF1aYJNZqM21gr4ukjVmjP4Ribg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;复合索引的顺序是(a1,a2,a3)，可以看到a1在最左边，因此a1就叫做“最佳左前缀”，如果要使用后面的索引字段，必须先使用到这个a1字段。对于explain1，where后面我们使用a1字段，但是后面的排序使用了a3，直接跳过了a2，属于跨列；对于explain2，where后面我们使用了a2字段，直接跳过了a1字段，也属于跨列；对于explain3，where后面我们使用a1字段，后面使用的是a2字段，因此没有出现【using filesort】。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ using temporary</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当出现了这个词，也表示你当前的SQL性能消耗较大。这是由于当前SQL用到了临时表。一般出现在group by中。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;a1&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">in</span>&nbsp;(<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'1'</span>,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'2'</span>,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'3'</span>)&nbsp;group&nbsp;by&nbsp;a1&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;a1&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">in</span>&nbsp;(<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'1'</span>,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'2'</span>,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'3'</span>)&nbsp;group&nbsp;by&nbsp;a2&nbsp;;&nbsp;--using&nbsp;temporary<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.24743326488706366" data-type="png" data-w="974" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRYngGLbH88yoLMyWo8Wiba8YiaKywQ8yYPXJqhKZKeIbJeg84z9kL7T6w/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;当你查询哪个字段，就按照那个字段分组，否则就会出现using temporary。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">针对using temporary，我们在看一个例子：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">using temporary表示需要额外再使用一张表，一般出现在group by语句中。虽然已经有表了，但是不适用，必须再来一张表。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">再次来看mysql的编写过程和解析过程。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">Ⅰ 编写过程</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">select&nbsp;dinstinct&nbsp;&nbsp;..from&nbsp;&nbsp;..join&nbsp;..on&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;..group&nbsp;by&nbsp;..having&nbsp;..order&nbsp;by&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">limit</span>&nbsp;..<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">Ⅱ 解析过程</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">from&nbsp;..&nbsp;on..&nbsp;join&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;..group&nbsp;by&nbsp;..having&nbsp;..select&nbsp;dinstinct&nbsp;..order&nbsp;by&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">limit</span>&nbsp;..<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">很显然，where后是group by，然后才是select。基于此，我们再查看如下两个SQL语句的执行计划。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test03&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a2=2&nbsp;and&nbsp;a4=4&nbsp;group&nbsp;by&nbsp;a2,a4;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;test03&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a2=2&nbsp;and&nbsp;a4=4&nbsp;group&nbsp;by&nbsp;a3;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">分析如下：</strong>&nbsp;对于第一个执行计划，where后面是a2和a4，接着我们按照a2和a4分组，很明显这两张表已经有了，直接在a2和a4上分组就行了。但是对于第二个执行计划，where后面是a2和a4，接着我们却按照a3分组，很明显我们没有a3这张表，因此有需要再来一张临时表a3。因此就会出现using temporary。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">④ using index</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当你看到这个关键词，恭喜你，表示你的SQL性能提升了。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">using index称之为“索引覆盖”。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当出现了using index，就表示不用读取源表，而只利用索引获取数据，不需要回源表查询。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">只要使用到的列，全部出现在索引中，就是索引覆盖。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;删除test02中的复合索引idx_a1_a2_a3</span><br style="outline: 0px;"  />drop&nbsp;index&nbsp;idx_a1_a2_a3&nbsp;on&nbsp;test02;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;重新创建一个复合索引</span><br style="outline: 0px;"  />idx_a1_a2create&nbsp;index&nbsp;idx_a1_a2&nbsp;on&nbsp;test02(a1,a2);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;a1,a3&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;or&nbsp;a3=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;a1,a2&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;and&nbsp;a2=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.36538461538461536" data-type="png" data-w="936" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRsvNYNUeCczRbkicHm80M4m4vs12eGQib6ZUtbicc2cM7u2BGq7zMb8Y3w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;我们创建的是a1和a2的复合索引，对于第一个执行计划，我们却出现了a3，该字段并没有创建索引，因此没有出现using index，而是using where，表示我们需要回表查询。对于第二个执行计划，属于完全的索引覆盖，因此出现了using index。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">针对using index，我们在查看一个案例：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;a1,a2&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;or&nbsp;a2=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;a1,a2&nbsp;from&nbsp;test02;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">如果用到了索引覆盖(using index时)，会对possible_keys和key造成影响：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">a.如果没有where，则索引只出现在key中；</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">b.如果有where，则索引 出现在key和possible_keys中。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑤ using where</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">表示需要【回表查询】，表示既在索引中进行了查询，又回到了源表进行了查询。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;删除test02中的复合索引idx_a1_a2</span><br style="outline: 0px;"  />drop&nbsp;index&nbsp;idx_a1_a2&nbsp;on&nbsp;test02;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;将a1字段，新增为一个索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;a1_index&nbsp;on&nbsp;test02(a1);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;a1,a3&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">""</span>&nbsp;and&nbsp;a3=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">""</span>&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.18435754189944134" data-type="png" data-w="895" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRbV5xBVmpHbMjagaOXJ5ib0OMoItlmqZsM2yhs1AI1aNx4oR93WyVCag/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;我们既使用了索引a1，表示我们使用了索引进行查询。但是又对于a3字段，我们并没有使用索引，因此对于a3字段，需要回源表查询，这个时候出现了using where。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑥ impossible where(了解)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当where子句永远为False的时候，会出现impossible where</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;a1&nbsp;from&nbsp;test02&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">"a"</span>&nbsp;and&nbsp;a1=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">"b"</span>&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.13903743315508021" data-type="png" data-w="935" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRYgjNWAiawRsKPXxZ69yndQdspPWH2Db0sArlM0uakWeJiaR5odavr6zg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">6、优化示例</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">1）引入案例</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建新表</span><br style="outline: 0px;"  />create&nbsp;table&nbsp;test03<br style="outline: 0px;"  />(&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;a1&nbsp;int(4)&nbsp;not&nbsp;null,&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;a2&nbsp;int(4)&nbsp;not&nbsp;null,&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;a3&nbsp;int(4)&nbsp;not&nbsp;null,&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;a4&nbsp;int(4)&nbsp;not&nbsp;null<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建一个复合索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;a1_a2_a3_test03&nbsp;on&nbsp;test03(a1,a2,a3);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;a3&nbsp;from&nbsp;test03&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=1&nbsp;and&nbsp;a2=2&nbsp;and&nbsp;a3=3;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.36987951807228914" data-type="png" data-w="830" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRRUQ93rIr2L2LV10zqzc8EfoQ7EGqGVzHMuWHYMb1sc8mzKXcCV9tYA/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">推荐写法：</strong>&nbsp;复合索引顺序和使用顺序一致。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">下面看看【<strong style="outline: 0px;">不推荐写法</strong>】：复合索引顺序和使用顺序不一致。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;a3&nbsp;from&nbsp;test03&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a3=1&nbsp;and&nbsp;a2=2&nbsp;and&nbsp;a1=3;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.145933014354067" data-type="png" data-w="836" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRPJwLbBcNDicjb8MHQbOhaDqnqr1HYOia4jh6liamjarnkibRzPkkO7vMNw/640?wx_fmt=png"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;虽然结果和上述结果一致，但是不推荐这样写。但是这样写怎么又没有问题呢？这是由于SQL优化器的功劳，它帮我们调整了顺序。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">最后再补充一点：对于复合索引，不要跨列使用</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;a3&nbsp;from&nbsp;test03&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;a1=1&nbsp;and&nbsp;a3=2&nbsp;group&nbsp;by&nbsp;a3;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.18241469816272965" data-type="png" data-w="762" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRKOgicIOZqQIj6vorIPWUjyA95SSLjd3X5j6PaGV0TeXPiaJfnc48mKvg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;a1_a2_a3是一个复合索引，我们使用a1索引后，直接跨列使用了a3，直接跳过索引a2，因此索引a3失效了，当使用a3进行分组的时候，就会出现using where。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">2）单表优化</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建新表</span><br style="outline: 0px;"  />create&nbsp;table&nbsp;book<br style="outline: 0px;"  />(&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;bid&nbsp;int(4)&nbsp;primary&nbsp;key,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;varchar(20)&nbsp;not&nbsp;null,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;authorid&nbsp;int(4)&nbsp;not&nbsp;null,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;publicid&nbsp;int(4)&nbsp;not&nbsp;null,&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;typeid&nbsp;int(4)&nbsp;not&nbsp;null&nbsp;<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;插入数据</span><br style="outline: 0px;"  />insert&nbsp;into&nbsp;book&nbsp;values(1,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tjava'</span>,1,1,2)&nbsp;;<br style="outline: 0px;"  />insert&nbsp;into&nbsp;book&nbsp;values(2,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'tc'</span>,2,1,2)&nbsp;;<br style="outline: 0px;"  />insert&nbsp;into&nbsp;book&nbsp;values(3,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'wx'</span>,3,2,1)&nbsp;;<br style="outline: 0px;"  />insert&nbsp;into&nbsp;book&nbsp;values(4,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'math'</span>,4,2,3)&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.5098591549295775" data-type="png" data-w="355" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 355px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRuRwgmjgTkQ2egg9lIEzF5DZficCzR2aSShrq1Ommqb9fLAPZuLibjIUQ/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">案例：查询authorid=1且typeid为2或3的bid，并根据typeid降序排列。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;<br style="outline: 0px;"  />select&nbsp;bid&nbsp;from&nbsp;book&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;typeid&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">in</span>(2,3)&nbsp;and&nbsp;authorid=1&nbsp;<br style="outline: 0px;"  />order&nbsp;by&nbsp;typeid&nbsp;desc&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.21418826739427013" data-type="png" data-w="733" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-radius: 4px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;background-size: 16px !important;visibility: visible !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRbgDfKKZ7cAORpBC2ckYCWicypsweAxicojjXsDRiagJUgRic45X1xI20icg/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">这是没有进行任何优化的SQL，可以看到typ为ALL类型，extra为using filesort，可以想象这个SQL有多恐怖。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">优化：添加索引的时候，要根据MySQL解析顺序添加索引，又回到了MySQL的解析顺序，下面我们再来看看MySQL的解析顺序。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">from&nbsp;..&nbsp;on..&nbsp;join&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;..group&nbsp;by&nbsp;..having&nbsp;..select&nbsp;dinstinct&nbsp;..order&nbsp;by&nbsp;..<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">limit</span>&nbsp;..<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 优化1：基于此，我们进行索引的添加，并再次查看执行计划。</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;添加索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;typeid_authorid_bid&nbsp;on&nbsp;book(typeid,authorid,bid);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;再次查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;<br style="outline: 0px;"  />select&nbsp;bid&nbsp;from&nbsp;book&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;typeid&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">in</span>(2,3)&nbsp;and&nbsp;authorid=1&nbsp;&nbsp;<br style="outline: 0px;"  />order&nbsp;by&nbsp;typeid&nbsp;desc&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><img class="rich_pages wxw-img" data-ratio="0.2597864768683274" data-type="png" data-w="843" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR0gogyZoJEYbyqLsVbVdDbSHbicCtOperF6nwUFxJIBtqM41enW4ntfQ/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;结果并不是和我们想象的一样，还是出现了using where，查看索引长度key_len=8，表示我们只使用了2个索引，有一个索引失效了。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 优化2：使用了in有时候会导致索引失效，基于此有了如下一种优化思路。</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">将in字段放在最后面。需要注意一点：每次创建新的索引的时候，最好是删除以前的废弃索引，否则有时候会产生干扰(索引之间)。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;删除以前的索引</span><br style="outline: 0px;"  />drop&nbsp;index&nbsp;typeid_authorid_bid&nbsp;on&nbsp;book;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;再次创建索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;authorid_typeid_bid&nbsp;on&nbsp;book(authorid,typeid,bid);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;再次查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;<br style="outline: 0px;"  />select&nbsp;bid&nbsp;from&nbsp;book&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid=1&nbsp;&nbsp;and&nbsp;typeid&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">in</span>(2,3)&nbsp;<br style="outline: 0px;"  />order&nbsp;by&nbsp;typeid&nbsp;desc&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.09501187648456057" data-type="png" data-w="842" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRmDt4fSOBM0qDkJXWiaC3hbRnsneXBzkZ3V4icBYmhAsU1e8XgqfP541A/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;这里虽然没有变化，但是这是一种优化思路。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">总结如下：</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">a.最佳做前缀，保持索引的定义和使用的顺序一致性</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">b.索引需要逐步优化(每次创建新索引，根据情况需要删除以前的废弃索引)</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">c.将含In的范围查询，放到where条件的最后，防止失效。</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">本例中同时出现了Using where（需要回原表）; Using index（不需要回原表）：原因，where authorid=1 and typeid in(2,3)中authorid在索引(authorid,typeid,bid)中，因此不需要回原表（直接在索引表中能查到）；而typeid虽然也在索引(authorid,typeid,bid)中，但是含in的范围查询已经使该typeid索引失效，因此相当于没有typeid这个索引，所以需要回原表（using where）；</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">例如以下没有了In，则不会出现using where：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;bid&nbsp;from&nbsp;book&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;&nbsp;authorid=1&nbsp;and&nbsp;typeid&nbsp;=3<br style="outline: 0px;"  />order&nbsp;by&nbsp;typeid&nbsp;desc&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.20580474934036938" data-type="png" data-w="758" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRw94sQqibWtuwYmoPKo6mSeYJu9Gtb06oNvYu2QVJRbusUnW9Lq8F8jw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">3）两表优化</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建teacher2新表</span><br style="outline: 0px;"  />create&nbsp;table&nbsp;teacher2<br style="outline: 0px;"  />(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;tid&nbsp;int(4)&nbsp;primary&nbsp;key,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;cid&nbsp;int(4)&nbsp;not&nbsp;null<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;插入数据</span><br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher2&nbsp;values(1,2);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher2&nbsp;values(2,1);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;teacher2&nbsp;values(3,3);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建course2新表</span><br style="outline: 0px;"  />create&nbsp;table&nbsp;course2<br style="outline: 0px;"  />(&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;cid&nbsp;int(4)&nbsp;,&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;cname&nbsp;varchar(20)<br style="outline: 0px;"  />);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;插入数据</span><br style="outline: 0px;"  />insert&nbsp;into&nbsp;course2&nbsp;values(1,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'java'</span>);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;course2&nbsp;values(2,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'python'</span>);<br style="outline: 0px;"  />insert&nbsp;into&nbsp;course2&nbsp;values(3,<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'kotlin'</span>);<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">案例：使用一个左连接，查找教java课程的所有信息。</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;<br style="outline: 0px;"  />select&nbsp;*<br style="outline: 0px;"  />from&nbsp;teacher2&nbsp;t<br style="outline: 0px;"  />left&nbsp;outer&nbsp;join&nbsp;course2&nbsp;c<br style="outline: 0px;"  />on&nbsp;t.cid=c.cid&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;c.cname=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'java'</span>;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.25635103926096997" data-type="png" data-w="866" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR7n4iaCLZGzEvZYrftngKkX2eMI0f7iaD4eHiaHA7Wsvp6BVRPVxwF8TTA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 优化</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">对于两张表，索引往哪里加？答：对于表连接，小表驱动大表。索引建立在经常使用的字段上。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">为什么小表驱动大表好一些呢？</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">&nbsp;&nbsp;&nbsp;&nbsp;小表:10&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;大表:300<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;小表驱动大表</span><br style="outline: 0px;"  />select&nbsp;...<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;小表.x10=大表.x300&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">for</span>(int&nbsp;i=0;i&lt;小表.length10;i++)<br style="outline: 0px;"  />{&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">for</span>(int&nbsp;j=0;j&lt;大表.length300;j++)&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;}<br style="outline: 0px;"  />}<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;大表驱动小表</span><br style="outline: 0px;"  />select&nbsp;...<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;大表.x300=小表.x10&nbsp;;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">for</span>(int&nbsp;i=0;i&lt;大表.length300;i++)<br style="outline: 0px;"  />{&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">for</span>(int&nbsp;j=0;j&lt;小表.length10;j++)&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;<br style="outline: 0px;"  />&nbsp;&nbsp;&nbsp;&nbsp;}<br style="outline: 0px;"  />}<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">分析：</strong>&nbsp;以上2个FOR循环，最终都会循环3000次；但是对于双层循环来说：一般建议，将数据小的循环，放外层。数据大的循环，放内层。不用管这是为什么，这是编程语言的一个原则，对于双重循环，外层循环少，内存循环大，程序的性能越高。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结论：当编写【…on t.cid=c.cid】时，将数据量小的表放左边（假设此时t表数据量小，c表数据量大。）</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">我们已经知道了，对于两表连接，需要利用小表驱动大表，例如【…on t.cid=c.cid】，t如果是小表(10条)，c如果是大表(300条)，那么t每循环1次，就需要循环300次，即t表的t.cid字段属于，经常使用的字段，因此需要给cid字段添加索引。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">更深入的说明：</strong>&nbsp;一般情况下，左连接给左表加索引。右连接给右表加索引。其他表需不需要加索引，我们逐步尝试。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;给左表的字段加索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;cid_teacher2&nbsp;on&nbsp;teacher2(cid);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;<br style="outline: 0px;"  />select&nbsp;*<br style="outline: 0px;"  />from&nbsp;teacher2&nbsp;t&nbsp;<br style="outline: 0px;"  />left&nbsp;outer&nbsp;join&nbsp;course2&nbsp;c<br style="outline: 0px;"  />on&nbsp;t.cid=c.cid<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;c.cname=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'java'</span>;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.12757731958762886" data-type="png" data-w="776" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRTu8faicPwazTxBwKhMVVIzQmRcjw6FB2flmiaiajsFMUiapC4OiaJ18DthA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当然你可以下去接着优化，给cname添加一个索引。索引优化是一个逐步的过程，需要一点点尝试。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;给cname的字段加索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;cname_course2&nbsp;on&nbsp;course2(cname);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain<br style="outline: 0px;"  />select&nbsp;t.cid,c.cname<br style="outline: 0px;"  />from&nbsp;teacher2&nbsp;t<br style="outline: 0px;"  />left&nbsp;outer&nbsp;join&nbsp;course2&nbsp;c<br style="outline: 0px;"  />on&nbsp;t.cid=c.cid&nbsp;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;c.cname=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'java'</span>;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.11086474501108648" data-type="png" data-w="902" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRAx8JRqc5cn1piaRvETvp5PvO1BjLO8yUMgolYq4XRMllMElNicJI8U8g/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">最后补充一个：Using join buffer是extra中的一个选项，表示Mysql引擎使用了“连接缓存”，即MySQL底层动了你的SQL，你写的太差了。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">4）三表优化</strong></p><ul data-tool="mdnice编辑器" class="list-paddingleft-1" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;outline: 0px;"><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">大于等于张表，优化原则一样</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">小表驱动大表</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">索引建立在经常查询的字段上</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">7、避免索引失效的一些原则</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 复合索引需要注意的点</strong></p><ul data-tool="mdnice编辑器" class="list-paddingleft-1" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;outline: 0px;"><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">复合索引，不要跨列或无序使用(最佳左前缀)</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">复合索引，尽量使用全索引匹配，也就是说，你建立几个索引，就使用几个索引</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">② 不要在索引上进行任何操作(计算、函数、类型转换)，否则索引失效</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid&nbsp;=&nbsp;1&nbsp;and&nbsp;typeid&nbsp;=&nbsp;2;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid*2&nbsp;=&nbsp;1&nbsp;and&nbsp;typeid&nbsp;=&nbsp;2&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><p style="outline: 0px;"><img class="rich_pages wxw-img" data-ratio="0.2944038929440389" data-type="png" data-w="822" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRxyhJULGyL9icEPYpDj2X5ibB5DN8txP1etPycmgp9RAibqktn6oWYFRiag/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></p></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">③ 索引不能使用不等于（!= &lt;&gt;）或is null (is not null)，否则自身以及右侧所有全部失效(针对大多数情况)。复合索引中如果有&gt;，则自身和右侧索引全部失效。</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;针对不是复合索引的情况</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid&nbsp;!=&nbsp;1&nbsp;and&nbsp;typeid&nbsp;=2&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid&nbsp;!=&nbsp;1&nbsp;and&nbsp;typeid&nbsp;!=2&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.39740820734341253" data-type="png" data-w="926" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRncelqFlhOpicDb4eH66eMDWefG10uppvyFLxRgQRvyMYomyw9uP69lw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">再观看下面这个案例：</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;删除单独的索引</span><br style="outline: 0px;"  />drop&nbsp;index&nbsp;authorid_index&nbsp;on&nbsp;book;<br style="outline: 0px;"  />drop&nbsp;index&nbsp;typeid_index&nbsp;on&nbsp;book;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;创建一个复合索引</span><br style="outline: 0px;"  />alter&nbsp;table&nbsp;book&nbsp;add&nbsp;index&nbsp;idx_book_at&nbsp;(authorid,typeid);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid&nbsp;&gt;&nbsp;1&nbsp;and&nbsp;typeid&nbsp;=&nbsp;2&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid&nbsp;=&nbsp;1&nbsp;and&nbsp;typeid&nbsp;&gt;&nbsp;2&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.27682403433476394" data-type="png" data-w="932" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRWunbtKgbGm8WzWtLBFibXiba1oTv4TIMlknc2eukpSry3AKHm4cKsWzg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结论：复合索引中如果有【&gt;】，则自身和右侧索引全部失效。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">在看看复合索引中有【&lt;】的情况：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.2926829268292683" data-type="png" data-w="902" style="margin-right: auto;margin-bottom: 8px;margin-left: auto;outline: 0px;font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;cursor: zoom-in;display: block;border-radius: 4px;visibility: visible !important;width: 677px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR1wGicucsic52Xas2MqicfzkRgcE1aKEanzib0SWEJYEkPjXJDqJfR6YxAg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">我们学习索引优化 ，是一个大部分情况适用的结论，但由于SQL优化器等原因 该结论不是100%正确。一般而言， 范围查询（&gt; &lt; in），之后的索引失效。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">④ SQL优化，是一种概率层面的优化。至于是否实际使用了我们的优化，需要通过explain进行推测。</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;删除复合索引</span><br style="outline: 0px;"  />drop&nbsp;index&nbsp;authorid_typeid_bid&nbsp;on&nbsp;book;<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;为authorid和typeid，分别创建索引</span><br style="outline: 0px;"  />create&nbsp;index&nbsp;authorid_index&nbsp;on&nbsp;book(authorid);<br style="outline: 0px;"  />create&nbsp;index&nbsp;typeid_index&nbsp;on&nbsp;book(typeid);<br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid&nbsp;=&nbsp;1&nbsp;and&nbsp;typeid&nbsp;=2&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.14161490683229813" data-type="png" data-w="805" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRkWzzpXibWib9TYPfKyuIyibyRYJft6zYEoN5Ub2KYgPU4vQMF736pPE5A/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结果分析：</strong>&nbsp;我们创建了两个索引，但是实际上只使用了一个索引。因为对于两个单独的索引，程序觉得只用一个索引就够了，不需要使用两个。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">当我们创建一个复合索引，再次执行上面的SQL：</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="padding-right: 10px;padding-left: 10px;outline: 0px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 637px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;查看执行计划</span><br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;book&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;authorid&nbsp;=&nbsp;1&nbsp;and&nbsp;typeid&nbsp;=2&nbsp;;</code></pre></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.08916478555304741" data-type="png" data-w="886" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRmN1iao7TibPqy47TjLmdPcN3icN9vd6V5fLjTIkiciazu7iaUv4wf3hFicT4A/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑤ 索引覆盖，百分之百没问题</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑥ like尽量以“常量”开头，不要以’%'开头，否则索引失效</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;like&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">"%x%"</span>&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher&nbsp;&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;like&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'x%'</span>;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;tname&nbsp;from&nbsp;teacher&nbsp;&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;like&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'%x%'</span>;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.41430192962542567" data-type="png" data-w="881" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRGGNEZDeIID2hh4vyG0fBmria61gxad1EKS9kX7LbZGwDsJr7ONCJK6w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">结论如下：</strong>&nbsp;like尽量不要使用类似"%x%"情况，但是可以使用"x%"情况。如果非使用 "%x%"情况，需要使用索引覆盖。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑦ 尽量不要使用类型转换（显示、隐式），否则索引失效</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;=&nbsp;<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">'abc'</span>&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;=&nbsp;123&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.2997512437810945" data-type="png" data-w="804" style="margin-right: auto;margin-left: auto;outline: 0px;display: block;width: 677px !important;visibility: visible !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWR5icL4gxKcdnjsRhS7o1XiaxnHw1oNvfT3BZN6WtKib2Gia3T8klicowCiaHg/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">⑧ 尽量不要使用or，否则索引失效</strong></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;and&nbsp;tcid&nbsp;&gt;1&nbsp;;<br style="outline: 0px;"  />explain&nbsp;select&nbsp;*&nbsp;from&nbsp;teacher&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;tname&nbsp;=<span style="outline: 0px;color: rgb(152, 195, 121);line-height: 26px;">''</span>&nbsp;or&nbsp;tcid&nbsp;&gt;1&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">结果如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-ratio="0.27303370786516856" data-type="png" data-w="890" style="margin-right: auto;margin-left: auto;outline: 0px;border-radius: 8px;display: block;background-size: 16px !important;width: 657px !important;height: auto !important;" src="https://mmbiz.qpic.cn/mmbiz_png/JNfe5NcuJicsZXiaj3mKR159vg5Ltw2UWRQyd2nmE6WPKdkWFBnoQ729Vbraj5gcRgM3pFIicicv7Rg1SPgSj1zcsg/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">注意：or很猛，会让自身索引和左右两侧的索引都失效。</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">8、一些其他的优化方法</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">1）exists和in的优化</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">如果主查询的数据集大，则使用i关键字，效率高。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">如果子查询的数据集大，则使用exist关键字,效率高。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;">select&nbsp;..from&nbsp;table&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;exist&nbsp;(子查询)&nbsp;;<br style="outline: 0px;"  />select&nbsp;..from&nbsp;table&nbsp;<span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">where</span>&nbsp;字段&nbsp;<span style="outline: 0px;color: rgb(198, 120, 221);line-height: 26px;">in</span>&nbsp;&nbsp;(子查询)&nbsp;;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">2）order by优化</strong></p><ul data-tool="mdnice编辑器" class="list-paddingleft-1" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;outline: 0px;"><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">IO就是访问硬盘文件的次数</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">using filesort 有两种算法：双路排序、单路排序（根据IO的次数）</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">MySQL4.1之前默认使用双路排序；双路：扫描2次磁盘(1：从磁盘读取排序字段,对排序字段进行排序(在buffer中进行的排序)2：扫描其他字段)</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">MySQL4.1之后默认使用单路排序：只读取一次（全部字段），在buffer中进行排序。但种单路排序会有一定的隐患(不一定真的是“单路/1次IO”，有可能多次IO)。原因：如果数据量特别大，则无法将所有字段的数据一次性读取完毕，因此会进行“分片读取、多次读取”。</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">注意：单路排序 比双路排序 会占用更多的buffer。</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">单路排序在使用时，如果数据大，可以考虑调大buffer的容量大小：</section></li></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;outline: 0px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="margin-bottom: -7px;outline: 0px;display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObzsRofRNYRP6hiaVf33JD9BlpOwBZm09ic8NlxbcUDnfSTboP8K18bpiaibibjia2xpouolSjhQPFBpOH74HoqLDHTicYO/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 657px;border-radius: 5px;"></span><code style="padding: 15px 16px 16px;outline: 0px;overflow-x: auto;color: rgb(171, 178, 191);display: -webkit-box;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;background: rgb(40, 44, 52);border-radius: 5px;"><span style="outline: 0px;color: rgb(92, 99, 112);font-style: italic;line-height: 26px;">#&nbsp;不一定真的是“单路/1次IO”，有可能多次IO</span><br style="outline: 0px;"  /><span style="outline: 0px;color: rgb(230, 192, 123);line-height: 26px;">set</span>&nbsp;max_length_for_sort_data&nbsp;=&nbsp;1024&nbsp;<br style="outline: 0px;"  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">如果max_length_for_sort_data值太低，则mysql会自动从 单路-&gt;双路(太低：需要排序的列的总大小超过了max_length_for_sort_data定义的字节数)</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;"><strong style="outline: 0px;">① 提高order by查询的策略：</strong></p><ul data-tool="mdnice编辑器" class="list-paddingleft-1" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;outline: 0px;"><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">选择使用单路、双路 ；调整buffer的容量大小</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">避免使用select * …（select后面写所有字段，也比写*效率高）</section></li><li style="outline: 0px;"><section style="margin-top: 5px;margin-bottom: 5px;outline: 0px;line-height: 26px;color: rgb(1, 1, 1);">复合索引，不要跨列使用 ，避免using filesort保证全部的排序字段，排序的一致性（都是升序或降序）</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;line-height: 26px;">篇幅很长，内容较多，建议收藏。</p></section><blockquote style="outline: 0px;color: var(--weui-FG-1);letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);caret-color: rgb(0, 0, 0);font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><p style="outline: 0px;text-align: right;"><span style="color: rgb(136, 136, 136);font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;outline: 0px;font-size: 12px;">来源：数据分析不是个事儿</span></p></blockquote><section style="margin-right: 16px;margin-bottom: 0px;margin-left: 16px;white-space: normal;outline: 0px;letter-spacing: 0.544px;font-size: 14px;color: rgb(34, 34, 34);font-family: system-ui, -apple-system, BlinkMacSystemFont, Arial, sans-serif;"><br style="outline: 0px;"  /></section><section class="mp_profile_iframe_wrp"><mp-common-profile class="custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、指标体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。关注我，和您一起终身学习。" data-from="0" data-weui-theme="light"></mp-common-profile></section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>