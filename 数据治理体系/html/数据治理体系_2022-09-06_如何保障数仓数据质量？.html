<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"数据治理体系","title":"如何保障数仓数据质量？","time":"2022-09-06 07:23:28","timeStamp":"1662420208"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzA3NjIzNjMwOA==&mid=2247490364&idx=1&sn=b535d24f79d1a3f27442e44716bc44bb&chksm=9f650847a81281516eb3c0c813fced3d5e5ddbcfa4c8ab58b67f29c6556f0100a3fb9ec0a550#rd" target="_blank">如何保障数仓数据质量？</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">数据治理体系&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2022-09-06 07:23:28</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3NjIzNjMwOA==&action=getalbum&album_id=2275731492741890049#wechat_redirect" title="数据治理" target="_blank">#数据治理</a></p></div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="padding: 0 10px;word-break: break-word;word-wrap: break-word;text-align: left;font-size: 15px;color: #3e3e3e;line-height: 1.8;word-spacing: 2px;letter-spacing: 2px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;" data-mpa-powered-by="yiban.io"><section class="mp_profile_iframe_wrp"><mp-common-profile class="js_uneditable custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、数字体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。" data-from="0"></mp-common-profile></section><h2 data-tool="mdnice编辑器" style="padding: 0px;font-weight: bold;color: black;font-size: 22px;display: block;text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3m11nCiaTn1hqptEZRlMnQsoMwacgZmusZQxQfHJibz7jq3c93DAWfhuA/640?wx_fmt=png&quot;);background-position: center center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 50px;margin-top: 1em;margin-bottom: 10px;"><span style="text-align: center;display: inline-block;height: 38px;line-height: 42px;color: #48b378;background-position: left center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 63px;margin-top: 38px;font-size: 18px;margin-bottom: 10px;">导读</span></h2><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;"><span style="color: rgb(178, 178, 178);font-size: 12px;">文｜傅宇康</span></p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">有赞数据报表中心为商家提供了丰富的数据指标，包括30+页面，100+数据报表以及400+不同类型的数据指标，它们帮助商家更合理、科学地运营店铺，同时也直接提供分析决策方法供商家使用。并且，每天在跑的底层任务和涉及的数据表已经达到千级别。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">面对如此庞大的数据体系，作为测试如何制定质量保障策略呢？这篇文章将从：1.有赞数据链路 、2.数据层测试、 3.应用层测试、 4.后续规划这四个方面展开。</p><h2 data-tool="mdnice编辑器" style="padding: 0px;font-weight: bold;color: black;font-size: 22px;display: block;text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3m11nCiaTn1hqptEZRlMnQsoMwacgZmusZQxQfHJibz7jq3c93DAWfhuA/640?wx_fmt=png&quot;);background-position: center center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 50px;margin-top: 1em;margin-bottom: 10px;"><span style="display: none;"></span><span style="text-align: center;display: inline-block;height: 38px;line-height: 42px;color: #48b378;background-position: left center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 63px;margin-top: 38px;font-size: 18px;margin-bottom: 10px;">一、有赞数据链路</span></h2><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">1、数据链路介绍</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">首先介绍有赞的数据总体架构图：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.8101898101898102" data-type="png" data-w="1001" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3Te4QlUiaWNEiby0C9fBSPO291sicSMurTUOWZhN89XbfFqAMF2ndc1Xqw/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">自顶向下可以大致划分为应用服务层、数据网关层、应用存储层、数据仓库，并且作业开发、元数据管理等平台为数据计算、任务调度以及数据查询提供了基础能力。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">以上对整体架构做了初步的介绍，对于质量把控来说，最核心的两个部分是：<strong style="font-weight: bold;font-size: 15px;color: rgb(255, 127, 36);">数据仓库以及数据应用部分</strong>。因为这两部分属于数据链路中的核心环节，相对于其他层级而言，日常改动也更为频繁，出现问题的风险也比较大。</p><h2 data-tool="mdnice编辑器" style="padding: 0px;font-weight: bold;color: black;font-size: 22px;display: block;text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3m11nCiaTn1hqptEZRlMnQsoMwacgZmusZQxQfHJibz7jq3c93DAWfhuA/640?wx_fmt=png&quot;);background-position: center center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 50px;margin-top: 1em;margin-bottom: 10px;"><span style="display: none;"></span><span style="text-align: center;display: inline-block;height: 38px;line-height: 42px;color: #48b378;background-position: left center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 63px;margin-top: 38px;font-size: 18px;margin-bottom: 10px;">二、数据层测试</span></h2><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">1、整体概览</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">首先，针对数据层的质量保障，可以分成三个方面：数据及时性、完整性、准确性。<br  /><img class="rich_pages wxw-img" data-ratio="0.47128712871287126" data-type="png" data-w="1010" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3B0ubwxyuJTOLuuWtNC9kjWLCgzhKnXbo47HGg2GWhicLpwnvr23Yq9w/640?wx_fmt=png"  /></p><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">2、 数据及时性</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">数据及时性，顾名思义就是测试数据需要按时产出。及时性重点关注的三个要素是：<strong style="font-weight: bold;font-size: 15px;color: rgb(255, 127, 36);">定时调度时间、优先级以及数据deadline</strong>。其中任务的优先级决定了它获取数据计算资源的多少，影响了任务执行时长。数据deadline则是数据最晚产出时间的统一标准，需要严格遵守。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">这三要素中，属于“<em style="font-style: normal;color: #3976f2;">普世规则</em>”且在质量保障阶段需要重点关注的是：数据deadline。那么我们基于数据deadline，针对及时性的保障策略就可分为两种：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">监控离线数据任务是否执行结束。这种方式依赖于有赞作业开发平台的监控告警，若数据任务在deadline时间点未执行完成，则会有邮件、企微、电话等告警形式，通知到相应人员。</section></li></ul><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.25555555555555554" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3sp8d3US0g1HN77EicniawBDTaEBFQ3lngUC4gWyxgyPTEYvyLAQ8D4ng/640?wx_fmt=png"  /></figure><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">检查全表条数或者检查分区条数。这种方式依赖接口自动化平台，通过调用dubbo接口，判断接口返回的数据指标是否为0，监控数据是否产出。</section></li></ul><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5055555555555555" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3tH4brA9cqPuQPkPnyickusKC2KWAAnJeTlzHpuT2p5g7icZC0qnrZvcA/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">其次我们可以关注失败、重试次数，当任务执行过程中出现多次失败、重试的异常情况，可以抛出告警让相关人员感知。这部分的告警是对deadline告警的补充，目前在有赞作业开发平台上也有功能集成。</p><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">3、数据完整性</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">数据完整性，顾名思义看数据是不是全，重点评估两点：数据不多、数据不少。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">数据不多：一般是检查全表数据、重要枚举值，看数据有没有多余、重复或者数据主键是否唯一。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">数据不少：一般是检查全表数据、重要字段（比如主键字段、枚举值、日期等），看字段的数值是否为空、为null等。</p></section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">可见数据完整性和业务本身关联度没有那么密切，更多的是数仓表的通用内容校验。所以从一些基础维度，我们可以将测试重点拆成表级别、字段级别两个方向。</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="1.113314447592068" data-type="png" data-w="353" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3hjnNNTLXL6fVFYYRosdu7vo9fN9Im5eHdRwvLkC5rAZXG5iaY9lnibpw/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">表级别完整性：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">全表维度，通过查看全表的总行数/表大小，若出现表总行数/总大小不变或下降，说明表数据可能出现了问题。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">分区维度，通过查看当日分区表的数据行数/大小，若和之前分区相比差异太大（偏大或偏小），说明表数据可能出现了问题。</p></section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">目前有赞元数据管理平台已集成相关数据视图：</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4148148148148148" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3l0xiasRvzR8oUWd5P5l6aKULWOJB7f3PQiau8EfwS0alGmeTQPuYnf4w/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">字段级别完整性：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">唯一性判断：保证主键或某些字段的唯一性，防止数据重复导致和其他表join之后数据翻倍，导致最终统计数据偏大。</section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">比如判断ods层订单表中的订单号是否唯一，编写sql：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/icXtjp9jsR5Tibdt5Ir9sP6FmB0dLsNbXicMO1v9O0bTzXuvPK2MgvblqrwJ4rSUpAbQfsMB6XVZkficSod1Je6nAAsZiaLQfRcZR/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(30, 30, 30);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #1E1E1E;border-radius: 5px;"><span style="color: #569CD6;line-height: 26px;">select</span>&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">count</span>(order_no)<br  />,<span style="color: #569CD6;line-height: 26px;">count</span>(<span style="color: #569CD6;line-height: 26px;">distinct</span>&nbsp;order_no)&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">from</span>&nbsp;ods.xx_order<br  /></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">若两者相等，则说明order_no值是表内唯一的；否则说明order_no表内不唯一，表数据存在问题。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">非空判断：保证重要字段非空，防止空数据造成和表join之后数据丢失，导致最终统计数据偏少。</section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">比如判断ods层订单表中的订单号是否出现null，编写sql：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/icXtjp9jsR5Tibdt5Ir9sP6FmB0dLsNbXicMO1v9O0bTzXuvPK2MgvblqrwJ4rSUpAbQfsMB6XVZkficSod1Je6nAAsZiaLQfRcZR/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(30, 30, 30);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #1E1E1E;border-radius: 5px;"><span style="color: #569CD6;line-height: 26px;">select</span>&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">count</span>(*)&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">from</span>&nbsp;ods.xx_order&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">where</span>&nbsp;order_no&nbsp;<span style="color: #569CD6;line-height: 26px;">is</span>&nbsp;<span style="color: #569CD6;line-height: 26px;">null</span><br  /></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">若结果等于0，则说明order_no不存在null；若结果大于0，则说明order_no存在null值，表数据存在问题。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">枚举类型判断：保证枚举字段值都在预期范围之内，防止业务脏数据，导致最终统计结果出现遗漏/多余的数据类型。</section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">比如判断ods层订单表中的shop_type字段中所有枚举值是否符合预期，编写sql：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/icXtjp9jsR5Tibdt5Ir9sP6FmB0dLsNbXicMO1v9O0bTzXuvPK2MgvblqrwJ4rSUpAbQfsMB6XVZkficSod1Je6nAAsZiaLQfRcZR/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(30, 30, 30);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #1E1E1E;border-radius: 5px;"><span style="color: #569CD6;line-height: 26px;">select</span>&nbsp;shop_type&nbsp;<span style="color: #569CD6;line-height: 26px;">from</span>&nbsp;ods.xx_order&nbsp;<span style="color: #569CD6;line-height: 26px;">group</span>&nbsp;<span style="color: #569CD6;line-height: 26px;">by</span>&nbsp;shop_type<br  /></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">分析查询结果是否满足预期，确保不会出现遗漏/多余的枚举类型。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">数据有效性判断：判断数据格式是否满足预期，防止字段的数据格式不正确导致数据统计的错误以及缺失。常见的有日期格式<code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: #28ca71;">yyyymmdd</code>。</section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">一旦出现数据完整性问题，对数据质量的影响很大。所以完整性策略更适用于ods层，因为我们更期望从源头发现并解决数据不合理问题，及时止损，避免脏数据进入下游之后，数据污染扩大。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">另外，我们看到完整性校验内容逻辑简单，且比较固定，稍微进行简单的抽象就能将其模板化。那么作为测试，我们更倾向于将数据完整性校验做成工具。目前有赞“数据形态工具”已经落地，下面给出我的一些思路：</p><ol data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: decimal;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">针对所有表来说，普世性的规则，比如表主键的唯一性。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">针对不同类型比如数值、String、枚举、日期格式类型，列举出常见的数据判断规则。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">给每项规则进行等级划分，比如表的主键不唯一，记为critical。String类型字段的空值比例大于70%，记为warning。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">根据表数据是否满足上述这些规则，最终落地一份可视化报告，测试人员可根据报告内容评估数据质量。</p></section></li></ol><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.8055555555555556" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3PpBhabBcofpcQib7BZickUnp11nagrgFhoKfS6x2zrZ0y2VrozkoO9YA/640?wx_fmt=png"  /></figure><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">4、数据准确性</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">数据准确性，顾名思义数据要“准确”。“准确”这个概念比较抽象，因为我们很难通过一个强逻辑性的判断，来说明数据有多准，大部分都存在于感性的认知中。所以准确性测试也是在数据质量保障过程中思维相对发散的一个方向。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">经过总结，我们可以从字段自身检查、数据横向对比、纵向对比、code review等方面，去把控数据的准确性，这些测试点和业务的关联也比较密切。</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="1.113314447592068" data-type="png" data-w="353" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3ibhfvH8pJyP3YyCttlUgtcMiaoXgjnxEPDibpKdpSn4phnv5kjdIcOZUA/640?wx_fmt=png"  /></figure><h4 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;margin-top: 30px;"><span style="display: none;"></span>4.1 自身检查<span style="display: none;"></span></h4><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">数据自身检查，是指在不和其他数据比较的前提下，用自身数据来检查准确的情况，属于最基本的一种检查。常见的自身检查包括：检查数值类指标大于0、比值类指标介于0-1范围。这类基础规则，同数据完整性，也可以结合“数据形态工具”辅助测试。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">举个例子，比如针对订单表，支付金额必然是大于等于0，不会出现负数的情况，编写sql：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/icXtjp9jsR5Tibdt5Ir9sP6FmB0dLsNbXicMO1v9O0bTzXuvPK2MgvblqrwJ4rSUpAbQfsMB6XVZkficSod1Je6nAAsZiaLQfRcZR/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(30, 30, 30);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #1E1E1E;border-radius: 5px;"><span style="color: #569CD6;line-height: 26px;">select</span>&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">count</span>(pay_price)&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">from</span>&nbsp;<br  />dw.dws_xx_order&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">where</span>&nbsp;par&nbsp;=&nbsp;<span style="color: #B8D7A3;line-height: 26px;">20211025</span>&nbsp;<span style="color: #569CD6;line-height: 26px;">and</span>&nbsp;pay_price&lt;<span style="color: #B8D7A3;line-height: 26px;">0</span><br  /></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">若结果为0，说明支付金额都是大于0，满足预期；否则若count结果大于0，说明数据存在问题。</p><h4 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;margin-top: 30px;"><span style="display: none;"></span>4.2 表内横向数据对比<span style="display: none;"></span></h4><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">表内横向对比可以理解为同一张表内，业务上相关联的两个或多个字段，他们存在一定的逻辑性关系，那么就可以用来做数据对比。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">比如针对订单表，根据实际业务分析易得：针对任何一家店铺的任意一款商品，都满足订单数 &gt;=下单人数，编写sql：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/icXtjp9jsR5Tibdt5Ir9sP6FmB0dLsNbXicMO1v9O0bTzXuvPK2MgvblqrwJ4rSUpAbQfsMB6XVZkficSod1Je6nAAsZiaLQfRcZR/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(30, 30, 30);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #DCDCDC;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #1E1E1E;border-radius: 5px;"><span style="color: #569CD6;line-height: 26px;">select</span>&nbsp;<br  />kdt_id<br  />,goods_id<br  />,<span style="color: #569CD6;line-height: 26px;">count</span>(order_no)<br  />,<span style="color: #569CD6;line-height: 26px;">count</span>(<span style="color: #569CD6;line-height: 26px;">distinct</span>&nbsp;buyer_id)&nbsp;<br  /><span style="color: #569CD6;line-height: 26px;">from</span>&nbsp;dw.dws_xx_order<br  /><span style="color: #569CD6;line-height: 26px;">where</span>&nbsp;par&nbsp;=&nbsp;<span style="color: #D69D85;line-height: 26px;">'20211025'</span><br  /><span style="color: #569CD6;line-height: 26px;">group</span>&nbsp;<span style="color: #569CD6;line-height: 26px;">by</span>&nbsp;kdt_id,goods_id<br  /><span style="color: #569CD6;line-height: 26px;">having</span>&nbsp;<span style="color: #569CD6;line-height: 26px;">count</span>(order_no)&lt;<span style="color: #569CD6;line-height: 26px;">count</span>(<span style="color: #569CD6;line-height: 26px;">distinct</span>&nbsp;buyer_id)<br  /></code></pre><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">若查询结果不存在记录，则说明不存在 订单数&lt;下单人数，反向说明订单数&gt;=下单人数，则符合预期；否则若查询结果的记录大于0，则不符合预期。</p><h4 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;margin-top: 30px;"><span style="display: none;"></span>4.3 表间横向数据对比<span style="display: none;"></span></h4><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">表间横向对比可以理解为两张表或多张表之间，其中具有业务关联或者业务含义一致的字段，可以用来做数据对比：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">同类型表之间对比：针对hive里的支付表A和支付表B，里面都有支付金额字段，那么同样维度下的 表A.支付金额 = 表B.支付金额。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">多套存储之间对比：比如有赞数据报表中心针对支付表，应用层存储分别用到了mysql和kylin，用作主备切换，那么相同维度下的kylin-表A.支付金额 = mysql-表B.支付金额。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">多个系统之间对比：跨系统之间，比如有赞的数据报表中心和crm系统，两个系统都有客户指标数据，那么相同维度下的数据报表中心-表A.客户指标 = crm-表B.客户指标。</p></section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">我们深度剖析数据横向对比的底层逻辑，本质就是两张表的不同字段，进行逻辑运算符的比较，也比较容易抽象成工具。目前有赞“数据比对工具”已经落地，下面给出我的一些思路：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">输入两张表，分别设置两表的主键。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">输入两张表中需要对比的字段，且设置对比的运算符，比如&gt;、=、&lt;。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">根据设置的规则，最终数据对比通过、不通过的记录，落地一份可视化报告，测试人员可根据报告内容评估数据质量。</p></section></li></ul><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.21203703703703702" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3yoWk93wibtoMmzibUyuaXIoV8jqQfVYK0pTLyEDuOUNvCCe47BlRrrAg/640?wx_fmt=png"  /></figure><h4 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;margin-top: 30px;"><span style="display: none;"></span>4.4 纵向数据对比<span style="display: none;"></span></h4><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">纵向对比就是上下游的数据比较，目的是确保重要字段在上下游的加工过程中没有出现问题。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">比如数仓dw层存在订单的明细表，数据产品dm层存在订单数的聚合表，那么二者在相同维度下的数据统计结果，应该保持一致。</p><h4 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;margin-top: 30px;"><span style="display: none;"></span>4.5 code review<span style="display: none;"></span></h4><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">首先，在进行code review之前的需求评审阶段，我们先要明确数据统计的详细口径是什么，下面举两个实际的需求例子。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">需求1：（错误示例）统计时间内店铺内所有用户的支付金额。问题所在：需求描述太过于简洁，没有阐述清楚数据统计的时间维度以及过滤条件，导致统计口径不清晰，要求产品明确口径。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">需求2：（正确示例）有赞全网商家域店铺维度的离线支付金额。支持自然日、自然周、自然月。统计时间内，所有付款订单金额之和（剔除抽奖拼团、剔除礼品卡、剔除分销供货订单）。</p></section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">明确需求之后，下面详细介绍code review的一些常见关注点：</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;"><strong style="font-weight: bold;font-size: 15px;color: rgb(255, 127, 36);">1）关联关系 &amp; 过滤条件</strong></p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">关联表使用 outer join 还是 join，要看数据是否需要做过滤。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">关联关系 on 字句中，左右值类型是否一致。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">关联关系如果是1：1，那么两张表的关联键是否唯一。如果不唯一，那么关联会产生笛卡尔导致数据膨胀。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">where 条件是否正确过滤，以上述需求为例子，关注sql中是否正确剔除抽奖拼团、礼品卡和分销供货订单。</p></section></li></ul><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g38cicKXGoDxWS6Yibm4vkIeSOabmjCZT395FYng1En3hFp6ZnfZr5r8eg/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;"><strong style="font-weight: bold;font-size: 15px;color: rgb(255, 127, 36);">2）指标的统计口径处理</strong></p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">数据指标的统计涉及到两个基本概念：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">可累加指标：比如支付金额，浏览量等，可以通过简单数值相加来进行统计的指标，针对这类指标，sql中使用的函数一般是sum。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">不可累加指标：比如访客数，不能通过简单相加，而是需要先去重再求和的方式进行统计，针对这类指标，sql中一般使用count(distinct )。</p></section></li></ul><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5314814814814814" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3dJRfBuaClV7IpUXIshyiaIpy1ETBTJe5smafppicHXicicTZokcJmmRhAQ/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;"><strong style="font-weight: bold;font-size: 15px;color: rgb(255, 127, 36);">3）insert插入数据</strong></p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">是否支持重跑。等价于看插入时是否有overwrite关键字，如果没有该关键字，重跑数据（多次执行该工作流）时不会覆盖脏数据，而是增量往表插入数据，进而可能会导致最终数据统计翻倍。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">插入的数据顺序和被插入表结构顺序是否完全一致。我们要保证数据字段写入顺序没有出错，否则会导致插入值错乱。</p></section></li></ul><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.33611111111111114" data-type="png" data-w="1080" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3IppIRFMkqRXnYcuibibGhha2swyhmOicfY0BZpSxCd8PgZUdmibYsnbqWw/640?wx_fmt=png"  /></figure><h2 data-tool="mdnice编辑器" style="padding: 0px;font-weight: bold;color: black;font-size: 22px;display: block;text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3m11nCiaTn1hqptEZRlMnQsoMwacgZmusZQxQfHJibz7jq3c93DAWfhuA/640?wx_fmt=png&quot;);background-position: center center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 50px;margin-top: 1em;margin-bottom: 10px;"><span style="display: none;"></span><span style="text-align: center;display: inline-block;height: 38px;line-height: 42px;color: #48b378;background-position: left center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 63px;margin-top: 38px;font-size: 18px;margin-bottom: 10px;">三、应用层测试</span></h2><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">1、整体概览</span><span style="display: none;"></span></h3><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4725897920604915" data-type="png" data-w="529" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g37VSXib4xicykXPoCG4Hhxx5rjhlKFial8C5v3TxCeRtJOusMiadb1pwgQQ/640?wx_fmt=png"  /></figure><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">基本的前端页面 + 服务端接口测试，和一般业务测试关注点是一致的，不再赘述。本篇重点展开“数据应用“测试需要额外关注的地方。</p><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">2、 降级策略</span><span style="display: none;"></span></h3><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">在页面新增数据表的时候，需求、技术评审阶段确认是否需要支持“蓝条”的功能，属于“测试左移”。</section></li></ul><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">蓝条介绍：有赞告知商家离线数据尚未产出的页面顶部蓝条，其中的“产出时间” = 当前访问时间 +2小时，动态计算得到。</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6575757575757576" data-type="png" data-w="660" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3E5d90TDyCza81MfusuDSb8LCia8Q3M1OSoK3tQ5yIa4RVUp5BjeunvQ/640?wx_fmt=png"  /></figure><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-type="png" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" data-ratio="0.287962962962963" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3scatjkKSJ3EPANn6QfWOXkNruZsictbAwqlwLxQrVB6JHCpeqQpuSGA/640?wx_fmt=png"  /></figure><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">测试比率类指标时，关注被除数 = 0 的特殊场景。在后端code review、测试页面功能阶段，关注该点。目前有赞针对这种情况，前端统一展示的是“-”。</section></li></ul><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.7917888563049853" data-type="png" data-w="682" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3HJnUcsuY0LyXlatXMkPoETbdmxian6XnSyk0dKmLokO6YG4FEmbX2Ww/640?wx_fmt=png"  /></figure><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">3、 主备策略</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">遇到有主备切换策略时，测试过程中注意数据正常双写，且通过配置，取数时能在主备数据源之间切换。</p><figure data-tool="mdnice编辑器" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.8105590062111802" data-type="png" data-w="644" style="display: block;margin: 0px auto 10px;max-width: 100%;height: auto !important;" src="https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3sUPt3I6qXqPDRwgDiaGhK17xMbFLlVauGYDCQbRjHs6nutccwzSyaSw/640?wx_fmt=png"  /></figure><h3 data-tool="mdnice编辑器" style="margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 20px;margin-top: 1.2em;"><span style="background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g31QGibYO4k4NRG23SyibJBx0yuBzcRySkj79GtWEX5bIa1521QiblbUkMg/640?wx_fmt=png&quot;);background-size: 100% 100%;background-repeat: no-repeat;display: inline-block;width: 16px;height: 15px;line-height: 15px;margin-bottom: -1px;"></span><span style="display: none;"></span><span style="font-size: 17px;font-weight: bold;display: inline-block;margin-left: 8px;color: #48b378;">4、 数据安全</span><span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">关注数据查询的权限管控，重点测试横向越权、纵向越权的场景。</p><h2 data-tool="mdnice编辑器" style="padding: 0px;font-weight: bold;color: black;font-size: 22px;display: block;text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/ZubDbBye0zHNf5g1pAK3yOXZ6hpMe3g3m11nCiaTn1hqptEZRlMnQsoMwacgZmusZQxQfHJibz7jq3c93DAWfhuA/640?wx_fmt=png&quot;);background-position: center center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 50px;margin-top: 1em;margin-bottom: 10px;"><span style="display: none;"></span><span style="text-align: center;display: inline-block;height: 38px;line-height: 42px;color: #48b378;background-position: left center;background-repeat: no-repeat;background-attachment: initial;background-origin: initial;background-clip: initial;background-size: 63px;margin-top: 38px;font-size: 18px;margin-bottom: 10px;">四、后续规划</span></h2><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">目前在实际项目的数据准确性对比中，数据对比工具因为暂不支持sql函数，所以只能代替50%的手工测试，一些复杂的横向和纵向数据对比还是需要编写sql。后续计划支持sum、count、max、min等sql函数，把工具覆盖范围提升到75%以上，大大降低数据对比的成本。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">目前“数据形态报告”、“数据对比工具”更多的运用项目测试当中，后续计划将形态检查和数据对比做成线上巡检，将自动化和数据工具相结合，持续保障数仓表的质量。</p><p data-tool="mdnice编辑器" style="font-size: 16px;padding-bottom: 8px;margin: 0;padding-top: 1em;color: rgb(74,74,74);line-height: 1.75em;">目前针对sql code review的方式主要靠人工，我们计划把一些基础的sql检查，比如insert into检查，join on条件的唯一性检查、字段插入顺序检查等作成sql静态扫描，整合到大数据测试服务中，并且赋能给其他业务线。</p></section><p style="white-space: normal;text-align: center;"><span style="font-size: 12px;"><strong><span style="font-size: 12px;color: rgb(74, 74, 74);font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 2px;text-align: left;word-spacing: 2px;background-color: rgb(255, 255, 255);">--END--</span></strong></span></p><section class="mp_profile_iframe_wrp"><mp-common-profile class="js_uneditable custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzA3NjIzNjMwOA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/hXibVSNciaXhzia07WkYkDfaRxHUiaDaNc5x3xTNO1RlNBRhPnxpEzoemhsn7ofat4pVwVgOktaveEtu6IKzzLONQQ/0?wx_fmt=png" data-nickname="数据治理体系" data-alias="DGsystem" data-signature="持续完善数据治理实战体系，数据仓库、标签、数字体系，实现业务数字化，数字资产化，资产业务化，资产资本化；回归业务场景的数字化案例才最具参考价值，最容易理解和借鉴的。" data-from="0"></mp-common-profile>&nbsp; &nbsp; &nbsp;&nbsp;</section><div class="msg_source_url"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3NjIzNjMwOA==&action=getalbum&album_id=2275731492741890049#wechat_redirect" target="_blank">阅读原文</a></div></content><div class="msg_source_url"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3NjIzNjMwOA==&action=getalbum&album_id=2275731492741890049#wechat_redirect" target="_blank">阅读原文</a></div>
</div>
</body>
</html>