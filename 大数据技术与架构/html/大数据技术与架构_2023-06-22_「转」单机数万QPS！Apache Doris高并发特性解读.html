<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"单机数万QPS！Apache Doris高并发特性解读","time":"2023-06-22 11:46:02","timeStamp":"1687405562"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247519329&idx=1&sn=182c1cd80d50d5012bc21711a6fdb797&chksm=fd3ecaf4ca4943e2c881330bf492a2fce8c12a74c2916b89026c132ef3e377568d23610b947b#rd" target="_blank">单机数万QPS！Apache Doris高并发特性解读</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">李航宇&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-06-22 11:46:02</em></div><content><div class="reprint"><p>转自公众号：SelectDB<br><a href="http://mp.weixin.qq.com/s?__biz=Mzg3Njc2NDAwOA==&mid=2247516978&idx=1&sn=eb3f1f74eedd2306ca0180b8076fe773" target="_blank" title="阅读原文">http://mp.weixin.qq.com/s?__biz=Mzg3Njc2NDAwOA==&mid=2247516978&idx=1&sn=eb3f1f74eedd2306ca0180b8076fe773</a></p></div><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;outline: 0px;color: rgb(34, 34, 34);font-size: 14.875px;text-size-adjust: auto;letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 23.625px;visibility: visible;" data-mpa-powered-by="yiban.io"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-role="outer" label="Powered by 135editor.com" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tools="135编辑器" data-id="98469" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 21.875px;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><blockquote data-tool="mdnice编辑器" mp-original-font-size="14.399999618530273" mp-original-line-height="23" style="margin: 20px 0px;padding: 10px 10px 10px 20px;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);line-height: 20.125px;font-size: 12.6px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;border-top-style: none;border-right-style: none;border-bottom-style: none;overflow: auto;background-color: rgb(255, 249, 249);visibility: visible;"><p mp-original-font-size="16" mp-original-line-height="26" style="margin: 0px;padding: 8px 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 22.75px;visibility: visible;"><span mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;color: rgb(89, 89, 89);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0.544px;text-align: left;font-size: 12.25px;visibility: visible;line-height: 22.75px;"><strong mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;visibility: visible;font-size: 12.25px;line-height: 22.75px;"><img class="rich_pages wxw-img" data-ratio="1" data-type="png" data-w="64" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/1_6VyhjNCMic3DGmPLZocTtEmtWBJKsQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2OP8CL6Mmrc9shxR4OiamrPMlRCKiaicf2n4JLNDRcyH1jfEKxo6VyhjNCMic3DGmPLZocTtEmtWBJKsQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" style="margin: 0px;padding: 0px;max-width: 100%;height: auto !important;overflow-wrap: break-word !important;vertical-align: text-bottom;outline: 0px;display: inline-block;font-size: 10.7188px;line-height: 19.9062px;box-sizing: border-box !important;visibility: visible !important;width: 20px !important;"  /><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247518343&amp;idx=1&amp;sn=eaf44bee8c4d90aedd508201475b57a9&amp;chksm=fd3ece12ca494704cdf02300bbfe39c1d4245ac30f41aba3065efe66eb9aa453a23e0b6dae6e&amp;scene=21#wechat_redirect" textvalue="300万字！全网最全大数据学‍习面试社区等你来！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-size: 14px;color: rgb(255, 41, 65);">300万字！全网最全大数据学习面试社区等你来！</span></strong></a></strong></span></p></blockquote></section></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25.14285659790039" style="margin: 0px 0px 24px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0px;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;outline: 0px;text-size-adjust: auto;font-size: 14px;color: black;line-height: 22px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.1572093023255814" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/2_AFSZz5rbzpfebZjT6sNdO7iasP5icA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uecg6b8kbSZZ9RbyicnDZg4k8tN01YPibkjm5mFNaLnuMpZRic7MLScfTm2NsAFSZz5rbzpfebZjT6sNdO7iasP5icA/640?wx_fmt=gif'" data-type="gif" data-w="1075" style="text-align: center;color: rgba(0, 0, 0, 0.9);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;letter-spacing: 0.034em;"  /><br  /></section><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.4255555555555556" data-s="300,640" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/3_Eofov29rF3r3vy1BVVm93IfYzRMlFg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uecg6b8kbSZFicibf1II7C2JuTOTjy2mQM2L1RjKBib02ArQLaA3AR8ic5MJEofov29rF3r3vy1BVVm93IfYzRMlFg/640?wx_fmt=png'" data-type="png" data-w="900" style=""  /></p><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">随着用户规模的极速扩张，越来越多用户将 Apache Doris 用于构建企业内部的统一分析平台，这一方面需要 Apache Doris 去承担更大业务规模的处理和分析——既包含了更大规模的数据量、也包含了更高的并发承载，而另一方面，也意味着需要应对企业更加多样化的数据分析诉求，从过去的统计报表、即席查询、交互式分析等典型 OLAP 场景，拓展到推荐、风控、标签画像以及 IoT 等更多业务场景中，而数据服务（Data Serving）就是其中具有代表性的一类需求。</span></section><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">Data Serving 通常指的是向用户或企业客户提供数据访问服务，</span><span style="font-size: 14px;letter-spacing: 0.5px;text-indent: 0em;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">用户使用较为频繁的查询模式一般是按照 Key 查询一行或多行数据</span><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">，例如：</span></section><ul class="list-paddingleft-1" style="list-style-type: square;"><li><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">订单详情查询</span></section></li><li><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">商品详情查询</span></section></li><li><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">物流状态查询</span></section></li><li><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">交易详情查询</span></section></li><li><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">用户信息查询</span></section></li><li><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">用户画像属性查询</span></section></li><li><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;"> ...</span></section></li></ul><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 24px;"><span style="font-size: 14px;letter-spacing: 0.5px;">与面向大规模数据扫描与计算的 Adhoc 不同，</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>Data Serving 在实际业务中通常呈现为高并发的点查询——</strong><strong>查询返回的数据量较少、通常只需返回一行或者少量行数据，但对于查询耗时极为敏感、期望在毫秒内返回查询结果，并且面临着超高并发的挑战。</strong></span></p><section style="margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">在过去面对此类业务需求时，通常采取不同的系统组件分别承载对应的查询访问。OLAP 数据库一般是基于列式存储引擎构建，且是针对大数据场景设计的查询框架，通常以数据吞吐量来衡量系统能力，因此在 Data Serving 高并发点查场景的表现往往不及用户预期。基于此，用户一般引入 Apache HBase 等 KV 系统来应对点查询、Redis 作为缓存层来分担高并发带来的系统压力。而这样的架构往往比较复杂，存在冗余存储、维护成本高的问题。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;"></span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">融合统一的分析范式为 Apache Doris 能承载的工作负载带来了挑战，也让我们更加系统化地去思考如何更好地满足用户在此类场景的业务需求。基于以上思考，</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>在即将发布的 2.0 版本中，我们在原有功能基础上引入了一系列面向点查询的优化手段，单节点可达数万 QPS 的超高并发，极大拓宽了适用场景的能力边界。</strong></span></section><h1 style="line-height: 1.75em;margin-top: 48px;margin-bottom: 32px;"><span style="color: rgb(0, 83, 205);font-size: 24px;"><strong><span style="color: rgb(0, 83, 205);letter-spacing: 0.5px;">#&nbsp; 如何应对高并发查询？</span></strong></span></h1><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">一直以来高并发就是 Apache Doris 的优势之一。对于高并发查询，其核心在于如何平衡有限的系统资源消耗与并发执行带来的高负载。换而言之，需要最大化降低单个 SQL 执行时的 CPU、内存和 IO 开销，其关键在于减少底层数据的 Scan 以及随后的数据计算，其主要优化方式有如下几种：</span></section><h3 style="text-indent: 0em;white-space: pre-wrap;line-height: 1.75em;margin-bottom: 24px;margin-top: 32px;"><span style="font-size: 18px;"><span style="text-indent: 0em;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="letter-spacing: 0.5px;text-indent: 0em;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">&nbsp; </span></span><span style="text-indent: 0em;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 19px;"><strong style="color: rgb(0, 83, 205);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15px;letter-spacing: 0.5px;text-align: left;text-indent: 0em;caret-color: rgb(51, 51, 51);">分区分桶裁剪</strong></span></h3><h3 style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Apache Doris 采用两级分区，第一级是 Partition，通常可以将时间作为分区键。第二级为 Bucket，通过 Hash 将数据打散至各个节点中，以此提升读取并行度并进一步提高读取吞吐。通过合理地划分区分桶，可以提高查询性能，以下列查询语句为例：</span><br  /></h3><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #c678dd;line-height: 26px;">select</span>&nbsp;*&nbsp;<span style="color: #c678dd;line-height: 26px;">from</span>&nbsp;user_table&nbsp;<span style="color: #c678dd;line-height: 26px;">where</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">id</span>&nbsp;=&nbsp;<span style="color: #d19a66;line-height: 26px;">5122</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">and</span>&nbsp;create_date&nbsp;=&nbsp;<span style="white-space:pre-wrap;color: rgb(209, 154, 102);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;font-size: 12px;text-align: left;background-color: rgb(40, 44, 52);">'</span><span style="color: #d19a66;line-height: 26px;">2022-01-01'</span><br  /></code></pre></section><p><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">用户以</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">create_time</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">作为分区键、ID 作为分桶键，并设置了 10 个 Bucket， 经过分区分桶裁剪后可快速过滤非必要的分区数据，最终只需读取极少数据，比如 1 个分区的 1 个 Bucket 即可快速定位到查询结果，最大限度减少了数据的扫描量、降低了单个查询的延时。</span></p><h3 style="margin-top: 32px;text-indent: 0em;white-space: pre-wrap;line-height: 1.75em;margin-bottom: 24px;"><span style="font-size: 18px;"><span style="text-indent: 0em;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="letter-spacing: 0.5px;text-indent: 0em;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">&nbsp; </span></span><span style="text-indent: 0em;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 19px;"><strong style="color: rgb(0, 83, 205);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15px;letter-spacing: 0.5px;text-align: left;text-indent: 0em;caret-color: rgb(51, 51, 51);">索引</strong></span></h3><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">除了分区分桶裁剪， Doris 还提供了丰富的索引结构来加速数据的读取和过滤。索引的类型大体可以分为智能索引和二级索引两种，其中智能索引是在 Doris 数据写入时自动生成的，无需用户干预。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">智能索引包括前缀索引和 ZoneMap 索引两类：</span></section><ul class="list-paddingleft-1" style="list-style-type: square;"><li><p style="text-align: justify;margin: 0px 0px 24px;text-indent: 0em;line-height: 1.75em;"><span style="color: rgb(0, 83, 205);"><strong><span style="font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">前缀稀疏索引（Sorted Index）</span></strong></span><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">是建立在排序结构上的一种索引。Doris 存储在文件中的数据，是按照排序列有序存储的，Doris 会在排序数据上每 1024 行创建一个稀疏索引项。索引的 Key 即当前这 1024 行中第一行的前缀排序列的值，当用户的查询条件包含这些排序列时，可以通过前缀稀疏索引快速定位到起始行。</span></p></li><li><p style="text-align: justify;margin: 0px 0px 24px;text-indent: 0em;line-height: 1.75em;"><span style="color: rgb(0, 83, 205);"><strong><span style="font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">ZoneMap 索引</span></strong></span><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">是建立在 Segment 和 Page 级别的索引。对于 Page 中的每一列，都会记录在这个 Page 中的最大值和最小值，同样，在 Segment 级别也会对每一列的最大值和最小值进行记录。这样当进行等值或范围查询时，可以通过 MinMax 索引快速过滤掉不需要读取的行。</span></p></li></ul><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 24px;"><span style="font-size: 14px;letter-spacing: 0.5px;">二级索引是需要用手动创建的索引，包括 Bloom Filter 索引、Bitmap 索引，以及 2.0 版本新增的 Inverted 倒排索引和 NGram Bloom Filter 索引，在此不细述，可从官网文档先行了解，后续将有系列文章进行解读。</span></p><p style="margin-top: 0px;line-height: 1.75em;margin-bottom: 16px;"><strong><span style="font-size: 14px;letter-spacing: 0.5px;">官网文档：</span></strong></p><ul class="list-paddingleft-1" style="list-style-type: square;"><li><p style="margin-top: 0px;line-height: 1.75em;margin-bottom: 8px;text-align: left;"><span style="font-size: 14px;letter-spacing: 0.5px;">倒排索引：</span><span style="font-size: 14px;letter-spacing: 0.5px;text-decoration: underline;color: rgb(136, 136, 136);">https://doris.apache.org/zh-CN/docs/dev/data-table/index/inverted-index</span></p></li><li><p style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;text-align: left;"><span style="font-size: 14px;letter-spacing: 0.5px;">NGram BloomFilter 索引：</span><span style="font-size: 14px;letter-spacing: 0.5px;text-decoration: underline;color: rgb(136, 136, 136);">https://doris.apache.org/zh-CN/docs/dev/data-table/index/ngram-bloomfilter-index</span></p></li></ul><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 32px;"><span style="font-size: 14px;letter-spacing: 0.5px;">我们以下列查询语句为例：</span></p><pre><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #c678dd;line-height: 26px;">select</span>&nbsp;*&nbsp;<span style="color: #c678dd;line-height: 26px;">from</span>&nbsp;user_table&nbsp;<span style="color: #c678dd;line-height: 26px;">where</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">id</span>&nbsp;&gt;&nbsp;<span style="color: #d19a66;line-height: 26px;">10</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">and</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">id</span>&nbsp;&lt;&nbsp;<span style="color: #d19a66;line-height: 26px;">1024</span><br  /></code></pre></section></pre><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 24px;"><span style="font-size: 14px;letter-spacing: 0.5px;">假设按照 ID 作为建表时指定的 Key， 那么在 Memtable 以及磁盘上按照 ID 有序的方式进行组织，查询时如果过滤条件包含前缀字段时，则可以使用前缀索引快速过滤。Key 查询条件在存储层会被划分为多个 Range，按照前缀索引做二分查找获取到对应的行号范围，由于前缀索引是稀疏的，所以只能大致定位出行的范围。随后过一遍 ZoneMap、Bloom Filter、Bitmap 等索引，进一步缩小需要 Scan 的行数。</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>通过索引，大大减少了需要扫描的行数，减少 CPU 和 IO 的压力，整体大幅提升了系统的并发能力。</strong></span></p><h3 style="text-indent: 0em;white-space: pre-wrap;line-height: 1.75em;margin-top: 32px;margin-bottom: 24px;"><span style="font-size: 18px;text-indent: 0em;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="letter-spacing: 0.5px;text-indent: 0em;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 18px;">&nbsp; </span><span style="color: rgb(0, 83, 205);font-size: 15px;"><strong>物化视图</strong></span></span></h3><h3 style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">物化视图是一种典型的空间换时间的思路，其本质是根据预定义的 SQL 分析语句执⾏预计算，并将计算结果持久化到另一张对用户透明但有实际存储的表中。在需要同时查询聚合数据和明细数据以及匹配不同前缀索引的场景，</span><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;color: rgb(0, 83, 205);"><strong>命中物化视图时可以获得更快的查询相应，同时也避免了大量的现场计算，因此可以提高性能表现并降低资源消耗</strong></span><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">。</span><br  /></h3><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">//&nbsp;对于聚合操作，&nbsp;直接读物化视图预聚合的列<br  /><span style="color: #c678dd;line-height: 26px;">create</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">materialized</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">view</span>&nbsp;store_amt&nbsp;<span style="color: #c678dd;line-height: 26px;">as</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">select</span>&nbsp;store_id,&nbsp;<span style="color: #c678dd;line-height: 26px;">sum</span>(sale_amt)&nbsp;<span style="color: #c678dd;line-height: 26px;">from</span>&nbsp;sales_records&nbsp;<span style="color: #c678dd;line-height: 26px;">group</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">by</span>&nbsp;store_id;<br  /><span style="color: #c678dd;line-height: 26px;">SELECT</span>&nbsp;store_id,&nbsp;<span style="color: #c678dd;line-height: 26px;">sum</span>(sale_amt)&nbsp;<span style="color: #c678dd;line-height: 26px;">FROM</span>&nbsp;sales_records&nbsp;<span style="color: #c678dd;line-height: 26px;">GROUP</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">BY</span>&nbsp;store_id;<br  /><br  />//&nbsp;对于查询，&nbsp;k3满足物化视图前缀列条件，&nbsp;走物化视图加速查询<br  /><span style="color: #c678dd;line-height: 26px;">CREATE</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">MATERIALIZED</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">VIEW</span>&nbsp;mv_1&nbsp;<span style="color: #c678dd;line-height: 26px;">as</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">SELECT</span>&nbsp;k3,&nbsp;k2,&nbsp;k1&nbsp;<span style="color: #c678dd;line-height: 26px;">FROM</span>&nbsp;tableA&nbsp;<span style="color: #c678dd;line-height: 26px;">ORDER</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">BY</span>&nbsp;k3;<br  /><span style="color: #c678dd;line-height: 26px;">select</span>&nbsp;k1,&nbsp;k2,&nbsp;k3&nbsp;<span style="color: #c678dd;line-height: 26px;">from</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">table</span>&nbsp;A&nbsp;<span style="color: #c678dd;line-height: 26px;">where</span>&nbsp;k3=<span style="color: #d19a66;line-height: 26px;">3</span>;</code></pre></section><h3 style="line-height: 1.75em;margin-top: 32px;margin-bottom: 24px;"><span style="text-indent: 0em;white-space: pre-wrap;font-size: 18px;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="text-indent: 0em;white-space: pre-wrap;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 18px;">&nbsp; </span><span style="color: rgb(0, 83, 205);font-size: 15px;"><strong>Runtime Filter</strong></span></span></h3><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">除了前文提到的用索引来加速过滤查询的数据， Doris 中还额外加入了动态过滤机制，即 Runtime Filter。在多表关联查询时，我们通常将右表称为 BuildTable、左表称为 ProbeTable，左表的数据量会大于右表的数据。在实现上，会首先读取右表的数据，在内存中构建一个 HashTable（Build）。之后开始读取左表的每一行数据，并在 HashTable 中进行连接匹配，来返回符合连接条件的数据（Probe）。而 Runtime Filter 是在右表构建 HashTable 的同时，为连接列生成一个过滤结构，可以是 Min/Max、IN 等过滤条件。之后把这个过滤列结构下推给左表。这样一来，左表就可以利用这个过滤结构，对数据进行过滤，从而减少 Probe 节点需要传输和比对的数据量。在大多数 Join 场景中，Runtime Filter 可以实现节点的自动穿透，将 Filter 穿透下推到最底层的扫描节点或者分布式 Shuffle Join 中。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);font-size: 14px;letter-spacing: 0.5px;">大多数的关联查询 Runtime Filter 都可以起到大幅减少数据读取的效果，从而加速整个查询的速度。</span></strong></span></section><h3 style="line-height: 1.75em;margin-top: 32px;margin-bottom: 24px;"><span style="text-indent: 0em;white-space: pre-wrap;font-size: 18px;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="text-indent: 0em;white-space: pre-wrap;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 18px;">&nbsp; </span><span style="color: rgb(0, 83, 205);font-size: 15px;"><strong>TOPN 优化技术</strong></span></span></h3><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">在数据库中查询最大或最小几条数据的应用场景非常广泛，比如查询满足某种条件的时间最近 100 条数据、查询价格最高或者最低的几个商品等，此类查询的性能对于实时分析非常重要。在 Doris 中引入了 TOPN 优化来解决大数据场景下较高的 IO、CPU、内存资源消耗：</span></section><ul class="list-paddingleft-1" style="list-style-type: square;"><li><p style="text-align: justify;margin: 0px 0px 24px;text-indent: 0em;line-height: 1.75em;"><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">首先从 Scanner 层读取排序字段和查询字段，利用堆排序保留 TOPN 条数据，实时更新当前已知的最大或最小的数据范围， 并动态下推至 Scanner</span></p></li><li><p style="text-align: justify;margin: 0px 0px 24px;text-indent: 0em;line-height: 1.75em;"><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">Scanner 层根据范围条件，利用索引等加速跳过文件和数据块，大幅减少读取的数据量。</span></p></li><li><p style="text-align: justify;margin: 0px 0px 24px;text-indent: 0em;line-height: 1.75em;"><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">在宽表中用户通常需要查询字段数较多， 在 TOPN 场景实际有效的数据仅 N 条， 通过将读取拆分成两阶段， 第一阶段根据少量的排序列、条件列来定位行号并排序，第二阶段根据排序后并取 TOPN 的结果得到行号反向查询数据，这样可以大大降低 Scan 的开销</span></p><p style="text-align: justify;margin: 0px 0px 24px;text-indent: 0em;line-height: 1.75em;"><br  /></p></li></ul><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 24px;"><span style="color: rgb(0, 83, 205);"><strong><span style="font-size: 14px;letter-spacing: 0.5px;">通过以上一系列优化手段，可以将不必要的数据剪枝掉，减少读取、排序的数据量，显著降低系统 IO、CPU 以及内存资源消耗</span></strong></span><span style="font-size: 14px;letter-spacing: 0.5px;">。此外，还可以利用包括 SQL Cache、Partition Ca<span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">che 在内的缓存机制以及 Join 优化手段来进一步提升并发，由于篇幅原因不在此详述。</span></span></p><h1 style="margin-bottom: 32px;white-space: normal;line-height: 1.75em;margin-top: 48px;"><span style="color: rgb(0, 83, 205);font-size: 24px;"><strong><span style="letter-spacing: 0.5px;">#&nbsp; Apache Doris 2.0 新特性揭秘</span></strong></span></h1><h1 style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">通过上一段中所介绍的内容，Apache Doris 实现了单节点上千 QPS 的并发支持。但在一些超高并发要求（例如数万 QPS）的 Data Serving 场景中，仍然存在瓶颈：</span></h1><ul class="list-paddingleft-1" style="list-style-type: square;"><li><p style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">列式存储引擎对于行级数据的读取不友好，宽表模型上列存格式将大大放大随机读取 IO；</span></p></li><li><p style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">OLAP 数据库的执行引擎和查询优化器对于某些简单的查询（如点查询）来说太重，需要在查询规划中规划短路径来处理此类查询；</span></p></li><li><p style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">SQL 请求的接入以及查询计划的解析与生成由 FE 模块负责，使用的是 Java 语言，在高并发场景下解析和生成大量的查询执行计划会导致高 CPU 开销；</span></p></li><li><p style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">……</span></p></li></ul><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 24px;"><span style="font-size: 14px;letter-spacing: 0.5px;">带着以上问题，Apache Doris 在分别从降低 SQL 内存 IO 开销、提升点查执行效率以及降低 SQL 解析开销这三个设计点出发，进行一系列优化。</span></p><h3 style="white-space: normal;line-height: 1.75em;margin-top: 32px;margin-bottom: 24px;"><span style="text-indent: 0em;white-space: pre-wrap;font-size: 18px;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="text-indent: 0em;white-space: pre-wrap;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 18px;">&nbsp; </span><span style="color: rgb(0, 83, 205);font-size: 15px;"><strong>行式存储格式（Row Store Format）</strong></span></span></h3><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">与列式存储格式不同，行式存储格式在数据服务场景会更加友好，数据按行存储、应对单次检索整行数据时效率更高，可以极大减少磁盘访问次数。</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>因此在 Apache Doris 2.0 版本中，我们引入了行式存储格式，将行存编码后存在单独的一列中，通过额外的空间来存储</strong></span><span style="font-size: 14px;letter-spacing: 0.5px;">。用户可以在建表语句的 Property 中指定如下属性来开启行存：</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">"store_row_column"&nbsp;=&nbsp;"true"</code></pre></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">我们选择以 JSONB 作为行存的编码格式，主要出于以下考虑：</span></section><ul class="list-paddingleft-1" style="list-style-type: square;"><li><section style="line-height: 1.75em;text-align: justify;margin: 0px 0px 24px;text-indent: 0em;"><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">Schema 变更灵活：随着数据的变化、变更，表的 Schema 也可能发生相应变化。行存储格式提供灵活性以处理这些变化是很重要的，例如用户删减字段、修改字段类型，数据变更需要及时同步到行存中。通过使用 JSONB 作为编码方式，将列作为 JSONB 的字段进行编码， 可以非常方便地进行字段扩展以及更改属性。</span></section></li><li><section style="line-height: 1.75em;text-align: justify;margin: 0px 0px 24px;text-indent: 0em;"><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">性能更高：在行存储格式中访问行可以比在列存储格式中访问行更快，因为数据存储在单个行中。这可以在高并发场景下显著减少磁盘访问开销。此外，通过将每个列 ID 映射到 JSONB其对应的值，可以实现对个别列的快速访问。</span></section></li><li><section style="line-height: 1.75em;text-align: justify;margin: 0px 0px 24px;text-indent: 0em;"><span style="color: rgb(51, 51, 51);font-size: 14px;text-decoration: none solid rgb(51, 51, 51);letter-spacing: 0.5px;">存储空间：将 JSONB 作为行存储格式的编解码器也可以帮助减少磁盘存储成本。紧凑的二进制格式可以减少存储在磁盘上的数据总大小，使其更具成本效益。</span></section></li></ul><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 24px;"><span style="font-size: 14px;letter-spacing: 0.5px;">使用 JSONB 编解码行存储格式，可以帮助解决高并发场景下面临的性能和存储问题。行存在存储引擎中会作为一个隐藏列（</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">DORIS_ROW_STORE_COL</code><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">）来进行存储，在 Memtable Flush 时，将各个列按照 JSONB 进行编码并缓存到这个隐藏列里。在数据读取时， 通过该隐藏列的 Column ID 来定位该列， 通过其行号定位到某一具体的行，并反序列化各列。</span></p><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">相关PR：</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(136, 136, 136);text-decoration: underline;">https://github.com/apache/doris/pull/15491</span></section><h3 style="white-space: normal;line-height: 1.75em;margin-top: 32px;margin-bottom: 24px;"><span style="text-indent: 0em;white-space: pre-wrap;font-size: 18px;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="text-indent: 0em;white-space: pre-wrap;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 18px;">&nbsp; </span><span style="color: rgb(0, 83, 205);font-size: 15px;"><strong>点查询短路径优化（Short-Circuit）</strong></span></span></h3><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">通常情况下，一条 SQL 语句的执行需要经过三个步骤：首先通过 SQL Parser 解析语句，生成抽象语法树(AST)，随后通过 Query Optimizer 生成可执行计划（Plan），最终通过执行该计划得到计算结果。对于大数据量下的复杂查询，经由查询优化器生成的执行计划无疑具有更高效的执行效果，但对于低延时和高并发要求的点查询，则不适宜走整个查询优化器的优化流程，会带来不必要的额外开销。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">为了解决这个问题，我们实现了点查询的短路径优化，绕过查询优化器以及 PlanFragment 来简化 SQL 执行流程，直接使用快速高效的读路径来检索所需的数据。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><img class="rich_pages wxw-img" data-height="476" data-ratio="0.47695390781563124" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/4_pMdiaqsa3R1RrmtwNd1CJNSScj6oLQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uecg6b8kbSZFicibf1II7C2JuTOTjy2mQMmEUIwtOA80Duj74gXxJlgLfv1pMdiaqsa3R1RrmtwNd1CJNSScj6oLQ/640?wx_fmt=png'" data-type="png" data-w="998" data-width="998"  /></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">当查询被 FE 接收后，它将由规划器生成适当的 Short-Circuit Plan 作为点查询的物理计划。该 Plan 非常轻量级，不需要任何等效变换、逻辑优化或物理优化，仅对 AST 树进行一些基本分析、构建相应的固定计划并减少优化器的开销。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">对于简单的主键点查询，如</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">select * from tbl where pk1 = 123 and pk2 = 456</code><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">，因为其只涉及单个 Tablet，因此可以使用轻量的 RPC 接口来直接与 StorageEngine 进行交互，以此避免生成复杂的Fragment Plan 并消除了在 MPP 查询框架下执行调度的性能开销。RPC 接口的详细信息如下：</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">message&nbsp;PTabletKeyLookupRequest&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;required&nbsp;int64&nbsp;tablet_id&nbsp;=&nbsp;1;<br  />&nbsp;&nbsp;&nbsp;&nbsp;repeated&nbsp;KeyTuple&nbsp;key_tuples&nbsp;=&nbsp;2;<br  />&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;Descriptor&nbsp;desc_tbl&nbsp;=&nbsp;4;<br  />&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;ExprList&nbsp;&nbsp;output_expr&nbsp;=&nbsp;5;<br  />}<br  /><br  />message&nbsp;PTabletKeyLookupResponse&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;required&nbsp;PStatus&nbsp;status&nbsp;=&nbsp;1;<br  />&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;bytes&nbsp;row_batch&nbsp;=&nbsp;5;<br  />&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;bool&nbsp;empty_batch&nbsp;=&nbsp;6;<br  />}<br  />rpc&nbsp;tablet_fetch_data(PTabletKeyLookupRequest)&nbsp;returns&nbsp;(PTabletKeyLookupResponse);<br  /></code></pre></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">以上 tablet_id 是从主键条件列计算得出的，</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">key_tuples</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">是主键的字符串格式，在上面的示例中，</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">key_tuples</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">类似于 ['123', '456']，在 BE 收到请求后</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">key_tuples</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">将被编码为主键存储格式，并根据主键索引来识别 Key 在 Segment File 中的行号，并查看对应的行是否在</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">delete bitmap</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">中，如果存在则返回其行号，否则返回</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">NotFound</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">。然后使用该行号直对</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">__DORIS_ROW_STORE_COL__</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">列进行点查询，因此我们只需在该列中定位一行并获取 JSONB 格式的原始值，并对其进行反序列化作为后续输出函数计算的值。</span><br  /></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">相关PR：</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(136, 136, 136);text-decoration: underline;">https://github.com/apache/doris/pull/15491</span></section><h3 style="white-space: normal;line-height: 1.75em;margin-top: 32px;margin-bottom: 24px;"><span style="text-indent: 0em;white-space: pre-wrap;font-size: 18px;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="text-indent: 0em;white-space: pre-wrap;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 18px;">&nbsp; </span><span style="color: rgb(0, 83, 205);font-size: 15px;"><strong>预处理语句优化（PreparedStatement）</strong></span></span></h3><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">高并发查询中的 CPU 开销可以部分归因于 FE 层分析和解析 SQL 的 CPU 计算，为了解决这个问题，我们在 FE 端提供了与 MySQL 协议完全兼容的预处理语句（Prepared Statement）。当 CPU 成为主键点查的性能瓶颈时，</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>Prepared Statement 可以有效发挥作用，实现 4 倍以上的性能提升</strong></span><span style="font-size: 14px;letter-spacing: 0.5px;">。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><img class="rich_pages wxw-img" data-height="452" data-ratio="0.6042780748663101" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/5_EYpYj8E8jWSzX30nmVUKQSm5h8MIdg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uecg6b8kbSZFicibf1II7C2JuTOTjy2mQMDsDR0Pc4MZpUcGdG7iaw0r5KibEYpYj8E8jWSzX30nmVUKQSm5h8MIdg/640?wx_fmt=png'" data-type="png" data-w="748" data-width="748"  /></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">Prepared Statement 的工作原理是通过在 Session 内存 HashMap 中缓存预先计算好的 SQL 和表达式，在后续查询时直接复用缓存对象即可。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">Prepared Statement 使用 </span><strong><span style="font-size: 14px;letter-spacing: 0.5px;text-decoration: none;">MySQL 二进制协议</span></strong><span style="font-size: 14px;letter-spacing: 0.5px;text-decoration: none;">（</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(136, 136, 136);text-decoration: none;">https://dev.mysql.com/doc/dev/mysqlserver/latest/page_protocol_binary_resultset.html#sect_protocol_binary_resultset_row</span><span style="font-size: 14px;letter-spacing: 0.5px;text-decoration: none;">）</span><span style="font-size: 14px;letter-spacing: 0.5px;">作为传输协议。该协议在文件</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">mysql_row_buffer.[h|cpp]&nbsp;</code><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">中实现，符合标准 MySQL 二进制编码， 通过该协议客户端例如 JDBC Client， 第一阶段发送</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">PREPARE</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">MySQL Command 将预编译语句发送给 FE 并由 FE 解析、Analyze 该语句并缓存到上图的 HashMap 中，接着客户端通过</span><code style="letter-spacing: 0px;text-align: left;font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">EXECUTE</code><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 14px;letter-spacing: 0.5px;">MySQL Command 将占位符替换并编码成二进制的格式发送给 FE， 此时 FE 按照 MySQL 协议反序列化后得到占位符中的值，生成对应的查询条件。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><img class="rich_pages wxw-img" data-height="872" data-ratio="0.8599605522682445" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/6_tlacn4KoNFXicibicTbV2qiaQvpO8Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uecg6b8kbSZFicibf1II7C2JuTOTjy2mQMTpCNhohsIq1QBa87IdNRhmDGNSMibtlacn4KoNFXicibicTbV2qiaQvpO8Q/640?wx_fmt=png'" data-type="png" data-w="1014" data-width="1014"  /></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">除了在 FE 缓存 Statement，我们还需要在 BE 中缓存被重复使用的结构，包括预先分配的计算 Block，查询描述符和输出表达式，由于这些结构在序列化和反序列化时会造成 CPU 热点， 所以需要将这些结构缓存下来。对于每个查询的 PreparedStatement，都会附带一个名为 CacheID 的 UUID。当 BE 执行点查询时，根据相关的 CacheID 找到对应的复用类， 并在 BE 中表达式计算、执行时重复使用上述结构。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">下面是在 JDBC 中使用 PreparedStatement 的示例：</span></section><section style="line-height: 1.75em;"><section style="margin-bottom: 24px;"><section style="margin-top: 0px;"><span style="font-size: 14px;letter-spacing: 0.5px;">1. 设置 JDBC URL 并在 Server 端开启 PreparedStatement</span></section></section></section><pre><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">url&nbsp;=&nbsp;jdbc:mysql://127.0.0.1:9030/ycsb?useServerPrepStmts=true</code></pre></section></pre><section style="margin-top: 32px;"><section style="margin-top: 40px;"><section style="margin-top: 32px;"><section style="margin-top: 24px;"><section style="line-height: 1.75em;"><section style="margin-bottom: 24px;"><section style="margin-top: 24px;"><span style="font-size: 14px;letter-spacing: 0.5px;">2. 使用 Prepared Statement</span></section></section></section></section></section></section></section><pre><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">//&nbsp;<span style="color: #c678dd;line-height: 26px;">use</span>&nbsp;<span style="color: #98c379;line-height: 26px;">`?`</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;placement&nbsp;holders,&nbsp;readStatement&nbsp;should&nbsp;be&nbsp;reused<br  />PreparedStatement&nbsp;readStatement&nbsp;=&nbsp;conn.prepareStatement(<span style="color: #98c379;line-height: 26px;">"select&nbsp;*&nbsp;from&nbsp;tbl_point_query&nbsp;where&nbsp;key&nbsp;=&nbsp;?"</span>);<br  />...<br  />readStatement.setInt(1234);<br  />ResultSet&nbsp;resultSet&nbsp;=&nbsp;readStatement.executeQuery();<br  />...<br  />readStatement.setInt(1235);<br  />resultSet&nbsp;=&nbsp;readStatement.executeQuery();<br  />...<br  /></code></pre></section><section style="margin-bottom: 24px;line-height: 1.75em;margin-top: 32px;"><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">相关 PR：</span><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-decoration: underline;color: rgb(136, 136, 136);">https://github.com/apache/doris/pull/15491</span><br  /></section></pre><h3 style="white-space: normal;line-height: 1.75em;margin-top: 32px;margin-bottom: 24px;"><span style="text-indent: 0em;white-space: pre-wrap;font-size: 18px;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);">&nbsp;</span></strong></span><span style="text-indent: 0em;white-space: pre-wrap;letter-spacing: 0.5px;text-align: left;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size: 18px;">&nbsp; </span><span style="color: rgb(0, 83, 205);font-size: 15px;"><strong>行存缓存</strong></span></span></h3><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">Doris 中有针对 Page 级别的 Cache，每个 Page 中存的是某一列的数据，所以 Page Cache 是针对列的缓存。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;text-align: center;"><img class="rich_pages wxw-img" data-height="540" data-ratio="0.9507042253521126" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/7_PrXRvVCKQ3Y1ibmwGLGJbxotQvLvbQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uecg6b8kbSZFicibf1II7C2JuTOTjy2mQMHH6U1dUmib5KSAKLOuRUQY37CAPrXRvVCKQ3Y1ibmwGLGJbxotQvLvbQ/640?wx_fmt=png'" data-type="png" data-w="568" data-width="568"  /></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">对于前面提到的行存，一行里包括了多列数据，缓存可能被大查询给刷掉，为了增加行缓存命中率，就需要单独引入行存缓存（Row Cache）。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">行存 Cache 复用了 Doris 中的 LRU Cache 机制， 启动时会初始化一个内存阈值， 当超过内存阈值后会淘汰掉陈旧的缓存行。对于一条主键查询语句，在存储层上命中行缓存和不命中行缓存可能有数十倍的性能差距(磁盘 IO 与内存的访问差距)，</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>因此行缓存的引入可以极大提升点查询的性能，特别是缓存命中高的场景下。</strong></span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;text-align: center;"><img class="rich_pages wxw-img" data-height="500" data-ratio="1.0683760683760684" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/8_yHKicaoE6s4ObubqemBFSJmDlgarNg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uecg6b8kbSZFicibf1II7C2JuTOTjy2mQMMBSUEHwBC2CyXK2VZ3tzug0RgyHKicaoE6s4ObubqemBFSJmDlgarNg/640?wx_fmt=png'" data-type="png" data-w="468" data-width="468"  /></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">开启行存缓存可以在 BE 中设置以下配置项来开启：</span></section><pre><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">disable_storage_row_cache=false&nbsp;//是否开启行缓存，&nbsp;默认不开启<br  />row_cache_mem_limit=20%&nbsp;//&nbsp;指定row&nbsp;<span style="color: #c678dd;line-height: 26px;">cache</span>占用内存的百分比，&nbsp;默认<span style="color: #d19a66;line-height: 26px;">20</span>%内存</code></pre></section></pre><section style="margin-bottom: 24px;line-height: 1.75em;margin-top: 32px;"><span style="font-size: 14px;letter-spacing: 0.5px;">相关 PR：</span><span style="font-size: 14px;letter-spacing: 0.5px;text-decoration: underline;color: rgb(136, 136, 136);">https://github.com/apache/doris/pull/15491</span></section><h1 style="line-height: 1.75em;margin-top: 48px;margin-bottom: 32px;"><span style="color: rgb(0, 83, 205);font-size: 24px;"><strong><span style="color: rgb(0, 83, 205);letter-spacing: 0.5px;">#&nbsp; Benchmark</span></strong></span></h1><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">基于以上一系列优化，帮助 Apache Doris 在 Data Serving 场景的性能得到进一步提升。我们基于 Yahoo! Cloud Serving Benchmark （YCSB）标准性能测试工具进行了基准测试，其中环境配置与数据规模如下：</span></section><ul class="list-paddingleft-1" style="list-style-type: square;"><li><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;text-align: justify;"><span style="font-size: 14px;letter-spacing: 0.5px;">机器环境：单台 16 Core 64G 内存 4*1T 硬盘的云服务器</span></section></li><li><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;text-align: justify;"><span style="font-size: 14px;letter-spacing: 0.5px;">集群规模：1 FE + 3 BE</span></section></li><li><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;text-align: justify;"><span style="font-size: 14px;letter-spacing: 0.5px;">数据规模：一共 1 亿条数据，平均每行在 1K 左右，测试前进行了预热。</span></section></li><li><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;text-align: justify;"><span style="font-size: 14px;letter-spacing: 0.5px;">对应测试表结构与查询语句如下：</span></section><section><br  /></section></li></ul><pre><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">//&nbsp;建表语句如下：<br  /><br  /><span style="color: #c678dd;line-height: 26px;">CREATE</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">TABLE</span>&nbsp;<span style="color: #98c379;line-height: 26px;">`usertable`</span>&nbsp;(<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`YCSB_KEY`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">varchar</span>(<span style="color: #d19a66;line-height: 26px;">255</span>)&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD0`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD1`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD2`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD3`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD4`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD5`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD6`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD7`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD8`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span>,<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">`FIELD9`</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">text</span>&nbsp;<span style="color: #56b6c2;line-height: 26px;">NULL</span><br  />)&nbsp;<span style="color: #c678dd;line-height: 26px;">ENGINE</span>=OLAP<br  /><span style="color: #c678dd;line-height: 26px;">UNIQUE</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">KEY</span>(<span style="color: #98c379;line-height: 26px;">`YCSB_KEY`</span>)<br  /><span style="color: #c678dd;line-height: 26px;">COMMENT</span>&nbsp;<span style="color: #98c379;line-height: 26px;">'OLAP'</span><br  /><span style="color: #c678dd;line-height: 26px;">DISTRIBUTED</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">BY</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">HASH</span>(<span style="color: #98c379;line-height: 26px;">`YCSB_KEY`</span>)&nbsp;BUCKETS&nbsp;<span style="color: #d19a66;line-height: 26px;">16</span><br  />PROPERTIES&nbsp;(<br  /><span style="color: #98c379;line-height: 26px;">"replication_allocation"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"tag.location.default:&nbsp;1"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"in_memory"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"false"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"persistent"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"false"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"storage_format"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"V2"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"enable_unique_key_merge_on_write"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"true"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"light_schema_change"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"true"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"store_row_column"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"true"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"disable_auto_compaction"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"false"</span><br  />);<br  /><br  />//&nbsp;查询语句如下：<br  /><br  /><span style="color: #c678dd;line-height: 26px;">SELECT</span>&nbsp;*&nbsp;<span style="color: #c678dd;line-height: 26px;">from</span>&nbsp;usertable&nbsp;<span style="color: #c678dd;line-height: 26px;">WHERE</span>&nbsp;YCSB_KEY&nbsp;=&nbsp;?</code></pre></section></pre><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 32px;"><span style="font-size: 14px;letter-spacing: 0.5px;">开启优化（即同时开启行存、点查短路径以及 PreparedStatement）与未开启的测试结果如下：</span></p><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><img class="rich_pages wxw-img" data-height="718" data-ratio="0.5611111111111111" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/9_334N0Xj5KIW0GFpibQbrCUSeNqibBg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uecg6b8kbSZFicibf1II7C2JuTOTjy2mQMk8ibKzaibgEax2xrh2hiabT35fOlU334N0Xj5KIW0GFpibQbrCUSeNqibBg/640?wx_fmt=png'" data-type="png" data-w="1080" data-width="1280"  /></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">开启以上优化项后平均</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>查询耗时降低了 96%</strong></span><span style="font-size: 14px;letter-spacing: 0.5px;">，99 分位的</span><span style="color: rgb(0, 83, 205);"><strong><span style="font-size: 14px;letter-spacing: 0.5px;">查询耗时仅之前的 1/28</span></strong></span><span style="font-size: 14px;letter-spacing: 0.5px;">，QPS 并发</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>从 1400 增至 3w、提升了超过 20 倍</strong></span><span style="font-size: 14px;letter-spacing: 0.5px;">，整体性能表现和并发承载实现数据量级的飞跃！</span></section><h1 style="line-height: 1.75em;margin-top: 48px;margin-bottom: 32px;"><span style="color: rgb(0, 83, 205);font-size: 24px;"><strong><span style="color: rgb(0, 83, 205);letter-spacing: 0.5px;">#&nbsp; 最佳实践</span></strong></span></h1><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">需要注意的是，在当前阶段实现的点查询优化均是在 Unique Key 主键模型进行的，同时需要开启 Merge-on-Write 以及 Light Schema Change 后使用，以下是点查询场景的建表语句示例：</span></section><pre><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">CREATE&nbsp;TABLE&nbsp;`usertable`&nbsp;(<br  />&nbsp;&nbsp;`USER_KEY`&nbsp;BIGINT&nbsp;NULL,<br  />&nbsp;&nbsp;`FIELD0`&nbsp;text&nbsp;NULL,<br  />&nbsp;&nbsp;`FIELD1`&nbsp;text&nbsp;NULL,<br  />&nbsp;&nbsp;`FIELD2`&nbsp;text&nbsp;NULL,<br  />&nbsp;&nbsp;`FIELD3`&nbsp;text&nbsp;NULL<br  />)&nbsp;ENGINE=<span style="line-height: 26px;">OLAP<br  />UNIQUE&nbsp;<span style="color: #61aeee;line-height: 26px;">KEY</span><span style="line-height: 26px;">(`USER_KEY`)</span><br  />COMMENT&nbsp;'OLAP'<br  />DISTRIBUTED&nbsp;BY&nbsp;<span style="color: #61aeee;line-height: 26px;">HASH</span><span style="line-height: 26px;">(`USER_KEY`)</span>&nbsp;BUCKETS&nbsp;16<br  /><span style="color: #61aeee;line-height: 26px;">PROPERTIES</span>&nbsp;<span style="line-height: 26px;">(<br  /><span style="color: #98c379;line-height: 26px;">"enable_unique_key_merge_on_write"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"true"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"light_schema_change"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"true"</span>,<br  /><span style="color: #98c379;line-height: 26px;">"store_row_column"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"true"</span>,<br  />)</span></span>;<br  /></code></pre></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><br  /></section></pre><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 32px;"><span style="color: rgb(0, 83, 205);"><strong><span style="color: rgb(0, 83, 205);font-size: 14px;letter-spacing: 0.5px;">注意:</span></strong></span></p><ul class="list-paddingleft-1" style="list-style-type: square;"><li><p style="text-align: justify;margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="letter-spacing: 0.5px;font-size: 14px;">开启</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin-bottom: 0px;padding-right: 10px;padding-left: 10px;display: inline;letter-spacing: 0px;text-align: left;white-space: normal;font-size: 16px;color: black;line-height: 1.6;word-break: break-word;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;display: inline;line-height: 26px;"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 4px;display: inline;font-size: 14px;border-radius: 4px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;">light_schema_change</code></p></section><p><span style="font-size: 14px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: justify;">来支持 JSONB 行存编码 ColumnID</span></p></li><li><p style="text-align: justify;margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="letter-spacing: 0.5px;font-size: 14px;">开启&nbsp;&nbsp;<span style="color: rgb(30, 107, 184);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;background-color: rgba(27, 31, 35, 0.05);">store_row_column&nbsp;</span></span></p><p><span style="letter-spacing: 0.5px;font-size: 14px;">来存储行存格式</span></p></li></ul><p style="margin-bottom: 24px;line-height: 1.75em;margin-top: 24px;"><span style="font-size: 14px;letter-spacing: 0.5px;">完成建表操作后，类似如下基于主键的点查 SQL 可通过行式存储格式和短路径执行得到性能的大幅提升：</span></p><pre><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">select&nbsp;*&nbsp;from&nbsp;usertable&nbsp;where&nbsp;USER_KEY&nbsp;=&nbsp;xxx;<br  /></code></pre></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><br  /></section></pre><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">与此同时，可以通过 JDBC 中的 Prepared Statement 来进一步提升点查询性能。如果有充足的内存， 还可以在 BE 配置文件中开启行存 Cache，上文中均已给出使用示例，在此不再赘述。</span></section><h1 style="line-height: 1.75em;margin-top: 48px;margin-bottom: 32px;"><span style="color: rgb(0, 83, 205);font-size: 24px;"><strong><span style="color: rgb(0, 83, 205);letter-spacing: 0.5px;">#&nbsp; 总结</span></strong></span></h1><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">通过引入行式存储格式、点查询短路径优化、预处理语句以及行存缓存，</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 0, 0);">Apache Doris 实现了单节点上万 QPS 的超高并发，实现了数十倍的性能飞跃</span><span style="font-size: 14px;letter-spacing: 0.5px;">。而随着集群规模的横向拓展、机器配置的提升，Apache Doris 还可以利用硬件资源实现计算加速，自身的 MPP 架构也具备横向线性拓展的能力。</span><span style="font-size: 14px;letter-spacing: 0.5px;color: rgb(0, 83, 205);"><strong>因此 Apache Doris 真正具备了在</strong><strong>一套架构下同时</strong><strong>满足高吞吐的 OLAP 分析和高并发的 Data Serving 在线服务的能力，大大简化了混合工作负载下的技术架构，为用户提供了多场景下的统一分析体验</strong></span><span style="font-size: 14px;letter-spacing: 0.5px;">。</span></section><section style="margin-top: 0px;margin-bottom: 24px;line-height: 1.75em;"><span style="font-size: 14px;letter-spacing: 0.5px;">以上功能的实现得益于 Apache Doris 社区开发者共同努力以及 SelectDB 工程师的的持续贡献，当前已处于紧锣密鼓的发版流程中，在不久后的 2.0 版本就会发布出来。</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;line-height: 1.6;letter-spacing: 0.034em;color: rgb(63, 63, 63);font-size: 16px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">如果这个文章对你有帮助，不要忘记&nbsp;</span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;outline: 0px;font-size: 15px;color: rgb(255, 104, 39);"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「在看」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「点赞」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「收藏」</strong></span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">&nbsp;三连啊喂！</span><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="1.215625" data-s="300,640" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/10_jNJdvwuULcOtMEU3DFFESPHpbU8Hdg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PDwSDUx452DKyaUxtxDoz47He3aCnMeSE9wLtZJwcdOFU6jNJdvwuULcOtMEU3DFFESPHpbU8Hdg/640?wx_fmt=png'" data-type="png" data-w="640" style="width: 241px;height: 293px;"></p><p style="margin: 0px 0px 0em;padding: 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: center;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;background-color: rgb(255, 255, 255);color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;"></span></p></section></section><section style="margin: 0px;padding: 0px;max-width: 100%;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="图片/大数据技术与架构_2023-06-22_「转」单机数万QPS！Apache Doris高并发特性解读/11_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="margin: 0px;padding: 0px;max-width: 100%;height: 42px;overflow-wrap: break-word !important;vertical-align: bottom;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">互联网最坏的时代可能真的来了</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">我在B站读大学，大数据专业</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Flink的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">193篇文章暴揍Flink，这个合集你需要关注一下</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Spark的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">在所有Spark模块中，我愿称SparkSQL为最强！</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">硬刚Hive | 4万字基础调优面试小总结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">数据治理方法论和实践小百科全书</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">标签体系下的用户画像建设小指南</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解析</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我写过的关于成长/面试/职场进阶的文章</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>