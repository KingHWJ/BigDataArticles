<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"「Hudi系列」Hudi查询&写入&常见问题汇总","time":"2022-05-17 17:30:38","timeStamp":"1652779838"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247513247&idx=1&sn=469762179bfb93dbd62efc0457d1ca1a&chksm=fd3ef20aca497b1ca73ac214b13bad5d035c40f0fe6315ff5ed39bb972a1b8ac8f9a3230cf11#rd" target="_blank">「Hudi系列」Hudi查询&写入&常见问题汇总</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2022-05-17 17:30:38</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU3MzgwNTU2Mg==&action=getalbum&album_id=1369031183400747008#wechat_redirect" title="大数据成神之路" target="_blank">#大数据成神之路</a></p></div><section data-mpa-powered-by="yiban.io"><br  /></section><section mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><span style="outline: 0px;visibility: visible;line-height: 18.7578px;font-size: 14px;"><span mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;visibility: visible;line-height: 21.4375px;">点击上方</span><strong mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;visibility: visible;line-height: 21.4375px;font-size: 12.25px;"><span mp-original-font-size="15" mp-original-line-height="18" style="outline: 0px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;line-height: 15.75px;color: rgb(87, 107, 148);-webkit-text-stroke-color: rgb(87, 107, 148);visibility: visible;">蓝色字体</span></strong><span mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;visibility: visible;line-height: 21.4375px;">，选择“设为星标”</span><br mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;visibility: visible;line-height: 21.4375px;font-size: 12.25px;"  /></span></section><section mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);line-height: 21.4375px;visibility: visible;"><span style="outline: 0px;visibility: visible;line-height: 18.7578px;font-size: 14px;"><span mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;background-color: rgb(255, 255, 255);visibility: visible;line-height: 21.4375px;">回复"</span><strong mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;visibility: visible;line-height: 21.4375px;font-size: 12.25px;"><span mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;background-color: rgb(255, 255, 255);color: rgb(255, 0, 0);visibility: visible;line-height: 21.4375px;">面试"</span></strong><span mp-original-font-size="14" mp-original-line-height="24.5" style="outline: 0px;background-color: rgb(255, 255, 255);visibility: visible;line-height: 21.4375px;">获取更多惊喜</span></span></section><section mp-original-font-size="14" mp-original-line-height="42" style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);line-height: 36.75px;visibility: visible;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247512011&amp;idx=1&amp;sn=68aaa9c5c42e2087d56d170c442b30ba&amp;chksm=fd3ee95eca496048b24a717a30fe820b9188d02e014ba7b554afe86f8da1efab189799fe7087&amp;scene=21#wechat_redirect" textvalue="八股文教给我，你们专心刷题和面试" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="15" mp-original-line-height="42" style="color: rgb(255, 104, 39);text-decoration: underline;outline: 0px;cursor: pointer;visibility: visible;line-height: 32.1562px;font-size: 14px;"><span style="outline: 0px;cursor: pointer;visibility: visible;line-height: 32.1562px;font-size: 14px;"><strong mp-original-font-size="15" mp-original-line-height="42" style="outline: 0px;visibility: visible;line-height: 36.75px;">八股文教给我，你们专心刷题和面试</strong></span></a></section><section mp-original-font-size="14" mp-original-line-height="16" style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;line-height: 14px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);visibility: visible;"><span style="outline: 0px;background-color: rgb(255, 255, 255);visibility: visible;line-height: 14px;font-size: 14px;"><img class="rich_pages wxw-img" data-ratio="0.0625" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/1_TMnLIpBq96wT1ibdccSSd3LVdSE3LQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/sq2uE6cicHYxoldXibjHyWbvjJfI6ibEm5Kw715uVJTBLdX1gkVpExwlFh22TMnLIpBq96wT1ibdccSSd3LVdSE3LQ/640?wx_fmt=png'" data-type="png" data-w="640" style="outline: 0px;line-height: 12.25px;font-size: 10.7188px;box-sizing: border-box !important;visibility: visible !important;width: 531px !important;"  /></span></section><section mp-original-font-size="14" mp-original-line-height="16" style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;line-height: 14px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: left;color: rgb(178, 178, 178);visibility: visible;"><br  /></section><section mp-original-font-size="14" mp-original-line-height="16" style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;line-height: 14px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: left;color: rgb(178, 178, 178);visibility: visible;"><span style="outline: 0px;visibility: visible;line-height: 14px;color: black;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0px;text-align: left;font-size: 14px;"><img class="rich_pages wxw-img" data-ratio="1" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/2_XY9xLn6KMdfmH5rlv09EictN0HhtWg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1CAiarZ98xibqM3SicNhFiaAviaCvv3ibXY9xLn6KMdfmH5rlv09EictN0HhtWg/640?wx_fmt=png'" data-type="png" data-w="20" style="display:inline-block;width:20px;vertical-align:text-bottom;"  />阅读本文前必读：</span></section><p style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: left;color: rgb(178, 178, 178);visibility: visible;line-height: 1.6em;"><span style="outline: 0px;visibility: visible;line-height: 14px;color: black;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0px;text-align: left;font-size: 14px;"><br  /></span></p><p style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: left;color: rgb(178, 178, 178);visibility: visible;line-height: 2em;"><span style="outline: 0px;visibility: visible;line-height: 14px;font-size: 14px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510400&amp;idx=1&amp;sn=d34d058a280659317ce83e5d0cc687a0&amp;chksm=fd3eef15ca496603ad278d1695ba5f10f76c7dac17d5c4f06a76a16a4e4944d2268a833d65b6&amp;scene=21#wechat_redirect" textvalue="「Apache Hudi系列」核心概念与架构设计总结" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0px;text-align: left;">1. 「Apache Hudi系列」核心概念与架构设计总结</a></span></p><p style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: left;color: rgb(178, 178, 178);visibility: visible;line-height: 2em;"><span style="outline: 0px;visibility: visible;line-height: 14px;font-size: 14px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247511802&amp;idx=1&amp;sn=3e1fade4604734d2e565734525369259&amp;chksm=fd3ee86fca4961794247ebed525bc4378db82ed1f821945a11d0e4fe936ea4aaadea6137f3e6&amp;scene=21#wechat_redirect" textvalue="「Hudi系列」Apache Hudi入门指南 | SparkSQL+Hive+Presto集成" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0px;text-align: left;">2. 「Hudi系列」Apache Hudi入门指南 | SparkSQL+Hive+Presto集成</a></span></p><p style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: left;color: rgb(178, 178, 178);visibility: visible;line-height: 2em;"><span style="outline: 0px;visibility: visible;line-height: 14px;font-size: 14px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247513089&amp;idx=1&amp;sn=c2e90656e6a28d5582fefd5ac0e13075&amp;chksm=fd3ef294ca497b821b0b160c4297c6ba6231b5171d1786af62d46bf3dc4a285d37184bdb04a2&amp;scene=21#wechat_redirect" textvalue="Apache Hudi 0.11 版本重磅发布，新特性速览!" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0px;text-align: left;">3.&nbsp; Apache Hudi 0.11 版本重磅发布，新特性速览!</a></span></p><section mp-original-font-size="14" mp-original-line-height="16" style="outline: 0px;white-space: normal;text-size-adjust: auto;letter-spacing: 0.544px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;line-height: 14px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);visibility: visible;"><br  /></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">1.Hudi基本概念 ：</span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Apache Hudi(发音为“Hudi”)在DFS的数据集上提供以下流原语</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">插入更新 (如何改变数据集?)</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">增量拉取 (如何获取变更的数据?)</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在本节中，我们将讨论重要的概念和术语，这些概念和术语有助于理解并有效使用这些原语。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">时间轴</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在它的核心，Hudi维护一条包含在不同的即时时间所有对数据集操作的时间轴，从而提供，从不同时间点出发得到不同的视图下的数据集。Hudi即时包含以下组件</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">操作类型 : 对数据集执行的操作类型</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">即时时间 : 即时时间通常是一个时间戳(例如：20190117010349)，该时间戳按操作开始时间的顺序单调增加。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">状态 : 即时的状态</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi保证在时间轴上执行的操作的原子性和基于即时时间的时间轴一致性。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">执行的关键操作包括</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">COMMITS - 一次提交表示将一组记录原子写入到数据集中。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">CLEANS - 删除数据集中不再需要的旧文件版本的后台活动。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">DELTA_COMMIT - 增量提交是指将一批记录原子写入到MergeOnRead存储类型的数据集中，其中一些/所有数据都可以只写到增量日志中。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">COMPACTION - 协调Hudi中差异数据结构的后台活动，例如：将更新从基于行的日志文件变成列格式。在内部，压缩表现为时间轴上的特殊提交。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">ROLLBACK - 表示提交/增量提交不成功且已回滚，删除在写入过程中产生的所有部分文件。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">SAVEPOINT - 将某些文件组标记为"已保存"，以便清理程序不会将其删除。在发生灾难/数据恢复的情况下，它有助于将数据集还原到时间轴上的某个点。</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">任何给定的即时都可以处于以下状态之一</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">REQUESTED - 表示已调度但尚未启动的操作。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">INFLIGHT - 表示当前正在执行该操作。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">COMPLETED - 表示在时间轴上完成了该操作。</section></li></ul><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.562962962962963" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/3_ftF9wY1FxG7H8K98Zcnj21xg03X7zQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1CicoPWyVMNmjMyiaX4sCCIoiaNGVftF9wY1FxG7H8K98Zcnj21xg03X7zQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1080" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">上面的示例显示了在Hudi数据集上大约10:00到10:20之间发生的更新事件，大约每5分钟一次，将提交元数据以及其他后台清理/压缩保留在Hudi时间轴上。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">观察的关键点是：提交时间指示数据的到达时间（上午10:20），而实际数据组织则反映了实际时间或事件时间，即数据所反映的（从07:00开始的每小时时段）。在权衡数据延迟和完整性时，这是两个关键概念。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如果有延迟到达的数据（事件时间为9:00的数据在10:20达到，延迟 &gt;1 小时），我们可以看到upsert将新数据生成到更旧的时间段/文件夹中。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在时间轴的帮助下，增量查询可以只提取10:00以后成功提交的新数据，并非常高效地只消费更改过的文件，且无需扫描更大的文件范围，例如07:00后的所有时间段。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">文件组织</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi将DFS上的数据集组织到基本路径下的目录结构中。数据集分为多个分区，这些分区是包含该分区的数据文件的文件夹，这与Hive表非常相似。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">每个分区被相对于基本路径的特定分区路径区分开来。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在每个分区内，文件被组织为文件组，由文件id唯一标识。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">每个文件组包含多个文件切片，其中每个切片包含在某个提交/压缩即时时间生成的基本列文件（*.parquet）以及一组日志文件（*.log*），该文件包含自生成基本文件以来对基本文件的插入/更新。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi采用MVCC设计，其中压缩操作将日志和基本文件合并以产生新的文件片，而清理操作则将未使用的/较旧的文件片删除以回收DFS上的空间。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi通过索引机制将给定的hoodie键（记录键+分区路径）映射到文件组，从而提供了高效的Upsert。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">一旦将记录的第一个版本写入文件，记录键和文件组/文件id之间的映射就永远不会改变。简而言之，映射的文件组包含一组记录的所有版本。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">存储类型和视图</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi存储类型定义了如何在DFS上对数据进行索引和布局以及如何在这种组织之上实现上述原语和时间轴活动（即如何写入数据）。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">反过来，视图定义了基础数据如何暴露给查询（即如何读取数据）。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.167989417989418" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/4_HvPQ27BhuZnqqUjkZ6SVPQMMKOlzEw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1CKWPFZsYJM7ZZic2PtkhltAhib6HvPQ27BhuZnqqUjkZ6SVPQMMKOlzEw/640?wx_fmt=png'" data-type="png" data-w="756" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>存储类型</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi支持以下存储类型。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">写时复制 : 仅使用列文件格式（例如parquet）存储数据。通过在写入过程中执行同步合并以更新版本并重写文件。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">读时合并 : 使用列式（例如parquet）+ 基于行（例如avro）的文件格式组合来存储数据。更新记录到增量文件中，然后进行同步或异步压缩以生成列文件的新版本。</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">下表总结了这两种存储类型之间的权衡</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.2635046113306983" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/5_N0kZ2PA3JkoVjm6icic2va40S8TsuA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1Cxic74J5ShkBpkdQoZ0hG7QF8xS9N0kZ2PA3JkoVjm6icic2va40S8TsuA/640?wx_fmt=png'" data-type="png" data-w="759" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>视图</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi支持以下存储数据的视图</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">读优化视图 : 在此视图上的查询将查看给定提交或压缩操作中数据集的最新快照。该视图仅将最新文件切片中的基本/列文件暴露给查询，并保证与非Hudi列式数据集相比，具有相同的列式查询性能。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">增量视图 : 对该视图的查询只能看到从某个提交/压缩后写入数据集的新数据。该视图有效地提供了更改流，来支持增量数据管道。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">实时视图 : 在此视图上的查询将查看某个增量提交操作中数据集的最新快照。该视图通过动态合并最新的基本文件(例如parquet)和增量文件(例如avro)来提供近实时数据集（几分钟的延迟）。</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">下表总结了不同视图之间的权衡。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.19894598155467721" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/6_ibZfdC8I4dlJS5TLcCSIkwBSuylKew.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1CCHOViaDhQnvUiatyicCow5VOYyibtibZfdC8I4dlJS5TLcCSIkwBSuylKew/640?wx_fmt=png'" data-type="png" data-w="759" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">写时复制存储</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">写时复制存储中的文件片仅包含基本/列文件，并且每次提交都会生成新版本的基本文件。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">换句话说，我们压缩每个提交，从而所有的数据都是以列数据的形式储存。在这种情况下，写入数据非常昂贵（我们需要重写整个列数据文件，即使只有一个字节的新数据被提交），而读取数据的成本则没有增加。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这种视图有利于读取繁重的分析工作。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">以下内容说明了将数据写入写时复制存储并在其上运行两个查询时，它是如何工作的。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4925925925925926" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/7_a76FXh2EHo9vvZz1WibNT9yaoVMTkQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1Cn1F51GnNVCQ0Zxj700mEvINCDa76FXh2EHo9vvZz1WibNT9yaoVMTkQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1080" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">随着数据的写入，对现有文件组的更新将为该文件组生成一个带有提交即时时间标记的新切片，而插入分配一个新文件组并写入该文件组的第一个切片。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这些文件切片及其提交即时时间在上面用颜色编码。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">针对这样的数据集运行SQL查询（例如：select count(*)统计该分区中的记录数目），首先检查时间轴上的最新提交并过滤每个文件组中除最新文件片以外的所有文件片。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如您所见，旧查询不会看到以粉红色标记的当前进行中的提交的文件，但是在该提交后的新查询会获取新数据。因此，查询不受任何写入失败/部分写入的影响，仅运行在已提交数据上。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">写时复制存储的目的是从根本上改善当前管理数据集的方式，通过以下方法来实现</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">优先支持在文件级原子更新数据，而无需重写整个表/分区</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">能够只读取更新的部分，而不是进行低效的扫描或搜索</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">严格控制文件大小来保持出色的查询性能（小的文件会严重损害查询性能）。</section></li></ul><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">读时合并存储</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">读时合并存储是写时复制的升级版，从某种意义上说，它仍然可以通过读优化表提供数据集的读取优化视图（写时复制的功能）。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">此外，它将每个文件组的更新插入存储到基于行的增量日志中，通过文件id，将增量日志和最新版本的基本文件进行合并，从而提供近实时的数据查询。因此，此存储类型智能地平衡了读和写的成本，以提供近乎实时的查询。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这里最重要的一点是压缩器，它现在可以仔细挑选需要压缩到其列式基础文件中的增量日志（根据增量日志的文件大小），以保持查询性能（较大的增量日志将会提升近实时的查询时间，并同时需要更长的合并时间）。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">以下内容说明了存储的工作方式，并显示了对近实时表和读优化表的查询。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.48333333333333334" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/8_CCZSB1oOGQicByzaQ8xQjV458MbP8A.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1Cv7pq3aoPGpHcqWiciaialD0tdLnXCCZSB1oOGQicByzaQ8xQjV458MbP8A/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1080" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">此示例中发生了很多有趣的事情，这些带出了该方法的微妙之处。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">现在，我们每1分钟左右就有一次提交，这是其他存储类型无法做到的。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">现在，在每个文件id组中，都有一个增量日志，其中包含对基础列文件中记录的更新。在示例中，增量日志包含10:05至10:10的所有数据。与以前一样，基本列式文件仍使用提交进行版本控制。因此，如果只看一眼基本文件，那么存储布局看起来就像是写时复制表的副本。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">定期压缩过程会从增量日志中合并这些更改，并生成基础文件的新版本，就像示例中10:05发生的情况一样。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">有两种查询同一存储的方式：读优化（RO）表和近实时（RT）表，具体取决于我们选择查询性能还是数据新鲜度。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">对于RO表来说，提交数据在何时可用于查询将有些许不同。请注意，以10:10运行的（在RO表上的）此类查询将不会看到10:05之后的数据，而在RT表上的查询总会看到最新的数据。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">何时触发压缩以及压缩什么是解决这些难题的关键。通过实施压缩策略，在该策略中，与较旧的分区相比，我们会积极地压缩最新的分区，从而确保RO表能够以一致的方式看到几分钟内发布的数据。</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">读时合并存储上的目的是直接在DFS上启用近实时处理，而不是将数据复制到专用系统，后者可能无法处理大数据量。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">该存储还有一些其他方面的好处，例如通过避免数据的同步合并来减少写放大，即批量数据中每1字节数据需要的写入数据量。</p><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">2.写入Hudi：</span></h2><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">写操作</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在此之前，了解Hudi数据源及delta streamer工具提供的三种不同的写操作以及如何最佳利用它们可能会有所帮助。这些操作可以在针对数据集发出的每个提交/增量提交中进行选择/更改。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">UPSERT（插入更新） ：这是默认操作，在该操作中，通过查找索引，首先将输入记录标记为插入或更新。在运行启发式方法以确定如何最好地将这些记录放到存储上，如优化文件大小之类后，这些记录最终会被写入。对于诸如数据库更改捕获之类的用例，建议该操作，因为输入几乎肯定包含更新。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">INSERT（插入） ：就使用启发式方法确定文件大小而言，此操作与插入更新（UPSERT）非常相似，但此操作完全跳过了索引查找步骤。因此，对于日志重复数据删除等用例（结合下面提到的过滤重复项的选项），它可以比插入更新快得多。插入也适用于这种用例，这种情况数据集可以允许重复项，但只需要Hudi的事务写/增量提取/存储管理功能。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">BULK_INSERT（批插入） ：插入更新和插入操作都将输入记录保存在内存中，以加快存储优化启发式计算的速度（以及其它未提及的方面）。所以对Hudi数据集进行初始加载/引导时这两种操作会很低效。批量插入提供与插入相同的语义，但同时实现了基于排序的数据写入算法，该算法可以很好地扩展数百TB的初始负载。但是，相比于插入和插入更新能保证文件大小，批插入在调整文件大小上只能尽力而为。</section></li></ul><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">DeltaStreamer</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">HoodieDeltaStreamer实用工具 (hudi-utilities-bundle中的一部分) 提供了从DFS或Kafka等不同来源进行摄取的方式，并具有以下功能。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">从Kafka单次摄取新事件，从Sqoop、HiveIncrementalPuller输出或DFS文件夹中的多个文件增量导入</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">支持json、avro或自定义记录类型的传入数据</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">管理检查点，回滚和恢复</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">利用DFS或Confluent schema注册表的Avro模式。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">支持自定义转换操作</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">命令行选项更详细地描述了这些功能：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">[hoodie]$&nbsp;spark-submit&nbsp;--class&nbsp;org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer&nbsp;`ls&nbsp;packaging/hudi-utilities-bundle/target/hudi-utilities-bundle-*.jar`&nbsp;--<span style="color: #e6c07b;line-height: 26px;">help</span><br  />Usage:&nbsp;&lt;main&nbsp;class&gt;&nbsp;[options]<br  />&nbsp;&nbsp;Options:<br  />&nbsp;&nbsp;&nbsp;&nbsp;--commit-on-errors<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Commit&nbsp;even&nbsp;when&nbsp;some&nbsp;records&nbsp;failed&nbsp;to&nbsp;be&nbsp;written<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;<span style="color: #56b6c2;line-height: 26px;">false</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">enable</span>-hive-sync<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enable&nbsp;syncing&nbsp;to&nbsp;hive<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;<span style="color: #56b6c2;line-height: 26px;">false</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;--filter-dupes<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Should&nbsp;duplicate&nbsp;records&nbsp;from&nbsp;<span style="color: #e6c07b;line-height: 26px;">source</span>&nbsp;be&nbsp;dropped/filtered&nbsp;outbefore<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert/bulk-insert<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;<span style="color: #56b6c2;line-height: 26px;">false</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">help</span>,&nbsp;-h<br  />&nbsp;&nbsp;&nbsp;&nbsp;--hudi-conf<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Any&nbsp;configuration&nbsp;that&nbsp;can&nbsp;be&nbsp;<span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;the&nbsp;properties&nbsp;file&nbsp;(using&nbsp;the&nbsp;CLI<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;<span style="color: #98c379;line-height: 26px;">"--propsFilePath"</span>)&nbsp;can&nbsp;also&nbsp;be&nbsp;passed&nbsp;<span style="color: #e6c07b;line-height: 26px;">command</span>&nbsp;line&nbsp;using&nbsp;this<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;[]<br  />&nbsp;&nbsp;&nbsp;&nbsp;--op<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Takes&nbsp;one&nbsp;of&nbsp;these&nbsp;values&nbsp;:&nbsp;UPSERT&nbsp;(default),&nbsp;INSERT&nbsp;(use&nbsp;when&nbsp;input&nbsp;is<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purely&nbsp;new&nbsp;data/inserts&nbsp;to&nbsp;gain&nbsp;speed)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;UPSERT<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Possible&nbsp;Values:&nbsp;[UPSERT,&nbsp;INSERT,&nbsp;BULK_INSERT]<br  />&nbsp;&nbsp;&nbsp;&nbsp;--payload-class<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subclass&nbsp;of&nbsp;HoodieRecordPayload,&nbsp;that&nbsp;works&nbsp;off&nbsp;a&nbsp;GenericRecord.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implement&nbsp;your&nbsp;own,&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;you&nbsp;want&nbsp;to&nbsp;<span style="color: #c678dd;line-height: 26px;">do</span>&nbsp;something&nbsp;other&nbsp;than&nbsp;overwriting<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;existing&nbsp;value<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;org.apache.hudi.OverwriteWithLatestAvroPayload<br  />&nbsp;&nbsp;&nbsp;&nbsp;--props<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;to&nbsp;properties&nbsp;file&nbsp;on&nbsp;localfs&nbsp;or&nbsp;dfs,&nbsp;with&nbsp;configurations&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hudi&nbsp;client,&nbsp;schema&nbsp;provider,&nbsp;key&nbsp;generator&nbsp;and&nbsp;data&nbsp;<span style="color: #e6c07b;line-height: 26px;">source</span>.&nbsp;For<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hudi&nbsp;client&nbsp;props,&nbsp;sane&nbsp;defaults&nbsp;are&nbsp;used,&nbsp;but&nbsp;recommend&nbsp;use&nbsp;to<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provide&nbsp;basic&nbsp;things&nbsp;like&nbsp;metrics&nbsp;endpoints,&nbsp;hive&nbsp;configs&nbsp;etc.&nbsp;For<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sources,&nbsp;referto&nbsp;individual&nbsp;classes,&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;supported&nbsp;properties.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;file:///Users/vinoth/bin/hoodie/src/<span style="color: #e6c07b;line-height: 26px;">test</span>/resources/delta-streamer-config/dfs-source.properties<br  />&nbsp;&nbsp;&nbsp;&nbsp;--schemaprovider-class<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subclass&nbsp;of&nbsp;org.apache.hudi.utilities.schema.SchemaProvider&nbsp;to&nbsp;attach<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schemas&nbsp;to&nbsp;input&nbsp;&amp;&nbsp;target&nbsp;table&nbsp;data,&nbsp;built&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;options:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FilebasedSchemaProvider<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;org.apache.hudi.utilities.schema.FilebasedSchemaProvider<br  />&nbsp;&nbsp;&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">source</span>-class<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subclass&nbsp;of&nbsp;org.apache.hudi.utilities.sources&nbsp;to&nbsp;<span style="color: #e6c07b;line-height: 26px;">read</span>&nbsp;data.&nbsp;Built-in<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options:&nbsp;org.apache.hudi.utilities.sources.{JsonDFSSource&nbsp;(default),<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AvroDFSSource,&nbsp;JsonKafkaSource,&nbsp;AvroKafkaSource,&nbsp;HiveIncrPullSource}<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;org.apache.hudi.utilities.sources.JsonDFSSource<br  />&nbsp;&nbsp;&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">source</span>-limit<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maximum&nbsp;amount&nbsp;of&nbsp;data&nbsp;to&nbsp;<span style="color: #e6c07b;line-height: 26px;">read</span>&nbsp;from&nbsp;<span style="color: #e6c07b;line-height: 26px;">source</span>.&nbsp;Default:&nbsp;No&nbsp;<span style="color: #e6c07b;line-height: 26px;">limit</span>&nbsp;For&nbsp;e.g:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DFSSource&nbsp;=&gt;&nbsp;max&nbsp;bytes&nbsp;to&nbsp;<span style="color: #e6c07b;line-height: 26px;">read</span>,&nbsp;KafkaSource&nbsp;=&gt;&nbsp;max&nbsp;events&nbsp;to&nbsp;<span style="color: #e6c07b;line-height: 26px;">read</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;9223372036854775807<br  />&nbsp;&nbsp;&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">source</span>-ordering-field<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Field&nbsp;within&nbsp;<span style="color: #e6c07b;line-height: 26px;">source</span>&nbsp;record&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;<span style="color: #e6c07b;line-height: 26px;">break</span>&nbsp;ties&nbsp;between&nbsp;records<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;same&nbsp;key&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;input&nbsp;data.&nbsp;Default:&nbsp;<span style="color: #98c379;line-height: 26px;">'ts'</span>&nbsp;holding&nbsp;unix&nbsp;timestamp&nbsp;of<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;record<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;ts<br  />&nbsp;&nbsp;&nbsp;&nbsp;--spark-master<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spark&nbsp;master&nbsp;to&nbsp;use.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;<span style="color: #e6c07b;line-height: 26px;">local</span>[2]<br  />&nbsp;&nbsp;*&nbsp;--target-base-path<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;path&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;the&nbsp;target&nbsp;Hudi&nbsp;dataset.&nbsp;(Will&nbsp;be&nbsp;created&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;did&nbsp;not<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exist&nbsp;first&nbsp;time&nbsp;around.&nbsp;If&nbsp;exists,&nbsp;expected&nbsp;to&nbsp;be&nbsp;a&nbsp;Hudi&nbsp;dataset)<br  />&nbsp;&nbsp;*&nbsp;--target-table<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;target&nbsp;table&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;Hive<br  />&nbsp;&nbsp;&nbsp;&nbsp;--transformer-class<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subclass&nbsp;of&nbsp;org.apache.hudi.utilities.transform.Transformer.&nbsp;UDF&nbsp;to<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transform&nbsp;raw&nbsp;<span style="color: #e6c07b;line-height: 26px;">source</span>&nbsp;dataset&nbsp;to&nbsp;a&nbsp;target&nbsp;dataset&nbsp;(conforming&nbsp;to&nbsp;target<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schema)&nbsp;before&nbsp;writing.&nbsp;Default&nbsp;:&nbsp;Not&nbsp;<span style="color: #e6c07b;line-height: 26px;">set</span>.&nbsp;E:g&nbsp;-<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.apache.hudi.utilities.transform.SqlQueryBasedTransformer&nbsp;(<span style="color: #e6c07b;line-height: 26px;">which</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allows&nbsp;a&nbsp;SQL&nbsp;query&nbsp;template&nbsp;to&nbsp;be&nbsp;passed&nbsp;as&nbsp;a&nbsp;transformation&nbsp;<span style="color: #c678dd;line-height: 26px;">function</span>)<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">该工具采用层次结构组成的属性文件，并具有可插拔的接口，用于提取数据、生成密钥和提供模式。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">从Kafka和DFS摄取数据的示例配置在这里：<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hudi-utilities/src/test/resources/delta-streamer-config</code>。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">例如：当您让Confluent Kafka、Schema注册表启动并运行后，可以用这个命令产生一些测试数据（impressions.avro，由schema-registry代码库提供）</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">[confluent-5.0.0]$&nbsp;bin/ksql-datagen&nbsp;schema=../impressions.avro&nbsp;format=avro&nbsp;topic=impressions&nbsp;key=impressionid<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">然后用如下命令摄取这些数据。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">[hoodie]$&nbsp;spark-submit&nbsp;--class&nbsp;org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer&nbsp;`ls&nbsp;packaging/hudi-utilities-bundle/target/hudi-utilities-bundle-*.jar`&nbsp;\<br  />&nbsp;&nbsp;--props&nbsp;file://<span style="color: #d19a66;line-height: 26px;">${PWD}</span>/hudi-utilities/src/<span style="color: #e6c07b;line-height: 26px;">test</span>/resources/delta-streamer-config/kafka-source.properties&nbsp;\<br  />&nbsp;&nbsp;--schemaprovider-class&nbsp;org.apache.hudi.utilities.schema.SchemaRegistryProvider&nbsp;\<br  />&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">source</span>-class&nbsp;org.apache.hudi.utilities.sources.AvroKafkaSource&nbsp;\<br  />&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">source</span>-ordering-field&nbsp;impresssiontime&nbsp;\<br  />&nbsp;&nbsp;--target-base-path&nbsp;file:///tmp/hudi-deltastreamer-op&nbsp;--target-table&nbsp;uber.impressions&nbsp;\<br  />&nbsp;&nbsp;--op&nbsp;BULK_INSERT<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在某些情况下，您可能需要预先将现有数据集迁移到Hudi。请参考迁移指南。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">Datasource Writer</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hudi-spark</code>模块提供了DataSource API，可以将任何数据帧写入（也可以读取）到Hudi数据集中。以下是在指定需要使用的字段名称的之后，如何插入更新数据帧的方法，这些字段包括<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">recordKey =&gt; _row_key、partitionPath =&gt; partition和precombineKey =&gt; timestamp</code></p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">inputDF.write()<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.options(clientOpts)&nbsp;//&nbsp;可以传入任何Hudi客户端参数<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY(),&nbsp;<span style="color: #98c379;line-height: 26px;">"_row_key"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY(),&nbsp;<span style="color: #98c379;line-height: 26px;">"partition"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY(),&nbsp;<span style="color: #98c379;line-height: 26px;">"timestamp"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(HoodieWriteConfig.TABLE_NAME,&nbsp;tableName)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.mode(SaveMode.Append)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.save(basePath);<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">与Hive同步</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">上面的两个工具都支持将数据集的最新模式同步到Hive Metastore，以便查询新的列和分区。如果需要从命令行或在独立的JVM中运行它，Hudi提供了一个<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">HiveSyncTool</code>，在构建了hudi-hive模块之后，可以按以下方式调用它。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #e6c07b;line-height: 26px;">cd</span>&nbsp;hudi-hive<br  />./run_sync_tool.sh<br  />&nbsp;[hudi-hive]$&nbsp;./run_sync_tool.sh&nbsp;--<span style="color: #e6c07b;line-height: 26px;">help</span><br  />Usage:&nbsp;&lt;main&nbsp;class&gt;&nbsp;[options]<br  />&nbsp;&nbsp;Options:<br  />&nbsp;&nbsp;*&nbsp;--base-path<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basepath&nbsp;of&nbsp;Hudi&nbsp;dataset&nbsp;to&nbsp;sync<br  />&nbsp;&nbsp;*&nbsp;--database<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;target&nbsp;database&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;Hive<br  />&nbsp;&nbsp;&nbsp;&nbsp;--<span style="color: #e6c07b;line-height: 26px;">help</span>,&nbsp;-h<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default:&nbsp;<span style="color: #56b6c2;line-height: 26px;">false</span><br  />&nbsp;&nbsp;*&nbsp;--jdbc-url<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hive&nbsp;jdbc&nbsp;connect&nbsp;url<br  />&nbsp;&nbsp;*&nbsp;--pass<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hive&nbsp;password<br  />&nbsp;&nbsp;*&nbsp;--table<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;target&nbsp;table&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;Hive<br  />&nbsp;&nbsp;*&nbsp;--user<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hive&nbsp;username<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">删除数据</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">通过允许用户指定不同的数据记录负载实现，Hudi支持对存储在Hudi数据集中的数据执行两种类型的删除。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Soft Deletes（软删除） ：使用软删除时，用户希望保留键，但仅使所有其他字段的值都为空。通过确保适当的字段在数据集模式中可以为空，并在将这些字段设置为null之后直接向数据集插入更新这些记录，即可轻松实现这一点。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Hard Deletes（硬删除） ：这种更强形式的删除是从数据集中彻底删除记录在存储上的任何痕迹。这可以通过触发一个带有自定义负载实现的插入更新来实现，这种实现可以使用总是返回Optional.Empty作为组合值的DataSource或DeltaStreamer。Hudi附带了一个内置的<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">org.apache.hudi.EmptyHoodieRecordPayload</code>类，它就是实现了这一功能。</section></li></ul><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">deleteDF&nbsp;//&nbsp;仅包含要删除的记录的数据帧<br  />&nbsp;&nbsp;&nbsp;.write().format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />&nbsp;&nbsp;&nbsp;.option(...)&nbsp;//&nbsp;根据设置需要添加HUDI参数，例如记录键、分区路径和其他参数<br  />&nbsp;&nbsp;&nbsp;//&nbsp;指定record_key，partition_key，precombine_fieldkey和常规参数<br  />&nbsp;&nbsp;&nbsp;.option(DataSourceWriteOptions.PAYLOAD_CLASS_OPT_KEY,&nbsp;<span style="color: #98c379;line-height: 26px;">"org.apache.hudi.EmptyHoodieRecordPayload"</span>)<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">存储管理</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi还对存储在Hudi数据集中的数据执行几个关键的存储管理功能。在DFS上存储数据的关键方面是管理文件大小和数量以及回收存储空间。例如，HDFS在处理小文件上性能很差，这会对Name Node的内存及RPC施加很大的压力，并可能破坏整个集群的稳定性。通常，查询引擎可在较大的列文件上提供更好的性能，因为它们可以有效地摊销获得列统计信息等的成本。即使在某些云数据存储上，列出具有大量小文件的目录也常常比较慢。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">以下是一些有效管理Hudi数据集存储的方法。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Hudi中的小文件处理功能，可以分析传入的工作负载并将插入内容分配到现有文件组中，而不是创建新文件组。新文件组会生成小文件。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">可以配置Cleaner来清理较旧的文件片，清理的程度可以调整，具体取决于查询所需的最长时间和增量拉取所需的回溯。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">用户还可以调整基础/parquet文件、日志文件的大小和预期的压缩率，使足够数量的插入被分到同一个文件组中，最终产生大小合适的基础文件。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">智能调整批插入并行度，可以产生大小合适的初始文件组。实际上，正确执行此操作非常关键，因为文件组一旦创建后就不能删除，只能如前所述对其进行扩展。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">对于具有大量更新的工作负载，读取时合并存储提供了一种很好的机制，可以快速将其摄取到较小的文件中，之后通过压缩将它们合并为较大的基础文件。</section></li></ul><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">3.查询Hudi：</span></h2><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">从概念上讲，Hudi物理存储一次数据到DFS上，同时在其上提供三个逻辑视图，如之前所述。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">数据集同步到Hive Metastore后，它将提供由Hudi的自定义输入格式支持的Hive外部表。一旦提供了适当的Hudi捆绑包，就可以通过Hive、Spark和Presto之类的常用查询引擎来查询数据集。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">具体来说，在写入过程中传递了两个由table name命名的Hive表。例如，如果table name = hudi_tbl，我们得到</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">hudi_tbl 实现了由 HoodieParquetInputFormat 支持的数据集的读优化视图，从而提供了纯列式数据。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">hudi_tbl_rt 实现了由 HoodieParquetRealtimeInputFormat 支持的数据集的实时视图，从而提供了基础数据和日志数据的合并视图。</p></section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如概念部分所述，增量处理所需要的一个关键原语是增量拉取（以从数据集中获取更改流/日志）。您可以增量提取Hudi数据集，这意味着自指定的即时时间起，您可以只获得全部更新和新行。这与插入更新一起使用，对于构建某些数据管道尤其有用，包括将1个或多个源Hudi表（数据流/事实）以增量方式拉出（流/事实）并与其他表（数据集/维度）结合以写出增量到目标Hudi数据集。增量视图是通过查询上表之一实现的，并具有特殊配置，该特殊配置指示查询计划仅需要从数据集中获取增量数据。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">接下来，我们将详细讨论在每个查询引擎上如何访问所有三个视图。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">Hive</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">为了使Hive能够识别Hudi数据集并正确查询，HiveServer2需要在其辅助jars路径中提供<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hudi-hadoop-mr-bundle-x.y.z-SNAPSHOT.jar</code>。这将确保输入格式类及其依赖项可用于查询计划和执行。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>读优化表 {#hive-ro-view}</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">除了上述设置之外，对于beeline cli访问，还需要将<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hive.input.format</code>变量设置为<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">org.apache.hudi.hadoop.HoodieParquetInputFormat</code>输入格式的完全限定路径名。对于Tez，还需要将<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hive.tez.input.format</code>设置为<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">org.apache.hadoop.hive.ql.io.HiveInputFormat</code>。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>实时表 {#hive-rt-view}</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">除了在HiveServer2上安装Hive捆绑jars之外，还需要将其放在整个集群的hadoop/hive安装中，这样查询也可以使用自定义RecordReader。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>增量拉取 {#hive-incr-pull}</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">HiveIncrementalPuller</code>允许通过HiveQL从大型事实/维表中增量提取更改， 结合了Hive（可靠地处理复杂的SQL查询）和增量原语的好处（通过增量拉取而不是完全扫描来加快查询速度）。该工具使用Hive JDBC运行hive查询并将其结果保存在临时表中，这个表可以被插入更新。Upsert实用程序（<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">HoodieDeltaStreamer</code>）具有目录结构所需的所有状态，以了解目标表上的提交时间应为多少。例如：<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">/app/incremental-hql/intermediate/{source_table_name}_temp/{last_commit_included}。已注册的Delta Hive表的格式为{tmpdb}.{source_table}_{last_commit_included}</code>。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">以下是HiveIncrementalPuller的配置选项</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>| 配置 | 描述 | 默认值 |</strong> |hiveUrl| 要连接的Hive Server 2的URL | | |hiveUser| Hive Server 2 用户名 | | |hivePass| Hive Server 2 密码 | | |queue| YARN 队列名称 | | |tmp| DFS中存储临时增量数据的目录。目录结构将遵循约定。请参阅以下部分。| | |extractSQLFile| 在源表上要执行的提取数据的SQL。提取的数据将是自特定时间点以来已更改的所有行。| | |sourceTable| 源表名称。在Hive环境属性中需要设置。| | |targetTable| 目标表名称。中间存储目录结构需要。| | |sourceDataPath| 源DFS基本路径。这是读取Hudi元数据的地方。| | |targetDataPath| 目标DFS基本路径。这是计算fromCommitTime所必需的。如果显式指定了fromCommitTime，则不需要设置这个参数。| | |tmpdb| 用来创建中间临时增量表的数据库 | hoodie_temp | |fromCommitTime| 这是最重要的参数。这是从中提取更改的记录的时间点。| | |maxCommits| 要包含在拉取中的提交数。将此设置为-1将包括从fromCommitTime开始的所有提交。将此设置为大于0的值，将包括在fromCommitTime之后仅更改指定提交次数的记录。如果您需要一次赶上两次提交，则可能需要这样做。| 3 | |help| 实用程序帮助 | |
设置fromCommitTime=0和maxCommits=-1将提取整个源数据集，可用于启动Backfill。如果目标数据集是Hudi数据集，则该实用程序可以确定目标数据集是否没有提交或延迟超过24小时（这是可配置的），它将自动使用Backfill配置，因为增量应用最近24小时的更改会比Backfill花费更多的时间。该工具当前的局限性在于缺乏在混合模式（正常模式和增量模式）下自联接同一表的支持。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>关于使用Fetch任务执行的Hive查询的说明</strong>：由于Fetch任务为每个分区调用InputFormat.listStatus()，每个listStatus()调用都会列出Hoodie元数据。为了避免这种情况，如下操作可能是有用的，即使用Hive session属性对增量查询禁用Fetch任务：<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">set hive.fetch.task.conversion = none</code>;。这将确保Hive查询使用Map Reduce执行， 合并分区（用逗号分隔），并且对所有这些分区仅调用一次InputFormat.listStatus()。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">Spark</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Spark可将Hudi jars和捆绑包轻松部署和管理到作业/笔记本中。简而言之，通过Spark有两种方法可以访问Hudi数据集。</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">Hudi DataSource：支持读取优化和增量拉取，类似于标准数据源（例如：spark.read.parquet）的工作方式。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">以Hive表读取：支持所有三个视图，包括实时视图，依赖于自定义的Hudi输入格式（再次类似Hive）。</p></section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">通常，您的spark作业需要依赖hudi-spark或hudi-spark-bundle-x.y.z.jar， 它们必须位于驱动程序和执行程序的类路径上（提示：使用--jars参数）。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>读优化表 {#spark-ro-view}</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">要使用SparkSQL将RO表读取为Hive表，只需按如下所示将路径过滤器推入sparkContext。对于Hudi表，该方法保留了Spark内置的读取Parquet文件的优化功能，例如进行矢量化读取。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">spark.sparkContext.hadoopConfiguration.setClass(<span style="color: #98c379;line-height: 26px;">"mapreduce.input.pathFilter.class"</span>,&nbsp;classOf[org.apache.hudi.hadoop.HoodieROTablePathFilter],&nbsp;classOf[org.apache.hadoop.fs.PathFilter]);<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如果您希望通过数据源在DFS上使用全局路径，则只需执行以下类似操作即可得到Spark数据帧。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">Dataset&lt;Row&gt;&nbsp;hoodieROViewDF&nbsp;=&nbsp;spark.read().format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />//&nbsp;pass&nbsp;any&nbsp;path&nbsp;glob,&nbsp;can&nbsp;include&nbsp;hudi&nbsp;&amp;&nbsp;non-hudi&nbsp;datasets<br  />.load(<span style="color: #98c379;line-height: 26px;">"/glob/path/pattern"</span>);<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>实时表 {#spark-rt-view}</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">当前，实时表只能在Spark中作为Hive表进行查询。为了做到这一点，设置<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">spark.sql.hive.convertMetastoreParquet = false</code>， 迫使Spark回退到使用Hive Serde读取数据（计划/执行仍然是Spark）。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">$&nbsp;spark-shell&nbsp;--jars&nbsp;hudi-spark-bundle-x.y.z-SNAPSHOT.jar&nbsp;--driver-class-path&nbsp;/etc/hive/conf&nbsp;&nbsp;--packages&nbsp;com.databricks:spark-avro_2.11:4.0.0&nbsp;--conf&nbsp;spark.sql.hive.convertMetastoreParquet=<span style="color: #56b6c2;line-height: 26px;">false</span>&nbsp;--num-executors&nbsp;10&nbsp;--driver-memory&nbsp;7g&nbsp;--executor-memory&nbsp;2g&nbsp;&nbsp;--master&nbsp;yarn-client<br  /><br  />scala&gt;&nbsp;sqlContext.sql(<span style="color: #98c379;line-height: 26px;">"select&nbsp;count(*)&nbsp;from&nbsp;hudi_rt&nbsp;where&nbsp;datestr&nbsp;=&nbsp;'2016-10-02'"</span>).show()<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>增量拉取 {#spark-incr-pull}</strong></p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hudi-spark</code>模块提供了DataSource API，这是一种从Hudi数据集中提取数据并通过Spark处理数据的更优雅的方法。如下所示是一个示例增量拉取，它将获取自<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">beginInstantTime</code>以来写入的所有记录。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">Dataset&lt;Row&gt;&nbsp;hoodieIncViewDF&nbsp;=&nbsp;spark.read()<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(DataSourceReadOptions.VIEW_TYPE_OPT_KEY(),<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataSourceReadOptions.VIEW_TYPE_INCREMENTAL_OPT_VAL())<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(DataSourceReadOptions.BEGIN_INSTANTTIME_OPT_KEY(),<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;beginInstantTime&gt;)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.load(tablePath);&nbsp;//&nbsp;For&nbsp;incremental&nbsp;view,&nbsp;pass&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;the&nbsp;root/base&nbsp;path&nbsp;of&nbsp;dataset<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">请参阅设置部分，以查看所有数据源选项。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">另外，HoodieReadClient通过Hudi的隐式索引提供了以下功能。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>| API | 描述</strong> | | read(keys) | 使用Hudi自己的索通过快速查找将与键对应的数据作为DataFrame读出 | | filterExists() | 从提供的RDD[HoodieRecord]中过滤出已经存在的记录。对删除重复数据有用 | | checkExists(keys) | 检查提供的键是否存在于Hudi数据集中 |</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;">Presto</h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Presto是一种常用的查询引擎，可提供交互式查询性能。Hudi RO表可以在Presto中无缝查询。这需要在整个安装过程中将<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hudi-presto-bundle jar放入&lt;presto_install&gt;/plugin/hive-hadoop2/中</code>。</p><h2 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: inline-block;background: rgb(239, 112, 96);color: rgb(255, 255, 255);padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">4.Hudi常见问题：</span></h2><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">1. ApacheHudi对个人和组织何时有用</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如果你希望将数据快速提取到HDFS或云存储中，Hudi可以提供帮助。另外，如果你的ETL /hive/spark作业很慢或占用大量资源，那么Hudi可以通过提供一种增量式读取和写入数据的方法来提供帮助。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">作为一个组织，Hudi可以帮助你构建高效的数据湖，解决一些最复杂的底层存储管理问题，同时将数据更快地交给数据分析师，工程师和科学家。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">2. Hudi不打算达成的目标</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi不是针对任何OLTP案例而设计的，在这些情况下，通常你使用的是现有的NoSQL / RDBMS数据存储。Hudi无法替代你的内存分析数据库（至少现在还没有！）。Hudi支持在几分钟内实现近乎实时的摄取，从而权衡了延迟以进行有效的批处理。如果确实希望亚-分钟处理延迟，请使用你最喜欢的流处理解决方案。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">3. 什么是增量处理？为什么Hudi一直在谈论它</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">增量处理是由Vinoth Chandar在O'reilly博客中首次引入的，博客中阐述了大部分工作。用纯粹的技术术语来说，增量处理仅是指以流处理方式编写微型批处理程序。典型的批处理作业每隔几个小时就会消费所有输入并重新计算所有输出。典型的流处理作业会连续/每隔几秒钟消费一些新的输入并重新计算新的/更改以输出。尽管以批处理方式重新计算所有输出可能会更简单，但这很浪费并且耗费昂贵的资源。Hudi具有以流方式编写相同批处理管道的能力，每隔几分钟运行一次。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">虽然可将其称为流处理，但我们更愿意称其为增量处理，以区别于使用Apache Flink，Apache Apex或Apache Kafka Streams构建的纯流处理管道。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">4. 写时复制（COW）与读时合并（MOR）存储类型之间有什么区别</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">写时复制（Copy On Write）：此存储类型使客户端能够以列式文件格式（当前为parquet）摄取数据。使用COW存储类型时，任何写入Hudi数据集的新数据都将写入新的parquet文件。更新现有的行将导致重写整个parquet文件（这些parquet文件包含要更新的受影响的行）。因此，所有对此类数据集的写入都受parquet写性能的限制，parquet文件越大，摄取数据所花费的时间就越长。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">读时合并（Merge On Read）：此存储类型使客户端可以快速将数据摄取为基于行（如avro）的数据格式。使用MOR存储类型时，任何写入Hudi数据集的新数据都将写入新的日志/增量文件，这些文件在内部将数据以avro进行编码。压缩（Compaction）过程（配置为嵌入式或异步）将日志文件格式转换为列式文件格式（parquet）。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">两种不同的格式提供了两种不同视图（读优化视图和实时视图），读优化视图取决于列式parquet文件的读取性能，而实时视图取决于列式和/或日志文件的读取性能。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">更新现有的行将导致：a）写入从以前通过压缩（Compaction）生成的基础parquet文件对应的日志/增量文件更新；或b）在未进行压缩的情况下写入日志/增量文件的更新。因此，对此类数据集的所有写入均受avro /日志文件写入性能的限制，其速度比parquet快得多（写入时需要复制）。虽然，与列式（parquet）文件相比，读取日志/增量文件需要更高的成本（读取时需要合并）。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">5. 如何为工作负载选择存储类型</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi的主要目标是提供更新功能，该功能比重写整个表或分区要快几个数量级。如果满足以下条件，则选择写时复制（COW）存储：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">寻找一种简单的替换现有的parquet表的方法，而无需实时数据。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">当前的工作流是重写整个表/分区以处理更新，而每个分区中实际上只有几个文件发生更改。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">想使操作更为简单（无需压缩等），并且摄取/写入性能仅受parquet文件大小以及受更新影响文件数量限制</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">工作流很简单，并且不会突然爆发大量更新或插入到较旧的分区。COW写入时付出了合并成本，因此，这些突然的更改可能会阻塞摄取，并干扰正常摄取延迟目标。</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如果满足以下条件，则选择读时合并（MOR）存储：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">希望数据尽快被摄取并尽可能快地可被查询。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">工作负载可能会突然出现模式的峰值/变化（例如，对上游数据库中较旧事务的批量更新导致对DFS上旧分区的大量更新）。异步压缩（Compaction）有助于缓解由这种情况引起的写放大，而正常的提取则需跟上上游流的变化。</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">不管选择何种存储，Hudi都将提供：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">快照隔离和原子写入批量记录</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">增量拉取</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">重复数据删除能力</section></li></ul><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">6. Hudi是分析型数据库吗</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">典型的数据库有一些长时间运行的服务器，以便提供读写服务。Hudi的体系结构与之不同，它高度解耦读写，为对应扩容挑战可以独立扩展写入和查询/读取。因此，它可能并不总是像数据库一样。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">尽管如此，Hudi的设计非常像数据库，并提供类似的功能（更新，更改捕获）和语义（事务性写入，快照隔离读取）。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">7. 如何对存储在Hudi中的数据建模</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在将数据写入Hudi时，可以像在键-值存储上那样对记录进行建模：指定键字段（对于单个分区/整个数据集是唯一的），分区字段（表示要放置键的分区）和preCombine/combine逻辑（用于指定如何处理一批写入记录中的重复记录）。该模型使Hudi可以强制执行主键约束，就像在数据库表上一样。请参阅此处的示例。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">当查询/读取数据时，Hudi只是将自己显示为一个类似于json的层次表，每个人都习惯于使用Hive/Spark/Presto 来对Parquet/Json/Avro进行查询。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">8. Hudi是否支持云存储/对象存储</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">一般来说，Hudi能够在任何Hadoop文件系统实现上提供该功能，因此可以在Cloud Store（Amazon S3或Microsoft Azure或Google Cloud Storage）上读写数据集。Hudi还进行了特定的设计，使在云上构建Hudi数据集变得非常容易，例如S3的一致性检查，数据文件涉及的零移动/重命名。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">9. Hudi支持Hive/Spark/Hadoop的哪些版本</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">从2019年9月开始，Hudi可以支持Spark 2.1 +，Hive 2.x，Hadoop 2.7+（非Hadoop 3）。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">10. Hudi如何在数据集中实际存储数据</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">从更高层次上讲，Hudi基于MVCC设计，将数据写入parquet/基本文件以及包含对基本文件所做更改的日志文件的不同版本。所有文件都以数据集的分区模式存储，这与Apache Hive表在DFS上的布局方式非常相似。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">11. 如何写入Hudi数据集</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">通常，你会从源获取部分更新/插入，然后对Hudi数据集执行写入操作。如果从其他标准来源（如Kafka或tailf DFS）中提取数据，那么DeltaStreamer将会非常有用，其提供了一种简单的自我管理解决方案，可将数据写入Hudi。你还可以自己编写代码，使用Spark数据源API从自定义源获取数据，并使用Hudi数据源写入Hudi。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">12. 如何部署Hudi作业</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">写入Hudi的好处是它可以像在YARN/Mesos甚至是K8S群集上运行的任何其他Spark作业一样运行。只需使用Spark UI即可查看写入操作，而无需单独搭建Hudi集群。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">13. 如何查询刚写入的Hudi数据集</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">除非启用了Hive同步，否则与其他任何源一样，通过上述方法写入Hudi的数据集可以简单地通过Spark数据源进行查询。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">val&nbsp;hoodieROView&nbsp;=spark.read.format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>).load(basePath&nbsp;+<span style="color: #98c379;line-height: 26px;">"/path/to/partitions/*"</span>)<br  />val&nbsp;hoodieIncViewDF&nbsp;=spark.read().format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(DataSourceReadOptions.VIEW_TYPE_OPT_KEY(),&nbsp;DataSourceReadOptions.VIEW_TYPE_INCREMENTAL_OPT_VAL())<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.option(DataSourceReadOptions.BEGIN_INSTANTTIME_OPT_KEY(),&nbsp;&lt;beginInstantTime&gt;)<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.load(basePath);<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><strong>请注意</strong>：当前不支持从Spark数据源读取实时视图。请使用下面的Hive路径。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如果在deltastreamer工具或数据源中启用了Hive Sync，则该数据集会同步到Hive的几张表中，可以使用HiveQL，Presto或SparkSQL进行读取。点击这里查看更多。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">14. Hudi如何处理输入中的重复记录</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在数据集上执行 upsert操作时，提供的记录包含给定键的多条记录，然后通过重复调用有效负载类的 preCombine方法将所有记录合并为一个最终值。默认情况下会选择最大值的记录（由 compareTo决定）。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">对于 insert或 bulk_insert操作，不执行 preCombine。因此，如果你的输入包含重复项，则数据集也将包含重复项。如果您不希望重复的记录，请使用upsert或在数据源或deltastreamer中指定删除重复数据的配置项。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">15. 可以实现自定义合并逻辑处理输入记录和存储的记录吗</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">与上面类似，定义有效负载类定义的方法（combineAndGetUpdateValue()，getInsertValue()），这些方法控制如何将存储的记录与输入的更新/插入组合以生成最终值以写回到存储中。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">16. 如何删除数据集中的记录</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">GDPR使删除成为数据管理工具箱中的必备工具。Hudi支持软删除和硬删除。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">17. 如何将数据迁移到Hudi</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi对迁移提供了内置支持，可使用 hudi-cli提供的 HDFSParquetImporter工具将整个数据集一次性写入Hudi。也可以使用Spark数据源API读取和写入数据集。迁移后，可以使用此处讨论的常规方法执行写操作。这里也详细讨论该问题，包括部分迁移的方法。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">18. 如何将Hudi配置传递给Spark作业</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这里涵盖了数据源和Hudi写入客户端（deltastreamer和数据源都会内部调用）的配置项。在DeltaStreamer之类的工具上调用 --help都会打印所有使用选项。许多控制 upsert、调整文件大小的选项是在客户端级别定义的，下面是将它们传递给可用于写数据配置项的方式。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">1). 对于Spark DataSource，可以使用DataFrameWriter的 options API来传递这些配置项。</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">inputDF.write().format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />&nbsp;&nbsp;.options(clientOpts)//&nbsp;any&nbsp;of&nbsp;the&nbsp;Hudi&nbsp;client&nbsp;opts&nbsp;can&nbsp;be&nbsp;passed&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;as&nbsp;well<br  />&nbsp;&nbsp;.option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY(),<span style="color: #98c379;line-height: 26px;">"_row_key"</span>)<br  />&nbsp;&nbsp;...<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">2). 直接使用HoodieWriteClient时，只需使用配置来构造HoodieWriteConfig对象。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">3). 使用HoodieDeltaStreamer工具提取时，可以在属性文件中设置配置项，并将该文件作为命令行参数 --props传递。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">19. 可以在Apache Hive Metastore中注册Hudi数据集吗</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以， 可以通过独立的Hive Sync工具或使用deltastreamer工具或数据源中的选项来执行此操作。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">20. Hudi索引的工作原理及其好处是什么</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">索引是Hudi写入的关键部分，它始终将给定的 recordKey映射到Hudi内部的文件组（ FileGroup）。这样可以更快地识别受给定写入操作影响的文件组。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi支持以下几种索引配置</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">HoodieBloomIndex（默认）：使用bloom过滤器和范围信息，并在parquet/基础文件（不久后的日志文件也支持）的页脚中放置该信息。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">HoodieGlobalBloomIndex：默认索引仅在单个分区内强制执行键的唯一性，即要求用户知道存储给定记录键的分区。这可以帮助非常大的数据集很好地建立索引。但是，在某些情况下，可能需要在所有分区上执行重复数据删除/强制唯一性操作，这就需要全局索引。如果使用此选项，则将传入记录与整个数据集中的文件进行比较，并确保仅在一个分区中存在 recordKey。</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">HBaseIndex：Apache HBase是一个键值存储，可以将索引存储在HBase内，如果已经在使用HBase，这将会非常方便。</p></section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">也可以自定义索引，需要实现HoodieIndex类并在配置中配置索引类名称。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">21. Hudi Cleaner是做什么的</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi Cleaner（清理程序）通常在 commit和 deltacommit之后立即运行，删除不再需要的旧文件。如果在使用增量拉取功能，请确保配置了清理项来保留足够数量的commit(提交)，以便可以回退，另一个考虑因素是为长时间运行的作业提供足够的时间来完成运行。否则，Cleaner可能会删除该作业正在读取或可能被其读取的文件，并使该作业失败。通常，默认配置为10会允许每30分钟运行一次提取，以保留长达5（10 * 0.5）个小时的数据。如果以繁进行摄取，或者为查询提供更多运行时间，可增加 <code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">hoodie.cleaner.commits.retained</code>配置项的值。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">22. Hudi的模式演进（schema evolution）是什么</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi使用 <code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Avro</code>作为记录的内部表示形式，这主要是由于其良好的架构兼容性和演进特性。这也是摄取或ETL管道保持可靠的关键所在。只要传递给Hudi的模式（无论是在<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">DeltaStreamer</code>显示提供还是由<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">SparkDatasource</code>的<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">Dataset</code>模式隐式）向后兼容（例如不删除任何字段，仅追加新字段），Hudi将无缝处理新旧数据的的读/写操作并会保持Hive模式为最新。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">23. 如何压缩（compaction）MOR数据集</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在MOR数据集上进行压缩的最简单方法是运行内联压缩（compaction inline），但需要花费更多时间。通常情况下，当有少量的迟到数据落入旧分区时，这可能特别有用，在这种情况下，你可能想压缩最后的N个分区，同时等待较旧的分区积累足够的日志。其最终会将大多数最新数据转化查询优化的列格式，即从日志log文件转化为parquet文件。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">还可异步运行压缩，这可以通过单独压缩任务来完成。如果使用的是 DeltaStreamer，则可以在连续模式下运行压缩，在该模式下，会在单个spark任务内同时进行摄取和压缩。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">24. Hudi写入的性能/最大延迟</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">写入Hudi的速度在写入操作以及在调整文件大小做了权衡。就像数据库在磁盘上的直接/原始文件产生I/O开销一样，与读取/写入原始DFS文件或支持数据库之类的功能相比，Hudi可能会产生开销。Hudi采用了数据库文献中的技术，以使这些开销最少，具体可参考下表。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="1.116" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/9_XjvUia2k9KG4YdaU9NbHvzXavVyMFQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1CEe6Wh86Vf4yxKIhWRmgEH3QTnXjvUia2k9KG4YdaU9NbHvzXavVyMFQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="750" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">与许多管理时间序列数据的系统一样，如果键具有时间戳前缀或单调增加/减少，则Hudi的性能会更好，而我们几乎总是可以实现这一目标。即便是UUID密钥，也可以按照以下技巧来获得有序的密钥另请参阅调优指南以获取有关JVM和其他配置的更多提示。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">25. Hudi读取/查询的性能</h5><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">对于读优化视图（Read optimized views)，可以达到Hive/Spark/Presto的parquet表相同的查询性能。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">对于增量视图（ Incremental views），相对于全表扫描所花费的时间，速度更快。例如，如果在最后一个小时中，在1000个文件的分区中仅更改了100个文件，那么与完全扫描该分区以查找新数据相比，使用Hudi中的增量拉取可以将速度提高10倍。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">对于实时视图（Real time views），性能类似于Hive/Spark/Presto中Avro格式的表。</section></li></ul><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">26. 如何避免创建大量小文件</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi的一项关键设计是避免创建小文件，并且始终写入适当大小的文件，其会在摄取/写入上花费更多时间以保持查询的高效。写入非常小的文件然后进行合并的方法只能解决小文件带来的系统可伸缩性问题，其无论如何都会因为小文件而降低查询速度。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">执行插入更新/插入操作时，Hudi可以配置文件大小。（注意：bulk_insert操作不提供此功能，其设计为用来替代 <code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">spark.write.parquet</code>。）</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">对于写时复制，可以配置基本/parquet文件的最大大小和软限制，小于限制的为小文件。Hudi将在写入时会尝试将足够的记录添加到一个小文件中，以使其达到配置的最大限制。例如，对于 <code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">compactionSmallFileSize=100MB</code>和 <code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">limitFileSize=120MB</code>，Hudi将选择所有小于100MB的文件，并尝试将其增加到120MB。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">对于读时合并，几乎没有其他配置。可以配置最大日志大小和一个因子，该因子表示当数据从avro转化到parquet文件时大小减小量。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;"><code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">HUDI-26</code>将较小的文件组合并成较大的文件组，从而提升提升性能。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">27. 如何使用DeltaStreamer或Spark DataSource API写入未分区的Hudi数据集</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hudi支持写入未分区数据集。如果要写入未分区的Hudi数据集并执行配置单元表同步，需要在传递的属性中设置以下配置：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">hoodie.datasource.write.keygenerator.class=org.apache.hudi.NonpartitionedKeyGenerator<br  />&nbsp;<br  />hoodie.datasource.hive_sync.partition_extractor_class=org.apache.hudi.hive.NonPartitionedExtractor<br  /></code></pre><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">28. 为什么必须进行两种不同的配置才能使Spark与Hudi配合使用</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">非Hive引擎倾向于自己列举DFS上的文件来查询数据集。例如，Spark直接从文件系统（HDFS或S3）读取路径。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Spark调用如下：</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">org.apache.spark.rdd.NewHadoopRDD.getPartitions</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">org.apache.parquet.hadoop.ParquetInputFormat.getSplits</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">org.apache.hadoop.mapreduce.lib.input.FileInputFormat.getSplits</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在不了解Hudi的文件布局的情况下，引擎只会简单地读取所有parquet文件并显示结果，这样结果中可能会出现大量的重复项。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">有两种方法可以配置查询引擎来正确读取Hudi数据集</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">A) 调用<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">HoodieParquetInputFormat#getSplits</code>和<code style="font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">HoodieParquetInputFormat#getRecordReader</code>方法</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">Hive原生就会执行此操作，因为InputFormat是Hive中插入表格式的抽象。HoodieParquetInputFormat扩展了MapredParquetInputFormat，其是hive的一种输入格式，将Hudi表注册到Hive metastore中。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">当使用 UseFileSplitsFromInputFormat注解时，Presto会使用输入格式来获取分片，然后继续使用自己的优化/矢量化parquet读取器来查询写时复制表。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">可以使用 --conf spark.sql.hive.convertMetastoreParquet=false将Spark强制回退到 HoodieParquetInputFormat类。</section></li></ul><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">B) 使引擎调用路径过滤器（path filter）或其他方式来直接调用Hudi类来过滤DFS上的文件并挑选最新的文件切片</p><ul data-tool="mdnice编辑器" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">即使我们可以强制Spark回退到使用InputFormat类，但这样做可能会失去使用Spark的parquet读取器的能力。</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">为保持parquet文件读取性能的优势，我们将 HoodieROTablePathFilter设置为路径过滤器，并在Spark 的Hadoop Configuration中指定，确保始终选择Hudi相关文件的文件夹（路径）或文件的最新文件片。这将过滤出重复的条目并显示每个记录的最新条目。</section></li></ul><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;">29. 已有数据集，如何使用部分数据来评估Hudi</h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以将该数据的一部分批量导入到新的hudi表中。例如一个月的数据</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">spark.read.parquet(<span style="color: #98c379;line-height: 26px;">"your_data_set/path/to/month"</span>)<br  />&nbsp;<br  />.write.format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />&nbsp;<br  />.option(<span style="color: #98c379;line-height: 26px;">"hoodie.datasource.write.operation"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"bulk_insert"</span>)<br  />&nbsp;<br  />.option(<span style="color: #98c379;line-height: 26px;">"hoodie.datasource.write.storage.type"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"storage_type"</span>)&nbsp;//&nbsp;COPY_ON_WRITE&nbsp;or&nbsp;MERGE_ON_READ<br  />&nbsp;<br  />.option(RECORDKEY_FIELD_OPT_KEY,&nbsp;<span style="color: #98c379;line-height: 26px;">"&lt;your&nbsp;key&gt;"</span>).<br  />&nbsp;<br  />.option(PARTITIONPATH_FIELD_OPT_KEY,&nbsp;<span style="color: #98c379;line-height: 26px;">"&lt;your_partition&gt;"</span>)<br  />&nbsp;<br  />...<br  />&nbsp;<br  />.mode(SaveMode.Append)<br  />&nbsp;<br  />.save(basePath);<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">一旦有初始副本后，就可选择一些数据样本进行更新插入操作</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">spark.read.parquet(<span style="color: #98c379;line-height: 26px;">"your_data_set/path/to/month"</span>).<span style="color: #e6c07b;line-height: 26px;">limit</span>(n)&nbsp;//&nbsp;Limit&nbsp;n&nbsp;records<br  />&nbsp;<br  />.write.format(<span style="color: #98c379;line-height: 26px;">"org.apache.hudi"</span>)<br  />&nbsp;<br  />.option(<span style="color: #98c379;line-height: 26px;">"hoodie.datasource.write.operation"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"upsert"</span>)<br  />&nbsp;<br  />.option(RECORDKEY_FIELD_OPT_KEY,&nbsp;<span style="color: #98c379;line-height: 26px;">"&lt;your&nbsp;key&gt;"</span>).<br  />&nbsp;<br  />.option(PARTITIONPATH_FIELD_OPT_KEY,&nbsp;<span style="color: #98c379;line-height: 26px;">"&lt;your_partition&gt;"</span>)<br  />&nbsp;<br  />...<br  />&nbsp;<br  />.mode(SaveMode.Append)<br  />&nbsp;<br  />.save(basePath);<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">对于读取的表的合并，若还需要调度和运行压缩（compaction）任务。则可以使用 spark sumbit直接提交 org.apache.hudi.utilities.HoodieCompactor运行压缩，也可以使用HUDI CLI运行压缩。</p></section><p style="text-align: left;"><br  /></p><p style="text-align: left;"><span style="font-size: 15px;"><span mp-original-font-size="15" mp-original-line-height="28" style="outline: 0px;color: rgb(74, 74, 74);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;text-size-adjust: auto;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);line-height: 24.5px;">如果这个文章对你有帮助，不要忘记&nbsp;</span><span mp-original-font-size="15" mp-original-line-height="28" style="outline: 0px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;text-size-adjust: auto;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);color: rgb(255, 104, 39);line-height: 24.5px;"><strong mp-original-font-size="15" mp-original-line-height="26.25" style="outline: 0px;line-height: 22.9688px;">「在看」</strong>&nbsp;<strong mp-original-font-size="15" mp-original-line-height="26.25" style="outline: 0px;line-height: 22.9688px;">「点赞」</strong>&nbsp;<strong mp-original-font-size="15" mp-original-line-height="26.25" style="outline: 0px;line-height: 22.9688px;">「收藏」</strong></span><span mp-original-font-size="15" mp-original-line-height="28" style="outline: 0px;color: rgb(74, 74, 74);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;text-size-adjust: auto;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);line-height: 24.5px;">&nbsp;三连啊喂！</span></span></p><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.4662576687116564" data-s="300,640" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/10_zCTCyeGSzibY39x8MxxcHlRIvZtibw.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1Czemq1a4M6pIJ5zdicA7HQNw2NjnzCTCyeGSzibY39x8MxxcHlRIvZtibw/640?wx_fmt=jpeg'" data-type="jpeg" data-w="978" style=""></p><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.10979228486646884" data-s="300,640" src="图片/大数据技术与架构_2022-05-17_「Hudi系列」Hudi查询&写入&常见问题汇总/11_1o3oK2301FDJxy5fetz247JhYaFARA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/UdK9ByfMT2NtfvawWKB5Vf5xqXo0uz1CkTlGTtmujr40Y1y1iaTxrQcibj1o3oK2301FDJxy5fetz247JhYaFARA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style=""  /></p><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;letter-spacing: 0.544px;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">互联网最坏的时代可能真的来了</span></a><br mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;line-height: 34.125px;"  /></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">我在B站读大学，大数据专业</span></a><br mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;line-height: 34.125px;"  /></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">我们在学习Flink的时候，到底在学习什么？</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;letter-spacing: 0.544px;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">193篇文章暴揍Flink，这个合集你需要关注一下</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;letter-spacing: 0.544px;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;letter-spacing: 0.544px;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">我们在学习Spark的时候，到底在学习什么？</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;letter-spacing: 0.544px;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">在所有Spark模块中，我愿称SparkSQL为最强！</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">硬刚Hive | 4万字基础调优面试小总结</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">数据治理方法论和实践小百科全书</span></a><br mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;line-height: 34.125px;"  /></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">标签体系下的用户画像建设小指南</span></a><br mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;line-height: 34.125px;"  /></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" hasload="1" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解</span></a><br mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;line-height: 34.125px;"  /></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</span></a></section><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;white-space: normal;text-size-adjust: auto;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">我写过的关于成长/面试/职场进阶的文章</span></a></section><section mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;color: rgb(34, 34, 34);font-size: 14.875px;white-space: normal;text-size-adjust: auto;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);line-height: 23.625px;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;"><section mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;"><section data-role="outer" label="Powered by 135editor.com" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;"><section data-tools="135编辑器" data-id="98469" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;"><section hm_fix="349:393" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;"><section mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 11.375px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 34.125px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="13" mp-original-line-height="39" style="outline: 0px;cursor: pointer;line-height: 34.125px;font-size: 13px;"><span style="font-size: 13px;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</span></a></section></section></section></section></section></section></section></section></content>
</div>
</body>
</html>