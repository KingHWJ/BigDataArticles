<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„","title":"Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦","time":"2022-06-29 11:54:32","timeStamp":"1656474872"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247514160&idx=1&sn=4676361efd9e5ea00a8df569a838180b&chksm=fd3efea5ca4977b3713939f5cc583364538d47322c2d954526838afd6a5dbd7ca9092cdffd7e#rd" target="_blank">Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">é­ç¥š&amp;é™ˆæ˜é›¨&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2022-06-29 11:54:32</em></div><content><div class="topic"><p>æ”¶å½•äºè¯é¢˜</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU3MzgwNTU2Mg==&action=getalbum&album_id=1369031183400747008#wechat_redirect" title="å¤§æ•°æ®æˆç¥ä¹‹è·¯" target="_blank">#å¤§æ•°æ®æˆç¥ä¹‹è·¯</a></p></div><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" style="padding-right: 10px;padding-left: 10px;max-width: 100%;white-space: normal;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;line-height: 1.6;letter-spacing: 0.034em;color: rgb(63, 63, 63);font-size: 16px;overflow-wrap: break-word !important;box-sizing: border-box !important;margin-bottom: 0px;" data-mpa-powered-by="yiban.io"><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" style="padding-right: 10px;padding-left: 10px;max-width: 100%;line-height: 1.6;letter-spacing: 0.034em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;outline: 0px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 14px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="font-size: 14px;"><span style="max-width: 100%;outline: 0px;font-kerning: none;overflow-wrap: break-word !important;box-sizing: border-box !important;">ç‚¹å‡»ä¸Šæ–¹</span><strong style="max-width: 100%;outline: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="max-width: 100%;outline: 0px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;line-height: normal;font-kerning: none;color: rgb(87, 107, 148);-webkit-text-stroke-color: rgb(87, 107, 148);overflow-wrap: break-word !important;box-sizing: border-box !important;">è“è‰²å­—ä½“</span></strong><span style="max-width: 100%;outline: 0px;font-kerning: none;overflow-wrap: break-word !important;box-sizing: border-box !important;">ï¼Œé€‰æ‹©â€œè®¾ä¸ºæ˜Ÿæ ‡â€</span></span></section><section style="max-width: 100%;outline: 0px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 14px;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="font-size: 14px;"><span style="max-width: 100%;outline: 0px;font-kerning: none;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;">å›å¤"</span><strong style="max-width: 100%;outline: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="max-width: 100%;outline: 0px;font-kerning: none;background-color: rgb(255, 255, 255);color: rgb(255, 0, 0);overflow-wrap: break-word !important;box-sizing: border-box !important;">é¢è¯•"</span></strong><span style="max-width: 100%;outline: 0px;font-kerning: none;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;">è·å–æ›´å¤šæƒŠå–œ</span></span></section><section style="max-width: 100%;outline: 0px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 14px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;color: rgb(178, 178, 178);overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="max-width: 100%;outline: 0px;font-kerning: none;background-color: rgb(255, 255, 255);font-size: 14px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.0625" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/1_TMnLIpBq96wT1ibdccSSd3LVdSE3LQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/sq2uE6cicHYxoldXibjHyWbvjJfI6ibEm5Kw715uVJTBLdX1gkVpExwlFh22TMnLIpBq96wT1ibdccSSd3LVdSE3LQ/640?wx_fmt=png'" data-type="png" data-w="640" style="outline: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;width: 640px !important;visibility: visible !important;"  /><span style="font-size: 11.375px;letter-spacing: 0.544px;"></span></span></section><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;color: rgb(34, 34, 34);font-size: 14.875px;font-style: normal;font-variant-caps: normal;font-weight: normal;orphans: auto;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: auto;word-spacing: 0px;-webkit-text-size-adjust: auto;-webkit-text-stroke-width: 0px;letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 23.625px;visibility: visible;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-role="outer" label="Powered by 135editor.com" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tools="135ç¼–è¾‘å™¨" data-id="98469" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25" style="margin: 0px;padding: 0px 10px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;font-size: 14px;color: black;line-height: 21.875px;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><blockquote data-tool="mdniceç¼–è¾‘å™¨" mp-original-font-size="14.399999618530273" mp-original-line-height="23" style="margin: 20px 0px;padding: 10px 10px 10px 20px;outline: 0px;border-left-width: 3px;border-style: none none none solid;border-left-color: rgb(239, 112, 96);color: rgb(106, 115, 125);font-size: 12.59999966621399px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;line-height: 20.125px;overflow: auto;background-color: rgb(255, 249, 249);visibility: visible;"><p mp-original-font-size="16" mp-original-line-height="26" style="margin: 0px;padding: 8px 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;clear: both;min-height: 1em;font-size: 14px;color: black;line-height: 22.75px;visibility: visible;"><img class="rich_pages wxw-img" data-ratio="1" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/2_vBcv0y1XsD2G4eGzwpWDB5zJ7WsXTw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/sq2uE6cicHYx7hRPkpj6kFISkZddB66TXddALsPHrNIMH29kxdMKMeBDdvBcv0y1XsD2G4eGzwpWDB5zJ7WsXTw/640?wx_fmt=png'" data-type="png" data-w="20" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;vertical-align: text-bottom;height: auto !important;-webkit-text-stroke-color: rgb(178, 178, 178);color: rgb(178, 178, 178);font-family: &quot;Helvetica Neue&quot;;font-size: 10.71875px;letter-spacing: 0.544px;display: inline-block;visibility: visible !important;width: 20px !important;line-height: 19.90625px;"  /><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;visibility: visible;line-height: 19.9062px;font-size: 13px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong mp-original-font-size="15" mp-original-line-height="42" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;-webkit-text-stroke-color: rgb(178, 178, 178);font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;text-align: center;visibility: visible;line-height: 36.75px;font-size: 13.125px;"><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247512011&amp;idx=1&amp;sn=68aaa9c5c42e2087d56d170c442b30ba&amp;scene=21#wechat_redirect" textvalue="ğŸ˜„è½»æˆ³æœ‰æƒŠå–œï¼šå…«è‚¡æ–‡æ•™ç»™æˆ‘ï¼Œâ€ä½ ä»¬ä¸“å¿ƒåˆ·é¢˜å’Œé¢è¯•" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2" wah-hotarea="click" mp-original-font-size="14" mp-original-line-height="22.75" style="margin: 0px;padding: 0px;outline: 0px;color: rgb(87, 107, 149);text-decoration: none;cursor: pointer;max-width: 100%;visibility: visible;line-height: 19.9062px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span mp-original-font-size="13.125" mp-original-line-height="16.493200302124023" style="font-size: 13px;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;cursor: pointer;visibility: visible;line-height: 14.4316px;letter-spacing: 0.544px;color: rgb(255, 76, 0);box-sizing: border-box !important;overflow-wrap: break-word !important;">å…¨ç½‘æœ€å…¨å¤§æ•°æ®é¢è¯•æå‡æ‰‹å†Œï¼</span></a></strong></span></p></blockquote></section></section></section></section></section></section></section><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding: 0 10px;line-height: 1.6;word-spacing: 0px;letter-spacing: 0px;word-break: break-word;word-wrap: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &#39;PingFang SC&#39;, Cambria, Cochin, Georgia, Times, &#39;Times New Roman&#39;, serif;"><h2 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;font-weight: bold;background: rgb(239, 112, 96);color: #ffffff;padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">Doris Compactionæœºåˆ¶è§£æ</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>1. æ€»ä½“æ¶æ„<span style="display: none;"></span></h4><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>1.1 â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compactionæœºåˆ¶è¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚ä½•é€‰å–åˆé€‚çš„Tabletè¿›è¡ŒCompactionã€‚Dorisçš„compactionæœºåˆ¶é‡‡ç”¨â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€ï¼ˆproducer-consumerï¼‰æ¨¡å¼ï¼Œç”±producerçº¿ç¨‹æŒç»­ç”Ÿäº§compactionä»»åŠ¡ï¼Œå¹¶å°†ç”Ÿäº§å‡ºçš„compactionä»»åŠ¡æäº¤ç»™compactionçº¿ç¨‹æ± è¿›è¡Œæ¶ˆè´¹æ‰§è¡Œï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4325581395348837" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/3_J2MARQZxqzxUUf2B1dm0vQFgn9zw9Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8A610Jo8zzLnGbjBwF8dv2rVUbJ2MARQZxqzxUUf2B1dm0vQFgn9zw9Q/640?wx_fmt=png'" data-type="png" data-w="860" style="display: block;margin: 0 auto;max-width: 100%;"><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">1. compactionæœºåˆ¶çš„â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼ç¤ºæ„å›¾</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Doris BEå¯åŠ¨æ—¶ï¼Œä¼šåœ¨åå°å¯åŠ¨ä¸€ä¸ªcompaction producerçº¿ç¨‹ï¼ŒåŒæ—¶ä¼šåˆ›å»ºä¸€ä¸ªcompactionçº¿ç¨‹æ± ã€‚producerçº¿ç¨‹æŒç»­åœ°ç”Ÿäº§compactionä»»åŠ¡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨ä¸€è½®ä»»åŠ¡ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œä¼šä»æ¯ä¸ªç£ç›˜å„é€‰æ‹©å‡ºä¸€ä¸ªtabletæ‰§è¡Œcompactionä»»åŠ¡ã€‚å¦‚æœcompactionçº¿ç¨‹æ± ä¸­æŸä¸ªç£ç›˜çš„compactionä»»åŠ¡æ•°è¾¾åˆ°äº†ä¸Šé™ï¼ˆé€šè¿‡compaction_task_num_per_diské…ç½®ï¼Œé»˜è®¤å€¼ä¸º2ï¼‰ï¼Œåˆ™è¿™ä¸€è½®ä»»åŠ¡ç”Ÿäº§ä¼šè·³è¿‡è¯¥ç£ç›˜ã€‚å¦‚æœæŸä¸€è½®ç”Ÿäº§è¿‡ç¨‹ä»æ‰€æœ‰ç£ç›˜å‡æ²¡æœ‰ç”Ÿäº§å‡ºcompactionä»»åŠ¡ï¼ˆå³compactionçº¿ç¨‹æ± ä¸­æ¯ä¸ªç£ç›˜çš„ä»»åŠ¡æ•°éƒ½å·²è¾¾åˆ°ä¸Šé™ï¼‰ï¼Œåˆ™producerçº¿ç¨‹ä¼šè¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œç›´åˆ°2ç§’è¶…æ—¶å”¤é†’ï¼Œæˆ–çº¿ç¨‹æ± ä¸­æŸä¸ªcompactionä»»åŠ¡æ‰§è¡Œå®Œæˆè¢«å”¤é†’ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨ä¸€è½®compactionä»»åŠ¡ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œè¿›è¡Œå•ä¸ªç£ç›˜çš„ä»»åŠ¡ç”Ÿäº§æ—¶ï¼Œéœ€è¦éå†BEèŠ‚ç‚¹ä¸Šæ‰€æœ‰çš„tabletï¼Œé¦–å…ˆè¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„tabletï¼Œæ¯”å¦‚ï¼šå…¶ä»–ç£ç›˜ä¸Šçš„tabletã€å·²ç»æäº¤ç»™compactionçº¿ç¨‹æ± çš„tabletã€æ­£åœ¨æ‰§è¡Œalteræ“ä½œçš„tabletã€åˆå§‹åŒ–å¤±è´¥çš„tabletã€ä¸Šæ¬¡compactionä»»åŠ¡å¤±è´¥è·ç¦»å½“å‰æ—¶åˆ»çš„æ—¶é—´é—´éš”å°äºè®¾å®šé˜ˆå€¼ï¼ˆé€šè¿‡min_compaction_failure_interval_secé…ç½®ï¼Œé»˜è®¤å€¼ä¸º600ç§’ï¼‰çš„tabletï¼Œç„¶åä»å‰©ä½™çš„æ»¡è¶³æ¡ä»¶çš„tabletä¸­é€‰æ‹©tablet scoreæœ€é«˜çš„tabletæ‰§è¡Œcompactionä»»åŠ¡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">tablet scoreé€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">ablet_score = k1 * scan_frequency + k2 * compaction_score</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å…¶ä¸­ï¼Œk1å’Œk2åˆ†åˆ«å¯ä»¥é€šè¿‡å‚æ•°compaction_tablet_scan_frequency_factorï¼ˆé»˜è®¤å€¼ä¸º0ï¼‰å’Œå‚æ•°compaction_tablet_compaction_score_factorï¼ˆé»˜è®¤å€¼ä¸º1ï¼‰åŠ¨æ€é…ç½®ã€‚scan_frequency è¡¨ç¤ºtabletå½“å‰ä¸€æ®µæ—¶é—´çš„scané¢‘ç‡ã€‚compaction scoreçš„è®¡ç®—æ–¹æ³•ä¼šåœ¨æœ¬æ–‡çš„åé¢è¿›è¡Œè¯¦ç»†åœ°ä»‹ç»ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¯ä»¥é€šè¿‡å‚æ•°generate_compaction_tasks_min_interval_msåŠ¨æ€é…ç½®ä»»åŠ¡ç”Ÿäº§çš„é¢‘ç‡ï¼Œé»˜è®¤å€¼ä¸º10msï¼Œå³æ¯ç”Ÿäº§ä¸€è½®compactionä»»åŠ¡ï¼Œproducerçº¿ç¨‹ä¼šä¼‘çœ 10msã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¯ä»¥é€šè¿‡å‚æ•°cumulative_compaction_rounds_for_each_base_compaction_roundåŠ¨æ€é…ç½®cumulative compactionå’Œbase compactionçš„ç”Ÿäº§å‘¨æœŸï¼Œé»˜è®¤å€¼ä¸º9ï¼Œå³æ¯ç”Ÿäº§9è½®cumulative compactionä»»åŠ¡ï¼Œç„¶åä¼šç”Ÿäº§1è½®base compactionä»»åŠ¡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¯ä»¥é€šè¿‡å‚æ•°disable_auto_compactionåŠ¨æ€é…ç½®æ˜¯å¦å…³é—­compaction producerçš„ä»»åŠ¡ç”Ÿäº§ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼Œå³ä¸å…³é—­producerçš„ä»»åŠ¡ç”Ÿäº§ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>1.2 permissionæœºåˆ¶<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">producerç”Ÿäº§å‡ºçš„compactionä»»åŠ¡éœ€è¦æäº¤ç»™compactionçº¿ç¨‹æ± æ‰§è¡Œã€‚ä¸ºäº†è°ƒèŠ‚BEèŠ‚ç‚¹compactionçš„å†…å­˜ä½¿ç”¨é‡ï¼ŒDoriså¢åŠ äº†å¯¹compactionä»»åŠ¡æäº¤çš„permissionæœºåˆ¶ï¼Œå¦‚å›¾2æ‰€ç¤ºã€‚ç³»ç»Ÿç»´æŒä¸€å®šæ•°é‡çš„compaction permitsï¼ˆé€šè¿‡å‚æ•°total_permits_for_compaction_scoreé…ç½®ï¼‰ï¼Œæ¯ä¸€ä¸ªcompactionä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± ä¹‹å‰éƒ½éœ€è¦å‘ç³»ç»Ÿç”³è¯·permitsï¼ˆpermits requestï¼‰ï¼Œåªæœ‰è·å¾—ç³»ç»Ÿåˆ†é…çš„permitsä¹‹åä»»åŠ¡æ‰èƒ½è¢«æäº¤ç»™compactionçº¿ç¨‹æ± ï¼Œcompactionä»»åŠ¡åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œç»“æŸä¹‹åéœ€è¦å°†è‡ªå·±æŒæœ‰permitså½’è¿˜ç»™ç³»ç»Ÿï¼ˆpermits releaseï¼‰ã€‚å¦‚æœç³»ç»Ÿå½“å‰å‰©ä½™çš„å¯åˆ†é…çš„compaction permitsæ•°é‡å°äºæœ¬æ¬¡compactionä»»åŠ¡éœ€è¦çš„permitsæ•°é‡ï¼Œåˆ™æœ¬æ¬¡ä»»åŠ¡æäº¤ä¼šè¢«é˜»å¡ï¼ˆcompactionä»»åŠ¡æäº¤æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œå…¶ä»–éœ€è¦æäº¤çš„ä»»åŠ¡ä¹Ÿä¼šè¢«é˜»å¡ï¼‰ï¼Œç›´åˆ°æœ‰å…¶ä»–compactionä»»åŠ¡æ‰§è¡Œç»“æŸå¹¶é‡Šæ”¾permitsï¼Œä½¿å¾—ç³»ç»Ÿæœ‰è¶³å¤Ÿæ•°é‡çš„permitsåˆ†é…ç»™å½“å‰compactionä»»åŠ¡ã€‚å¦‚æœæŸä¸€ä¸ªcompactionä»»åŠ¡éœ€è¦çš„permitsæ•°é‡è¶…è¿‡ç³»ç»Ÿç»´æŒçš„permitsæ€»æ•°ï¼Œåˆ™å…è®¸å½“çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„ä»»åŠ¡éƒ½æ‰§è¡Œç»“æŸä¹‹åï¼Œå°†è¯¥compactionä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± æ‰§è¡Œã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="1.2361111111111112" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/4_SKibyUXnqKyQI9aZuu0xStWZz1mYWQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8ANw1wXfHfJHKqbQtSeia7GkUicib9SKibyUXnqKyQI9aZuu0xStWZz1mYWQ/640?wx_fmt=png'" data-type="png" data-w="864" style="display: block;margin: 0 auto;max-width: 100%;"><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">2. compactionä»»åŠ¡æäº¤çš„permissionæœºåˆ¶</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Dorisä¸­å•ä¸ªcompactionä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å†…å­˜ä½¿ç”¨é‡ä¸æœ¬æ¬¡compactionä»»åŠ¡åˆå¹¶çš„segmentæ–‡ä»¶æ•°é‡æœ‰å…³ã€‚ä¸€ä¸ªrowsetä¼šåŒ…å«å¤šä¸ªsegmentæ–‡ä»¶ï¼Œè€Œä¸€ä¸ªcompactionä»»åŠ¡å¯èƒ½åŒ…å«å¤šä¸ªrowsetã€‚å› æ­¤ï¼Œä½¿ç”¨compactionä»»åŠ¡ä¸­éœ€è¦åˆå¹¶çš„segmentæ–‡ä»¶æ•°é‡ä½œä¸ºcompactionä»»åŠ¡çš„permitsã€‚é€šè¿‡è°ƒæ•´ç³»ç»Ÿç»´æŒçš„compaction permitsæ€»é‡å¯ä»¥å¯¹BEèŠ‚ç‚¹compactionçš„å†…å­˜ä½¿ç”¨é‡è¿›è¡Œè°ƒèŠ‚ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compactionä»»åŠ¡å¯ä»¥æ¦‚æ‹¬ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šcompaction preparationå’Œcompaction executionï¼Œå¦‚å›¾3æ‰€ç¤ºã€‚compaction preparationé˜¶æ®µä¸»è¦æ˜¯ä»tabletä¸­é€‰å‡ºéœ€è¦è¿›è¡Œç‰ˆæœ¬åˆå¹¶çš„rowsetsï¼Œcompaction executioné˜¶æ®µä¸»è¦è¿›è¡Œrowsetsçš„ç‰ˆæœ¬åˆå¹¶æ“ä½œã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.3321976149914821" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/5_pu7tibyQUQ2rwMr3YbACnlJ48Ua5rw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8APict1IPOQDiaIqjzyTom3xkTJrhpu7tibyQUQ2rwMr3YbACnlJ48Ua5rw/640?wx_fmt=png'" data-type="png" data-w="587" style="display: block;margin: 0 auto;max-width: 100%;"  /><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">3. compactionä»»åŠ¡çš„ä¸¤é˜¶æ®µåˆ’åˆ†ç¤ºæ„å›¾</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨Dorisä¸­ï¼Œcompactionä»»åŠ¡çš„preparationé˜¶æ®µåœ¨permits requestä¹‹å‰æ‰§è¡Œï¼Œä»tabletä¸­é€‰å‡ºéœ€è¦è¿›è¡Œç‰ˆæœ¬åˆå¹¶çš„rowsetsï¼Œé€šè¿‡éœ€è¦åˆå¹¶çš„segmentæ–‡ä»¶æ•°é‡è®¡ç®—compaction permitsã€‚compactionä»»åŠ¡çš„executioné˜¶æ®µä¼šçœŸæ­£åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œè¿›è¡Œç‰ˆæœ¬çš„åˆå¹¶ï¼Œå¦‚å›¾4æ‰€ç¤ºã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.33449074074074076" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/6_jM9qo9ib39RPdicAyFRzTgnN9O3IXQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8A8bRog7jkMWSLzZeuk18E0AtaN7jM9qo9ib39RPdicAyFRzTgnN9O3IXQ/640?wx_fmt=png'" data-type="png" data-w="864" style="display: block;margin: 0 auto;max-width: 100%;"  /><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">4. compactionä»»åŠ¡çš„æäº¤æ‰§è¡Œç¤ºæ„å›¾</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compactionä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± ä¹‹åï¼Œå¯èƒ½ä¼šåœ¨çº¿ç¨‹æ± çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…è¾ƒé•¿çš„æ—¶é—´éƒ½æ²¡æœ‰è¢«è°ƒåº¦ï¼Œå½“å‰tabletåœ¨è¿™æœŸé—´å¯èƒ½å‘ç”Ÿè¿‡cloneæ“ä½œï¼Œå¯¼è‡´compaction preparationé˜¶æ®µé€‰å‡ºçš„éœ€è¦è¿›è¡Œç‰ˆæœ¬åˆå¹¶çš„rowsetå‘ç”Ÿäº†æ”¹å˜ï¼Œå› æ­¤ï¼Œåœ¨compaction executioné˜¶æ®µä¸€å¼€å§‹éœ€è¦åˆ¤æ–­ä»»åŠ¡ç­‰å¾…è°ƒåº¦æœŸé—´tabletæ˜¯å¦å‘ç”Ÿè¿‡cloneæ“ä½œï¼Œå¦‚æœå‘ç”Ÿè¿‡cloneæ“ä½œï¼Œåˆ™æœ¬æ¬¡compactionä»»åŠ¡é€€å‡ºï¼Œå¦åˆ™ï¼Œæ­£å¸¸æ‰§è¡Œrowsetsçš„åˆå¹¶ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Dorisä¹Ÿæä¾›äº†httpæ¥å£ï¼Œæ”¯æŒæ‰‹åŠ¨è§¦å‘å•ä¸ªtabletçš„cumulative compactionæˆ–base compactionã€‚</p><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>2. Cumulative Compaction<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Dorisçš„cumulative compactionæ¯æ¬¡ä¼šåœ¨cumulative pointä¹‹åé€‰æ‹©ç›¸é‚»çš„æ•°ä¸ªrowsetè¿›è¡Œåˆå¹¶ï¼Œä¸»è¦åŒ…å«5ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯è®¡ç®—cumulative pointã€ç”Ÿæˆcandidate rowsetsã€é€‰æ‹©input rowsetsã€æ‰§è¡Œrowsetsåˆå¹¶ä»¥åŠæ›´æ–°cumulative pointï¼Œå¦‚å›¾1ã€‚å…¶ä¸­ï¼Œå‰é¢ä¸‰ä¸ªæ­¥éª¤å±äºcompaction preparationé˜¶æ®µï¼Œåé¢ä¸¤ä¸ªæ­¥éª¤å±äºcompaction executioné˜¶æ®µã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.14930555555555555" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/7_LibmpC7cGZNjj2zse2ibLMDgNBqHEA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8A8RWVuaQWXZYW7FmjYtHhu72xCrLibmpC7cGZNjj2zse2ibLMDgNBqHEA/640?wx_fmt=png'" data-type="png" data-w="864" style="display: block;margin: 0 auto;max-width: 100%;"  /><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">1. cumulative compactionæ‰§è¡Œæµç¨‹å›¾</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç›®å‰å¯ä¾›é€‰æ‹©çš„cumulative compactionç­–ç•¥æœ‰ä¸¤ç§ï¼šnum_based cumulative compactionå’Œsize_based cumulative compactionã€‚cumulative compactionçš„ç­–ç•¥é€‰æ‹©å¯ä»¥é€šè¿‡å‚æ•°cumulative_compaction_policyè¿›è¡Œé…ç½®ï¼ˆé»˜è®¤ä¸ºsize_basedï¼‰ã€‚num_based cumulative compactionæ˜¯åŸºäºrowsetçš„æ–‡ä»¶æ•°é‡è¿›è¡Œcompactionçš„é€‰æ‹©ï¼Œè¯¥ç­–ç•¥ä¼šåœ¨åé¢çš„ç‰ˆæœ¬ä¸­è¢«ä¸¢å¼ƒã€‚Size_based cumulative compactionç­–ç•¥é€šè¿‡è®¡ç®—æ¯ä¸ªrowsetçš„å¤§å°æ¥å†³å®šcompactionçš„é€‰æ‹©ï¼Œå¯ä»¥æ˜¾è‘—åœ°å‡å°‘å†™æ”¾å¤§çš„ç³»æ•°ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä¸‹é¢å°†è¯¦ç»†åœ°å¯¹size_based cumulative compactionç­–ç•¥è¿›è¡Œä»‹ç»ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2.1 &nbsp;è®¡ç®—cumulative point<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç‰ˆæœ¬å·æ¯”cumulative pointå°çš„rowsetä»…ä¼šæ‰§è¡Œbase compactionï¼Œè€Œç‰ˆæœ¬å·æ¯”cumulative pointå¤§çš„rowsetä»…ä¼šæ‰§è¡Œcumulutive compactionã€‚å°†ä¸€ä¸ªrowsetä»cumulative ä¾§ç§»åŠ¨åˆ°baseä¾§ï¼ˆå³å¢å¤§cumulative pointï¼‰çš„è¡Œä¸ºç§°ä¸ºä¸€æ¬¡Promotionã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœtabletå½“å‰çš„cumulative pointå€¼ä¸º-1ï¼ˆåˆå§‹å€¼ï¼‰ï¼Œåˆ™æœ¬æ¬¡è®¡ç®—çš„cumulative pointå€¼ä¸å˜ï¼Œä»ä¸º-1ï¼›å¦åˆ™ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œè¿›è¡Œcumulative pointçš„è®¡ç®—ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ1ï¼‰ å¯¹tabletä¸‹æ‰€æœ‰çš„rowsetæŒ‰ç…§ç‰ˆæœ¬å…ˆåè¿›è¡Œæ’åºï¼›</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ2ï¼‰ Dorisä¼šé€šè¿‡è®¡ç®—promotion sizeæ¥å†³å®šæ˜¯å¦è¦å¯¹ä¸€ä¸ªrowsetæ‰§è¡ŒPromotionã€‚æ ¹æ®base rowsetï¼ˆstart versionä¸º0ï¼‰çš„å¤§å°è®¡ç®—tabletå½“å‰çš„promotion_sizeï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">promotion_size = base_rowset_size * ratio</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å…¶ä¸­ï¼Œratioå€¼å¯ä»¥é€šè¿‡cumulative_size_based_promotion_ratioé…ç½®ï¼Œé»˜è®¤å€¼ä¸º0.05ã€‚promotion_sizeè¢«é™å®šåœ¨cumulative_size_based_promotion_size_mbytesï¼ˆé»˜è®¤å€¼ä¸º1024MBï¼‰ä¸cumulative_size_based_promotion_min_size_mbytesï¼ˆé»˜è®¤å€¼ä¸º64MBï¼‰ä¹‹é—´ï¼Œpromotion sizeçš„è®¡ç®—æµç¨‹å¦‚å›¾2æ‰€ç¤ºã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6967592592592593" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/8_gichiaMe50b30BcmoGJ26GNGRLY3cg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8A8TWNBO8tpW7ia9SCiazW35bne9N9gichiaMe50b30BcmoGJ26GNGRLY3cg/640?wx_fmt=png'" data-type="png" data-w="864" style="display: block;margin: 0 auto;max-width: 100%;"  /><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">2. promotion sizeçš„è®¡ç®—æµç¨‹å›¾</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ3ï¼‰ä»base rowsetå¼€å§‹ï¼Œä¾æ¬¡éå†æ¯ä¸€ä¸ªrowsetï¼Œå½“é‡åˆ°ä»¥ä¸‹æƒ…å†µï¼Œåˆ™åœæ­¢éå†ï¼Œæ›´æ–°tabletçš„cumulative pointï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">a.å½“å‰rowsetä¸å‰ä¸€ä¸ªrowsetä¹‹é—´å‡ºç°ç‰ˆæœ¬ç¼ºå¤±ï¼Œåˆ™æ›´æ–°cumulative pointä¸ºå‰ä¸€ä¸ªrowsetçš„end_version+1ï¼›</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">b.å½“å‰rowsetä¸æ˜¯æ•°æ®åˆ é™¤ç‰ˆæœ¬ï¼ŒåŒæ—¶å½“å‰rowsetæ²¡æœ‰å‘ç”Ÿè¿‡ç‰ˆæœ¬åˆå¹¶ï¼Œæˆ–å½“å‰rowsetä¸­çš„segmentæ–‡ä»¶ä¹‹é—´å­˜åœ¨overlappingï¼Œåˆ™æ›´æ–°cumulative pointä¸ºå½“å‰rowsetçš„start_versionï¼›</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">c.å½“å‰rowsetä¸æ˜¯æ•°æ®åˆ é™¤ç‰ˆæœ¬ï¼ŒåŒæ—¶å½“å‰rowsetçš„å¤§å°å°äºpromotion_sizeï¼Œåˆ™æ›´æ–°cumulative pointä¸ºå½“å‰rowsetçš„start_versionã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2.2 &nbsp;ç”Ÿæˆcandidate rowsets<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä¾æ¬¡éå†tabletä¸­æŒ‰ç…§ç‰ˆæœ¬å…ˆåæ’åºå¥½çš„æ¯ä¸€ä¸ªrowsetï¼Œå¦‚æœæŸä¸€ä¸ªrowsetçš„ç‰ˆæœ¬ä½äºcumulative pointä¹‹åï¼›å¹¶ä¸”è¯¥rowsetçš„åˆ›å»ºæ—¶é—´è·ç¦»å½“å‰æ—¶åˆ»è¶…è¿‡è®¾å®šçš„æ—¶é—´é—´éš”ï¼ˆå¯ä»¥é€šè¿‡cumulative_compaction_skip_window_secondsé…ç½®ï¼Œé»˜è®¤å€¼ä¸º30ç§’ï¼‰ï¼Œæˆ–è€…è¯¥rowsetå‚ä¸è¿‡ç‰ˆæœ¬åˆå¹¶ï¼ˆrowsetçš„start_versionä¸end_versionä¸ç›¸ç­‰ï¼‰ï¼Œåˆ™å°†è¯¥rowsetä½œä¸ºä¸€ä¸ªå€™é€‰rowsetã€‚å°†æ‰€æœ‰å€™é€‰rowsetä¾æ¬¡ä¿å­˜åœ¨å‘é‡candidate rowsetsä¸­ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2.3 &nbsp;é€‰æ‹©input rowsets<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ1ï¼‰å¯»æ‰¾candidate rowsetsä¸­æœ€å¤§çš„è¿ç»­ç‰ˆæœ¬åºåˆ—ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">éå†candidate rowsetsä¸­çš„æ¯ä¸€ä¸ªrowsetï¼Œå¦‚æœæŸä¸¤ä¸ªç›¸é‚»çš„rowsetä¹‹é—´å‡ºç°ç‰ˆæœ¬ç¼ºå¤±ï¼Œåˆ™å°†candidate rowsetsä¸­ç¬¬ä¸€ä¸ªç¼ºå¤±ç‰ˆæœ¬ä¹‹å‰çš„æ‰€æœ‰rowsetä½œä¸ºæ–°çš„candidate rowsetsï¼›</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ2ï¼‰ç”Ÿæˆinput rowsetsã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">éå†candidate rowsetsä¸­çš„æ¯ä¸€ä¸ªrowsetï¼Œå°†è®¿é—®å®Œæˆçš„rowsetä¿å­˜åœ¨å‘é‡input rowsetsä¸­ï¼Œå½“é‡åˆ°ä»¥ä¸‹æƒ…å†µï¼Œéå†ç»“æŸï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">a.æŸä¸€ä¸ªrowsetä¸ºæ•°æ®åˆ é™¤ç‰ˆæœ¬ï¼ˆå¹¶ä½¿ç”¨last_delete_versionè®°å½•å½“å‰æ•°æ®åˆ é™¤ç‰ˆæœ¬ï¼Œlast_delete_versionåˆå§‹å€¼ä¸º-1ï¼‰ï¼Œå¹¶ä¸”input rowsetsä¸­çš„rowsetæ•°é‡ä¸ä¸º0ï¼ˆå¦‚æœinput rowsetsä¸­çš„rowsetæ•°é‡ä¸º0ï¼Œåˆ™è·³è¿‡å½“å‰rowsetï¼Œç»§ç»­è®¿é—®ä¸‹ä¸€ä¸ªrowsetï¼‰ï¼›</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">b.input rowsetsä¸­çš„rowset scoreï¼ˆè¡¨ç¤ºrowsetä¸­çš„segmentæ–‡ä»¶æ•°ç›®ï¼‰ä¹‹å’Œè¾¾åˆ°ä¸Šé™é˜ˆå€¼ï¼ˆé€šè¿‡max_cumulative_compaction_num_singleton_deltasé…ç½®ï¼Œé»˜è®¤å€¼ä¸º1000ï¼‰ï¼›</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">c.éå†è¿‡ç¨‹æ­£å¸¸å®Œæˆï¼Œinput rowsetsä¸­åŒ…å«äº†candidate rowsetsä¸­æ‰€æœ‰çš„rowsetã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ3ï¼‰è°ƒæ•´input rowsetsã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">a.å¦‚æœinput rowsetsä¸­æ‰€æœ‰çš„rowsetå¤§å°ä¹‹å’Œè¾¾åˆ°promotion_sizeï¼Œåˆ™ä¸éœ€è¦è°ƒæ•´input rowsetsã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">b.å¦‚æœå­˜åœ¨æ•°æ®åˆ é™¤ç‰ˆæœ¬çš„è®°å½•ï¼ˆlast_delete_version ä¸ä¸º-1ï¼Œå³ç”Ÿæˆinput rowsetsçš„éå†è¿‡ç¨‹å› ä¸ºå­˜åœ¨åˆ é™¤æ•°æ®ç‰ˆæœ¬è€Œç»“æŸï¼‰ï¼Œå¹¶ä¸”input rowsetsä¸­çš„rowsetæ•°é‡ä¸ä¸º1ï¼Œåˆ™ä¸éœ€è¦è°ƒæ•´input rowsetsï¼›å¦‚æœå­˜åœ¨æ•°æ®åˆ é™¤ç‰ˆæœ¬çš„è®°å½•ï¼Œå¹¶ä¸”input rowsetsä¸­çš„rowsetæ•°é‡ä¸º1ï¼ŒåŒæ—¶è¯¥rowsetä¸­çš„segmentæ–‡ä»¶ä¹‹é—´å­˜åœ¨overlappingï¼Œåˆ™ä¸éœ€è¦è°ƒæ•´input rowsetsï¼›å¦‚æœå­˜åœ¨æ•°æ®åˆ é™¤ç‰ˆæœ¬çš„è®°å½•ï¼Œå¹¶ä¸”input rowsetsä¸­çš„rowsetæ•°é‡ä¸º1ï¼ŒåŒæ—¶è¯¥rowsetä¸­çš„segmentæ–‡ä»¶ä¹‹é—´ä¸å­˜åœ¨overlappingï¼Œåˆ™æ¸…ç©ºinput rowsetsã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">c.å¦‚æœä¸å­˜åœ¨æ•°æ®åˆ é™¤ç‰ˆæœ¬çš„è®°å½•ï¼ˆlast_delete_version ä¸º-1ï¼‰ï¼Œåˆ™éå†input rowsetsä¸­çš„rowsetã€‚ä»ç¬¬ä¸€ä¸ªrowsetå¼€å§‹ï¼Œè®¡ç®—å½“å‰rowsetçš„å¤§å°ç­‰çº§ï¼ˆcurrent_levelï¼‰ï¼ŒåŒæ—¶è®¡ç®—input rowsetsä¸­é™¤å½“å‰rowsetä¹‹å¤–çš„å…¶ä»–rowsetå¤§å°ä¹‹å’Œçš„ç­‰çº§ï¼ˆremain_levelï¼‰ï¼Œå¦‚æœcurrent_level &gt; remain_levelï¼Œåˆ™ä»input rowsetsä¸­åˆ é™¤å½“å‰rowsetï¼Œå¦åˆ™ï¼Œåœæ­¢éå†ã€‚</p><blockquote data-tool="mdniceç¼–è¾‘å™¨" style="border-top: none;border-right: none;border-bottom: none;display: block;font-size: 0.9em;overflow: auto;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0px;color: black;line-height: 26px;">ã€æ³¨ã€‘levelç­‰çº§åˆ’åˆ†ç”±å‚æ•°cumulative_size_based_promotion_size_mbytes ï¼ˆé»˜è®¤å€¼ä¸º1024MBï¼‰å’Œcumulative_size_based_compaction_lower_size_mbytes ï¼ˆé»˜è®¤å€¼ä¸º64MBï¼‰ç¡®å®šã€‚æœ€é«˜çš„levelå€¼ä¸ºcumulative_size_based_promotion_size_mbytes / 2ï¼Œä¸‹ä¸€çº§levelå€¼ä¸ºä¸Šä¸€çº§levelå€¼çš„1/2ï¼Œç›´åˆ°levelå€¼å°äºcumulative_size_based_compaction_lower_size_mbytesï¼Œåˆ™è®¾ç½®è¯¥çº§levelå€¼ä¸º0ï¼Œlevelç­‰çº§åˆ’åˆ†æµç¨‹å¦‚å›¾3æ‰€ç¤ºã€‚</p></blockquote><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.9588235294117647" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/9_MDQeFnXVibsqId1F3ibsGBtJHJibBg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8Ahckbmibe23AxglSBiclib0aFL8TkoZMDQeFnXVibsqId1F3ibsGBtJHJibBg/640?wx_fmt=png'" data-type="png" data-w="510" style="display: block;margin: 0 auto;max-width: 100%;"  /><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">3. levelç­‰çº§åˆ’åˆ†æµç¨‹å›¾</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è®¡ç®—æŸä¸€ä¸ªrowsetçš„levelå€¼æ—¶ï¼Œå¦‚æœlevel[n-1] &gt; rowset_size &gt;= level[n]ï¼Œåˆ™è¯¥rowsetçš„levelå€¼ä¸ºlevel[n]ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2.4 &nbsp;æ‰§è¡Œrowsetsåˆå¹¶<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å°†input rowsetsä¸­çš„æ‰€æœ‰rowsetè¿›è¡Œåˆå¹¶ï¼Œç”Ÿæˆä¸€ä¸ªoutput rowsetã€‚åœ¨æ‰§è¡Œrowsetsåˆå¹¶æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªReaderå’Œä¸€ä¸ªRowset Writerï¼ŒRowset Writerä¸output rowsetç›¸å¯¹åº”ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨Readeråº•å±‚é€»è¾‘ä¸­ï¼Œinput rowsetsä¸­çš„æ¯ä¸€ä¸ªrowsetéƒ½ä¼šå¯¹åº”ä¸€ä¸ªRowset Readerã€‚ReaderæŒ‰ç…§keyçš„æ’åºè§„åˆ™é€è¡Œè¯»å‡ºinput rowsetsä¸­çš„æ•°æ®ï¼Œç„¶åé€šè¿‡Rowset Writerå†™å…¥output rowsetã€‚aggregation keyæ•°æ®æ¨¡å‹å’Œunique keyæ•°æ®æ¨¡å‹ä¸­ï¼Œkeyç›¸åŒä½†åˆ†æ•£åœ¨ä¸åŒRowsetä¸­çš„æ•°æ®è¡Œä¼šåœ¨rowsetsåˆå¹¶åå®Œæˆèšåˆã€‚cumulative compactionä¸ä¼šå°†deleteæ“ä½œåˆ é™¤çš„æ•°æ®è¡Œè¿›è¡ŒçœŸæ­£åœ°åˆ é™¤ï¼Œè¿™éƒ¨åˆ†å·¥ä½œä¼šåœ¨base compactionä¸­è¿›è¡Œã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2.5 &nbsp;æ›´æ–°cumulative point<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">cumulative compactionæ‰§è¡Œç»“æŸä¹‹åï¼Œéœ€è¦æ›´æ–°cumulative pointã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ1ï¼‰å¦‚æœå­˜åœ¨æ•°æ®åˆ é™¤ç‰ˆæœ¬çš„è®°å½•ï¼ˆlast_delete_version ä¸ä¸º-1ï¼Œå³ç”Ÿæˆinput rowsetsçš„éå†è¿‡ç¨‹å› ä¸ºå­˜åœ¨åˆ é™¤æ•°æ®ç‰ˆæœ¬è€Œç»“æŸï¼‰ï¼Œåˆ™æ›´æ–°cumulative pointä¸ºoutput_rowsetçš„end_version+1ï¼›</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ2ï¼‰å¦‚æœä¸å­˜åœ¨æ•°æ®åˆ é™¤ç‰ˆæœ¬çš„è®°å½•ï¼ˆlast_delete_version ä¸º-1ï¼‰ï¼Œåˆ¤æ–­output rowsetçš„å¤§å°æ˜¯å¦è¶…è¿‡promotion_sizeï¼Œå¦‚æœè¶…è¿‡ï¼Œåˆ™æ›´æ–°cumulative pointä¸ºoutput_rowsetçš„end_version+1ï¼Œå¦åˆ™ï¼Œä¸æ›´æ–°cumulative pointã€‚</p><blockquote data-tool="mdniceç¼–è¾‘å™¨" style="border-top: none;border-right: none;border-bottom: none;display: block;font-size: 0.9em;overflow: auto;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0px;color: black;line-height: 26px;">ã€æ³¨ã€‘cumulative compactionæ‰§è¡Œä¹‹å‰éœ€è¦è®¡ç®—ä¸€æ¬¡cumulative pointï¼Œå› ä¸ºä¸Šä¸€æ¬¡cumulative compactionä¹‹åå¯èƒ½å‘ç”Ÿè¿‡base compactionï¼Œbase rowsetå‘ç”Ÿäº†å˜åŒ–ï¼Œå› æ­¤ï¼Œpromotion sizeå‘ç”Ÿäº†å˜åŒ–ï¼Œcumulative pointä¹Ÿä¼šå˜åŒ–ã€‚cumulative compactionæ‰§è¡Œä¹‹å‰è®¡ç®—cumulative pointï¼Œæ˜¯ä¸ºäº†ç¡®å®šæœ¬æ¬¡ cumulative compactionçš„è¾¹ç•Œï¼›cumulative compactionæ‰§è¡Œä¹‹åæ›´æ–°cumulative pointï¼Œæ˜¯ä¸ºäº†ç¡®å®šä¸‹ä¸€æ¬¡å¯èƒ½å‘ç”Ÿçš„base compactionçš„è¾¹ç•Œã€‚</p></blockquote><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2.6 &nbsp;è®¡ç®—cumulative compaction score<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨compaction producerçº¿ç¨‹ä¸­ï¼Œéœ€è¦ä¾æ®cumulative compaction scoreç”Ÿäº§cumulative compactionä»»åŠ¡ã€‚ä¾æ¬¡éå†tabletä¸­çš„æ‰€æœ‰rowsetï¼Œå¦‚æœæŸä¸€ä¸ªrowsetçš„ç‰ˆæœ¬ä½äºcumulative pointä¹‹åï¼Œåˆ™å°†è¯¥rowsetæ·»åŠ åˆ°å‘é‡rowset_to_compactã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ1ï¼‰å¦‚æœrowset_to_compactä¸­æ‰€æœ‰rowsetçš„å¤§å°ä¹‹å’Œè¶…è¿‡promotion_sizeï¼Œåˆ™rowset_to_compactä¸­æ‰€æœ‰rowsetçš„scoreä¹‹å’Œä¸ºå½“å‰tabletçš„cumulative compaction scoreï¼Œå³rowset_to_compactä¸­æ‰€æœ‰rowsetçš„segmentæ–‡ä»¶æ•°ç›®ä¹‹å’Œã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ2ï¼‰å¦‚æœrowset_to_compactä¸­æ‰€æœ‰rowsetçš„å¤§å°ä¹‹å’Œå°äºpromotion_sizeï¼Œåˆ™æŒ‰ç…§ç‰ˆæœ¬å…ˆåå¯¹rowset_to_compactä¸­çš„rowsetè¿›è¡Œæ’åºï¼Œç„¶åéå†rowset_to_compactä¸­çš„æ¯ä¸€ä¸ªrowsetã€‚è®¡ç®—å½“å‰rowsetçš„å¤§å°ç­‰çº§ï¼ˆcurrent_levelï¼‰ï¼ŒåŒæ—¶è®¡ç®—rowset_to_compactä¸­é™¤å½“å‰rowsetä¹‹å¤–çš„å…¶ä»–rowsetå¤§å°ä¹‹å’Œçš„ç­‰çº§ï¼ˆremain_levelï¼‰ï¼Œå¦‚æœcurrent_level &gt; remain_levelï¼Œåˆ™ä»å‘é‡rowset_to_compactä¸­åˆ é™¤å½“å‰rowsetï¼Œå¦åˆ™ï¼Œåœæ­¢éå†ã€‚rowset_to_compactä¸­æ‰€æœ‰rowsetçš„scoreä¹‹å’Œä¸ºå½“å‰tabletçš„cumulative compaction scoreã€‚</p><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>3. Base Compaction<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Dorisçš„base compactionä¼šå°†cumulative pointä¹‹å‰çš„æ‰€æœ‰rowsetè¿›è¡Œåˆå¹¶ï¼Œä¸»è¦åŒ…å«3ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯é€‰æ‹©input rowsetsã€æ£€æŸ¥base compactionçš„æ‰§è¡Œæ¡ä»¶ä»¥åŠæ‰§è¡Œrowsetsåˆå¹¶ï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚å…¶ä¸­ï¼Œå‰é¢ä¸¤ä¸ªæ­¥éª¤å±äºcompaction preparationé˜¶æ®µï¼Œæœ€åä¸€ä¸ªæ­¥éª¤å±äºcompaction executioné˜¶æ®µã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.20689655172413793" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/10_MUgZfU4g6YaM09rbFrXR90q4QExJNA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8A5Ifhlf4HRvprest3AIxhQzCiaMUgZfU4g6YaM09rbFrXR90q4QExJNA/640?wx_fmt=png'" data-type="png" data-w="725" style="display: block;margin: 0 auto;max-width: 100%;"  /><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">1. base compactionæ‰§è¡Œæµç¨‹å›¾</figcaption></figure><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>3.1 é€‰æ‹©input rowsets<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ1ï¼‰é€‰æ‹©input rowsetsã€‚ä¾æ¬¡éå†tabletä¸­çš„æ¯ä¸€ä¸ªrowsetï¼Œè·å–æ‰€æœ‰ç‰ˆæœ¬ä½äºcumulative pointä¹‹å‰çš„rowsetä½œä¸ºinput rowsetsã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ2ï¼‰å¯¹input rowsetsä¸­çš„æ‰€æœ‰rowsetæŒ‰ç…§ç‰ˆæœ¬å…ˆåè¿›è¡Œæ’åºã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>3.2 æ£€æŸ¥base compactionçš„æ‰§è¡Œæ¡ä»¶<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä¾æ¬¡æ£€æŸ¥ä»¥ä¸‹æ¡ä»¶ï¼ˆå¦‚å›¾2æ‰€ç¤ºï¼‰ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ1ï¼‰ç‰ˆæœ¬è¿ç»­æ€§æ¡ä»¶</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">éå†input rowsetsï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ç›¸é‚»çš„ä¸¤ä¸ªrowsetä¹‹é—´å­˜åœ¨ç‰ˆæœ¬ç¼ºå¤±ï¼Œå¦‚æœå­˜åœ¨ç‰ˆæœ¬ç¼ºå¤±ï¼Œåˆ™å½“å‰tabletä¸æ»¡è¶³base compactionçš„æ‰§è¡Œæ¡ä»¶ï¼Œæœ¬æ¬¡base compactionä»»åŠ¡ç»“æŸï¼›å¦åˆ™ï¼Œæ£€æŸ¥ä¸‹ä¸€ä¸ªæ¡ä»¶ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ2ï¼‰rowset overlappingæ¡ä»¶</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">éå†input rowsetsï¼Œå¦‚æœæœ‰rowsetä¸­ä¸åŒsegmentæ–‡ä»¶ä¹‹é—´å­˜åœ¨overlappingï¼Œåˆ™å½“å‰tabletä¸æ»¡è¶³base compactionçš„æ‰§è¡Œæ¡ä»¶ï¼Œæœ¬æ¬¡base compactionä»»åŠ¡ç»“æŸï¼›å¦åˆ™ï¼Œæ£€æŸ¥æ£€æŸ¥ä¸‹ä¸€ä¸ªæ¡ä»¶ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ3ï¼‰ base rowsetæ¡ä»¶</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœinput rowsetsä¸­åªæœ‰ä¸¤ä¸ªrowsetï¼Œå¹¶ä¸”base rowsetï¼ˆstart versionä¸º0ï¼‰çš„end versionä¸º1ï¼Œåˆ™å½“å‰tabletä¸æ»¡è¶³base compactionçš„æ‰§è¡Œæ¡ä»¶ï¼Œæœ¬æ¬¡base compactionä»»åŠ¡ç»“æŸï¼›å¦åˆ™ï¼Œæ£€æŸ¥ä¸‹ä¸€ä¸ªæ¡ä»¶ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ4ï¼‰rowsetçš„æ•°é‡æ¡ä»¶</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœinput rowsetsä¸­rowsetçš„æ•°é‡è¶…è¿‡è®¾å®šçš„é˜ˆå€¼ï¼ˆé€šè¿‡base_compaction_num_cumulative_deltasé…ç½®ï¼Œé»˜è®¤å€¼ä¸º5ï¼‰ï¼Œåˆ™å½“å‰tabletæ»¡è¶³base compactionçš„æ‰§è¡Œæ¡ä»¶ï¼›å¦åˆ™ï¼Œæ£€æŸ¥ä¸‹ä¸€ä¸ªæ¡ä»¶ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ5ï¼‰rowset sizeæ¡ä»¶</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœinput rowsetsä¸­é™¤base rowsetï¼ˆstart versionä¸º0ï¼‰ä¹‹å¤–çš„å…¶ä»–rowsetå¤§å°ä¹‹å’Œä¸base rowsetå¤§å°ä¹‹æ¯”è¶…è¿‡è®¾å®šçš„é˜ˆå€¼ï¼ˆé€šè¿‡base_cumulative_delta_ratioé…ç½®ï¼Œé»˜è®¤å€¼ä¸º0.3ï¼‰ï¼Œåˆ™å½“å‰tabletæ»¡è¶³base compactionçš„æ‰§è¡Œæ¡ä»¶ï¼›å¦åˆ™ï¼Œæ£€æŸ¥æ£€æŸ¥ä¸‹ä¸€ä¸ªæ¡ä»¶ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ï¼ˆ6ï¼‰æ—¶é—´æ¡ä»¶</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœå½“å‰tabletä¸Šä¸€æ¬¡æˆåŠŸæ‰§è¡Œbase compactionçš„æ—¶é—´è·ç¦»å½“å‰æ—¶åˆ»è¶…è¿‡æŒ‡å®šçš„æ—¶é—´é—´éš”ï¼ˆé€šè¿‡base_compaction_interval_seconds_since_last_operationé…ç½®ï¼Œé»˜è®¤å€¼ä¸º86400ç§’ï¼Œå³1å¤©ï¼‰ï¼Œåˆ™å½“å‰tabletæ»¡è¶³base compactionçš„æ‰§è¡Œæ¡ä»¶ï¼›å¦åˆ™ï¼Œå½“å‰tabletä¸æ»¡è¶³base compactionçš„æ‰§è¡Œæ¡ä»¶ï¼Œæœ¬æ¬¡base compactionä»»åŠ¡ç»“æŸã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="1.4094674556213018" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/11_tLCyScFBhuMAwmUzLzjVNY54lf7m7w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8AaqeHVufnXYibibMIzgDJKZYSFGtLCyScFBhuMAwmUzLzjVNY54lf7m7w/640?wx_fmt=png'" data-type="png" data-w="845" style="display: block;margin: 0 auto;max-width: 100%;"  /><figcaption style="margin-top: 5px;text-align: center;color: #888;font-size: 14px;">2. æ£€æŸ¥base compactionæ‰§è¡Œæ¡ä»¶çš„æµç¨‹å›¾</figcaption></figure><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>3.3 æ‰§è¡Œrowsetsåˆå¹¶<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å°†input rowsetsä¸­çš„æ‰€æœ‰rowsetè¿›è¡Œåˆå¹¶ï¼Œç”Ÿæˆä¸€ä¸ªoutput rowsetã€‚ä¸cumulative compactionè¿‡ç¨‹ä¸­æ‰§è¡Œrowsetsåˆå¹¶çš„æµç¨‹ç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œbase compactionè¿‡ç¨‹ä¸­ä¼šå°†deleteæ“ä½œåˆ é™¤çš„æ•°æ®è¡ŒçœŸæ­£åœ°åˆ é™¤ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>3.4 è®¡ç®—base compaction score<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨compaction producerçº¿ç¨‹ä¸­ï¼Œéœ€è¦ä¾æ®base compaction scoreç”Ÿäº§base compactionä»»åŠ¡ã€‚ä¾æ¬¡éå†tabletä¸­çš„æ¯ä¸€ä¸ªrowsetï¼Œæ‰€æœ‰ä½äºcumulative pointä¹‹å‰çš„rowsetçš„ scoreä¹‹å’Œä¸ºtabletå½“å‰çš„base compaction scoreï¼Œå³cumulative pointä¹‹å‰çš„rowsetä¸­çš„segmentæ–‡ä»¶æ•°ç›®ä¹‹å’Œã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;font-weight: bold;background: rgb(239, 112, 96);color: #ffffff;padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">Compactionè°ƒä¼˜(ä¸€)</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>1. ä»€ä¹ˆæ˜¯ Compaction<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Doris çš„æ•°æ®å†™å…¥æ¨¡å‹ä½¿ç”¨äº† LSM-Tree ç±»ä¼¼çš„æ•°æ®ç»“æ„ã€‚æ•°æ®éƒ½æ˜¯ä»¥è¿½åŠ ï¼ˆAppendï¼‰çš„æ–¹å¼å†™å…¥ç£ç›˜çš„ã€‚è¿™ç§æ•°æ®ç»“æ„å¯ä»¥å°†éšæœºå†™å˜ä¸ºé¡ºåºå†™ã€‚è¿™æ˜¯ä¸€ç§é¢å‘å†™ä¼˜åŒ–çš„æ•°æ®ç»“æ„ï¼Œä»–èƒ½å¢å¼ºç³»ç»Ÿçš„å†™å…¥ååï¼Œä½†æ˜¯åœ¨è¯»é€»è¾‘ä¸­ï¼Œéœ€è¦é€šè¿‡ Merge-on-Read çš„æ–¹å¼ï¼Œåœ¨è¯»å–æ—¶åˆå¹¶å¤šæ¬¡å†™å…¥çš„æ•°æ®ï¼Œä»è€Œå¤„ç†å†™å…¥æ—¶çš„æ•°æ®å˜æ›´ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Merge-on-Read ä¼šå½±å“è¯»å–çš„æ•ˆç‡ï¼Œä¸ºäº†é™ä½è¯»å–æ—¶éœ€è¦åˆå¹¶çš„æ•°æ®é‡ï¼ŒåŸºäº LSM-Tree çš„ç³»ç»Ÿéƒ½ä¼šå¼•å…¥åå°æ•°æ®åˆå¹¶çš„é€»è¾‘ï¼Œä»¥ä¸€å®šç­–ç•¥å®šæœŸçš„å¯¹æ•°æ®è¿›è¡Œåˆå¹¶ã€‚Doris ä¸­è¿™ç§æœºåˆ¶è¢«ç§°ä¸º Compactionã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Doris ä¸­æ¯æ¬¡æ•°æ®å†™å…¥ä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®ç‰ˆæœ¬ã€‚Compactionçš„è¿‡ç¨‹å°±æ˜¯è®²å¤šä¸ªæ•°æ®ç‰ˆæœ¬åˆå¹¶æˆä¸€ä¸ªæ›´å¤§çš„ç‰ˆæœ¬ã€‚Compaction å¯ä»¥å¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>1. ä½¿æ•°æ®æ›´åŠ æœ‰åº<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æ¯ä¸ªæ•°æ®ç‰ˆæœ¬å†…çš„æ•°æ®æ˜¯æŒ‰ä¸»é”®æœ‰åºçš„ï¼Œä½†æ˜¯ç‰ˆæœ¬ä¹‹é—´çš„æ•°æ®æ˜¯æ— åºçš„ã€‚Compactionåå½¢æˆçš„å¤§ç‰ˆæœ¬å°†å¤šä¸ªå°ç‰ˆæœ¬çš„æ•°æ®å˜æˆæœ‰åºæ•°æ®ã€‚åœ¨æœ‰åºæ•°æ®ä¸­è¿›è¡Œæ•°æ®æ£€ç´¢çš„æ•ˆç‡æ›´é«˜ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2. æ¶ˆé™¤æ•°æ®å˜æ›´<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æ•°æ®éƒ½æ˜¯ä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥çš„ï¼Œå› æ­¤ Deleteã€Update ç­‰æ“ä½œéƒ½æ˜¯å†™å…¥ä¸€ä¸ªæ ‡è®°ã€‚Compaction æ“ä½œå¯ä»¥å¤„ç†è¿™äº›æ ‡è®°ï¼Œè¿›è¡ŒçœŸæ­£çš„æ•°æ®åˆ é™¤æˆ–æ›´æ–°ï¼Œä»è€Œåœ¨è¯»å–æ—¶ï¼Œä¸å†éœ€è¦æ ¹æ®è¿™äº›æ ‡è®°æ¥è¿‡æ»¤æ•°æ®ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>3. å¢åŠ æ•°æ®èšåˆåº¦<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨èšåˆæ¨¡å‹ä¸‹ï¼ŒCompaction èƒ½è¿›ä¸€æ­¥èšåˆä¸åŒæ•°æ®ç‰ˆæœ¬ä¸­ç›¸åŒ key çš„æ•°æ®è¡Œï¼Œä»è€Œå¢åŠ æ•°æ®èšåˆåº¦ï¼Œå‡å°‘è¯»å–æ—¶éœ€è¦å®æ—¶è¿›è¡Œçš„èšåˆè®¡ç®—ã€‚</p><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>2. Compaction çš„é—®é¢˜<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç”¨æˆ·å¯èƒ½éœ€è¦æ ¹æ®å®é™…çš„ä½¿ç”¨åœºæ™¯æ¥è°ƒæ•´ Compaction çš„ç­–ç•¥ï¼Œå¦åˆ™å¯èƒ½é‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>1. Compaction é€Ÿåº¦ä½äºæ•°æ®å†™å…¥é€Ÿåº¦<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨é«˜é¢‘å†™å…¥åœºæ™¯ä¸‹ï¼ŒçŸ­æ—¶é—´å†…ä¼šäº§ç”Ÿå¤§é‡çš„æ•°æ®ç‰ˆæœ¬ã€‚å¦‚æœ Compaction ä¸åŠæ—¶ï¼Œå°±ä¼šé€ æˆå¤§é‡ç‰ˆæœ¬å †ç§¯ï¼Œæœ€ç»ˆä¸¥é‡å½±å“å†™å…¥é€Ÿåº¦ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>2. å†™æ”¾å¤§é—®é¢˜<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compaction æœ¬è´¨ä¸Šæ˜¯å°†å·²ç»å†™å…¥çš„æ•°æ®è¯»å–åé‡å†™å†™å›çš„è¿‡ç¨‹ï¼Œè¿™ç§æ•°æ®é‡å¤å†™å…¥è¢«ç§°ä¸ºå†™æ”¾å¤§ã€‚ä¸€ä¸ªå¥½çš„Compactionç­–ç•¥åº”è¯¥åœ¨ä¿è¯æ•ˆç‡çš„å‰æä¸‹ï¼Œå°½é‡é™ä½å†™æ”¾å¤§ç³»æ•°ã€‚è¿‡å¤šçš„ Compaction ä¼šå ç”¨å¤§é‡çš„ç£ç›˜IOèµ„æºï¼Œå½±å“ç³»ç»Ÿæ•´ä½“æ•ˆç‡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Doris ä¸­ç”¨äºæ§åˆ¶Compactionçš„å‚æ•°éå¸¸å¤šã€‚æœ¬æ–‡å°è¯•ä»¥ä¸‹æ–¹é¢ï¼Œä»‹ç»è¿™äº›å‚æ•°çš„å«ä¹‰ä»¥åŠå¦‚æœé€šè¿‡è°ƒæ•´å‚æ•°æ¥é€‚é…åœºæ™¯ã€‚</p><ul data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: disc;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">æ•°æ®ç‰ˆæœ¬æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œå“ªäº›å› ç´ å½±å“æ•°æ®ç‰ˆæœ¬çš„äº§å‡ºã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">ä¸ºä»€ä¹ˆéœ€è¦ Base å’Œ Cumulative ä¸¤ç§ç±»å‹çš„ Compactionã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">Compaction æœºåˆ¶æ˜¯å¦‚ä½•æŒ‘é€‰æ•°æ®åˆ†ç‰‡è¿›è¡Œ Compaction çš„ã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">å¯¹äºä¸€ä¸ªæ•°æ®åˆ†ç‰‡ï¼ŒCompaction æœºåˆ¶æ˜¯å¦‚ä½•ç¡®å®šå“ªäº›æ•°æ®ç‰ˆæœ¬å‚ä¸ Compaction çš„ã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">åœ¨é«˜é¢‘å¯¼å…¥åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä¿®æ”¹å“ªäº›å‚æ•°æ¥ä¼˜åŒ– Compaction é€»è¾‘ã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">Compaction ç›¸å…³çš„æŸ¥çœ‹å’Œç®¡ç†å‘½ä»¤ã€‚</section></li></ul><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>3. æ•°æ®ç‰ˆæœ¬çš„äº§ç”Ÿ<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é¦–å…ˆï¼Œç”¨æˆ·çš„æ•°æ®è¡¨ä¼šæŒ‰ç…§åˆ†åŒºå’Œåˆ†æ¡¶è§„åˆ™ï¼Œåˆ‡åˆ†æˆè‹¥å¹²ä¸ªæ•°æ®åˆ†ç‰‡ï¼ˆTabletï¼‰å­˜å‚¨åœ¨ä¸åŒ BE èŠ‚ç‚¹ä¸Šã€‚æ¯ä¸ª Tablet éƒ½æœ‰å¤šä¸ªå‰¯æœ¬ï¼ˆé»˜è®¤ä¸º3å‰¯æœ¬ï¼‰ã€‚Compaction æ˜¯åœ¨æ¯ä¸ª BE ä¸Šç‹¬ç«‹è¿›è¡Œçš„ï¼ŒCompaction é€»è¾‘å¤„ç†çš„å°±æ˜¯ä¸€ä¸ª BE èŠ‚ç‚¹ä¸Šæ‰€æœ‰çš„æ•°æ®åˆ†ç‰‡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å‰æ–‡è¯´åˆ°ï¼ŒDorisçš„æ•°æ®éƒ½æ˜¯ä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥ç³»ç»Ÿçš„ã€‚Dorisç›®å‰çš„å†™å…¥ä¾ç„¶æ˜¯ä»¥å¾®æ‰¹çš„æ–¹å¼è¿›è¡Œçš„ï¼Œæ¯ä¸€æ‰¹æ¬¡çš„æ•°æ®é’ˆå¯¹æ¯ä¸ª Tablet éƒ½ä¼šå½¢æˆä¸€ä¸ª rowsetã€‚è€Œä¸€ä¸ª Tablet æ˜¯ç”±å¤šä¸ªRowset ç»„æˆçš„ã€‚æ¯ä¸ª Rowset éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„èµ·å§‹ç‰ˆæœ¬å’Œç»ˆæ­¢ç‰ˆæœ¬ã€‚å¯¹äºæ–°å¢Rowsetï¼Œèµ·å§‹ç‰ˆæœ¬å’Œç»ˆæ­¢ç‰ˆæœ¬ç›¸åŒï¼Œè¡¨ç¤ºä¸º [6-6]ã€[7-7] ç­‰ã€‚å¤šä¸ªRowsetç»è¿‡ Compaction å½¢æˆä¸€ä¸ªå¤§çš„ Rowsetï¼Œèµ·å§‹ç‰ˆæœ¬å’Œç»ˆæ­¢ç‰ˆæœ¬ä¸ºå¤šä¸ªç‰ˆæœ¬çš„å¹¶é›†ï¼Œå¦‚ [6-6]ã€[7-7]ã€[8-8] åˆå¹¶åå˜æˆ [6-8]ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Rowset çš„æ•°é‡ç›´æ¥å½±å“åˆ° Compaction æ˜¯å¦èƒ½å¤ŸåŠæ—¶å®Œæˆã€‚é‚£ä¹ˆä¸€æ‰¹æ¬¡å¯¼å…¥ä¼šç”Ÿæˆå¤šå°‘ä¸ª Rowset å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å‡è®¾é›†ç¾¤æœ‰3ä¸ª BE èŠ‚ç‚¹ã€‚æ¯ä¸ªBEèŠ‚ç‚¹2å—ç›˜ã€‚åªæœ‰ä¸€å¼ è¡¨ï¼Œ2ä¸ªåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒº3ä¸ªåˆ†æ¡¶ï¼Œé»˜è®¤3å‰¯æœ¬ã€‚é‚£ä¹ˆæ€»åˆ†ç‰‡æ•°é‡æ˜¯ï¼ˆ2 * 3 * 3ï¼‰18 ä¸ªï¼Œå¦‚æœå‡åŒ€åˆ†å¸ƒåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šï¼Œåˆ™æ¯ä¸ªç›˜ä¸Š3ä¸ªtabletã€‚å‡è®¾ä¸€æ¬¡å¯¼å…¥æ¶‰åŠåˆ°å…¶ä¸­ä¸€ä¸ªåˆ†åŒºï¼Œåˆ™ä¸€æ¬¡å¯¼å…¥æ€»å…±äº§ç”Ÿ9ä¸ªRowsetï¼Œå³å¹³å‡æ¯å—ç›˜äº§ç”Ÿ1-2ä¸ª Rowsetã€‚ï¼ˆè¿™é‡Œä»…è€ƒè™‘æ•°æ®å®Œå…¨å‡åŒ€åˆ†å¸ƒçš„æƒ…å†µä¸‹ï¼Œå®é™…æƒ…å†µä¸­ï¼Œå¯èƒ½å¤šä¸ª Tablet é›†ä¸­åœ¨æŸä¸€å—ç£ç›˜ä¸Šã€‚ï¼‰</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œrowsetçš„æ•°é‡ç›´æ¥å–å†³äºè¡¨çš„åˆ†ç‰‡æ•°é‡ã€‚ä¸¾ä¸ªæç«¯çš„ä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªDorisé›†ç¾¤åªæœ‰3ä¸ªBEèŠ‚ç‚¹ï¼Œä½†æ˜¯æœ‰9000ä¸ªåˆ†ç‰‡ã€‚é‚£ä¹ˆä¸€æ¬¡å¯¼å…¥ï¼Œæ¯ä¸ªBEèŠ‚ç‚¹å°±ä¼šæ–°å¢3000ä¸ªrowsetï¼Œåˆ™è‡³å°‘è¦è¿›è¡Œ3000æ¬¡compactionï¼Œæ‰èƒ½å¤„ç†å®Œæ‰€æœ‰çš„åˆ†ç‰‡ã€‚æ‰€ä»¥ï¼š</p><blockquote data-tool="mdniceç¼–è¾‘å™¨" style="border-top: none;border-right: none;border-bottom: none;display: block;font-size: 0.9em;overflow: auto;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0px;color: black;line-height: 26px;">åˆç†çš„è®¾ç½®è¡¨çš„åˆ†åŒºã€åˆ†æ¡¶å’Œå‰¯æœ¬æ•°é‡ï¼Œé¿å…è¿‡å¤šçš„åˆ†ç‰‡ï¼Œå¯ä»¥é™ä½Compactionçš„å¼€é”€ã€‚</p></blockquote><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>4. Base &amp; Cumulative Compaction<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Doris ä¸­æœ‰ä¸¤ç§ Compaction æ“ä½œï¼Œåˆ†åˆ«ç§°ä¸º Base Compaction(BC) å’Œ Cumulative Compaction(CC)ã€‚BC æ˜¯å°†åŸºçº¿æ•°æ®ç‰ˆæœ¬ï¼ˆä»¥0ä¸ºèµ·å§‹ç‰ˆæœ¬çš„æ•°æ®ï¼‰å’Œå¢é‡æ•°æ®ç‰ˆæœ¬åˆå¹¶çš„è¿‡ç¨‹ï¼Œè€ŒCCæ˜¯å¢é‡æ•°æ®é—´çš„åˆå¹¶è¿‡ç¨‹ã€‚BCæ“ä½œå› ä¸ºæ¶‰åŠåˆ°åŸºçº¿æ•°æ®ï¼Œè€ŒåŸºçº¿æ•°æ®é€šå¸¸æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥æ“ä½œè€—æ—¶ä¼šæ¯”CCé•¿ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœåªæœ‰ Base Compactionï¼Œåˆ™æ¯æ¬¡å¢é‡æ•°æ®éƒ½è¦å’Œå…¨é‡çš„åŸºçº¿æ•°æ®åˆå¹¶ï¼Œå†™æ”¾å¤§é—®é¢˜ä¼šéå¸¸ä¸¥é‡ï¼Œå¹¶ä¸”æ¯æ¬¡ Compaction éƒ½ç›¸å½“è€—æ—¶ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å¼•å…¥ Cumulative Compaction æ¥å…ˆå¯¹å¢é‡æ•°æ®è¿›è¡Œåˆå¹¶ï¼Œå½“å¢é‡æ•°æ®åˆå¹¶åçš„å¤§å°è¾¾åˆ°ä¸€å®šé˜ˆå€¼åï¼Œå†å’ŒåŸºçº¿æ•°æ®åˆå¹¶ã€‚è¿™é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„ Compaction è°ƒä¼˜ç­–ç•¥ï¼š</p><blockquote data-tool="mdniceç¼–è¾‘å™¨" style="border-top: none;border-right: none;border-bottom: none;display: block;font-size: 0.9em;overflow: auto;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0px;color: black;line-height: 26px;">åœ¨åˆç†èŒƒå›´å†…ï¼Œå°½é‡å‡å°‘ Base Compaction æ“ä½œã€‚</p></blockquote><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">BC å’Œ CC ä¹‹é—´çš„åˆ†ç•Œçº¿æˆä¸º Cumulative Pointï¼ˆCPï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠ¨æ€å˜åŒ–çš„ç‰ˆæœ¬å·ã€‚æ¯”CPå°çš„æ•°æ®ç‰ˆæœ¬ä¼šåªä¼šè§¦å‘ BCï¼Œè€Œæ¯”CPå¤§çš„æ•°æ®ç‰ˆæœ¬ï¼Œåªä¼šè§¦å‘CCã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.45646437994722955" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/12_3hPy7mJ7ibk7QAKdD6kZicUEibHicw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8Aic7hIuKhWg6WcRWSpqsiakdoyALFqH3hPy7mJ7ibk7QAKdD6kZicUEibHicw/640?wx_fmt=png'" data-type="png" data-w="379" style="display: block;margin: 0 auto;max-width: 100%;"  /></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æ•´ä¸ªè¿‡ç¨‹æœ‰ç‚¹ç±»ä¼¼ 2048 å°æ¸¸æˆï¼šåªæœ‰åˆå¹¶åå¤§å°è¶³å¤Ÿï¼Œæ‰èƒ½ç»§ç»­å’Œæ›´å¤§çš„æ•°æ®ç‰ˆæœ¬åˆå¹¶ã€‚</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="1.005730659025788" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/13_hSz2RtZEia1engkvYTHJoz9AsSHfuQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8Ae403ScSpp6TkaKRgLY7LxyT6MhSz2RtZEia1engkvYTHJoz9AsSHfuQ/640?wx_fmt=png'" data-type="png" data-w="698" style="display: block;margin: 0 auto;max-width: 100%;"  /></figure><h2 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;font-weight: bold;background: rgb(239, 112, 96);color: #ffffff;padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">Compactionè°ƒä¼˜(äºŒ)</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>1. æ•°æ®åˆ†ç‰‡é€‰æ‹©ç­–ç•¥<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compaction çš„ç›®çš„æ˜¯åˆå¹¶å¤šä¸ªæ•°æ®ç‰ˆæœ¬ï¼Œä¸€æ˜¯é¿å…åœ¨è¯»å–æ—¶å¤§é‡çš„ Merge æ“ä½œï¼ŒäºŒæ˜¯é¿å…å¤§é‡çš„æ•°æ®ç‰ˆæœ¬å¯¼è‡´çš„éšæœºIOã€‚å› æ­¤ï¼ŒCompaction ç­–ç•¥çš„é‡ç‚¹é—®é¢˜ï¼Œå°±æ˜¯å¦‚ä½•é€‰æ‹©åˆé€‚çš„ tabletï¼Œä»¥ä¿è¯èŠ‚ç‚¹ä¸Šä¸ä¼šå‡ºç°æ•°æ®ç‰ˆæœ¬è¿‡å¤šçš„æ•°æ®åˆ†ç‰‡ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>Compaction åˆ†æ•°<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•ï¼Œå°±æ˜¯æ¯æ¬¡éƒ½é€‰æ‹©æ•°æ®ç‰ˆæœ¬æœ€å¤šçš„æ•°æ®åˆ†ç‰‡è¿›è¡Œ Compactionã€‚è¿™ä¸ªç­–ç•¥ä¹Ÿæ˜¯ Doris çš„é»˜è®¤ç­–ç•¥ã€‚è¿™ä¸ªç­–ç•¥åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹éƒ½èƒ½å¾ˆå¥½çš„å·¥ä½œã€‚ä½†æ˜¯è€ƒè™‘åˆ°ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ç‰ˆæœ¬å¤šçš„åˆ†ç‰‡ï¼Œå¯èƒ½å¹¶ä¸æ˜¯æœ€é¢‘ç¹è®¿é—®çš„åˆ†ç‰‡ã€‚è€Œ Compaction çš„ç›®çš„å°±æ˜¯ä¼˜åŒ–è¯»æ€§èƒ½ã€‚é‚£ä¹ˆæœ‰å¯èƒ½æŸä¸€å¼  â€œå†™å¤šè¯»å°‘â€ è¡¨ä¸€ç›´åœ¨ Compactionï¼Œè€Œå¦ä¸€å¼  â€œè¯»å¤šå†™å°‘â€ çš„è¡¨ä¸èƒ½åŠæ—¶çš„ Compactionï¼Œå¯¼è‡´è¯»æ€§èƒ½å˜å·®ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å› æ­¤ï¼ŒDoris åœ¨é€‰æ‹©æ•°æ®åˆ†ç‰‡æ—¶è¿˜å¼•å…¥äº† â€œè¯»å–é¢‘ç‡â€ çš„å› ç´ ã€‚â€œè¯»å–é¢‘ç‡â€ å’Œ â€œç‰ˆæœ¬æ•°é‡â€ ä¼šæ ¹æ®å„è‡ªçš„æƒé‡ï¼Œç»¼åˆè®¡ç®—å‡ºä¸€ä¸ª Compaction åˆ†æ•°ï¼Œåˆ†æ•°è¶Šé«˜çš„åˆ†ç‰‡ï¼Œä¼˜å…ˆåš Compactionã€‚è¿™ä¸¤ä¸ªå› ç´ çš„æƒé‡ç”±ä»¥ä¸‹ BE å‚æ•°æ§åˆ¶ï¼ˆå–å€¼è¶Šå¤§ï¼Œæƒé‡è¶Šé«˜ï¼‰ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">compaction_tablet_scan_frequency_factor</code>ï¼šâ€œè¯»å–é¢‘ç‡â€ çš„æƒé‡å€¼ï¼Œé»˜è®¤ä¸º 0ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">compaction_tablet_compaction_score_factor</code>ï¼šâ€œç‰ˆæœ¬æ•°é‡â€ çš„æƒé‡ï¼Œé»˜è®¤ä¸º 1ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">&gt; â€œè¯»å–é¢‘ç‡â€ çš„æƒé‡å€¼é»˜è®¤ä¸º0ï¼Œå³é»˜è®¤ä»…è€ƒè™‘ â€œç‰ˆæœ¬æ•°é‡â€  è¿™ä¸ªå› ç´ ã€‚</code></p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compaction æ˜¯ä¸€ä¸ª ç”Ÿäº§è€…-æ¶ˆè´¹è€… æ¨¡å‹ã€‚ç”±ä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹è´Ÿè´£é€‰æ‹©éœ€è¦åš Compaction çš„æ•°æ®åˆ†ç‰‡ï¼Œè€Œå¤šä¸ªæ¶ˆè´¹è€…è´Ÿè´£æ‰§è¡Œ Compaction æ“ä½œã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç”Ÿäº§è€…çº¿ç¨‹åªæœ‰ä¸€ä¸ªï¼Œä¼šå®šæœŸæ‰«ææ‰€æœ‰ tablet æ¥é€‰æ‹©åˆé€‚çš„ compaction å¯¹è±¡ã€‚å› ä¸º Base Compaction å’Œ Cumulative Compaction æ˜¯ä¸åŒç±»å‹çš„ä»»åŠ¡ï¼Œå› æ­¤ç›®å‰çš„ç­–ç•¥æ˜¯æ¯ç”Ÿæˆ 9 ä¸ª CC ä»»åŠ¡ï¼Œç”Ÿæˆä¸€ä¸ª BC ä»»åŠ¡ã€‚ä»»åŠ¡ç”Ÿæˆçš„é¢‘ç‡ç”±ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°æ§åˆ¶ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">cumulative_compaction_rounds_for_each_base_compaction_round</code>ï¼šå¤šå°‘ä¸ªCCä»»åŠ¡åç”Ÿæˆä¸€ä¸ªBCä»»åŠ¡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">generate_compaction_tasks_min_interval_ms</code>ï¼šä»»åŠ¡ç”Ÿæˆçš„é—´éš”ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">&gt; è¿™ä¸¤ä¸ªå‚æ•°é€šå¸¸æƒ…å†µä¸‹ä¸éœ€è¦è°ƒæ•´ã€‚</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç”Ÿäº§è€…çº¿ç¨‹äº§ç”Ÿçš„ä»»åŠ¡ä¼šè¢«æäº¤åˆ°æ¶ˆè´¹è€…çº¿ç¨‹æ± ã€‚å› ä¸º Compaction æ˜¯ä¸€ä¸ªIOå¯†é›†å‹çš„ä»»åŠ¡ï¼Œä¸ºäº†ä¿è¯ Compaction ä»»åŠ¡ä¸ä¼šè¿‡å¤šçš„å ç”¨IOèµ„æºï¼ŒDoris é™åˆ¶äº†æ¯ä¸ªç£ç›˜ä¸Šèƒ½å¤ŸåŒæ—¶è¿›è¡Œçš„ Compaction ä»»åŠ¡æ•°é‡ï¼Œä»¥åŠèŠ‚ç‚¹æ•´ä½“çš„ä»»åŠ¡æ•°é‡ï¼Œè¿™äº›é™åˆ¶ç”±ä»¥ä¸‹å‚æ•°æ§åˆ¶ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">compaction_task_num_per_disk</code>ï¼šæ¯ä¸ªç£ç›˜ä¸Šçš„ä»»åŠ¡æ•°ï¼Œé»˜è®¤ä¸º2ã€‚è¯¥å‚æ•°å¿…é¡»å¤§äºç­‰äº2ï¼Œä»¥ä¿è¯ BC å’Œ CC ä»»åŠ¡å„è‡ªè‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">max_compaction_threads</code>ï¼šæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå³Compactionçº¿ç¨‹çš„æ€»æ•°ã€‚é»˜è®¤ä¸º 10ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä¸€ä¸ª BE èŠ‚ç‚¹é…ç½®äº†3ä¸ªæ•°æ®ç›®å½•ï¼ˆå³3å—ç£ç›˜ï¼‰ï¼Œæ¯ä¸ªç£ç›˜ä¸Šçš„ä»»åŠ¡æ•°é…ç½®ä¸º2ï¼Œæ€»çº¿ç¨‹æ•°ä¸º5ã€‚åˆ™åŒä¸€æ—¶é—´ï¼Œæœ€å¤šæœ‰5ä¸ª Compaction ä»»åŠ¡åœ¨è¿›è¡Œï¼Œè€Œæ¯å—ç£ç›˜ä¸Šæœ€å¤šæœ‰2ä¸ªä»»åŠ¡åœ¨è¿›è¡Œã€‚å¹¶ä¸”æœ€å¤šæœ‰3ä¸ª BC ä»»åŠ¡åœ¨è¿›è¡Œï¼Œå› ä¸ºæ¯å—ç›˜ä¸Šä¼šè‡ªåŠ¨é¢„ç•™ä¸€ä¸ªçº¿ç¨‹ç»™CCä»»åŠ¡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦ä¸€æ–¹é¢ï¼ŒCompaction ä»»åŠ¡åŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªå†…å­˜å¯†é›†å‹ä»»åŠ¡ï¼Œå› ä¸ºå…¶æœ¬è´¨æ˜¯ä¸€ä¸ªå¤šè·¯å½’å¹¶æ’åºçš„è¿‡ç¨‹ï¼Œæ¯ä¸€è·¯æ˜¯ä¸€ä¸ªæ•°æ®ç‰ˆæœ¬ã€‚å¦‚æœä¸€ä¸ª Compaction ä»»åŠ¡æ¶‰åŠçš„æ•°æ®ç‰ˆæœ¬å¾ˆå¤šï¼Œåˆ™ä¼šå ç”¨æ›´å¤šçš„å†…å­˜ï¼Œå¦‚æœä»…é™åˆ¶ä»»åŠ¡æ•°ï¼Œè€Œä¸è€ƒè™‘ä»»åŠ¡çš„å†…å­˜å¼€é”€ï¼Œåˆ™æœ‰å¯èƒ½å¯¼è‡´ç³»ç»Ÿå†…å­˜è¶…é™ã€‚å› æ­¤ï¼ŒDoris åœ¨ä¸Šè¿°ä»»åŠ¡ä¸ªæ•°é™åˆ¶ä¹‹å¤–ï¼Œè¿˜å¢åŠ äº†ä¸€ä¸ªä»»åŠ¡é…é¢é™åˆ¶ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">total_permits_for_compaction_score</code>ï¼šCompaction ä»»åŠ¡é…é¢ï¼Œé»˜è®¤ 10000ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æ¯ä¸ª Compaction ä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªé…é¢ï¼Œå…¶æ•°å€¼å°±æ˜¯ä»»åŠ¡æ¶‰åŠçš„æ•°æ®ç‰ˆæœ¬æ•°é‡ã€‚å‡è®¾ä¸€ä¸ªä»»åŠ¡éœ€è¦åˆå¹¶100ä¸ªç‰ˆæœ¬ï¼Œåˆ™å…¶é…é¢ä¸º100ã€‚å½“æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡é…é¢æ€»å’Œè¶…è¿‡é…ç½®åï¼Œæ–°çš„ä»»åŠ¡å°†è¢«æ‹’ç»ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä¸‰ä¸ªé…ç½®å…±åŒå†³å®šäº†èŠ‚ç‚¹æ‰€èƒ½æ‰¿å—çš„ Compaction ä»»åŠ¡æ•°é‡ã€‚</p><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>2. æ•°æ®ç‰ˆæœ¬é€‰æ‹©ç­–ç•¥<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä¸€ä¸ª Compaction ä»»åŠ¡å¯¹åº”çš„æ˜¯ä¸€ä¸ªæ•°æ®åˆ†ç‰‡ï¼ˆTabletï¼‰ã€‚æ¶ˆè´¹çº¿ç¨‹æ‹¿åˆ°ä¸€ä¸ª Compaction ä»»åŠ¡åï¼Œä¼šæ ¹æ® Compaction çš„ä»»åŠ¡ç±»å‹ï¼Œé€‰æ‹© tablet ä¸­åˆé€‚çš„æ•°æ®ç‰ˆæœ¬ï¼ˆRowsetï¼‰è¿›è¡Œæ•°æ®åˆå¹¶ã€‚ä¸‹é¢åˆ†åˆ«ä»‹ç» Base Compaction å’Œ Cumulative Compaction çš„æ•°æ®åˆ†ç‰‡é€‰æ‹©ç­–ç•¥ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>Base Compaction<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å‰æ–‡è¯´è¿‡ï¼ŒBC ä»»åŠ¡æ˜¯å¢é‡æ•°æ®å’ŒåŸºçº¿æ•°æ®çš„åˆå¹¶ä»»åŠ¡ã€‚å¹¶ä¸”åªæœ‰æ¯” Cumulative Pointï¼ˆCPï¼‰ å°çš„æ•°æ®ç‰ˆæœ¬æ‰ä¼šå‚ä¸ BC ä»»åŠ¡ã€‚å› æ­¤ï¼ŒBC ä»»åŠ¡çš„æ•°æ®ç‰ˆæœ¬é€‰å–ç­–ç•¥æ¯”è¾ƒç®€å•ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é¦–å…ˆï¼Œä¼šé€‰å–æ‰€æœ‰ç‰ˆæœ¬åœ¨ 0 åˆ° CPä¹‹é—´çš„ rowsetã€‚ç„¶åæ ¹æ®ä»¥ä¸‹å‡ ä¸ªé…ç½®å‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦å¯åŠ¨ä¸€ä¸ª BC ä»»åŠ¡ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">base_compaction_num_cumulative_deltas</code>ï¼šä¸€æ¬¡ BC ä»»åŠ¡æœ€å°ç‰ˆæœ¬æ•°é‡é™åˆ¶ã€‚é»˜è®¤ä¸º5ã€‚è¯¥å‚æ•°ä¸»è¦ä¸ºäº†é¿å…è¿‡å¤š BC ä»»åŠ¡ã€‚å½“æ•°æ®ç‰ˆæœ¬æ•°é‡è¾ƒå°‘æ—¶ï¼ŒBC æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">base_compaction_interval_seconds_since_last_operation</code>ï¼šç¬¬ä¸€ä¸ªå‚æ•°é™åˆ¶äº†å½“ç‰ˆæœ¬æ•°é‡å°‘æ—¶ï¼Œä¸ä¼šè¿›è¡Œ BC ä»»åŠ¡ã€‚ä½†æˆ‘ä»¬éœ€è¦é¿å…å¦ä¸€ç§æƒ…å†µï¼Œå³æŸäº› tablet å¯èƒ½ä»…ä¼šå¯¼å…¥å°‘é‡æ‰¹æ¬¡çš„æ•°æ®ï¼Œå› æ­¤å½“ Doris å‘ç°ä¸€ä¸ª tablet é•¿æ—¶é—´æ²¡æœ‰æ‰§è¡Œè¿‡ BC ä»»åŠ¡æ—¶ï¼Œä¹Ÿä¼šè§¦å‘ BC ä»»åŠ¡ã€‚è¿™ä¸ªå‚æ•°å°±æ˜¯æ§åˆ¶è¿™ä¸ªæ—¶é—´çš„ï¼Œé»˜è®¤æ˜¯ 86400ï¼Œå•ä½æ˜¯ç§’ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">&gt; ä»¥ä¸Šä¸¤ä¸ªå‚æ•°é€šå¸¸æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¦‚ä½•éœ€è¦æƒ³å°½å¿«åˆå¹¶åŸºçº¿æ•°æ®ï¼Œå¯ä»¥å°è¯•æ”¹å° base_compaction_num_cumulative_deltas å‚æ•°ã€‚ä½†è¿™ä¸ªå‚æ•°åªä¼šå½±å“åˆ° â€œè¢«é€‰ä¸­çš„ tabletâ€ã€‚è€Œ â€œè¢«é€‰ä¸­â€ çš„å‰ææ˜¯è¿™ä¸ª tablet çš„æ•°æ®ç‰ˆæœ¬æ•°é‡æ˜¯æœ€å¤šçš„ã€‚</code></p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>Cumulative Compaction<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">CC ä»»åŠ¡åªä¼šé€‰å–ç‰ˆæœ¬æ¯” CP å¤§çš„æ•°æ®ç‰ˆæœ¬ã€‚å…¶æœ¬èº«çš„é€‰å–ç­–ç•¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå³ä» CP ç‰ˆæœ¬å¼€å§‹ï¼Œä¾æ¬¡å‘åé€‰å–æ•°æ®ç‰ˆæœ¬ã€‚æœ€ç»ˆçš„æ•°æ®ç‰ˆæœ¬é›†åˆç”±ä»¥ä¸‹å‚æ•°æ§åˆ¶ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">min_cumulative_compaction_num_singleton_deltas</code>ï¼šä¸€æ¬¡ CC ä»»åŠ¡æœ€å°‘çš„ç‰ˆæœ¬æ•°é‡é™åˆ¶ã€‚è¿™ä¸ªé…ç½®æ˜¯å’Œ cumulative_size_based_compaction_lower_size_mbytes é…ç½®åŒæ—¶åˆ¤æ–­çš„ã€‚å³å¦‚æœç‰ˆæœ¬æ•°é‡å°äºé˜ˆå€¼ï¼Œå¹¶ä¸”æ•°æ®é‡ä¹Ÿå°äºé˜ˆå€¼ï¼Œåˆ™ä¸ä¼šè§¦å‘ CC ä»»åŠ¡ã€‚ä»¥é¿å…èº²è¿‡ä¸æ¯”è¾ƒçš„ CC ä»»åŠ¡ã€‚é»˜è®¤æ˜¯5ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">max_cumulative_compaction_num_singleton_deltas</code>ï¼šä¸€æ¬¡ CC ä»»åŠ¡æœ€å¤§çš„ç‰ˆæœ¬æ•°é‡é™åˆ¶ã€‚ä»¥é˜²æ­¢ä¸€æ¬¡ CC ä»»åŠ¡åˆå¹¶çš„ç‰ˆæœ¬æ•°é‡è¿‡å¤šï¼Œå ç”¨è¿‡å¤šèµ„æºã€‚é»˜è®¤æ˜¯1000ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">cumulative_size_based_compaction_lower_size_mbytes</code>ï¼šä¸€æ¬¡ CC ä»»åŠ¡æœ€å°‘çš„æ•°æ®é‡ï¼Œå’Œmin_cumulative_compaction_num_singleton_delta åŒæ—¶åˆ¤æ–­ã€‚é»˜è®¤æ˜¯ 64ï¼Œå•ä½æ˜¯ MBã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç®€å•æ¥è¯´ï¼Œé»˜è®¤é…ç½®ä¸‹ï¼Œå°±æ˜¯ä» CP ç‰ˆæœ¬å¼€å§‹å¾€åé€‰å– rowsetã€‚æœ€å°‘é€‰5ä¸ªï¼Œæœ€å¤šé€‰ 1000 ä¸ªï¼Œç„¶ååˆ¤æ–­æ•°æ®é‡æ˜¯å¦å¤§äºé˜ˆå€¼å³å¯ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">CC ä»»åŠ¡è¿˜æœ‰ä¸€ä¸ªé‡è¦æ­¥éª¤ï¼Œå°±æ˜¯åœ¨åˆå¹¶ä»»åŠ¡ç»“æŸåï¼Œè®¾ç½®æ–°çš„ Cumulative Pointã€‚CC ä»»åŠ¡åˆå¹¶å®Œæˆåï¼Œä¼šäº§ç”Ÿä¸€ä¸ªåˆå¹¶åçš„æ–°çš„æ•°æ®ç‰ˆæœ¬ï¼Œè€Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯åˆ¤æ–­è¿™ä¸ªæ–°çš„æ•°æ®ç‰ˆæ˜¯ â€œæ™‹å‡â€ åˆ° BC ä»»åŠ¡åŒºï¼Œè¿˜æ˜¯ä¾ç„¶ä¿ç•™åœ¨ CC ä»»åŠ¡åŒºã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å‡è®¾å½“å‰ CP æ˜¯ 10ã€‚æœ‰ä¸€ä¸ª CC ä»»åŠ¡åˆå¹¶äº† [10-13] [14-14] [15-15] åç”Ÿæˆäº† [10-15] è¿™ä¸ªç‰ˆæœ¬ã€‚å¦‚æœå†³å®šå°† [10-15] ç‰ˆæœ¬ç§»åŠ¨åˆ° BC ä»»åŠ¡åŒºï¼Œåˆ™éœ€ä¿®æ”¹ CP ä¸º 15ï¼Œå¦åˆ™ CP ä¿æŒä¸å˜ï¼Œä¾ç„¶ä¸º 10ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">CP åªä¼šå¢åŠ ï¼Œä¸ä¼šå‡å°‘ã€‚ä»¥ä¸‹å‚æ•°å†³å®šäº†æ˜¯å¦æ›´æ–° CPï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">cumulative_size_based_promotion_ratio</code>ï¼šæ™‹å‡æ¯”ç‡ã€‚é»˜è®¤ 0.05ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">cumulative_size_based_promotion_min_size_mbytes</code>ï¼šæœ€å°æ™‹å‡å¤§å°ï¼Œé»˜è®¤ 64ï¼Œå•ä½ MBã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">cumulative_size_based_promotion_size_mbytes</code>ï¼šæœ€å¤§æ™‹å‡å¤§å°ï¼Œé»˜è®¤ 1024ï¼Œå•ä½ MBã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä»¥ä¸Šå‚æ•°æ¯”è¾ƒéš¾ç†è§£ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆè§£é‡Šä¸‹ â€œæ™‹å‡â€ çš„åŸåˆ™ã€‚ä¸€ä¸ª CC ä»»åŠ¡ç”Ÿæˆçš„ rowset çš„æ™‹å‡åŸåˆ™ï¼Œæ˜¯å…¶æ•°æ®å¤§å°å’ŒåŸºçº¿æ•°æ®çš„å¤§å°åœ¨ â€œåŒä¸€é‡çº§â€ã€‚è¿™ä¸ªç±»ä¼¼ 2048 å°æ¸¸æˆï¼Œåªæœ‰ç›¸åŒçš„æ•°å­—æ‰èƒ½åˆå¹¶å½¢æˆæ›´å¤§çš„æ•°å­—ã€‚è€Œä¸Šé¢ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯ç”¨äºåˆ¤æ–­ä¸€ä¸ªæ–°çš„rowsetæ˜¯å¦åŒ¹é…åŸºçº¿æ•°æ®çš„æ•°é‡çº§ã€‚ä¸¾ä¾‹è¯´æ˜ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œå‡è®¾å½“å‰åŸºçº¿æ•°æ®ï¼ˆå³æ‰€æœ‰ CP ä¹‹å‰çš„æ•°æ®ç‰ˆæœ¬ï¼‰çš„æ•°æ®é‡ä¸º 10GBï¼Œåˆ™æ™‹å‡é‡çº§ä¸º ï¼ˆ10GB * 0.05ï¼‰512MBã€‚è¿™ä¸ªæ•°å€¼å¤§äº 64 MB å°äº 1024 MBï¼Œæ»¡è¶³æ¡ä»¶ã€‚æ‰€ä»¥å¦‚æœ CC ä»»åŠ¡ç”Ÿæˆçš„æ–°çš„ rowset çš„å¤§å°å¤§äº 512 MBï¼Œåˆ™å¯ä»¥æ™‹å‡ï¼Œå³ CP å¢åŠ ã€‚è€Œå‡è®¾åŸºçº¿æ•°æ®ä¸º 50GBï¼Œåˆ™æ™‹å‡é‡çº§ä¸ºï¼ˆ50GB * 0.05ï¼‰2.5GBã€‚è¿™ä¸ªæ•°å€¼å¤§äº 64 MB ä¹Ÿå¤§äº 1024 MBï¼Œå› æ­¤æ™‹å‡é‡çº§ä¼šè¢«è°ƒæ•´ä¸º 1024 MBã€‚æ‰€ä»¥å¦‚æœ CC ä»»åŠ¡ç”Ÿæˆçš„æ–°çš„ rowset çš„å¤§å°å¤§äº 1024 MBï¼Œåˆ™å¯ä»¥æ™‹å‡ï¼Œå³ CP å¢åŠ ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œcumulative_size_based_promotion_ratio ç”¨äºå®šä¹‰ â€œåŒä¸€é‡çº§â€ï¼Œ0.05 å³è¡¨ç¤ºæ•°æ®é‡å¤§äºåŸºçº¿æ•°æ®çš„ 5% çš„ rowset éƒ½æœ‰æ™‹å‡çš„å¯èƒ½ï¼Œè€Œ cumulative_size_based_promotion_min_size_mbytes å’Œ cumulative_size_based_promotion_size_mbytes ç”¨äºä¿è¯æ™‹å‡ä¸ä¼šè¿‡äºé¢‘ç¹æˆ–è¿‡äºä¸¥æ ¼ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">&gt; è¿™ä¸‰ä¸ªå‚æ•°ä¼šç›´æ¥å½±å“ BC å’Œ CC ä»»åŠ¡çš„é¢‘ç‡ï¼Œå°¤å…¶åœ¨é«˜é¢‘å¯¼å…¥åœºæ™¯ä¸‹éœ€è¦é€‚å½“è°ƒæ•´ã€‚æˆ‘ä»¬ä¼šåœ¨åç»­æ–‡ç« ä¸­ä¸¾ä¾‹è¯´æ˜ã€‚</code></p><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>3. å…¶ä»– Compaction å‚æ•°å’Œæ³¨æ„äº‹é¡¹<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿˜æœ‰ä¸€äº›å‚æ•°å’Œ Compaction ç›¸å…³ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦ä¿®æ”¹ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">disable_auto_compaction</code>ï¼šé»˜è®¤ä¸º falseï¼Œä¿®æ”¹ä¸º true åˆ™ä¼šç¦æ­¢ Compaction æ“ä½œã€‚è¯¥å‚æ•°ä»…åœ¨ä¸€äº›è°ƒè¯•æƒ…å†µï¼Œæˆ–è€… compaction å¼‚å¸¸éœ€è¦ä¸´æ—¶å…³é—­çš„æƒ…å†µä¸‹æ‰éœ€ä½¿ç”¨ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>Delete ç¾éš¾<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é€šè¿‡ DELETE FROM è¯­å¥æ‰§è¡Œçš„æ•°æ®åˆ é™¤æ“ä½œï¼Œåœ¨ Doris ä¸­ä¹Ÿä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®ç‰ˆæœ¬ç”¨äºæ ‡è®°åˆ é™¤ã€‚è¿™ç§ç±»å‹çš„æ•°æ®ç‰ˆæœ¬æ¯”è¾ƒç‰¹æ®Šï¼Œæˆ‘ä»¬æˆä¸º â€œåˆ é™¤ç‰ˆæœ¬â€ã€‚åˆ é™¤ç‰ˆæœ¬åªèƒ½é€šè¿‡ Base Compaction ä»»åŠ¡å¤„ç†ã€‚å› æ­¤åœ¨åœ¨é‡åˆ°åˆ é™¤ç‰ˆæœ¬æ—¶ï¼ŒCumulative Point ä¼šå¼ºåˆ¶å¢åŠ ï¼Œå°†åˆ é™¤ç‰ˆæœ¬ç§»åŠ¨åˆ° BC ä»»åŠ¡åŒºã€‚å› æ­¤æ•°æ®å¯¼å…¥å’Œåˆ é™¤äº¤æ›¿å‘ç”Ÿçš„åœºæ™¯é€šå¸¸ä¼šå¯¼è‡´ Compaction ç¾éš¾ã€‚æ¯”å¦‚ä»¥ä¸‹ç‰ˆæœ¬åºåˆ—ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">[11-11] åˆ é™¤ç‰ˆæœ¬<br  />[12-12]<br  />[13-13] åˆ é™¤ç‰ˆæœ¬<br  />[14-14]<br  />[15-15] åˆ é™¤ç‰ˆæœ¬<br  />[16-16]<br  />[17-17] åˆ é™¤ç‰ˆæœ¬<br  />...</code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCC ä»»åŠ¡å‡ ä¹ä¸ä¼šè¢«è§¦å‘ï¼ˆå› ä¸ºCCä»»åŠ¡åªèƒ½é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ï¼Œè€Œæ— æ³•å¤„ç†åˆ é™¤ç‰ˆæœ¬ï¼‰ï¼Œæ‰€æœ‰ç‰ˆæœ¬éƒ½ä¼šäº¤ç»™ Base Compaction å¤„ç†ï¼Œå¯¼è‡´ Compaction è¿›åº¦ç¼“æ…¢ã€‚ç›®å‰Dorisè¿˜æ— æ³•å¾ˆå¥½çš„å¤„ç†è¿™ç§åœºæ™¯ï¼Œå› æ­¤éœ€è¦åœ¨ä¸šåŠ¡ä¸Šå°½é‡é¿å…ã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;border-bottom: 2px solid rgb(239, 112, 96);font-size: 1.3em;"><span style="display: none;"></span><span style="display: inline-block;font-weight: bold;background: rgb(239, 112, 96);color: #ffffff;padding: 3px 10px 1px;border-top-right-radius: 3px;border-top-left-radius: 3px;margin-right: 3px;">Compactionè°ƒä¼˜(ä¸‰)</span><span style="display: inline-block;vertical-align: bottom;border-bottom: 36px solid #efebe9;border-right: 20px solid transparent;"> </span></h2><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>1. ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦è°ƒæ•´ Compaction å‚æ•°<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compaction çš„ç›®çš„æ˜¯åˆå¹¶å¤šä¸ªæ•°æ®ç‰ˆæœ¬ï¼Œä¸€æ˜¯é¿å…åœ¨è¯»å–æ—¶å¤§é‡çš„ Merge æ“ä½œï¼ŒäºŒæ˜¯é¿å…å¤§é‡çš„æ•°æ®ç‰ˆæœ¬å¯¼è‡´çš„éšæœºIOã€‚å¹¶ä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒCompaction æ“ä½œä¸èƒ½å ç”¨å¤ªå¤šçš„ç³»ç»Ÿèµ„æºã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»¥ç»“æœä¸ºå¯¼å‘ï¼Œä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢åæ¨æ˜¯å¦éœ€è¦è°ƒæ•´ Compaction ç­–ç•¥ã€‚</p><ol data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: decimal;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">æ£€æŸ¥æ•°æ®ç‰ˆæœ¬æ˜¯å¦æœ‰å †ç§¯ã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">æ£€æŸ¥ IO å’Œå†…å­˜èµ„æºæ˜¯å¦è¢« Compaction ä»»åŠ¡è¿‡å¤šçš„å ç”¨ã€‚</section></li></ol><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>æŸ¥çœ‹æ•°æ®ç‰ˆæœ¬æ•°é‡å˜åŒ–è¶‹åŠ¿<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Doris æä¾›æ•°æ®ç‰ˆæœ¬æ•°é‡çš„ç›‘æ§æ•°æ®ã€‚å¦‚æœä½ éƒ¨ç½²äº† Prometheus + Grafana çš„ç›‘æ§ï¼Œåˆ™å¯ä»¥é€šè¿‡ Grafana ä»ªè¡¨ç›˜çš„ BE Base Compaction Score å’Œ BE Cumu Compaction Score å›¾è¡¨æŸ¥çœ‹åˆ°è¿™ä¸ªç›‘æ§æ•°æ®çš„è¶‹åŠ¿å›¾ï¼š</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.2833333333333333" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/14_iclt4oiaaWMdGsomkCC2uGnZRdL7pw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8AFTF7J4SchaUuiaNohtPkcn9raSPiclt4oiaaWMdGsomkCC2uGnZRdL7pw/640?wx_fmt=png'" data-type="png" data-w="1080" style="display: block;margin: 0 auto;max-width: 100%;"  /></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">&gt; è¿™ä¸ªå›¾è¡¨å±•ç¤ºçš„æ˜¯æ¯ä¸ª BE èŠ‚ç‚¹ï¼Œæ‰€æœ‰ Tablet ä¸­æ•°æ®ç‰ˆæœ¬æœ€å¤šçš„é‚£ä¸ª Tablet çš„ç‰ˆæœ¬æ•°é‡ï¼Œå¯ä»¥åæ˜ å‡ºå½“å‰ç‰ˆæœ¬å †ç§¯æƒ…å†µã€‚</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">&gt; éƒ¨ç½²æ–¹å¼å‚é˜…ï¼šhttp://doris.incubator.apache.org/master/zh-CN/administrator-guide/operation/monitor-alert.html</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœæ²¡æœ‰å®‰è£…è¿™ä¸ªç›‘æ§ï¼Œå¦‚æœä½ æ˜¯ç”¨çš„ Palo 0.14.7 ç‰ˆæœ¬ä»¥ä¸Šï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤åœ¨å‘½ä»¤è¡ŒæŸ¥çœ‹è¿™ä¸ªç›‘æ§æ•°æ®çš„è¶‹åŠ¿å›¾ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">mysql&gt;&nbsp;ADMIN&nbsp;SHOW&nbsp;BACKEND&nbsp;METRIC&nbsp;(<span style="color: #98c379;line-height: 26px;">"nodes"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"30746894"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"metrics"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"BE_BASE_COMPACTION_SCORE"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"time"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"last&nbsp;4&nbsp;hours"</span>);<br  />mysql&gt;&nbsp;ADMIN&nbsp;SHOW&nbsp;BACKEND&nbsp;METRIC&nbsp;(<span style="color: #98c379;line-height: 26px;">"nodes"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"30746894"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"metrics"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"BE_CUMU_COMPACTION_SCORE"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"time"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">"last&nbsp;4&nbsp;hours"</span>);<br  /></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6018518518518519" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/15_13ZOjWCJyP9TElrcu20xiauMN3fFgw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8A838jafKaoRaAuIOKxsD49l6v013ZOjWCJyP9TElrcu20xiauMN3fFgw/640?wx_fmt=png'" data-type="png" data-w="1080" style="display: block;margin: 0 auto;max-width: 100%;"  /></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">&gt; è¯¥å‘½ä»¤å…·ä½“å¸®åŠ©å¯æ‰§è¡Œ HELP ADMIN SHOW METRIC æŸ¥çœ‹</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æ³¨æ„è¿™é‡Œæœ‰ä¸¤ä¸ªæŒ‡æ ‡ï¼Œåˆ†åˆ«è¡¨ç¤º Base Compaction å’Œ Cumulative Compaction æ‰€å¯¹åº”çš„ç‰ˆæœ¬æ•°é‡ã€‚åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦æŸ¥çœ‹ Cumulative Compaction çš„æŒ‡æ ‡ï¼Œå³å¯å¤§è‡´äº†è§£é›†ç¾¤çš„æ•°æ®ç‰ˆæœ¬å †ç§¯æƒ…å†µã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç‰ˆæœ¬æ˜¯å¦å †ç§¯æ²¡æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç•Œé™ï¼Œè€Œæ˜¯æ ¹æ®ä½¿ç”¨åœºæ™¯å’ŒæŸ¥è¯¢å»¶è¿Ÿè¿›è¡Œåˆ¤æ–­çš„ä¸€ä¸ªç»éªŒå€¼ã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œç®€å•çš„æ¨æ–­ï¼š</p><ol data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: decimal;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è§‚å¯Ÿæ•°æ®ç‰ˆæœ¬æ•°é‡çš„è¶‹åŠ¿ï¼Œå¦‚æœè¶‹åŠ¿å¹³ç¨³ï¼Œåˆ™è¯´æ˜ Compaction å’Œå¯¼å…¥é€Ÿåº¦åŸºæœ¬æŒå¹³ã€‚å¦‚æœå‘ˆä¸Šå‡æ€åŠ¿ï¼Œåˆ™è¯´æ˜ Compaction é€Ÿåº¦è·Ÿä¸ä¸Šå¯¼å…¥é€Ÿåº¦äº†ã€‚å¦‚æœå‘ˆä¸‹é™æ€åŠ¿ï¼Œè¯´æ˜ Compaction é€Ÿåº¦è¶…è¿‡äº†å¯¼å…¥é€Ÿåº¦ã€‚å¦‚æœå‘ˆä¸Šå‡æ€åŠ¿ï¼Œæˆ–åœ¨å¹³ç¨³çŠ¶æ€ä½†æ•°å€¼è¾ƒé«˜ï¼Œåˆ™éœ€è¦è€ƒè™‘è°ƒæ•´ Compaction å‚æ•°ä»¥åŠ å¿« Compaction çš„è¿›åº¦ã€‚</p></section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é€šå¸¸ç‰ˆæœ¬æ•°é‡ç»´æŒåœ¨ 100 ä»¥å†…å¯ä»¥è§†ä¸ºæ­£å¸¸ã€‚è€Œåœ¨å¤§éƒ¨åˆ†æ‰¹é‡å¯¼å…¥æˆ–ä½é¢‘å¯¼å…¥åœºæ™¯ä¸‹ï¼Œç‰ˆæœ¬æ•°é‡é€šå¸¸ä¸º10-20ç”šè‡³æ›´ä½ã€‚</p></section></li></ol><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>æŸ¥çœ‹Compactionèµ„æºå ç”¨<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">Compaction èµ„æºå ç”¨ä¸»è¦æ˜¯ IO å’Œ å†…å­˜ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¯¹äº Compaction å ç”¨çš„å†…å­˜ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨æ‰“å¼€ä»¥ä¸‹é“¾æ¥ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">http://be_host:webserver_port/mem_tracker</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨æœç´¢æ¡†ä¸­è¾“å…¥ AutoCompactionï¼š</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.1675925925925926" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/16_icP9d8a6hWd3Gia99W7ia0Jm9BibIg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8AYXDJL08r2voLYkVb5WCwqANktGFcicP9d8a6hWd3Gia99W7ia0Jm9BibIg/640?wx_fmt=png'" data-type="png" data-w="1080" style="display: block;margin: 0 auto;max-width: 100%;"  /></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åˆ™å¯ä»¥æŸ¥çœ‹å½“å‰Compactionçš„å†…å­˜å¼€é”€å’Œå†å²å³°å€¼å¼€é”€ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è€Œå¯¹äº IO æ“ä½œï¼Œç›®å‰è¿˜æ²¡æœ‰æä¾›å•ç‹¬çš„ Compaction æ“ä½œçš„ IO ç›‘æ§ï¼Œæˆ‘ä»¬åªèƒ½æ ¹æ®é›†ç¾¤æ•´ä½“çš„ IO åˆ©ç”¨ç‡æƒ…å†µæ¥åšåˆ¤æ–­ã€‚æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ç›‘æ§å›¾ Disk IO utilï¼š</p><figure data-tool="mdniceç¼–è¾‘å™¨" style="margin: 0;margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.525" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/17_44LssX8AyyhvGCgmWnp0ttxRibqPPQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2Mmou0pIyazjArfALCibvV8AyJeQMRX4z9XichY7vy1pwcq2Cf44LssX8AyyhvGCgmWnp0ttxRibqPPQ/640?wx_fmt=png'" data-type="png" data-w="1040" style="display: block;margin: 0 auto;max-width: 100%;"  /></figure><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æˆ–è€…é€šè¿‡å‘½ä»¤åœ¨å‘½ä»¤è¡ŒæŸ¥çœ‹ï¼ˆPalo 0.14.7 ä»¥ä¸Šç‰ˆæœ¬ï¼‰ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">mysql&gt; ADMIN SHOW BACKEND METRIC ("nodes" = "30746894", "metrics" = "BE_DISK_IO", "time" = "last 4 hours");</code></p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™ä¸ªç›‘æ§å±•ç¤ºçš„æ˜¯æ¯ä¸ª BE èŠ‚ç‚¹ä¸Šç£ç›˜çš„ IO util æŒ‡æ ‡ã€‚æ•°å€¼è¶Šé«˜è¡¨ç¤ºIOè¶Šç¹å¿™ã€‚å½“ç„¶å¤§éƒ¨åˆ†æƒ…å†µä¸‹ IO èµ„æºéƒ½æ˜¯æŸ¥è¯¢è¯·æ±‚æ¶ˆè€—çš„ï¼Œè¿™ä¸ªç›‘æ§ä¸»è¦ç”¨äºæŒ‡å¯¼æˆ‘ä»¬æ˜¯å¦éœ€è¦å¢åŠ æˆ–å‡å°‘ Compaction ä»»åŠ¡æ•°ã€‚</p><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>2. Compaction è°ƒä¼˜ç­–ç•¥<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœç‰ˆæœ¬æ•°é‡æœ‰ä¸Šå‡è¶‹åŠ¿æˆ–è€…æ•°å€¼è¾ƒé«˜ï¼Œåˆ™å¯ä»¥ä»ä»¥ä¸‹ä¸¤æ–¹é¢ä¼˜åŒ– Compactionï¼š</p><ol data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: decimal;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">ä¿®æ”¹ Compaction çº¿ç¨‹æ•°ï¼Œä½¿å¾—åŒæ—¶èƒ½å¤Ÿæ‰§è¡Œæ›´å¤šçš„ Compaction ä»»åŠ¡ã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">ä¼˜åŒ–å•ä¸ª Compaction çš„æ‰§è¡Œé€»è¾‘ï¼Œä½¿æ•°æ®ç‰ˆæœ¬æ•°é‡ç»´æŒåœ¨ä¸€ä¸ªåˆç†èŒƒå›´ã€‚</section></li></ol><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>ä¼˜åŒ–å‰çš„å‡†å¤‡å·¥ä½œ<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœ¨ä¼˜åŒ– Compaction æ‰§è¡Œé€»è¾‘ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›å‘½ä»¤æ¥è¿›ä¸€æ­¥æŸ¥çœ‹ä¸€äº›Compactionçš„ç»†èŠ‚ä¿¡æ¯ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡ç›‘æ§å›¾æ‰¾åˆ°ä¸€ä¸ªç‰ˆæœ¬æ•°é‡æœ€é«˜çš„ BE èŠ‚ç‚¹ã€‚ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ†ææ—¥å¿—ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">$&gt;&nbsp;grep&nbsp;<span style="color: #98c379;line-height: 26px;">"succeed&nbsp;to&nbsp;do&nbsp;base"</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">log</span>/be.INFO.log.20210505-142010&nbsp;|tail&nbsp;-n&nbsp;100<br  />$&gt;&nbsp;grep&nbsp;<span style="color: #98c379;line-height: 26px;">"succeed&nbsp;to&nbsp;do&nbsp;cumu"</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">log</span>/be.INFO.log.20210505-142010&nbsp;|tail&nbsp;-n&nbsp;100<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ä»¥ä¸Šä¸¤ä¸ªå‘½ä»¤å¯ä»¥æŸ¥çœ‹æœ€è¿‘100ä¸ªæ‰§è¡Œå®Œæˆçš„ compaction ä»»åŠ¡ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">I0505&nbsp;17:06:56.143455&nbsp;&nbsp;&nbsp;675&nbsp;compaction.cpp:135]&nbsp;succeed&nbsp;to&nbsp;<span style="color: #c678dd;line-height: 26px;">do</span>&nbsp;cumulative&nbsp;compaction.&nbsp;tablet=106827682.505347040.d040c1cdf71e5c95-3a002a06127ccd86,&nbsp;output_version=2-2631,&nbsp;current_max_version=2633,&nbsp;disk=/home/disk6/palo.HDD,&nbsp;segments=57.&nbsp;elapsed&nbsp;time=2.29371s.&nbsp;cumulative_compaction_policy=SIZE_BASED.<br  />I0505&nbsp;17:06:56.520058&nbsp;&nbsp;&nbsp;666&nbsp;compaction.cpp:135]&nbsp;succeed&nbsp;to&nbsp;<span style="color: #c678dd;line-height: 26px;">do</span>&nbsp;cumulative&nbsp;compaction.&nbsp;tablet=106822189.1661856168.654562832a620ea6-46fe84c73ea84795,&nbsp;output_version=2-3247,&nbsp;current_max_version=3250,&nbsp;disk=/home/disk2/palo.HDD,&nbsp;segments=22.&nbsp;elapsed&nbsp;time=2.66858s.&nbsp;cumulative_compaction_policy=SIZE_BASED.<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é€šè¿‡æ—¥å¿—æ—¶é—´å¯ä»¥åˆ¤æ–­ Compaction æ˜¯å¦åœ¨æŒç»­æ­£ç¡®çš„æ‰§è¡Œï¼Œé€šè¿‡ elapsed time å¯ä»¥è§‚å¯Ÿæ¯ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æˆ‘ä»¬è¿˜å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å±•ç¤ºæœ€è¿‘100ä¸ª compaction ä»»åŠ¡çš„é…é¢ï¼ˆpermitsï¼‰ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">$&gt;&nbsp;grep&nbsp;<span style="color: #98c379;line-height: 26px;">"permits"</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">log</span>/be.INFO&nbsp;|tail&nbsp;-n&nbsp;100<br  /><br  />I0505&nbsp;17:04:07.120920&nbsp;&nbsp;&nbsp;667&nbsp;compaction.cpp:83]&nbsp;start&nbsp;cumulative&nbsp;compaction.&nbsp;tablet=106827970.777011641.9c474de1b8ba9199-4addeb135d6834ac,&nbsp;output_version=2-2623,&nbsp;permits:&nbsp;39<br  />I0505&nbsp;17:04:13.898777&nbsp;&nbsp;&nbsp;672&nbsp;compaction.cpp:83]&nbsp;start&nbsp;cumulative&nbsp;compaction.&nbsp;tablet=106822777.1948936074.a44ac9462e79b76d-4a33ee39559bb0bf,&nbsp;output_version=2-3238,&nbsp;permits:&nbsp;22<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é…é¢å’Œç‰ˆæœ¬æ•°é‡æˆæ­£æ¯”ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æˆ‘ä»¬å¯ä»¥æ‰¾åˆ° permits è¾ƒå¤§çš„ä¸€ä¸ªä»»åŠ¡å¯¹åº”çš„ tablet idï¼Œå¦‚ä¸Šå›¾permit ä¸º 39 çš„ä»»åŠ¡çš„ tablet id ä¸º 106827970ï¼Œç„¶åç»§ç»­åˆ†æè¿™ä¸ª tablet çš„ compaction æƒ…å†µã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é€šè¿‡ MySQL å®¢æˆ·ç«¯è¿æ¥ Doris é›†ç¾¤åï¼Œæ‰§è¡Œï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">mysql&gt;&nbsp;show&nbsp;tablet&nbsp;106827970;<br  />+--------------------------+-----------+---------------+-----------+---------+----------+-------------+----------+--------+----------------------------------------------------------------------------+<br  />|&nbsp;DbName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;TableName&nbsp;|&nbsp;PartitionName&nbsp;|&nbsp;IndexName&nbsp;|&nbsp;DbId&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;TableId&nbsp;&nbsp;|&nbsp;PartitionId&nbsp;|&nbsp;IndexId&nbsp;&nbsp;|&nbsp;IsSync&nbsp;|&nbsp;DetailCmd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br  />+--------------------------+-----------+---------------+-----------+---------+----------+-------------+----------+--------+----------------------------------------------------------------------------+<br  />|&nbsp;default_cluster:<span style="color: #e6c07b;line-height: 26px;">test</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;tbl1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;p20210505&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;tbl1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3828954&nbsp;|&nbsp;63708800&nbsp;|&nbsp;106826829&nbsp;&nbsp;&nbsp;|&nbsp;63709761&nbsp;|&nbsp;<span style="color: #56b6c2;line-height: 26px;">true</span>&nbsp;&nbsp;&nbsp;|&nbsp;SHOW&nbsp;PROC&nbsp;<span style="color: #98c379;line-height: 26px;">'/dbs/3828954/63708800/partitions/106826829/63709761/106827970'</span>;&nbsp;|<br  />+--------------------------+-----------+---------------+-----------+---------+----------+-------------+----------+--------+----------------------------------------------------------------------------+<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">ç„¶åæ‰§è¡Œåé¢çš„ SHOW PROC è¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—è¿™ä¸ª tablet æ‰€æœ‰å‰¯æœ¬çš„è¯¦ç»†ä¿¡æ¯ã€‚å…¶ä¸­ VersionCount åˆ—è¡¨ç¤ºå¯¹åº”å‰¯æœ¬çš„æ•°æ®ç‰ˆæœ¬æ•°é‡ã€‚æˆ‘ä»¬å¯ä»¥é€‰å–ä¸€ä¸ª VersionCount è¾ƒå¤§çš„å‰¯æœ¬ï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€ CompactionStatus åˆ—æ˜¾ç¤ºçš„ URLï¼Œå¾—åˆ°å¦‚ä¸‹Jsonç»“æœï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">{<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"cumulative&nbsp;policy&nbsp;type"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"SIZE_BASED"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"cumulative&nbsp;point"</span>:&nbsp;18438,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"last&nbsp;cumulative&nbsp;failure&nbsp;time"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"1970-01-01&nbsp;08:00:00.000"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"last&nbsp;base&nbsp;failure&nbsp;time"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"1970-01-01&nbsp;08:00:00.000"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"last&nbsp;cumulative&nbsp;success&nbsp;time"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2021-05-05&nbsp;17:18:48.904"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"last&nbsp;base&nbsp;success&nbsp;time"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"2021-05-05&nbsp;16:14:49.786"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"rowsets"</span>:&nbsp;[<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[0-17444]&nbsp;13&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b1fb8d344f83103113563dd81740036795499d&nbsp;2.86&nbsp;GB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[17445-17751]&nbsp;1&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b25183344f83103113563dd81740036795499d&nbsp;68.61&nbsp;MB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[17752-18089]&nbsp;1&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b2b9a2344f83103113563dd81740036795499d&nbsp;74.52&nbsp;MB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[18090-18437]&nbsp;1&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b32686344f83103113563dd81740036795499d&nbsp;76.41&nbsp;MB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[18438-18678]&nbsp;1&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b37084344f83103113563dd81740036795499d&nbsp;53.07&nbsp;MB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[18679-18679]&nbsp;1&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b36d87344f83103113563dd81740036795499d&nbsp;3.11&nbsp;KB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[18680-18680]&nbsp;1&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b36d70344f83103113563dd81740036795499d&nbsp;258.40&nbsp;KB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"[18681-18681]&nbsp;1&nbsp;DATA&nbsp;NONOVERLAPPING&nbsp;0200000000b36da0344f83103113563dd81740036795499d&nbsp;266.98&nbsp;KB"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;],<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"stale_rowsets"</span>:&nbsp;[<br  />&nbsp;&nbsp;&nbsp;&nbsp;],<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"stale&nbsp;version&nbsp;path"</span>:&nbsp;[<br  />&nbsp;&nbsp;&nbsp;&nbsp;]<br  />}<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ª tablet çš„ Cumulative Pointï¼Œæœ€è¿‘ä¸€æ¬¡æˆåŠŸã€å¤±è´¥çš„ BC/CC ä»»åŠ¡æ—¶é—´ï¼Œä»¥åŠæ¯ä¸ª rowset çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚ä¸Šé¢è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</p><ol data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: decimal;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">åŸºçº¿æ•°æ®é‡å¤§çº¦åœ¨2-3GBï¼Œå¢é‡rowsetå¢é•¿åˆ°å‡ åMBåå°±ä¼šæ™‹å‡åˆ°BCä»»åŠ¡åŒºã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">æ–°å¢rowsetæ•°æ®é‡å¾ˆå°ï¼Œä¸”ç‰ˆæœ¬å¢é•¿è¾ƒå¿«ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªé«˜é¢‘å°æ‰¹é‡çš„å¯¼å…¥åœºæ™¯ã€‚</section></li></ol><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æˆ‘ä»¬è¿˜å¯ä»¥è¿›ä¸€æ­¥çš„é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ†ææŒ‡å®š tablet id çš„æ—¥å¿—ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;æŸ¥çœ‹&nbsp;tablet&nbsp;48062815&nbsp;æœ€è¿‘åä¸ªä»»åŠ¡çš„é…é¢æƒ…å†µ</span><br  />$&gt;&nbsp;grep&nbsp;permits&nbsp;<span style="color: #e6c07b;line-height: 26px;">log</span>/be.INFO&nbsp;|grep&nbsp;48062815&nbsp;|tail&nbsp;-n&nbsp;10<br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;æŸ¥çœ‹&nbsp;tablet&nbsp;48062815&nbsp;æœ€è¿‘åä¸ªæ‰§è¡Œå®Œæˆçš„&nbsp;compaction&nbsp;ä»»åŠ¡</span><br  />$&gt;&nbsp;grep&nbsp;<span style="color: #98c379;line-height: 26px;">"succeed&nbsp;to&nbsp;do"</span>&nbsp;<span style="color: #e6c07b;line-height: 26px;">log</span>/be.INFO&nbsp;|grep&nbsp;48062815&nbsp;|tail&nbsp;-n&nbsp;10<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨æµè§ˆå™¨æ‰“å¼€ä»¥ä¸‹ URLï¼ŒæŸ¥çœ‹ä¸€ä¸ª BE èŠ‚ç‚¹å½“å‰æ­£åœ¨æ‰§è¡Œçš„ compaction ä»»åŠ¡ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">be_host:webserver_port/api/compaction/run_status</code></p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">{<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"CumulativeCompaction"</span>:&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"/home/disk2/palo"</span>:&nbsp;[],<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"/home/disk1/palo"</span>:&nbsp;[<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"48061239"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br  />&nbsp;&nbsp;&nbsp;&nbsp;},<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"BaseCompaction"</span>:&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"/home/disk2/palo"</span>:&nbsp;[],<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"/home/disk1/palo"</span>:&nbsp;[<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"48062815"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"48061276"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  />}<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™ä¸ªæ¥å£å¯ä»¥çœ‹åˆ°æ¯ä¸ªç£ç›˜ä¸Šå½“å‰æ­£åœ¨æ‰§è¡Œçš„ compaction ä»»åŠ¡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">é€šè¿‡ä»¥ä¸Šä¸€ç³»åˆ—çš„åˆ†æï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥å¯¹ç³»ç»Ÿçš„ Compaction æƒ…å†µæœ‰ä»¥ä¸‹åˆ¤æ–­ï¼š</p><ol data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: black;list-style-type: decimal;" class="list-paddingleft-1"><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">Compaction ä»»åŠ¡çš„æ‰§è¡Œé¢‘ç‡ã€æ¯ä¸ªä»»åŠ¡å¤§è‡´çš„æ‰§è¡Œè€—æ—¶ã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">æŒ‡å®šèŠ‚ç‚¹æ•°æ®ç‰ˆæœ¬æ•°é‡çš„å˜åŒ–æƒ…å†µã€‚</section></li><li><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;text-align: left;color: rgb(1,1,1);font-weight: 500;">æŒ‡å®š tablet æ•°æ®ç‰ˆæœ¬çš„å˜åŒ–æƒ…å†µï¼Œä»¥åŠ compaction çš„é¢‘ç‡ã€‚</section></li></ol><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™äº›ç»“è®ºå°†æŒ‡å¯¼æˆ‘ä»¬å¯¹ Compaction è¿›è¡Œè°ƒä¼˜ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>ä¿®æ”¹ Compaction çº¿ç¨‹æ•°<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¢åŠ  Compaction çº¿ç¨‹æ•°æ˜¯ä¸€ä¸ªéå¸¸ç›´æ¥çš„åŠ é€Ÿ Compaction çš„æ–¹æ³•ã€‚ä½†æ˜¯æ›´å¤šçš„ä»»åŠ¡æ„å‘³ç€æ›´å¤§çš„ IO å’Œ å†…å­˜å¼€é”€ã€‚å°¤å…¶åœ¨æœºæ¢°ç£ç›˜ä¸Šï¼Œå› ä¸ºéšæœºè¯»å†™é—®é¢˜ï¼Œæœ‰æ—¶å¯èƒ½å•çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œçš„æ•ˆç‡ä¼šé«˜äºå¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œã€‚Doris é»˜è®¤é…ç½®ä¸ºæ¯å—ç›˜ä¸¤ä¸ª Compaction ä»»åŠ¡ï¼ˆè¿™ä¹Ÿæ˜¯æœ€å°çš„åˆæ³•é…ç½®ï¼‰ï¼Œæœ€å¤š 10 ä¸ªä»»åŠ¡ã€‚å¦‚æœç£ç›˜æ•°é‡å¤šäº 5ï¼Œåœ¨å†…å­˜å…è®¸çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¿®æ”¹ max_compaction_threads å‚æ•°å¢åŠ æ€»ä»»åŠ¡æ•°ï¼Œä»¥ä¿è¯æ¯å—ç›˜å¯ä»¥æ‰§è¡Œä¸¤ä¸ª Compaction ä»»åŠ¡ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¯¹äºæœºæ¢°ç£ç›˜ï¼Œä¸å»ºè®®å¢åŠ æ¯å—ç›˜çš„ä»»åŠ¡æ•°ã€‚å¯¹äºå›ºæ€ç¡¬ç›˜ï¼Œå¯ä»¥è€ƒè™‘ä¿®æ”¹ compaction_task_num_per_disk å‚æ•°é€‚å½“å¢åŠ æ¯å—ç›˜çš„ä»»åŠ¡æ•°ï¼Œå¦‚ä¿®æ”¹ä¸º 4ã€‚æ³¨æ„ä¿®æ”¹è¿™ä¸ªå‚æ•°çš„åŒæ—¶å¯èƒ½è¿˜éœ€åŒæ­¥ä¿®æ”¹ max_compaction_threadsï¼Œä½¿å¾— max_compaction_threads å¤§äºç­‰äº compaction_task_num_per_disk * ç£ç›˜æ•°é‡ã€‚</p><h5 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 16px;"><span style="display: none;"></span>ä¼˜åŒ–å•ä¸ª Compaction ä»»åŠ¡é€»è¾‘<span style="display: none;"></span></h5><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™ä¸ªä¼˜åŒ–æ–¹å¼æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å°è¯•ä»å‡ ä¸ªåœºæ™¯å‡ºå‘æ¥è¯´æ˜ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœºæ™¯ä¸€ï¼šåŸºçº¿æ•°æ®é‡å¤§ï¼ŒBase Compaction ä»»åŠ¡æ‰§è¡Œæ—¶é—´é•¿ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">BC ä»»åŠ¡æ‰§è¡Œæ—¶é—´é•¿ï¼Œæ„å‘³ç€ä¸€ä¸ªä»»åŠ¡ä¼šé•¿æ—¶é—´å ç”¨ Compaction å·¥ä½œçº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´å…¶ä»– tablet çš„ compaction ä»»åŠ¡æ—¶é—´è¢«æŒ¤å ã€‚å¦‚æœæ˜¯å› ä¸º 0 å·ç‰ˆæœ¬çš„åŸºçº¿æ•°æ®é‡è¾ƒå¤§å¯¼è‡´ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°½é‡æ¨è¿Ÿå¢é‡rowset æ™‹å‡åˆ° BC ä»»åŠ¡åŒºçš„æ—¶é—´ã€‚ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°å°†å½±å“è¿™ä¸ªé€»è¾‘ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">cumulative_size_based_promotion_ratio</code>ï¼šé»˜è®¤ 0.05ï¼ŒåŸºçº¿æ•°æ®é‡ä¹˜ä»¥è¿™ä¸ªç³»æ•°ï¼Œå³æ™‹å‡é˜ˆå€¼ã€‚å¯ä»¥è°ƒå¤§è¿™ä¸ªç³»æ•°æ¥æé«˜æ™‹å‡é˜ˆå€¼ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">cumulative_size_based_promotion_size_mbytes</code>ï¼šé»˜è®¤ 1024MBã€‚å¦‚æœå¢é‡rowsetçš„æ•°æ®é‡å¤§äºè¿™ä¸ªå€¼ï¼Œåˆ™ä¼šå¿½ç•¥ç¬¬ä¸€ä¸ªå‚æ•°çš„é˜ˆå€¼ç›´æ¥æ™‹å‡ã€‚å› æ­¤éœ€è¦åŒæ—¶è°ƒæ•´è¿™ä¸ªå‚æ•°æ¥æå‡æ™‹å‡é˜ˆå€¼ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å½“ç„¶ï¼Œæå‡æ™‹å‡é˜ˆå€¼ï¼Œä¼šå¯¼è‡´å•ä¸ª BC ä»»åŠ¡éœ€è¦å¤„ç†æ›´å¤§çš„æ•°æ®é‡ï¼Œè€—æ—¶æ›´é•¿ï¼Œä½†æ˜¯æ€»ä½“çš„æ•°æ®é‡ä¼šå‡å°‘ã€‚ä¸¾ä¸ªä¾‹å­ã€‚åŸºçº¿æ•°æ®å¤§å°ä¸º 1024GBï¼Œå‡è®¾æ™‹å‡é˜ˆå€¼åˆ†åˆ«ä¸º 100MB å’Œ 200MBã€‚æ•°æ®å¯¼å…¥é€Ÿåº¦ä¸º 100MB/åˆ†é’Ÿã€‚æ¯5ä¸ªç‰ˆæœ¬æ‰§è¡Œä¸€æ¬¡ BCã€‚é‚£ä¹ˆç†è®ºä¸Šåœ¨10åˆ†é’Ÿå†…ï¼Œé˜ˆå€¼ä¸º 100MB æ—¶ï¼ŒBC ä»»åŠ¡å¤„ç†çš„æ€»æ•°æ®é‡ä¸º ï¼ˆ1024 + 100 * 5ï¼‰* 2 = 3048MBã€‚é˜ˆå€¼ä¸º 200MB æ˜¯ï¼ŒBC ä»»åŠ¡å¤„ç†çš„æ€»æ•°æ®é‡ä¸º (1024 + 200 * 5) = 2024 MBã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">åœºæ™¯äºŒï¼šå¢é‡æ•°æ®ç‰ˆæœ¬æ•°é‡å¢é•¿è¾ƒå¿«ï¼ŒCumulative Compaction å¤„ç†è¿‡å¤šç‰ˆæœ¬ï¼Œè€—æ—¶è¾ƒé•¿ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;"><code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">max_cumulative_compaction_num_singleton_deltas</code> å‚æ•°æ§åˆ¶ä¸€ä¸ª CC ä»»åŠ¡æœ€å¤šåˆå¹¶å¤šå°‘ä¸ªæ•°æ®ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼ä¸º 1000ã€‚æˆ‘ä»¬è€ƒè™‘è¿™æ ·ä¸€ç§åœºæ™¯ï¼šé’ˆå¯¹æŸä¸€ä¸ª tabletï¼Œå…¶æ•°æ®ç‰ˆæœ¬çš„å¢é•¿é€Ÿåº¦ä¸º 1ä¸ª/ç§’ã€‚è€Œå…¶ CC ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ + è°ƒåº¦æ—¶é—´æ˜¯ 1000ç§’ï¼ˆå³å•ä¸ª CC ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´åŠ ä¸ŠCompactionå†ä¸€æ¬¡è°ƒåº¦åˆ°è¿™ä¸ª tablet çš„æ—¶é—´æ€»å’Œï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šçœ‹åˆ°è¿™ä¸ª tablet çš„ç‰ˆæœ¬æ•°é‡åœ¨ 1-1000ä¹‹é—´æµ®åŠ¨ï¼ˆè¿™é‡Œæˆ‘ä»¬å¿½ç•¥åŸºçº¿ç‰ˆæœ¬æ•°é‡ï¼‰ã€‚å› ä¸ºåœ¨ä¸‹ä¸€æ¬¡ CC ä»»åŠ¡æ‰§è¡Œå‰çš„ 1000 ç§’å†…ï¼Œåˆä¼šç´¯ç§¯ 1000 ä¸ªç‰ˆæœ¬ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™ç§æƒ…å†µå¯èƒ½å¯¼è‡´è¿™ä¸ª tablet çš„è¯»å–æ•ˆç‡å¾ˆä¸ç¨³å®šã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥å°è¯•è°ƒå° <code style="font-size: 14px;word-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin: 0 2px;background-color: rgba(27,31,35,.05);font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(239, 112, 96);">max_cumulative_compaction_num_singleton_deltas</code> è¿™ä¸ªå‚æ•°ï¼Œè¿™æ ·ä¸€ä¸ª CC æ‰€è¦åˆå¹¶çš„ç‰ˆæœ¬æ•°æ›´å°‘ï¼Œæ‰§è¡Œæ—¶é—´æ›´çŸ­ï¼Œæ‰§è¡Œé¢‘ç‡ä¼šæ›´é«˜ã€‚è¿˜æ˜¯åˆšæ‰è¿™ä¸ªåœºæ™¯ï¼Œå‡è®¾å‚æ•°è°ƒæ•´åˆ°500ï¼Œè€Œå¯¹åº”çš„ CC ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ + è°ƒåº¦æ—¶é—´ä¹Ÿé™ä½åˆ° 500ï¼Œåˆ™ç†è®ºä¸Šè¿™ä¸ª tablet çš„ç‰ˆæœ¬æ•°é‡å°†ä¼šåœ¨ 1-500 ä¹‹é—´æµ®åŠ¨ï¼Œç›¸æ¯”äºä¹‹å‰ï¼Œç‰ˆæœ¬æ•°é‡æ›´ç¨³å®šã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å½“ç„¶è¿™ä¸ªåªæ˜¯ç†è®ºæ•°å€¼ï¼Œå®é™…æƒ…å†µè¿˜è¦è€ƒè™‘ä»»åŠ¡çš„å…·ä½“æ‰§è¡Œæ—¶é—´ã€è°ƒåº¦æƒ…å†µç­‰ç­‰ã€‚</p><h4 data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 30px;margin-bottom: 15px;padding: 0px;font-weight: bold;color: black;font-size: 18px;"><span style="display: none;"></span>3. æ‰‹åŠ¨ Compaction<span style="display: none;"></span></h4><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">æŸäº›æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨ Compaction ç­–ç•¥å¯èƒ½æ— æ³•é€‰å–åˆ°æŸäº› tabletï¼Œè¿™æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦é€šè¿‡ Compaction æ¥å£æ¥ä¸»åŠ¨è§¦å‘æŒ‡å®š tablet çš„ Compactionã€‚æˆ‘ä»¬ä»¥ curl å‘½ä»¤ä¸¾ä¾‹ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">curl&nbsp;-X&nbsp;POST&nbsp;http://192.168.1.1:8040/api/compaction/run?tablet_id=106818600\&amp;schema_hash=6979334\&amp;compact_type=cumulative<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™é‡Œæˆ‘ä»¬æŒ‡å®š id ä¸º 106818600ï¼Œschema hash ä¸º 6979334 çš„ tablet è¿›è¡Œ Cumulative Compactionï¼ˆcompact_typeå‚æ•°ä¸º base åˆ™è§¦å‘ Base Compactionï¼‰ã€‚å…¶ä¸­ schema hash å¯ä»¥é€šè¿‡ SHOW TABLET tablet_id å‘½ä»¤å¾—åˆ°çš„ SHOW PROC å‘½ä»¤è·å–ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å¦‚æœæäº¤æˆåŠŸï¼Œåˆ™ä¼šè¿”å›ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">{<span style="color: #98c379;line-height: 26px;">"status"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"Success"</span>,&nbsp;<span style="color: #98c379;line-height: 26px;">"msg"</span>:&nbsp;<span style="color: #98c379;line-height: 26px;">"compaction&nbsp;task&nbsp;is&nbsp;successfully&nbsp;triggered."</span>}<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œå‘½ä»¤åªæ˜¯æäº¤compaction ä»»åŠ¡ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ API æ¥æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦åœ¨è¿è¡Œï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">curl&nbsp;-X&nbsp;GET&nbsp;http://192.168.1.1:8040/api/compaction/run_status?tablet_id=106818600\&amp;schema_hash=6979334<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">è¿”å›ç»“æœï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">{<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"status"</span>&nbsp;:&nbsp;<span style="color: #98c379;line-height: 26px;">"Success"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"run_status"</span>&nbsp;:&nbsp;<span style="color: #56b6c2;line-height: 26px;">false</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"msg"</span>&nbsp;:&nbsp;<span style="color: #98c379;line-height: 26px;">"compaction&nbsp;task&nbsp;for&nbsp;this&nbsp;tablet&nbsp;is&nbsp;running"</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"tablet_id"</span>&nbsp;:&nbsp;106818600,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"schema_hash"</span>&nbsp;:&nbsp;6979334,<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"compact_type"</span>&nbsp;:&nbsp;<span style="color: #98c379;line-height: 26px;">"cumulative"</span><br  />}<br  /></code></pre><p data-tool="mdniceç¼–è¾‘å™¨" style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;">å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥æŸ¥çœ‹ tablet çš„ç‰ˆæœ¬æƒ…å†µï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YDUEFrFh05SL5iciaTvRNZAEEzMZY6tXBVNF4VgXhQynyJpev0p4RHriar61VryCud8jd7GEvILaEps20tiatUPo475/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">curl&nbsp;-X&nbsp;GET&nbsp;http://192.168.1.1:8040/api/compaction/show?tablet_id=106818600\&amp;schema_hash=6979334</code></pre></section><section style="margin-top: 5px;margin-bottom: 5px;max-width: 100%;line-height: 26px;color: rgb(1, 1, 1);overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: left;"><span style="letter-spacing: 0.544px;color: rgb(74, 74, 74);max-width: 100%;font-size: 15px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;"><br  /></span></section><section style="margin-top: 5px;margin-bottom: 5px;max-width: 100%;line-height: 26px;color: rgb(1, 1, 1);overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: left;"><span style="letter-spacing: 0.544px;color: rgb(74, 74, 74);max-width: 100%;font-size: 15px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;">å¦‚æœè¿™ä¸ªæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸è¦å¿˜è®°&nbsp;</span><span style="letter-spacing: 0.544px;max-width: 100%;outline: 0px;font-size: 15px;background-color: rgb(255, 255, 255);color: rgb(255, 104, 39);overflow-wrap: break-word !important;box-sizing: border-box !important;"><strong style="max-width: 100%;outline: 0px;line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;">ã€Œåœ¨çœ‹ã€</strong>&nbsp;<strong style="max-width: 100%;outline: 0px;line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;">ã€Œç‚¹èµã€</strong>&nbsp;<strong style="max-width: 100%;outline: 0px;line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;">ã€Œæ”¶è—ã€</strong></span><span style="letter-spacing: 0.544px;color: rgb(74, 74, 74);max-width: 100%;font-size: 15px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;">&nbsp;ä¸‰è¿å•Šå–‚ï¼</span><br  /></section></section></section><section style="max-width: 100%;white-space: normal;margin-bottom: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: center;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.4662576687116564" data-s="300,640" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/18_T7huEHTT4z45Jibay1ZebmsSSqiaeA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MPL7m13Yrluz8WJicNiaVRsiaCqArkyO99exPDGicFIH6AF7ZWRpT7huEHTT4z45Jibay1ZebmsSSqiaeA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="978" style="height: 204px;font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: center;widows: 1;color: rgb(255, 97, 149);font-size: 15px;letter-spacing: 1px;border-radius: 30px;box-shadow: rgb(150, 150, 150) 0em 0em 0.5em 0px;width: 438px;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;text-align: left;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;"><br  /></section><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135ç¼–è¾‘å™¨" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="å›¾ç‰‡/å¤§æ•°æ®æŠ€æœ¯ä¸æ¶æ„_2022-06-29_Apache Doris Compactionä¼˜åŒ–ç™¾ç§‘å…¨ä¹¦/19_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="height: 42px;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;overflow-wrap: break-word !important;"  /></section><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135ç¼–è¾‘å™¨" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022å¹´å…¨ç½‘é¦–å‘|å¤§æ•°æ®ä¸“å®¶çº§æŠ€èƒ½æ¨¡å‹ä¸å­¦ä¹ æŒ‡å—(èƒœå¤©åŠå­ç¯‡)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">2022å¹´å…¨ç½‘é¦–å‘|å¤§æ•°æ®ä¸“å®¶çº§æŠ€èƒ½æ¨¡å‹ä¸å­¦ä¹ æŒ‡å—(èƒœå¤©åŠå­ç¯‡)</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="äº’è”ç½‘æœ€åçš„æ—¶ä»£å¯èƒ½çœŸçš„æ¥äº†" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">äº’è”ç½‘æœ€åçš„æ—¶ä»£å¯èƒ½çœŸçš„æ¥äº†</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="æˆ‘åœ¨Bç«™è¯»å¤§å­¦ï¼Œå¤§æ•°æ®ä¸“ä¸š" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">æˆ‘åœ¨Bç«™è¯»å¤§å­¦ï¼Œå¤§æ•°æ®ä¸“ä¸š</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">æˆ‘ä»¬åœ¨å­¦ä¹ Flinkçš„æ—¶å€™ï¼Œåˆ°åº•åœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿ</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">193ç¯‡æ–‡ç« æš´æFlinkï¼Œè¿™ä¸ªåˆé›†ä½ éœ€è¦å…³æ³¨ä¸€ä¸‹</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">Flinkç”Ÿäº§ç¯å¢ƒTOPéš¾é¢˜ä¸ä¼˜åŒ–ï¼Œé˜¿é‡Œå·´å·´è—ç»é˜YYDS</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">Flink CDCæˆ‘åƒå®šäº†è€¶ç¨£ä¹Ÿç•™ä¸ä½ä»–ï¼| Flink CDCçº¿ä¸Šé—®é¢˜å°ç›˜ç‚¹</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">æˆ‘ä»¬åœ¨å­¦ä¹ Sparkçš„æ—¶å€™ï¼Œåˆ°åº•åœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿ</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">åœ¨æ‰€æœ‰Sparkæ¨¡å—ä¸­ï¼Œæˆ‘æ„¿ç§°SparkSQLä¸ºæœ€å¼ºï¼</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">ç¡¬åˆšHive | 4ä¸‡å­—åŸºç¡€è°ƒä¼˜é¢è¯•å°æ€»ç»“</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">æ•°æ®æ²»ç†æ–¹æ³•è®ºå’Œå®è·µå°ç™¾ç§‘å…¨ä¹¦</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">æ ‡ç­¾ä½“ç³»ä¸‹çš„ç”¨æˆ·ç”»åƒå»ºè®¾å°æŒ‡å—</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4ä¸‡å­—é•¿æ–‡ | ClickHouseåŸºç¡€&amp;å®è·µ&amp;è°ƒä¼˜å…¨è§†è§’è§£æ</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">ã€é¢è¯•&amp;ä¸ªäººæˆé•¿ã€‘2021å¹´è¿‡åŠï¼Œç¤¾æ‹›å’Œæ ¡æ‹›çš„ç»éªŒä¹‹è°ˆ</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">å¤§æ•°æ®æ–¹å‘å¦ä¸€ä¸ªåå¹´å¼€å¯ |ã€Šç¡¬åˆšç³»åˆ—ã€‹ç¬¬ä¸€ç‰ˆå®Œç»“</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">æˆ‘å†™è¿‡çš„å…³äºæˆé•¿/é¢è¯•/èŒåœºè¿›é˜¶çš„æ–‡ç« </a></section><section style="max-width: 100%;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135ç¼–è¾‘å™¨" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">å½“æˆ‘ä»¬åœ¨å­¦ä¹ Hiveçš„æ—¶å€™åœ¨å­¦ä¹ ä»€ä¹ˆï¼Ÿã€Œç¡¬åˆšHiveç»­é›†ã€</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></content>
</div>
</body>
</html>