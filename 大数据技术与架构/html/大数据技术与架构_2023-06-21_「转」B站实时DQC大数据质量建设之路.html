<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"B站实时DQC大数据质量建设之路","time":"2023-06-21 11:45:48","timeStamp":"1687319148"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247519223&idx=1&sn=bdb6ba93ce659e2ecfa6f60b6bda29df&chksm=fd3ecd62ca494474acdae628d30a561039ffe4c36458a065ad01819b478cf72e3f78ea10a15d#rd" target="_blank">B站实时DQC大数据质量建设之路</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">韩志华冯益峰王鼎&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-06-21 11:45:48</em></div><content><div class="reprint"><p>转自公众号：哔哩哔哩技术<br><a href="http://mp.weixin.qq.com/s?__biz=Mzg3Njc0NTgwMg==&mid=2247493174&idx=1&sn=648bf0ffb5e31b1c211d22e636e2c3df" target="_blank" title="阅读原文">http://mp.weixin.qq.com/s?__biz=Mzg3Njc0NTgwMg==&mid=2247493174&idx=1&sn=648bf0ffb5e31b1c211d22e636e2c3df</a></p></div><section data-mpa-powered-by="yiban.io"><section powered-by="xiumi.us"><section><section><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;outline: 0px;color: rgb(34, 34, 34);font-size: 14.875px;text-size-adjust: auto;letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 23.625px;visibility: visible;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-role="outer" label="Powered by 135editor.com" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tools="135编辑器" data-id="98469" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 21.875px;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><blockquote data-tool="mdnice编辑器" mp-original-font-size="14.399999618530273" mp-original-line-height="23" style="margin: 20px 0px;padding: 10px 10px 10px 20px;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);line-height: 20.125px;font-size: 12.6px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;border-top-style: none;border-right-style: none;border-bottom-style: none;overflow: auto;background-color: rgb(255, 249, 249);visibility: visible;"><p mp-original-font-size="16" mp-original-line-height="26" style="margin: 0px;padding: 8px 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 22.75px;visibility: visible;"><span mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;color: rgb(89, 89, 89);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0.544px;text-align: left;font-size: 12.25px;visibility: visible;line-height: 22.75px;"><strong mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;visibility: visible;font-size: 12.25px;line-height: 22.75px;"><img class="rich_pages wxw-img" data-ratio="1" data-type="png" data-w="64" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/1_6VyhjNCMic3DGmPLZocTtEmtWBJKsQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2OP8CL6Mmrc9shxR4OiamrPMlRCKiaicf2n4JLNDRcyH1jfEKxo6VyhjNCMic3DGmPLZocTtEmtWBJKsQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" style="margin: 0px;padding: 0px;max-width: 100%;height: auto !important;overflow-wrap: break-word !important;vertical-align: text-bottom;outline: 0px;display: inline-block;font-size: 10.7188px;line-height: 19.9062px;box-sizing: border-box !important;visibility: visible !important;width: 20px !important;"  /><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247518343&amp;idx=1&amp;sn=eaf44bee8c4d90aedd508201475b57a9&amp;chksm=fd3ece12ca494704cdf02300bbfe39c1d4245ac30f41aba3065efe66eb9aa453a23e0b6dae6e&amp;scene=21#wechat_redirect" textvalue="300万字！全网最全大数据学‍习面试社区等你来！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-size: 14px;color: rgb(255, 41, 65);">300万字！全网最全大数据学习面试社区等你来！</span></strong></a></strong></span></p></blockquote></section></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25.14285659790039" style="margin: 0px 0px 24px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0px;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;outline: 0px;text-size-adjust: auto;font-size: 14px;color: black;line-height: 22px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><br  /></section></section></section></section><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;vertical-align: top;padding-left: 10px;box-sizing: border-box;"><section style="border-bottom: 1px dashed rgb(0, 0, 0);padding-left: 5px;font-size: 20px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">背景</strong></p></section><section style="margin-top: -7px;margin-left: -10px;width: 10px;box-sizing: border-box;"><section style="transform: rotate(0deg);-webkit-transform: rotate(0deg);-moz-transform: rotate(0deg);-o-transform: rotate(0deg);margin-left: auto;width: 7px;height: 7px;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="margin-top: -4px;margin-left: -3px;width: 10px;height: 10px;background-color: rgb(12, 182, 242);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">数据质量是基于大数据衍生的应用有效与否的重要的前提和保障之一。B站现在高速发展的业务需求以及未来能够依靠大数据孵化出更有深度和竞争力应用的愿景，都要求我们数据平台能够提供实时的、准确的、可以被各个业务方所信赖的数据。可以说，可信赖的数据，是大数据平台核心竞争力的体现。因此，在B站的大数据平台的建设过程中，数据质量平台成为了不可或缺的一环，因为它的使命便是为大数据平台的数据质量保驾护航。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;font-size: 18px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">&nbsp;质量平台</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">平台组件</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.6410256410256411" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/2_5f97WIV9LbeHYrGTTNIdUFhJcmuXFg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRmIHcBjGVeGt78JjOjiaaV5UMx5f97WIV9LbeHYrGTTNIdUFhJcmuXFg/640?wx_fmt=png'" data-type="png" data-w="780" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;font-size: 18px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">&nbsp;DQC简介</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">功能图</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.3990740740740741" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/3_iaD2U2ZDxNQC8bh8HJ6lEjW2gMTKkg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRldUFD3OItTscMQkW1r39QqINhiaD2U2ZDxNQC8bh8HJ6lEjW2gMTKkg/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><ul class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">DQC主要的工作链路与普通的监控系统如prometheus基本相似，过程都包括数据采集、数据检查、告警通知，都需要尽量减少对监控对象正常工作的影响，同时对监控对象的异常做到及时告警。</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">功能上有离线和实时之分</p></li><li><section style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;text-indent: 0em;text-align: justify;margin-left: 32px;margin-right: 32px;">离线DQC：主要用来保障由离线任务生产出来的数据，触发规则主要是由离线调度任务完成后来通知DQC做采集，然后再根据阈值进行检查及告警。通常用户配置检查规则，一般会在下一次任务完成后生效。</section></li><li><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><section style="word-break: break-all;white-space: normal;box-sizing: border-box;text-indent: 0em;margin-left: 32px;margin-right: 32px;">实时DQC：主要针对Kafka数据源。Kafka是大数据平台中一个非常重要的基础组件，特别是在实时数仓中，使用的则更加频<span style="text-indent: 0em;box-sizing: border-box;">繁。一般是根据规则在固定的检查周期对在一定窗口数据进行采集及检查。通常用户配置检查规则，一般会在下一个数据周期后生效。</span></section></section></li></ul></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;vertical-align: top;padding-left: 10px;box-sizing: border-box;"><section style="border-bottom: 1px dashed rgb(0, 0, 0);padding-left: 5px;font-size: 20px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">实时DQC</strong></p></section><section style="margin-top: -7px;margin-left: -10px;width: 10px;box-sizing: border-box;"><section style="transform: rotate(0deg);-webkit-transform: rotate(0deg);-moz-transform: rotate(0deg);-o-transform: rotate(0deg);margin-left: auto;width: 7px;height: 7px;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="margin-top: -4px;margin-left: -3px;width: 10px;height: 10px;background-color: rgb(12, 182, 242);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;font-size: 18px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">&nbsp;第一版方案</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.5601851851851852" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/4_Plnbbkh4tqb6YQSWhERHa19owbVIMQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRXaCJgKo4eA3bXrAF2xgYUb8BPlnbbkh4tqb6YQSWhERHa19owbVIMQ/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">公司内部流计算的主流框架是Flink，所有实时DQC也是采用Flink计算框架。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">实时DQC 相对离线DQC复杂不少，因为它的数据采集任务是一直运行着的，向一个已经运行的任务中去更新规则，或者新增采集对象，有一定的难度。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">因此在第一版方案中，用户每新增一个采集对象或一个规则，DQC服务会为用户重新生成一个新的Flink任务来完成采集，并将采集结果写入到MySQL中。同时定时触发质量规则检查，将检查结果写入到MySQL中，并根据检查结果判断是否做告警通知。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">这个方案架构简单，但是仍存在以下弊端：</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">资源利用率低：</strong>&nbsp;由于一个检查规则一个数据采集任务，导致Flink任务大多数时间都比较空闲，特别在一些流量小的Topic更加明显。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">网络带宽消耗大：</strong>&nbsp;对一个Topic不同的规则，需要多个任务去消费。如果Topic流量很大，对网络带宽会有很大冲击。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">稳定性差：</strong>&nbsp;规则的修改需要重启数据采集任务，集群资源紧张时可能因为申请不到YARN/K8s资源而导致启动失败。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">监控程序本身占用资源大，在降本增效为主流的现在，是不合时宜的。因此，我们迫切需要对实时DQC的方案进行改造，在资源使用上有下面三个要求：</p><ol class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">一次启动，不再重启。避免资源竞争，提高系统可用性。</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">一个任务，多Topic共用。实际应用中，一些Topic流量很小，导致Flink任务大多数时间都比较空闲。如果一个Flink可以多消费几个这样Topic，相同的资源做更多的事，资源利用率更高。</p></li><li style="box-sizing: border-box;"><p style="word-break: break-all;box-sizing: border-box;">一次消费，多规则校验。避免多任务重复消费一个Topic，减少网络带宽消耗。</p></li></ol></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;font-size: 18px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">&nbsp;新的方案</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.6037037037037037" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/5_SslT5gEZuqrfSXv5cNLkeCMVufK75Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRk3eZAibXzibnicBic4VB313sSueeSslT5gEZuqrfSXv5cNLkeCMVufK75Q/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><ul class="list-paddingleft-1" style="list-style-type: disc;"><li><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">设计目标：</p></section></li><ul class="list-paddingleft-1" style="margin-left: 32px;margin-right: 32px;list-style-type: square;"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">实时DQC采集程序的准确性；</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">规则检查的及时性；</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">最大限度的减低实时DQC的资源消耗；</p></li><li style="box-sizing: border-box;"><p style="word-break: break-all;box-sizing: border-box;">最大限度的减低Kafka正常作业的影响；</p></li></ul></ul><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">总体架构</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.6611111111111111" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/6_O1BrtllhcZtuXOJyyNVdlZ4lhYKtjg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRm6baJ36JZ7mIMsNfhGg6HXpYO1BrtllhcZtuXOJyyNVdlZ4lhYKtjg/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">目前线上Topic 有7000+，为了便于管理，主要根据Influxdb能接受的QPS、及Flink任务利用率，实时DQC把Topic划分为大Topic、中Topic、小Topic。小Topic: 消息量 &lt;1000/s，中Topic: 消息量 (1000/s—10w/s)，大Topic: 消息量 &gt; 10w/s。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">方案分析：</p><ul class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">大中小Topic分开管理，走不同的路径来做数据采集，中小Topic中的数据全量导入到全量表中（字段会根据检查规则做过滤），然后利用Influxdb CQ功能做汇聚存入CQ表完成数据采集，而大Topic则在Flink任务中直接算出最终的汇聚数据存入CQ表；</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Influxdb 全量表：中小Topic使用，保存Topic中的全量数据（字段会根据检查规则做过滤），一般有效时间为一个小时；</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Influxdb CQ表：所有Topic都会使用， 保存了Topic的汇聚数据，用于规则检查，一般有效时间为二个星期；</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Topic动态化：运行时可新增或删除监控的Topic，无需重启Fllink任务；</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">规则动态化：运行时可以新增、删除、修改Topic的监控规则，无需重启Fllink任务；</p></li><li style="box-sizing: border-box;"><p style="word-break: break-all;box-sizing: border-box;">DQC资源管理：这里包括两个部分，一个Flink任务和Influxdb资源，合理利用这两个资源，对Topic或者Topic的规则进行动态分配管理；</p></li></ul></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">中小Topic方案</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.27685185185185185" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/7_eSiappop5j4BE8deSra9QBUBBo8lUw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRDPOUUsUbibDd7Ec2O9Qw8lNDzReSiappop5j4BE8deSra9QBUBBo8lUw/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><ul class="list-paddingleft-1" style="list-style-type: disc;"><li><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">数据全量导入到全量表中（字段会根据检查规则做过滤）</p></section></li><li><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Topic、Mapper支持动态化：</p></section></li></ul><ul class="list-paddingleft-1" style="list-style-type: circle;"><li><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><section style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;margin-left: 32px;margin-right: 32px;">Topic动态化，Topic列表维护在配置中心，KafkaConsumer可以感知配置的变化从而达到动态的增删Topic；</section></section></li><li><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><section style="word-break: break-all;box-sizing: border-box;margin-left: 32px;margin-right: 32px;">Mapper动态化，根据消费Topic 列表、Topic内部的数据格式、及对应DQC规则，动态形成Mapper的处理逻辑，推到Mapper Warpper；</section></section><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><section style="word-break: break-all;box-sizing: border-box;margin-left: 32px;margin-right: 32px;"><br  /></section></section></li></ul><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">中小Topic方案—kafkaconsumer</strong></span></p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.3861111111111111" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/8_jicnOe205eD75JYiaYawh6GtVL9n2g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRE0Cn02jMQuX0KGRwWATibnFrr9SjicnOe205eD75JYiaYawh6GtVL9n2g/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">解决方案：因为开发人力、时间的原因，没有完全开发一个新的支持动态Topic的Kafka Consumer，而是扩展了FlinkKafkaConsumer，KafkaFetcher &amp;&amp; KafkaConsumerThread采用hack方式处理。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">中小Topic方案—Mapper</strong></span></p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.3787037037037037" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/9_M0XpF2NHOlT43egLfCrn4W5RU9OjOw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRd9HkJ3FFxtBGEIcx1zdUm7g8M0XpF2NHOlT43egLfCrn4W5RU9OjOw/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">解决方案：根据TopicList、Topic内容、DQC规则形成Mapper的bytecode，以Base64方式存入配置中心，Mapper Wrapper动态获取，形成新的Mapper，来替换老的Mapper。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">大Topic方案</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">由于大型Topic流量很大，如果还和中小型Topic使用相同的方案，不管是对网络带宽，还是对底层存储，都会造成非常大的压力。因此我们选择了另一种方案------单Topic单任务 + 规则动态。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">每一个Flink任务只消费一个Topic，在这个任务中，我们需要能够动态感知针对该Topic的检查规则的变化，并根据检查规则对消费到的实时数据流进行打标，对打标后的结果按窗口进行汇聚。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.1638888888888889" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/10_3cD3wkcT0icB5dicy1ylmiceH2icVw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJR2CJkicGv9Zr1nDJ8rOibnPq98CBgMf3cD3wkcT0icB5dicy1ylmiceH2icVw/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><ul class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="word-break: break-all;box-sizing: border-box;">动态逻辑：规则动态化，规则元信息维护在配置中心，FlatMap可以感知规则变化，将规则命中的记录向后输出进行聚合</p></li></ul></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">规则动态</strong></span></p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.3675925925925926" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/11_j8Xk0Cs7UcUia35ico1pYI79KLMCOg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJR8icVercJLc4IKrxy8llUnDCP4iawj8Xk0Cs7UcUia35ico1pYI79KLMCOg/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">为了降低用户的学习成本，在该方案中，我们与离线DQC配置保持一致，用户可以通过SQL自定义where子句对数据进行过滤，实现更加精细的质量检查。规则解析器会对SQL中的where子句部分进行词法解析，生成对应的过滤器，用于数据过滤，对符合规则的记录，打上规则ID后，根据规则ID向后输出后由聚合算子进行局部的聚合。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">数据膨胀</strong></span></p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="white-space: normal;box-sizing: border-box;">在规则打标后，输出到窗口进行聚合的过程中，可能会产生数据膨胀。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.3037037037037037" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/12_wZ4UW4sBft5JeLgZcDdaOhCg66ibyg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRFibU7yQ8gkAHcAmxWAdl311vuJwZ4UW4sBft5JeLgZcDdaOhCg66ibyg/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">如上图所示，当数据进入FlatMap后，FlatMap会根据规则过滤器对数据打上规则ID标签，再将数据向后发送给聚合算子，聚合算子根据规则进行聚合。如果一条记录没有命中任何规则，则不会向后输出。从上图可以看出，输入条数为1，输出条数为4，数据膨胀4倍。这是由于我们向后输出的数据格式为，使用规则ID作为分组条件。一条记录命中多个规则，则会输出多条记录。由于该方案本身是针对大Topic的，流量本身就很大，在经过规则过滤器放大，带宽压力很重，不符合设计初衷。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">针对这种情况，我们做了两个优化：</p><ol class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">FlatMap数据输出格式调整为 &lt;分组Key，RuleIdList，Data&gt;。将数据命中的所有规则ID合并在一起，向后输出。聚合算子收到数据后，根据RuleIdList进行业务计算。</p></li><li style="box-sizing: border-box;"><p style="word-break: break-all;box-sizing: border-box;">使用map -&gt; reduce -&gt; reduce架构，对规则打标后输出的结果，会先进行一次局部聚合，最后再进行全局规约数据汇总。</p></li></ol></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.14444444444444443" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/13_ZJibq6o74kddBj8yIx5SezRUEa0NaA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJR0DsnRZq24A4YScdo2kuiagRxumZJibq6o74kddBj8yIx5SezRUEa0NaA/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">但是，这个设计并不能彻底解决问题。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;box-sizing: border-box;" powered-by="xiumi.us"><table><tbody><tr><td width="93" valign="top" style="word-break: break-all;"><span style="font-size: 16px;"><strong>规则<br  /></strong></span></td><td width="347" valign="top" style="word-break: break-all;"><span style="font-size: 16px;"><strong>处理逻辑<br  /></strong></span></td><td width="73" valign="top" style="word-break: break-all;"><span style="font-size: 16px;"><strong>分组key<br  /></strong></span></td></tr><tr><td width="93" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">表行数类规则</span></td><td width="347" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">局部累加，汇总时将局部计算结果累加得到汇总值</span></td><td width="73" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">数据hash</span></td></tr><tr><td width="93" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">汇总值类规则</span></td><td width="347" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">局部累加，汇总时将局部计算结果累加得到汇总值</span></td><td width="73" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">数据hash</span></td></tr><tr><td width="93" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">最大值/最小值类规则</span></td><td width="347" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">局部取最大/小值，汇总时将局部计算结果取最大/小值得到全局的最大/小值</span></td><td width="73" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">数据hash</span></td></tr><tr><td width="93" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">平均数类规则</span></td><td width="347" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">局部计算&lt;字段值累加值， 条数累加值&gt;，汇总时将局部计算结果合并计算全局的&lt;字段值累加值， 条数累加值&gt;得到全局的&lt;字段值累加值， 条数累加值&gt;</span></td><td width="73" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">数据hash</span></td></tr><tr><td width="93" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">字段去重（Distinct）类规则</span></td><td width="347" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">局部对字段值去重后向后输出一遍，汇总时累加字段数量</span></td><td width="73" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">字段值</span></td></tr></tbody></table><p style="box-sizing: border-box;"><br  /></p></section><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">经过对实时DQC质量规则分析，除了字段去重（Distinct）类规则外，其他所有规则，对分组的key的具体取值是完全不依赖，因为局部聚合与最终汇总时的业务逻辑是一致的。然而字段去重（Distinct）类规则是在局部进行去重，最终汇总时则是将计算去重后的记录数量，因此在局部聚合时分组key必须使用字段值。对此，我们调整了第一步的优化方案：</p><ol class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">当Topic没有字段去重（Distinct）类规则，将所有规则合并输出，输出格式为</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">当Topic有一个字段去重（Distinct）类规则，则将所有规则合并输出，输出格式为 &lt;字段值，ruleIDList，Data&gt;</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">当Topic有多个字段去重（Distinct）类规则，且使用不同的字段时。将其中一个与其他所有非去重类规则合并输出。剩余的数值字段去重（Distinct）类规则单独输出。</p></li></ol><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">最终形态如下图所示：</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.3101851851851852" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/14_NoBV2c2ic1caJLch2M7MFz1ia0Elow.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRXRuhDm5HIK9ibIkwq3Awat1tZg6NoBV2c2ic1caJLch2M7MFz1ia0Elow/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">在优化之前，由于FlatMap的数据膨胀率很高，聚合算子经常会出现背压情况，导致消费性能下降。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">在优化之后，数据膨胀率大大降低，但是仍然存在。而膨胀率取决于字段去重（Distinct）类规则类规则的数量，膨胀率是可预知且可控的。目前在B站大数据平台中，除了特殊业务外，基本没用使用该类规则的情况，但仍需要通过监控该规则使用情况，适时增加资源或规则下线方式保障任务稳定性。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Influxdb proxy方案</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">为了更好的适配和处理读写请求和Influxdb之间的联系，我们引入了Influxdb proxy代理服务。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.39436619718309857" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/15_brEYlKta7khS2zZHlBjKRg1s7z1jhw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJR2VBIgHF3pJSUNSRYaAbZ88SPbrEYlKta7khS2zZHlBjKRg1s7z1jhw/640?wx_fmt=png'" data-type="png" data-w="1065" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">后端的Influxdb集群包含多组实例，每一组实例中的数据都不分片，只互为备份，最终一致性由proxy双写来保证。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">双写过程中，如有写入失败，Influxdb proxy将失败请求内容，记录到本地文件中并进行重试，直至成功写入。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">每一个Influxdb实例节点包含分配到该实例的完整的全量表和CQ表数据。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">优化读请求</strong></span></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">查询时，proxy会选择后端的最优Influxdb节点（数据完整性、节点性能）来查询。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">如果后端的Influxdb节点都有问题情况时，那么这次查询会降级。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">优化写请求</strong></span></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">由于实时DQC写入数据量大且极为频繁，所以为了减少网络IO流量开销，Influxdb proxy使用gzip压缩、批次写入的方式提升写入性能。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">在Influxdb proxy上线后，由于实际运行时，实时写入的数据量十分大，导致网络IO一直处于峰值状态。经过排查，发现原本数据输入都是一次请求包含5000+的完整Influxdb数据插入语句，且大多都是相同db和相同measurement，同时每条插入语句有太多的无效tag。随即我们优化的数据写入的接口协议，每次请求只能写入同一个db，且把相同的measurement抽出来，同时删除插入语句中无效tag。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">在上述改造之后，网络IO流量开销有了明显的改善和下降。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">运维保障</strong></span></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">在Influxdb proxy中，引入了Prometheus监控，实时监控读写请求的qps、写入的db，measurement数量和分布情况等，更好的加强相关资源的利用。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">支持对后端的Influxdb集群管理，包括节点数据同步，新节点加入、删除，节点数据恢复等。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Influxdb方案</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">全量表</strong></span></p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">在中小型Topic的处理上，我们选择落库全部数据，每个Topic都会单独存储为一张Influxdb的measurement。measurement的结构如下所示：</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.16793893129770993" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/16_AdOrUkiaykXg6N88MtqVSl6Bd4HnXA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRiaKUb0YLdCIyyZN7Vc3TJiap4rcAdOrUkiaykXg6N88MtqVSl6Bd4HnXA/640?wx_fmt=png'" data-type="png" data-w="786" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><ul class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">time：数据时间</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">subtask：业务默认字段，消费的flink子任务号</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">sinknum：业务默认字段，子任务消费顺序</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">扩展tag：topic字段，做索引用</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">record_num：业务默认字段，值为1，用于计算行数类规则</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">扩展field：topic字段</p></li></ul><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="text-decoration: underline;">业务默认字段</span><span style="text-decoration: none;">：</span><strong style="box-sizing: border-box;"></strong>在全量表的设计中，我们额外增加了两个tag字段：subtask和sinknum。由于Influxdb的特性，当两条记录的时间和tag完全相同时，此时后写入的记录会覆盖前一条。当计算表行数规则时，这种情况可能导致误告。因此，为了保障数据可以写入，我们增加了subtask、sinknum两个字段，subtask使用的flink上下文中的子任务号，sinknum我们使用环形数组实现，取值范围是1-200，用于确保每条记录都是独一无二的，不会发生覆盖的问题。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="text-decoration: underline;">TTL时间</span><span style="text-decoration: none;">：</span><strong style="box-sizing: border-box;"></strong>全量表的作用，主要是为CQ表做准备。Influxdb会定时读取全量表，根据质量规则进行数据聚合，并将聚合结果写入到CQ表。而实时DQC的特性决定了已经被计算进入CQ表的全量表数据便已经过期了。因此，为了避免数据条数、序列数等资源无限制增长，全量表的TTL时间我们设计为1小时，超过1小时的全量表记录会被Influxdb删除。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="text-decoration: underline;">Tag和Field的关系</span><span style="text-decoration: none;">：</span><strong style="box-sizing: border-box;"></strong>tag在Influxdb中是被作为索引使用的，通常用来作为查询条件使用，而field则是在某个时间点产生的事件的具体值。在Influxdb中，一次查询如果没有查询任何一个field字段，那么这次查询是没有意义的，不会返回任何结果。因为只有field才能反应那个时间点的信息。因此我们业务默认保留一个record_num字段作为field，表行数类规则会优先使用该字段。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;margin-bottom: 15px;white-space: normal;box-sizing: border-box;"><span style="color: rgb(0, 0, 0);"><strong><span style="box-sizing: border-box;">什么字段会被存储到Influxdb？</span></strong></span><span style="color: rgb(255, 102, 149);box-sizing: border-box;"></span></p><p style="word-break: break-all;margin-bottom: 15px;white-space: normal;box-sizing: border-box;">一个Topic的字段数量无法确定，几个或上百个，都有可能。起初对这些字段，我们并没有筛选，选择全部落库，在运行过程中发现调用Influxdb-proxy服务屡屡发生异常。在问题定位中发现这样的异常现象，Influxdb-proxy机器网络带宽消耗大，CPU使用率高。最终结论是，Influxdb-proxy写入Influxdb时会将数据压缩，减少网络带宽消耗，提高写入性能，但由于写入数据的冗余信息过多，压缩过程导致CPU负载非常高。Influxdb-porxy机器由于负载过高，无法继续向外提供服务。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">因此，去除冗余数据使我们需要优化的点。经过业务分析，我们任务一个Topic中大部分字段，都是不需要落库的。以直播业务某TopicA（40个字段）为例，计算某个时间窗口下的质量规则：</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;box-sizing: border-box;" powered-by="xiumi.us"><table><tbody><tr><td width="74" valign="top" style="word-break: break-all;"><strong>规则ID<br  /></strong></td><td width="115" valign="top" style="word-break: break-all;"><strong>规则<br  /></strong></td><td width="184" valign="top" style="word-break: break-all;"><strong>业务SOL<br  /></strong></td><td width="119" valign="top" style="word-break: break-all;"><strong>需要存储的字段<br  /></strong></td></tr><tr><td width="74" valign="top" style="word-break: break-all;">1<br  /></td><td width="115" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">表行数</span></td><td width="184" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">select count(1) from TopicA</span></td><td width="119" valign="top" style="word-break: break-all;">无<br  /></td></tr><tr><td width="74" valign="top" style="word-break: break-all;">2<br  /></td><td width="115" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">来自IOS平台的记录数</span></td><td width="184" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">select count(1) from TopicA where platform = 'IOS'</span></td><td width="119" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">platform</span></td></tr><tr><td width="74" valign="top" style="word-break: break-all;">3<br  /></td><td width="115" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">来自安卓平台的不同mid数</span></td><td width="184" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">select count(distinct mid) from TopicA where platform = 'android'</span></td><td width="119" valign="top" style="word-break: break-all;"><span style="color: rgb(23, 43, 77);font-family: -apple-system, &quot;system-ui&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">platform,mid</span></td></tr></tbody></table></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">根据规则发现，我们实际使用的字段只有platform和mid字段，其余字段对当前业务而言，都是冗余的。针对目前实时质量规则使用的现状，去除掉冗余字段，只存储必须的信息，网络带宽消耗可以减少90%以上，Influxdb-proxy的使用率一直维持在一个稳定的变化范围。在后续的使用中，该类异常再也未曾复现。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0);box-sizing: border-box;">什么字段会被应用为tag？</span></strong></span></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">tag在Influxdb中是作为索引被使用的，一条记录所有的tag被称为序列Series，根据机器性能的不同，每台机器可以承载的序列数量是有限的，序列数膨胀会造成Influxdb的读写性能急剧下降。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">刚上线初期，由于接入Topic时未进行严格的SOP流程，发生过这样一起事故。某Topic中包含XxxId字段，运维人员误认为该字段是某字典信息，取值范围是有限的。因此直接作为Tag字段进行接入，结果该字段是高基数的，短时间造成Influxdb序列数急速膨胀到300W，Influxdb几乎不可对外提供服务。在总结会议上，为避免此类情况再次发生，我们制定了Topic接入SOP，对Tag字段进行严格校验。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">由于Tag字段的选取对Influxdb的稳定性十分重要。我们是如何判断什么字段会被应用为tag？</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.7851851851851852" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/17_hoLjvFFm0RrQbMUKzE9vNNl5U4Sztg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRBxcg4gJXjrTJTV74gX9ZK0yUhoLjvFFm0RrQbMUKzE9vNNl5U4Sztg/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">我们认为tag字段的使用需要满足以下两点：</p><ol class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">where子句中被用作过滤条件，如 where platform = 'ios' 子句中，platform字段会被选中继续进行筛选</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">字段取值范围可枚举，不存在高基，如 platform 字段的取值范围在 ios、android、web中，符合tag字段的选取特征。</p></li></ol><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">在上面的例子中，platform字段会被应用为tag，而mid字段由于存在高基，会被应用为field。实际应用中，不能作为tag又需要使用的字段，都会被存储为field。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0);box-sizing: border-box;">新增规则，字段如何扩展？</span></strong></span></p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">类似mongodb这种非结构化数据库，Influxdb中的measurement也不需要预先定义schema，拥有良好的扩展性。当新增字段时，只需要在写入语句中指定新增字段与字段值即可完成字段新增。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">CQ表</strong></span></p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">CQ表存储的是实时数据根据业务规则聚合后的结果，它的结构简单且固定，如下图所示：</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.32673267326732675" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/18_ExX9tW9v34rBAKCDRLvxLuVmHXZ9Ng.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRS3yRax0YM2b3z7BqT6xSY0ZSExX9tW9v34rBAKCDRLvxLuVmHXZ9Ng/640?wx_fmt=png'" data-type="png" data-w="404" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><ul class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;box-sizing: border-box;">time：计算窗口开始时间</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;box-sizing: border-box;">rule_id：质量规则ID</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;box-sizing: border-box;">value：时间窗口内质量规则的计算结果</p></li></ul><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">CQ的表数据来源有两种：</p><ol class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">全量表定时汇聚写入：依靠Influxdb自身提供的基础能力Continuous Query实现，依靠该能力，Influxdb能够对实时数据自动周期运行查询，并将查询结果写入指定的CQ表中，目前Continuous Query运行 99分位耗时&lt;30ms.</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Flink任务（大Topic）实时汇聚写入：大Topic消费任务会在时间窗口内进行质量规则计算，并将计算结果写入到CQ表中</p></li></ol><p style="word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="text-decoration: underline;">CQ表的TTL时间</span><span style="text-decoration: none;">：</span>CQ表是按分钟聚合的结果，它的TTL时间我们是根据业务来设计的。由于存在日同比、周同比等波动率比值类型的规则，因此CQ表的TTL时间目前设置的是14天，避免由于数据过期删除导致误告警。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="box-sizing: border-box;color: rgb(255, 102, 149);"><strong style="box-sizing: border-box;">Influxdb水位</strong></span></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">Influxdb是整个方案的核心，保障Influxdb的稳定性是非常重要的一环。因此，对Influxdb的监控便是重中之重。经过对我们实际使用机器的测试，目前单机写入瓶颈在150W/s，序列数量峰值在200W左右，超出数值可能会导致写入性能下降。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">对此我们采取了以下措施：</p><ol class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Influxdb支持水平扩展，根据Topic元数据与Influxdb监控信息判断，如果某台Influxdb当前承载的Topic流量或Influxdb实时写入量已经达瓶颈的80%，新接入的Topic会往新的Influxdb写入。</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">序列数量增速监控，由于数据ttl时间的限制，序列的数量应该是呈周期性的变化，并且峰值稳定保持在一个数据范围内。但若是tag字段选取不当，选择了高基字段，就会造成序列数量急速增长。当监控到这种情况，需要及时处理相关Topic，保障服务稳定。</p><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;"><br  /></p></li></ol><section style="box-sizing: border-box;font-size: 16px;"><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong>运维&amp;&amp;异常情况</strong></p><p style="box-sizing: border-box;"><strong style="color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: justify;box-sizing: border-box;"><br  /></strong></p></section></section></section></section><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">为了保障实时DQC新架构的稳定性，我们主要考虑了以下异常情况。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;line-height: 1.5em;margin-bottom: 0px;"><br  /></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><span style="color: rgb(255, 102, 149);"><strong><span style="box-sizing: border-box;">流量突增，消息堆积</span></strong></span><span style="color: rgb(255, 102, 149);box-sizing: border-box;"></span></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">流量突增，消息堆积主要分两种情况：</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">业务方可预知的增长情况：这类情况会比较多，比如某些赛事直播活动，相关的Topic流量突增，类似于最近的英雄联盟S12总决赛直播</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">业务方不可预知的增长情况：这类情况会比较少，UP主上传某个视频成了爆款，这种现象是不可预知的。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">经过评估，当出现消息堆积时，此时的告警都可能是不准确，因此我们需要极力避免出现消息堆积的情况。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">针对可预知的增长情况，我们会提前增加资源，提高任务的消费能力。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">针对不可预知的增长情况或即使增加资源仍旧导致消息堆积时，我们认为此时任务是以非正常状态运行的，对其进行降级处理，关闭任务触发的相关告警，P0等高优级Topic会发送通知给到用户，告知其影响面。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="0.6268518518518519" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/19_bnmHGKuUarPLJyrGY6Z8C7v7IicJYg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRcQJqvIyJqoTZRYKjhP6SC6QRwbnmHGKuUarPLJyrGY6Z8C7v7IicJYg/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;white-space: normal;box-sizing: border-box;"><strong><span style="color: rgb(255, 102, 149);box-sizing: border-box;">程序Crash</span></strong><span style="color: rgb(255, 102, 149);box-sizing: border-box;"></span></p><p style="white-space: normal;box-sizing: border-box;">使用Flink的checkpoint机制，保障任务异常恢复。但是仍然存在以下问题。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">中小Topic：</strong></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">该方案中数据需要写入Influxdb，为提高吞吐量，在sink阶段接收的数据不会每次都写入存储，而是先放入缓冲区，当达到数据长度或等待时间达到阈值后，再写入Influxdb。因此，若程序Crash，可能导致最近一次缓冲区中的数据丢失，该情况可能导致漏告与误告。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">目前我们设置的时间阈值是10秒，记录数量是1000条，考虑到把缓存中的数据在每次checkpoint时保存到文件系统所耗费的成本，我们认为这样的损失是可以接受的，在产品的宣发上也会与用户说明。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">大Topic:</strong></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">使用Flink的checkpoint机制，可以很好的保障任务从上次状态恢复。在写入Influxdb时，会根据时间和tag信息覆盖聚合结果，避免结果重复写入。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">需要考虑的点是，这个方案针对的Topic都是大流量的，如果恢复时间过长，可能导致数据堆积。需要考虑数据堆积的处理方案。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><strong><span style="box-sizing: border-box;color: rgb(255, 102, 149);">重复消费</span></strong></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">多个任务重复消费相同的Topic，导致写入Influxdb数据增多，可能导致误告。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;"><em style="box-sizing: border-box;">需要注意：kafkaconsumer里面配置的group.id已经不具备消费组的特性，因为kafkaconsumer使用了底层API来分配TP。</em></p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;"><strong style="box-sizing: border-box;">解决方案：</strong></p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">任务与Topic强绑定，分配Topic给消费任务时，注册任务与Topic到数据库中，若已存在相同的Topic，则启动失败，同时发出告警。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">结合以上异常情况，为了保障新架构的稳定性，在运维方面我们主要做了以下措施：</p><ol class="list-paddingleft-1"><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Flink断流与堆积监控</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Influxdb集群状态监控</p></li><li style="box-sizing: border-box;"><p style="margin-bottom: 15px;word-break: break-all;box-sizing: border-box;">Influxdb序列数监控</p></li></ol><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">借助这些措施，帮助我们及时发现问题并解决问题。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: center;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;vertical-align: top;padding-left: 10px;box-sizing: border-box;"><section style="border-bottom: 1px dashed rgb(0, 0, 0);padding-left: 5px;font-size: 20px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">实时DQC后续工作</strong></p></section><section style="margin-top: -7px;margin-left: -10px;width: 10px;box-sizing: border-box;"><section style="transform: rotate(0deg);-webkit-transform: rotate(0deg);-moz-transform: rotate(0deg);-o-transform: rotate(0deg);margin-left: auto;width: 7px;height: 7px;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="margin-top: -4px;margin-left: -3px;width: 10px;height: 10px;background-color: rgb(12, 182, 242);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;font-size: 18px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">&nbsp;工程化</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;box-sizing: border-box;" powered-by="xiumi.us"><section style="max-width: 100%;vertical-align: middle;display: inline-block;line-height: 0;box-sizing: border-box;"><img class="rich_pages wxw-img" data-ratio="1.000925925925926" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/20_MSMictXUys3XsX9lh9ic4n6iaicIIw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/1BMf5Ir754QauGcvOGBWULITcuTfkZJRJM2c65iaaCYTwibh7VLEAT4UkTfg1eMSMictXUys3XsX9lh9ic4n6iaicIIw/640?wx_fmt=png'" data-type="png" data-w="1080" style="vertical-align: middle;width: 100%;box-sizing: border-box;"  /></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">新的方案虽然目前已经上线实施，但是，由于新的架构较之前稍显复杂，在自动工程化方面还有所欠缺。存量的DQC规则都是依靠开发人员人工移植，后续的规则新增也需开发人员参与。</p><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">另一方面，分级保障也是我们工程化的一个发力点。P0级别的Topic是在任何情况下，都是需要我们优先保障的。P0与P1的Topic不会再一个任务中合并消费，当启动P0任务如果失败，根据失败异常信息，会选择停止一个正在运行中的P1级别任务，释放资源，优先用来启动P0任务。当P1任务停止时，会发出告警通知到用户与运维人员，进行人工判断是否需要增加队列资源。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">下一阶段，我们会在自动工程化和分级保障方面持续发力，将更好的使用体验呈现给用户。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;font-size: 18px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">&nbsp;Flink任务管理</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="margin-bottom: 15px;word-break: break-all;white-space: normal;box-sizing: border-box;">在降本增效主流的现在，依靠Topic动态与规则动态两种设计，节约大量集群资源消耗，但仍有优化的空间，那就是多Flink任务更加精细化的管理。比如，Topic动态方案中，一个Topic是否应该向已经存在的任务重动态加入，还是新启动一个任务进行消费？这需要结合任务当前负载进行判断。</p><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">还有Influxdb单机处理瓶颈问题，在我们的规划中，Influxdb可以水平扩展，Flink任务启动时，需要结合Influxdb集群负载，与当前任务信息，选择最优Influxdb节点写入数据。</p></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="margin-top: 10px;margin-bottom: 10px;text-align: left;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;box-sizing: border-box;"><section style="width: 0.7em;height: 0.7em;margin-right: 5px;margin-top: 0.5em;display: inline-block;vertical-align: top;background-color: rgb(255, 102, 149);box-sizing: border-box;"><svg viewbox="0 0 1 1" style="float:left;line-height:0;width:0;vertical-align:top;"></svg></section><section style="display: inline-block;vertical-align: top;text-align: center;font-size: 18px;color: rgb(12, 182, 242);box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">&nbsp;对正常流的影响</strong></p></section></section></section><p style="white-space: normal;box-sizing: border-box;" powered-by="xiumi.us"><br style="box-sizing: border-box;"  /></p><section style="padding-right: 8px;padding-left: 8px;box-sizing: border-box;" powered-by="xiumi.us"><p style="word-break: break-all;white-space: normal;box-sizing: border-box;">对Topic的质量监控，不应该影响到线上正常作业的任务。目前质量任务所使用的队列仍然是和其他任务混合使用的，可能会造成资源竞争、占用机器资源影响到机器上其他任务等问题，后续会根据资源规划进行调整。</p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;line-height: 1.6;letter-spacing: 0.034em;color: rgb(63, 63, 63);font-size: 16px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: left;"><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">如果这个文章对你有帮助，不要忘记&nbsp;</span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;outline: 0px;font-size: 15px;color: rgb(255, 104, 39);"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「在看」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「点赞」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「收藏」</strong></span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">&nbsp;三连啊喂！</span><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><p style="text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="1.215625" data-s="300,640" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/21_jNJdvwuULcOtMEU3DFFESPHpbU8Hdg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PDwSDUx452DKyaUxtxDoz47He3aCnMeSE9wLtZJwcdOFU6jNJdvwuULcOtMEU3DFFESPHpbU8Hdg/640?wx_fmt=png'" data-type="png" data-w="640" style="width: 241px;height: 293px;"  /></p><p style="margin: 0px 0px 0em;padding: 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: center;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;background-color: rgb(255, 255, 255);color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;"></span></p></section></section><section style="margin: 0px;padding: 0px;max-width: 100%;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, &quot;system-ui&quot;, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="图片/大数据技术与架构_2023-06-21_「转」B站实时DQC大数据质量建设之路/22_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="margin: 0px;padding: 0px;max-width: 100%;height: 42px;overflow-wrap: break-word !important;vertical-align: bottom;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">互联网最坏的时代可能真的来了</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">我在B站读大学，大数据专业</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Flink的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">193篇文章暴揍Flink，这个合集你需要关注一下</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Spark的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">在所有Spark模块中，我愿称SparkSQL为最强！</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">硬刚Hive | 4万字基础调优面试小总结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">数据治理方法论和实践小百科全书</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">标签体系下的用户画像建设小指南</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解析</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我写过的关于成长/面试/职场进阶的文章</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>