<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"如何利用 Flink CDC 实现数据增量备份到 Clickhouse","time":"2021-12-22 08:10:00","timeStamp":"1640131800"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247509446&idx=2&sn=954dfc8e964269510cde823f6df2dc9a&chksm=fd3ee353ca496a45ac90ad1def28f356d3b098b4b44f998c7763887bd453fbf6ff4a4644caf2#rd" target="_blank">如何利用 Flink CDC 实现数据增量备份到 Clickhouse</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">dafei1288&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-12-22 08:10:00</em></div><content><div class="reprint"><p>转自公众号：麒思妙想<br><a href="http://mp.weixin.qq.com/s?__biz=MzI3MDU3OTc1Nw==&mid=2247485379&idx=1&sn=49638a6bd0612029649930700f2eed3b" target="_blank" title="阅读原文">http://mp.weixin.qq.com/s?__biz=MzI3MDU3OTc1Nw==&mid=2247485379&idx=1&sn=49638a6bd0612029649930700f2eed3b</a></p></div><section class="mp_profile_iframe_wrp" data-mpa-powered-by="yiban.io"><mpprofile class="js_uneditable custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzU3MzgwNTU2Mg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MrfCUBgMwsXeyxKKIxY5GNfl3g0zm1ibib46XO7tlIEs8ncmlp3Zzq8JJs0ibLbHdL4AWox8hSUIMDw/0?wx_fmt=png" data-nickname="大数据技术与架构" data-alias="import_bigdata" data-signature="大数据开发、大数据面试、大数据框架、大数据实时计算、大数据离线计算Flink/Spark/Hadoop/数仓开发，干货，面试，资料下载，源码解读等" data-from="0"></mpprofile></section><p cid="n5" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">挖了很久的CDC坑，今天打算填一填了。本文我们首先来介绍什么是CDC，以及CDC工具选型，接下来我们来介绍如何通过Flink CDC抓取mysql中的数据，并把他汇入Clickhouse里，最后我们还将介绍Flink SQL CDC的方式。</span></p><h1 cid="n132" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">CDC</span></h1><p cid="n128" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">首先什么是CDC ？它是Change Data Capture的缩写,即变更数据捕捉的简称，使用CDC我们可以从数据库中获取已提交的更改并将这些更改发送到下游，供下游使用。这些变更可以包括INSERT,DELETE,UPDATE等操作。</span></p><p style="text-align: center;padding: 0px 0.5em;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.6022044088176353" data-s="300,640" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/1_bbjVLwWtK1qYPgm6kIfmJUribucwyw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcfxQ2VYayibticMadBpaOkiciaESdVibbjVLwWtK1qYPgm6kIfmJUribucwyw/640?wx_fmt=png'" data-type="png" data-w="998" style="border-radius: 3px;box-shadow: rgb(180, 180, 180) 0em 0em 0.5em 0px;font-size: 17px;"></p><p cid="n128" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n126" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">其主要的应用场景：</span></p><ul class="list-paddingleft-2" cid="n146" mdtype="list" data-mark="-" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n135" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">异构数据库之间的数据同步或备份 / 建立数据分析计算平台</span></p></li><li style="box-sizing: border-box;"><p cid="n138" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">微服务之间共享数据状态</span></p></li><li style="box-sizing: border-box;"><p cid="n141" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">更新缓存 / CQRS 的 Query 视图更新</span></p></li></ul><p cid="n124" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">CDC 它是一个比较广义的概念，只要能捕获变更的数据，我们都可以称为 CDC 。业界主要有基于查询的 CDC 和基于日志的 CDC ，可以从下面表格对比他们功能和差异点。</span></p><figure cid="n11" mdtype="table" style="box-sizing: border-box;margin-top: 1.2em;margin-bottom: 1.2em;overflow-x: auto;cursor: default;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><table width="1140" style="width: 768px;"><thead style="box-sizing: border-box;background-color: rgb(248, 248, 248);"><tr cid="n12" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><th style="box-sizing: border-box;padding: 6px 13px;border-top-width: 1px;border-bottom: 0px;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-left-color: rgb(223, 226, 229);text-align: left;"><br  /></th><th style="box-sizing: border-box;padding: 6px 13px;border-top-width: 1px;border-bottom: 0px;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-left-color: rgb(223, 226, 229);text-align: left;"><span cid="n14" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">基于查询的 CDC</span></th><th style="box-sizing: border-box;padding: 6px 13px;border-top-width: 1px;border-bottom: 0px;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-left-color: rgb(223, 226, 229);"><span cid="n15" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">基于日志的 CDC</span></th></tr></thead><tbody style="box-sizing: border-box;"><tr cid="n16" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n17" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">概念</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n18" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">每次捕获变更发起 Select 查询进行全表扫描，过滤出查询之间变更的数据</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n19" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">读取数据存储系统的 log ，例如 MySQL 里面的 binlog持续监控</span></td></tr><tr cid="n20" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n21" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">开源产品</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n22" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">Sqoop, Kafka JDBC Source</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n23" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">Canal, Maxwell, Debezium</span></td></tr><tr cid="n24" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n25" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">执行模式</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n26" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">Batch</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n27" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">Streaming</span></td></tr><tr cid="n28" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n29" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">捕获所有数据的变化</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n30" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">❌</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n31" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">✅</span></td></tr><tr cid="n32" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n33" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">低延迟，不增加数据库负载</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n34" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">❌</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n35" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">✅</span></td></tr><tr cid="n36" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n37" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">不侵入业务（LastUpdated字段）</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n38" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">❌</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n39" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">✅</span></td></tr><tr cid="n40" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n41" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">捕获删除事件和旧记录的状态</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n42" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">❌</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n43" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">✅</span></td></tr><tr cid="n44" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n45" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;box-sizing: border-box;">捕获旧记录的状态</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n46" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;box-sizing: border-box;">❌</span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n47" mdtype="table_cell" style="display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;box-sizing: border-box;">✅</span></td></tr></tbody></table></figure><h1 cid="n161" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Debezium</span></h1><p cid="n162" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;"> Debezium是一个开源项目，为捕获数据更改(change data capture,CDC)提供了一个低延迟的流式处理平台。你可以安装并且配置Debezium去监控你的数据库，然后你的应用就可以消费对数据库的每一个行级别(row-level)的更改。只有已提交的更改才是可见的，所以你的应用不用担心事务(transaction)或者更改被回滚(roll back)。Debezium为所有的数据库更改事件提供了一个统一的模型，所以你的应用不用担心每一种数据库管理系统的错综复杂性。另外，由于Debezium用持久化的、有副本备份的日志来记录数据库数据变化的历史，因此，你的应用可以随时停止再重启，而不会错过它停止运行时发生的事件，保证了所有的事件都能被正确地、完全地处理掉。</span></p><p cid="n162" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;"><br  /></span></p><blockquote cid="n163" mdtype="blockquote" style="box-sizing: border-box;margin-top: 0.8em;margin-bottom: 0.8em;border-left-width: 4px;border-left-color: rgb(223, 226, 229);padding-top: 0px;padding-right: 15px;padding-left: 15px;color: rgb(119, 119, 119);font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><p cid="n164" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">Debezium is an open source distributed platform for change data capture. Start it up, point it at your databases, and your apps can start responding to all of the inserts, updates, and deletes that other apps commit to your databases. Debezium is durable and fast, so your apps can respond quickly and never miss an event, even when things go wrong</span></p></blockquote><p cid="n165" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><h1 cid="n205" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">ClickHouse</span></h1><p cid="n213" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">实时数据分析数据库，俄罗斯的谷歌开发的，推荐OLAP场景使用</span></p><p cid="n270" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="strong" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Clickhouse的优点.</strong></span></p><ol class="list-paddingleft-2" cid="n216" mdtype="list" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n218" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">真正的面向列的 DBMS</span></p><p cid="n219" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">ClickHouse 是一个 DBMS，而不是一个单一的数据库。它允许在运行时创建表和数据库、加载数据和运行</span></p><p cid="n220" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">查询，而无需重新配置和重新启动服务器。</span></p></li><li style="box-sizing: border-box;"><p cid="n222" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">数据压缩</span></p><p cid="n223" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">一些面向列的 DBMS（InfiniDB CE 和 MonetDB）不使用数据压缩。但是，数据压缩确实提高了性能。</span></p></li><li style="box-sizing: border-box;"><p cid="n225" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">磁盘存储的数据</span></p></li><li style="box-sizing: border-box;"><p cid="n227" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">在多个服务器上分布式处理</span></p></li><li style="box-sizing: border-box;"><p cid="n229" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">SQL支持</span></p></li><li style="box-sizing: border-box;"><p cid="n231" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">数据不仅按列存储，而且由矢量 - 列的部分进行处理，这使开发者能够实现高 CPU 性能</span></p></li></ol><p cid="n235" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n260" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="strong" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Clickhouse的缺点</strong></span></p><ol class="list-paddingleft-2" cid="n236" mdtype="list" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n238" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">没有完整的事务支持，</span></p></li><li style="box-sizing: border-box;"><p cid="n240" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">缺少完整的Update/Delete操作，缺少高频率、低延迟的修改或删除已存在数据的能力，仅能用于批量删</span></p><p cid="n241" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">除或修改数据</span></p></li><li style="box-sizing: border-box;"><p cid="n243" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">聚合结果必须小于一台机器的内存大小：</span></p></li><li style="box-sizing: border-box;"><p cid="n245" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">不适合key-value存储，</span></p></li></ol><p cid="n246" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n264" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="strong" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">什么时候不可以用Clickhouse?</strong></span></p><ol class="list-paddingleft-2" cid="n247" mdtype="list" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n249" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">事物性工作（OLTP）</span></p></li><li style="box-sizing: border-box;"><p cid="n251" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">高并发的键值访问</span></p></li><li style="box-sizing: border-box;"><p cid="n253" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">Blob或者文档存储</span></p></li><li style="box-sizing: border-box;"><p cid="n255" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">超标准化的数据</span></p></li></ol><p cid="n211" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><h1 cid="n167" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Flink CDC</span></h1><p cid="n97" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Flink cdc connector 消费 Debezium 里的数据，经过处理再sink出来，这个流程还是相对比较简单的</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.4175675675675676" data-s="300,640" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/2_7zhNl2FXKRia5XWtACHe00TI8klXoQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcVCgAHpA3z2xKIQvTT2IozrQ7M7zhNl2FXKRia5XWtACHe00TI8klXoQ/640?wx_fmt=png'" data-type="png" data-w="740" style=""  /></p><p cid="n84" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">首先创建 Source 和 Sink（对应的依赖引用，在文末）</span><br  /></p><pre spellcheck="false" lang="java" cid="n277" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; SourceFunction&lt;String&gt; sourceFunction = MySQLSource.&lt;String&gt;builder()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .hostname("localhost")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .port(3306)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .databaseList("test")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .username("flinkcdc")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .password("dafei1288")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .deserializer(new JsonDebeziumDeserializationSchema())</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .build();</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 添加 source</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;env.addSource(sourceFunction)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 添加 sink</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .addSink(new ClickhouseSink());</span></pre><p cid="n275" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">这里用到的JsonDebeziumDeserializationSchema，是我们自定义的一个序列化类，用于将Debezium输出的数据，序列化</span></p><pre spellcheck="false" lang="java" cid="n288" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">// 将cdc数据反序列化</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;public static class JsonDebeziumDeserializationSchema implements DebeziumDeserializationSchema {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void deserialize(SourceRecord sourceRecord, Collector collector) throws Exception {</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Gson jsstr = new Gson();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HashMap&lt;String, Object&gt; hs = new HashMap&lt;&gt;();</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String topic = sourceRecord.topic();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String[] split = topic.split("[.]");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String database = split[1];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String table = split[2];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("database",database);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("table",table);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//获取操作类型</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Envelope.Operation operation = Envelope.operationFor(sourceRecord);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//获取数据本身</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Struct struct = (Struct)sourceRecord.value();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Struct after = struct.getStruct("after");</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (after != null) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Schema schema = after.schema();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HashMap&lt;String, Object&gt; afhs = new HashMap&lt;&gt;();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (Field field : schema.fields()) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;afhs.put(field.name(), after.get(field.name()));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("data",afhs);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String type = operation.toString().toLowerCase();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ("create".equals(type)) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type = "insert";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("type",type);</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collector.collect(jsstr.toJson(hs));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public TypeInformation&lt;String&gt; getProducedType() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return BasicTypeInfo.STRING_TYPE_INFO;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span></pre><p cid="n286" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">这里是将数据序列化成如下Json格式</span></p><pre spellcheck="false" lang="json" cid="n294" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">{"database":"test","data":{"name":"jacky","description":"fffff","id":8},"type":"insert","table":"test_cdc"}</span></pre><p cid="n284" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">接下来就是要创建Sink，将数据变化存入Clickhouse中，这里我们仅以insert为例</span></p><pre spellcheck="false" lang="java" cid="n299" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">public static class ClickhouseSink extends RichSinkFunction&lt;String&gt;{</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;Connection connection;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;PreparedStatement pstmt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;private Connection getConnection() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Connection conn = null;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Class.forName("ru.yandex.clickhouse.ClickHouseDriver");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String url = "jdbc:clickhouse://localhost:8123/default";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn = DriverManager.getConnection(url,"default","dafei1288");</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  } catch (Exception e) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return conn;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void open(Configuration parameters) throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;super.open(parameters);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connection = getConnection();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String sql = "insert into sink_ch_test(id,name,description) values (?,?,?)";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt = connection.prepareStatement(sql);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 每条记录插入时调用一次</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void invoke(String value, Context context) throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//{"database":"test","data":{"name":"jacky","description":"fffff","id":8},"type":"insert","table":"test_cdc"}</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Gson t = new Gson();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HashMap&lt;String,Object&gt; hs = t.fromJson(value,HashMap.class);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String database = (String)hs.get("database");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String table = (String)hs.get("table");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String type = (String)hs.get("type");</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if("test".equals(database) &amp;&amp; "test_cdc".equals(table)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if("insert".equals(type)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.out.println("insert =&gt; "+value);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LinkedTreeMap&lt;String,Object&gt; data = (LinkedTreeMap&lt;String,Object&gt;)hs.get("data");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String name = (String)data.get("name");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String description = (String)data.get("description");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Double id = (Double)data.get("id");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 未前面的占位符赋值</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.setInt(1, id.intValue());</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.setString(2, name);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.setString(3, description);</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.executeUpdate();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void close() throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;super.close();</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(pstmt != null) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.close();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(connection != null) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connection.close();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span></pre><p cid="n280" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n86" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">完整代码案例：</span></p><pre spellcheck="false" lang="java" cid="n49" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">package name.lijiaqi.cdc;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import com.alibaba.ververica.cdc.debezium.DebeziumDeserializationSchema;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import com.google.gson.Gson;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import com.google.gson.internal.LinkedTreeMap;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import io.debezium.data.Envelope;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.api.common.typeinfo.BasicTypeInfo;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.api.common.typeinfo.TypeInformation;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.configuration.Configuration;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.streaming.api.functions.sink.RichSinkFunction;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.streaming.api.functions.source.SourceFunction;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import com.alibaba.ververica.cdc.connectors.mysql.MySQLSource;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.util.Collector;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.kafka.connect.source.SourceRecord;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.kafka.connect.data.Field;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.kafka.connect.data.Schema;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.kafka.connect.data.Struct;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import java.sql.Connection;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import java.sql.DriverManager;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import java.sql.PreparedStatement;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import java.util.HashMap;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">public class MySqlBinlogSourceExample {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;public static void main(String[] args) throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;SourceFunction&lt;String&gt; sourceFunction = MySQLSource.&lt;String&gt;builder()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .hostname("localhost")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .port(3306)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .databaseList("test")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .username("flinkcdc")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .password("dafei1288")</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .deserializer(new JsonDebeziumDeserializationSchema())</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .build();</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 添加 source</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;env.addSource(sourceFunction)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 添加 sink</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .addSink(new ClickhouseSink());</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;env.execute("mysql2clickhouse");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;// 将cdc数据反序列化</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;public static class JsonDebeziumDeserializationSchema implements DebeziumDeserializationSchema {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void deserialize(SourceRecord sourceRecord, Collector collector) throws Exception {</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Gson jsstr = new Gson();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HashMap&lt;String, Object&gt; hs = new HashMap&lt;&gt;();</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String topic = sourceRecord.topic();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String[] split = topic.split("[.]");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String database = split[1];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String table = split[2];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("database",database);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("table",table);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//获取操作类型</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Envelope.Operation operation = Envelope.operationFor(sourceRecord);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//获取数据本身</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Struct struct = (Struct)sourceRecord.value();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Struct after = struct.getStruct("after");</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (after != null) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Schema schema = after.schema();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HashMap&lt;String, Object&gt; afhs = new HashMap&lt;&gt;();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (Field field : schema.fields()) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;afhs.put(field.name(), after.get(field.name()));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("data",afhs);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String type = operation.toString().toLowerCase();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ("create".equals(type)) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type = "insert";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hs.put("type",type);</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collector.collect(jsstr.toJson(hs));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public TypeInformation&lt;String&gt; getProducedType() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return BasicTypeInfo.STRING_TYPE_INFO;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;public static class ClickhouseSink extends RichSinkFunction&lt;String&gt;{</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;Connection connection;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;PreparedStatement pstmt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;private Connection getConnection() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Connection conn = null;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Class.forName("ru.yandex.clickhouse.ClickHouseDriver");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String url = "jdbc:clickhouse://localhost:8123/default";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn = DriverManager.getConnection(url,"default","dafei1288");</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  } catch (Exception e) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return conn;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void open(Configuration parameters) throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;super.open(parameters);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connection = getConnection();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String sql = "insert into sink_ch_test(id,name,description) values (?,?,?)";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt = connection.prepareStatement(sql);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 每条记录插入时调用一次</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void invoke(String value, Context context) throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//{"database":"test","data":{"name":"jacky","description":"fffff","id":8},"type":"insert","table":"test_cdc"}</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Gson t = new Gson();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HashMap&lt;String,Object&gt; hs = t.fromJson(value,HashMap.class);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String database = (String)hs.get("database");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String table = (String)hs.get("table");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String type = (String)hs.get("type");</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if("test".equals(database) &amp;&amp; "test_cdc".equals(table)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if("insert".equals(type)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.out.println("insert =&gt; "+value);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LinkedTreeMap&lt;String,Object&gt; data = (LinkedTreeMap&lt;String,Object&gt;)hs.get("data");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String name = (String)data.get("name");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String description = (String)data.get("description");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Double id = (Double)data.get("id");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 未前面的占位符赋值</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.setInt(1, id.intValue());</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.setString(2, name);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.setString(3, description);</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.executeUpdate();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;@Override</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;public void close() throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;super.close();</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(pstmt != null) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pstmt.close();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(connection != null) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connection.close();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">}</span></pre><p cid="n50" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n51" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">执行查看结果</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.23089840470193115" data-s="300,640" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/3_PAIZUZk1bfU3rNIRIPzBCWD6FL8Lzw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcpgsAqKUcENpA1ZJBUs3uO0icvPAIZUZk1bfU3rNIRIPzBCWD6FL8Lzw/640?wx_fmt=png'" data-type="png" data-w="1191" style=""  /></p><p cid="n55" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">数据成功汇入</span></p><p cid="n56" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.894937917860554" data-s="300,640" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/4_sDVxZ0hsX8QJtl2ABolO7bmibgWpZg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOciaFTHYl1vOkhbtx0QfPFVaAicmXsDVxZ0hsX8QJtl2ABolO7bmibgWpZg/640?wx_fmt=png'" data-type="png" data-w="1047"  /><br  /></p><h1 cid="n179" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Flink SQL CDC</span></h1><p cid="n181" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">接下来，我们看一下如何通过Flink SQL实现CDC ，只需3条SQL语句即可。</span></p><p cid="n60" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">创建数据源表</span></p><pre spellcheck="false" lang="java" cid="n314" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 数据源表</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String sourceDDL =</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"CREATE TABLE mysql_binlog (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" id INT NOT NULL,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" name STRING,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" description STRING\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;") WITH (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'connector' = 'mysql-cdc',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'hostname' = 'localhost',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'port' = '3306',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'username' = 'flinkcdc',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'password' = 'dafei1288',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'database-name' = 'test',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'table-name' = 'test_cdc'\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;")";</span></pre><p cid="n310" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">创建输出表</span></p><pre spellcheck="false" lang="java" cid="n319" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> // 输出目标表</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String sinkDDL =</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"CREATE TABLE test_cdc_sink (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" id INT NOT NULL,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" name STRING,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" description STRING,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" PRIMARY KEY (id) NOT ENFORCED \n " +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;") WITH (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'connector' = 'jdbc',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'driver' = 'com.mysql.jdbc.Driver',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'url' = '" + url + "',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'username' = '" + userName + "',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'password' = '" + password + "',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'table-name' = '" + mysqlSinkTable + "'\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;")";</span></pre><p cid="n312" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">这里我们直接将数据汇入</span></p><pre spellcheck="false" lang="java" cid="n324" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">// 简单的聚合处理</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String transformSQL =</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"insert into test_cdc_sink select * from mysql_binlog";</span></pre><p cid="n308" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n327" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">完整参考代码</span></p><pre spellcheck="false" lang="Java" cid="n187" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">package name.lijiaqi.cdc;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.table.api.EnvironmentSettings;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.table.api.SqlDialect;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.table.api.TableResult;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">import org.apache.flink.table.api.bridge.java.StreamTableEnvironment;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">public class MysqlToMysqlMain {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;public static void main(String[] args) throws Exception {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;EnvironmentSettings fsSettings = EnvironmentSettings.newInstance()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .useBlinkPlanner()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .inStreamingMode()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .build();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;env.setParallelism(1);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;StreamTableEnvironment tableEnv = StreamTableEnvironment.create(env, fsSettings);</span><br  /><br  /><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;tableEnv.getConfig().setSqlDialect(SqlDialect.DEFAULT);</span><br  /><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 数据源表</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String sourceDDL =</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"CREATE TABLE mysql_binlog (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" id INT NOT NULL,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" name STRING,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" description STRING\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;") WITH (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'connector' = 'mysql-cdc',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'hostname' = 'localhost',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'port' = '3306',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'username' = 'flinkcdc',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'password' = 'dafei1288',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'database-name' = 'test',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'table-name' = 'test_cdc'\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;")";</span><br  /><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String url = "jdbc:mysql://127.0.0.1:3306/test";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String userName = "root";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String password = "dafei1288";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String mysqlSinkTable = "test_cdc_sink";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 输出目标表</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String sinkDDL =</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"CREATE TABLE test_cdc_sink (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" id INT NOT NULL,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" name STRING,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" description STRING,\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" PRIMARY KEY (id) NOT ENFORCED \n " +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;") WITH (\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'connector' = 'jdbc',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'driver' = 'com.mysql.jdbc.Driver',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'url' = '" + url + "',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'username' = '" + userName + "',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'password' = '" + password + "',\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;" 'table-name' = '" + mysqlSinkTable + "'\n" +</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;")";</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 简单的聚合处理</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;String transformSQL =</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"insert into test_cdc_sink select * from mysql_binlog";</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;tableEnv.executeSql(sourceDDL);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;tableEnv.executeSql(sinkDDL);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;TableResult result = tableEnv.executeSql(transformSQL);</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;// 等待flink-cdc完成快照</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;result.print();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;env.execute("sync-flink-cdc");</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">}</span></pre><p cid="n185" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">查看执行结果</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.5522041763341067" data-s="300,640" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/5_KGWicicgj8qicbicdTz1UpsHQWJVjA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcw3dKBbKwc8ZA73s8s30tBiaibsM9iaeKGWicicgj8qicbicdTz1UpsHQWJVjA/640?wx_fmt=png'" data-type="png" data-w="862" style=""  /></p><p cid="n196" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">添加依赖</span></p><pre spellcheck="false" lang="xml" cid="n202" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;&lt;dependencies&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- https://mvnrepository.com/artifact/org.apache.flink/flink-core --&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-core&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-streaming-java_2.12&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">&lt;!-- &nbsp; &nbsp; &nbsp;  &lt;dependency&gt;--&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">&lt;!-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;--&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">&lt;!-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;artifactId&gt;flink-jdbc_2.12&lt;/artifactId&gt;--&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">&lt;!-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;version&gt;1.10.3&lt;/version&gt;--&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">&lt;!-- &nbsp; &nbsp; &nbsp;  &lt;/dependency&gt;--&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-connector-jdbc_2.12&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-java&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-clients_2.12&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-table-api-java-bridge_2.12&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-table-common&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-table-planner_2.12&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-table-planner-blink_2.12&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-table-planner-blink_2.12&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.13.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;type&gt;test-jar&lt;/type&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;com.alibaba.ververica&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-connector-mysql-cdc&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.4.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><br  /><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;com.aliyun&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;flink-connector-clickhouse&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;1.12.0&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;ru.yandex.clickhouse&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;clickhouse-jdbc&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;0.2.6&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;artifactId&gt;gson&lt;/artifactId&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;version&gt;2.8.6&lt;/version&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/dependency&gt;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;&lt;/dependencies&gt;</span></pre><p cid="n62" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span style="box-sizing: border-box;font-size: 14px;">参考链接：</span></p><p cid="n64" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span style="box-sizing: border-box;word-break: break-all;font-size: 14px;">https://blog.csdn.net/zhangjun5965/article/details/107605396</span></p><p cid="n66" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span style="box-sizing: border-box;word-break: break-all;font-size: 14px;">https://cloud.tencent.com/developer/article/1745233?from=article.detail.1747773</span></p><p cid="n329" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span style="box-sizing: border-box;word-break: break-all;font-size: 14px;">https://segmentfault.com/a/1190000039662261</span></p><p cid="n331" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span style="box-sizing: border-box;word-break: break-all;font-size: 14px;">https://www.cnblogs.com/weijiqian/p/13994870.html</span></p><section style="max-width: 100%;color: rgb(178, 178, 178);outline: 0px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 14px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(178, 178, 178);text-align: center;background-color: rgb(255, 255, 255);margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><br  /></section><hr data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;max-width: 100%;height: 1px;border-right: none;border-bottom: none;border-left: none;border-top-style: solid;border-top-color: black;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /><section style="padding-top: 8px;padding-bottom: 8px;max-width: 100%;line-height: 26px;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="max-width: 100%;font-size: 14px;overflow-wrap: break-word !important;box-sizing: border-box !important;">《大数据成神之路》正在全面PDF化。</span></section><section style="padding-top: 8px;padding-bottom: 8px;max-width: 100%;line-height: 26px;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="max-width: 100%;font-size: 14px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><strong style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">你只需要关注并在后台回复</strong><strong style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 4px;max-width: 100%;font-size: 14px;border-radius: 4px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break: break-all;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="max-width: 100%;color: rgb(255, 104, 39);overflow-wrap: break-word !important;box-sizing: border-box !important;">「PDF」</span></code></strong><strong style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">就可以看到阿里云盘下载链接了！</strong></span></section><section class="mp_profile_iframe_wrp"><mpprofile class="js_uneditable custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzU3MzgwNTU2Mg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MrfCUBgMwsXeyxKKIxY5GNfl3g0zm1ibib46XO7tlIEs8ncmlp3Zzq8JJs0ibLbHdL4AWox8hSUIMDw/0?wx_fmt=png" data-nickname="大数据技术与架构" data-alias="import_bigdata" data-signature="大数据开发、大数据面试、大数据框架、大数据实时计算、大数据离线计算Flink/Spark/Hadoop/数仓开发，干货，面试，资料下载，源码解读等" data-from="0"></mpprofile></section><section style="padding-top: 8px;padding-bottom: 8px;max-width: 100%;line-height: 26px;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="max-width: 100%;font-size: 14px;overflow-wrap: break-word !important;box-sizing: border-box !important;">另外我把发表过的文章按照体系全部整理好了。现在你可以在后台方便的进行查找：</span></section><section style="padding-right: 10px;padding-left: 10px;max-width: 100%;color: black;line-height: 1.6;letter-spacing: 0px;word-break: break-word;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;display: flex;flex-direction: column;justify-content: center;align-items: center;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.6712962962962963" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/6_yPb94gicvelDmiaGhnMem0cs9p9LLw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PM7nI3CL3Oy36gcxKeHdodXia8jHXrOPpe2ZePDiaoCeLFvdKbyPb94gicvelDmiaGhnMem0cs9p9LLw/640?wx_fmt=png'" data-type="png" data-w="1080" style="margin-right: auto;margin-left: auto;display: block;border-radius: 6px;box-shadow: rgb(180, 180, 180) 0em 0em 0.5em 0px;font-size: 17px;overflow-wrap: break-word !important;"  /></figure><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;display: flex;flex-direction: column;justify-content: center;align-items: center;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.6574074074074074" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/7_ibqM9S3BOIOicTSNuqbIw29KGsTIPw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PM7nI3CL3Oy36gcxKeHdodsDazT1XgoDW32ye4TAd3fnOhDSibqM9S3BOIOicTSNuqbIw29KGsTIPw/640?wx_fmt=png'" data-type="png" data-w="1080" style="margin-right: auto;margin-left: auto;display: block;border-radius: 6px;box-shadow: rgb(180, 180, 180) 0em 0em 0.5em 0px;font-size: 17px;overflow-wrap: break-word !important;"  /></figure></section><section style="padding-top: 8px;padding-bottom: 8px;max-width: 100%;line-height: 26px;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="font-size: 14px;">电子版把他们分类做成了下面这个样子，并且放在了阿里云盘提供下载。</span></section><section style="padding-right: 10px;padding-left: 10px;max-width: 100%;line-height: 1.6;letter-spacing: 0.034em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;display: flex;flex-direction: column;justify-content: center;align-items: center;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.42314814814814816" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/8_aSS56bw8SAal18vVZXoAccvxJ1ZEog.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PM7nI3CL3Oy36gcxKeHdodduk3T8FicKOfOTaks0WNX5EKJiaSS56bw8SAal18vVZXoAccvxJ1ZEog/640?wx_fmt=png'" data-type="png" data-w="1080" style="margin-right: auto;margin-left: auto;display: block;border-radius: 6px;box-shadow: rgb(180, 180, 180) 0em 0em 0.5em 0px;font-size: 17px;overflow-wrap: break-word !important;"  /></figure></section><section style="padding-top: 8px;padding-bottom: 8px;max-width: 100%;line-height: 26px;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="font-size: 14px;">我们点开一个文件夹后:</span></section><section style="padding-right: 10px;padding-left: 10px;max-width: 100%;white-space: normal;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;line-height: 1.6;letter-spacing: 0.034em;font-size: 16px;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;display: flex;flex-direction: column;justify-content: center;align-items: center;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.7435185185185185" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/9_mHztuezIg8YLzqrHmnaLaW2M5iaEmg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PM7nI3CL3Oy36gcxKeHdodxsrfAZf18GhJRbPZWqTzlUoUumHztuezIg8YLzqrHmnaLaW2M5iaEmg/640?wx_fmt=png'" data-type="png" data-w="1080" style="margin-right: auto;margin-left: auto;display: block;border-radius: 6px;box-shadow: rgb(180, 180, 180) 0em 0em 0.5em 0px;font-size: 17px;overflow-wrap: break-word !important;"  /></figure></section><section style="padding-top: 1em;padding-bottom: 8px;max-width: 100%;color: rgb(74, 74, 74);line-height: 1.75em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="font-size: 14px;"><span style="font-size: 14px;max-width: 100%;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;">如果这个文章对你有帮助，不要忘记&nbsp;</span><span style="font-size: 14px;max-width: 100%;outline: 0px;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);color: rgb(255, 104, 39);overflow-wrap: break-word !important;box-sizing: border-box !important;"><strong style="max-width: 100%;outline: 0px;line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;">「在看」</strong>&nbsp;<strong style="max-width: 100%;outline: 0px;line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;">「点赞」</strong>&nbsp;<strong style="max-width: 100%;outline: 0px;line-height: 1.75em;overflow-wrap: break-word !important;box-sizing: border-box !important;">「收藏」</strong></span><span style="font-size: 14px;max-width: 100%;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;">&nbsp;三连啊喂！</span></span></section><blockquote data-tool="mdnice编辑器" style="margin-top: 20px;margin-bottom: 20px;padding: 15px 20px;border-left-color: rgb(53, 179, 120);color: rgb(106, 115, 125);line-height: 27px;font-size: 0.9em;max-width: 100%;border-top: none;border-right: none;border-bottom: none;overflow: auto;background: rgb(251, 249, 253);overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;line-height: 26px;font-size: 15px;color: rgb(89, 89, 89);margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="font-size: 14px;">Hi，我是王知无，一个大数据领域的原创作者。&nbsp;</span></section><section style="max-width: 100%;line-height: 26px;font-size: 15px;color: rgb(89, 89, 89);margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="font-size: 14px;">放心关注我，获取更多行业的一手消息。</span></section></blockquote><section style="max-width: 100%;white-space: normal;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.4662576687116564" data-s="300,640" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/10_T7huEHTT4z45Jibay1ZebmsSSqiaeA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MPL7m13Yrluz8WJicNiaVRsiaCqArkyO99exPDGicFIH6AF7ZWRpT7huEHTT4z45Jibay1ZebmsSSqiaeA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="978" style="height: 241px;font-family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: center;widows: 1;color: rgb(255, 97, 149);font-size: 15px;letter-spacing: 1px;border-radius: 30px;box-shadow: rgb(150, 150, 150) 0em 0em 0.5em 0px;width: 518px;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;text-align: left;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><br  /></section><section style="padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;text-align: left;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><br  /></section><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="图片/大数据技术与架构_2021-12-22_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/11_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="height: 42px;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;overflow-wrap: break-word !important;"  /></section><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504680&amp;idx=1&amp;sn=9f2547b40316b8dc8a748bbc8b6b6015&amp;chksm=fd3e95bdca491cab9e0badbd7a1144f7511638ae80db684fd5383c771129a16bb08ba5e72515&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">八千里路云和月 | 从零到大数据专家学习路径指南</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">互联网最坏的时代可能真的来了</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">我在B站读大学，大数据专业</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">我们在学习Flink的时候，到底在学习什么？</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">193篇文章暴揍Flink，这个合集你需要关注一下</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">我们在学习Spark的时候，到底在学习什么？</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">在所有Spark模块中，我愿称SparkSQL为最强！</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">硬刚Hive | 4万字基础调优面试小总结</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">数据治理方法论和实践小百科全书</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">标签体系下的用户画像建设小指南</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解析</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">我写过的关于成长/面试/职场进阶的文章</a></section><section style="max-width: 100%;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></content>
</div>
</body>
</html>