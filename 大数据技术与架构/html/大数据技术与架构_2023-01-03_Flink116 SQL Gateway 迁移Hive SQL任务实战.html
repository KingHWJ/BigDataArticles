<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"Flink1.16 SQL Gateway 迁移Hive SQL任务实战","time":"2023-01-03 17:50:51","timeStamp":"1672739451"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247516766&idx=1&sn=a4eaaf80084e5b13afbc46b01039e20c&chksm=fd3ec4cbca494ddd1a4cc447546d5c937a2350d76a44e807fe6fa8bb39e26b65bdb87f4aaf53#rd" target="_blank">Flink1.16 SQL Gateway 迁移Hive SQL任务实战</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-01-03 17:50:51</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU3MzgwNTU2Mg==&action=getalbum&album_id=1369031183400747008#wechat_redirect" title="大数据成神之路" target="_blank">#大数据成神之路</a></p></div><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;outline: 0px;color: rgb(34, 34, 34);font-size: 14.875px;text-size-adjust: auto;letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 23.625px;visibility: visible;" data-mpa-powered-by="yiban.io"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-role="outer" label="Powered by 135editor.com" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tools="135编辑器" data-id="98469" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 21.875px;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><blockquote data-tool="mdnice编辑器" mp-original-font-size="14.399999618530273" mp-original-line-height="23" style="margin: 20px 0px;padding: 10px 10px 10px 20px;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);line-height: 20.125px;font-size: 12.6px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;border-top-style: none;border-right-style: none;border-bottom-style: none;overflow: auto;background-color: rgb(255, 249, 249);visibility: visible;"><p mp-original-font-size="16" mp-original-line-height="26" style="margin: 0px;padding: 8px 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 22.75px;visibility: visible;"><span mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;color: rgb(89, 89, 89);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0.544px;text-align: left;font-size: 12.25px;visibility: visible;line-height: 22.75px;"><strong mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;visibility: visible;font-size: 12.25px;line-height: 22.75px;"><img class="rich_pages wxw-img" data-ratio="1" data-type="png" data-w="20" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/1_6VyhjNCMic3DGmPLZocTtEmtWBJKsQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2OP8CL6Mmrc9shxR4OiamrPMlRCKiaicf2n4JLNDRcyH1jfEKxo6VyhjNCMic3DGmPLZocTtEmtWBJKsQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" style="margin: 0px;padding: 0px;max-width: 100%;height: auto !important;overflow-wrap: break-word !important;vertical-align: text-bottom;outline: 0px;display: inline-block;font-size: 10.7188px;line-height: 19.9062px;box-sizing: border-box !important;visibility: visible !important;width: 20px !important;"  /><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247514568&amp;idx=1&amp;sn=659d7464a3b61ebf8397d2597069f4ab&amp;chksm=fd3eff5dca49764beef9ab14400e96715b86b3394f05e161181c03424fa579cdbc242a401411&amp;scene=21#wechat_redirect" textvalue="全网最全大数据面试提升手册！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;color: rgb(255, 41, 65);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: left;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;background-color: rgb(255, 249, 249);font-size: 14px;"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-size: 14px;color: rgb(255, 41, 65);">全网最全大数据面试提升手册！</span></strong></a></strong></span></p></blockquote></section></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">使用Flink的SQL Gateway迁移Hive SQL任务</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>前言<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">我们有数万个离线任务，主要还是默认的DataPhin调度CDP集群的Hive On Tez这种低成本任务，当然也有PySpark、打Jar包的Spark和打Jar包的Flink任务这种高成本的任务【Java和Scala都有】。毕竟SQL上手门槛极低，是个人都能写几下并且跑起来，还可以很容易看到run成功的数据长得像不像。其实HQL任务的性能并不会好到哪里去，主要是SQL Boy便宜，无脑堆人天就可以线性提升开发速度。DataPhin的底层基本可以确认就是beeline -f包了一层，而它本身作为二级队列，并不是真正意义上的网关。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">我们之前做大数据基础平台时，也有为数据中台租户部署Kyuubi这个网关组件。</p><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">Apache Kyuubi：https://kyuubi.apache.org/</p></blockquote><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.3334214002642008" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/2_O9UymWy2tkF6lgSfwOyx3I5ABtWm4w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLF4ibic3w4lJwubGxfK9L8g8Cm96O9UymWy2tkF6lgSfwOyx3I5ABtWm4w/640?wx_fmt=png'" data-type="png" data-w="3785" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这货现在发育的灰常好：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4138171667829728" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/3_dibKB9lz8XRhGQTFdGqHf0FiaEKhpA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFjGSxnmxbuHWbJMeNibHWia2m11QQdibKB9lz8XRhGQTFdGqHf0FiaEKhpA/640?wx_fmt=png'" data-type="png" data-w="2866" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">已经不局限于一个霸占Yarn的资源锁定一个Session ID，然后提交Spark任务了。。。这货现在还可以支持Flink和Hudi。。。湖仓一体就需要这货。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">燃鹅，新版Flink1.16.0新增了一个和Kyuubi、Spark、Tez抢饭碗的重磅功能：SQL Gateway：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.7055762081784387" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/4_1AeXuMm6yXWZ50xnPGU6oZGKNFibvw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFN8EiaEh70d55P3TomoGLX4c3ZX1AeXuMm6yXWZ50xnPGU6oZGKNFibvw/640?wx_fmt=png'" data-type="png" data-w="2690" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">众所周知，Flink的SQL和标准Hive SQL不太一样，新版Flink主动向Hive的dialect看齐：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6032048836322015" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/5_K9xbmgkuiaHuDF6Oeovs0iaj2dVC6A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFeWricBWq9fSIpFgwibS8umOicvVJSK9xbmgkuiaHuDF6Oeovs0iaj2dVC6A/640?wx_fmt=png'" data-type="png" data-w="2621" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">从而提高了堆HQL的兼容性。官方号称可以97%的HQL任务无需修改直接迁移到Flink！！！还是比较唬人的。</p><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">常规的Spark SQL：https://lizhiyong.blog.csdn.net/article/details/120064874</p></blockquote><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">只是让Spark去读Hive9083端口MetaStore的元数据，SQL解析AST、CBO优化和Task执行都是Spark的Catalyst负责。</p><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">Hive On Tez【或者MR、Spark】：https://lizhiyong.blog.csdn.net/article/details/123436630</p></blockquote><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这种方式只是Hive把解析完的任务提交给不同的计算引擎去具体运算。但是很少有听说过Hive On Flink【虽然翻Hive的源码好像可以去实现它】。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">所以本文重点就是这个Hive On Flink。用流批一体的运算引擎去跑批也是个有趣的事情。有生之年有望看到Flink一统江湖了。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>Hive On Flink原理<span style="display: none;"></span></h3><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>新增的支持<span style="display: none;"></span></h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hive任务能使用Flink来跑，Flink当然是做了很多支持：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6118347599553405" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/6_jbFt22C2I4yy5aejoVL7seIHfVsT4A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFcZobiaRYAJ2RngsyhKNa52j4WjbFt22C2I4yy5aejoVL7seIHfVsT4A/640?wx_fmt=png'" data-type="png" data-w="2687" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Hive的MetaStore在大数据领域的地位相当于K8S在云原生容器编排领域的地位，或者Alluxio在云原生存算分离架构统一存储层的地位，都是事实上的标准了。能解析Hive的Metastore就可以管理Hadoop集群绝大多数的Hive表了。当然Hudi的一些表、Flink的一些SQL流式表也可能被管控到。</p><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">而支持Hive的UDF，天然就拥有了Hive的那几百个系统函数：https://lizhiyong.blog.csdn.net/article/details/127501392</p></blockquote><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">当然就可以减少很多写UDF的平台组件二开攻城狮或者部分资深SQL Boy的工作量。UDF函数们是公司的资产，轻易不可以弃用的。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.7025060630557801" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/7_tlxtPP9f1IoSKh0dt6ou2ub3O9TzWQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFyL5VBakFPsnz2Ce5dmknjSzNtlxtPP9f1IoSKh0dt6ou2ub3O9TzWQ/640?wx_fmt=png'" data-type="png" data-w="1237" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">作为一个运算引擎，在Source端和Sink端都支持流式和批式操作Hive表，毫不意外。还可以自动小文件合并，有点像Hudi的Merge On Read这种写多读少的模式了。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>SQL解析<span style="display: none;"></span></h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在SQL Boy们眼里最重要的SQL，其实在Java和C#种也就是个普通的String字符串，走JDBC传参或者ADO.NET，如果是开发个AD Hoc即席查询平台，单从功能角度，其实都不需要关心租户们传的select语句的具体内容。但是执行引擎必须能把SQL字符串给解析成具体的执行计划或者底层任务。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6966879721092388" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/8_kbyicoaiblDLlwpZboLEYViaUpYP1g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLF1iakicMiabyt4MhPorsr9uuGiaHFXgUkbyicoaiblDLlwpZboLEYViaUpYP1g/640?wx_fmt=png'" data-type="png" data-w="1721" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink1.16.0使用了这么一个可插拔的插件，将HQL解析为Logical Plan逻辑计划。后续的ROB、CBO优化生成Physical Plan物理计划，还有转换为Flink最终的Job Graph都是与普通的Blink执行套路一致。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>效果<span style="display: none;"></span></h5><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4449319877139096" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/9_HQUYpEIJ1edcK28oUuu6BM8hzic88g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFZPcicIFmrCzfPUtnCicTpVZ0KneHQUYpEIJ1edcK28oUuu6BM8hzic88g/640?wx_fmt=png'" data-type="png" data-w="2279" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以满足大部分应用场景了。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4630274874177313" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/10_ic4VPhUSqicic0iaAcSmXQzkw2RicA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLF1RPSDCwEyXBXa9QycwvEBex1ziaxWAic4VPhUSqicic0iaAcSmXQzkw2RicA/640?wx_fmt=png'" data-type="png" data-w="2583" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">命令行和API、运行时、底层资源调度，都可以实现一致，运维起来应该要方便不少。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>Gateway<span style="display: none;"></span></h5><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5677622692480865" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/11_8bEQs7Sds33juD0ZOhGKNxpqx7hxRA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFQ6PAia61pzGjaiblwmpPibdOo2R8bEQs7Sds33juD0ZOhGKNxpqx7hxRA/640?wx_fmt=png'" data-type="png" data-w="2221" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink自带了Flink SQL Gateway，显而易见的好处是平台和组件二开人员不需要去自己写Gateway去Dispatch分发任务了，甚至二级调度都可以省了。</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4706847068470685" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/12_hpw8J1SCAjJt2QNxuFoyhqEnOib1zw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFrSZrhxh1W6vGwon8Vl5TKlVVChpw8J1SCAjJt2QNxuFoyhqEnOib1zw/640?wx_fmt=png'" data-type="png" data-w="2439" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">本身后端就可以多租户了，还可以支持多种Cluster，K8S和Yarn或者Docker的Standalone混合云考虑一下？</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">前端支持Rest和Hive Server2，对Java开发人员和SQL Boy们都很友好。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>HS2Endpoint<span style="display: none;"></span></h5><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.8134851138353766" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/13_dt8fjG9Hy3suNGTGwyqB88DRnJsibg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFwc57YrusnH94j771AcD2njPnodt8fjG9Hy3suNGTGwyqB88DRnJsibg/640?wx_fmt=png'" data-type="png" data-w="1142" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">有点区别：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6115204286671132" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/14_CXribKbUSNLHhhv2BcVQUoEEeVcXGg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFR3hG5AdrjthOkBgibfrBjrIXXGCXribKbUSNLHhhv2BcVQUoEEeVcXGg/640?wx_fmt=png'" data-type="png" data-w="1493" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>优势<span style="display: none;"></span></h5><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6132971506105834" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/15_RTR4wbX4vyHqHhXEBwlLqtPnxH6qKw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFoRKIW28KAVASKMFOYaCJBpic7RTR4wbX4vyHqHhXEBwlLqtPnxH6qKw/640?wx_fmt=png'" data-type="png" data-w="1474" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">尤其是处理异构数据源：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.6400778210116731" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/16_BpibV9nLqlbH2KGicylUnMNyzoESBg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFVwWPNvrb1GgaBfrXy8kpVELnlBBpibV9nLqlbH2KGicylUnMNyzoESBg/640?wx_fmt=png'" data-type="png" data-w="1542" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">优势很明显。做联邦查询的改动也只是需要+个Catalog。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>Demo<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">FFA2022的罗宇侠&amp;方盛凯两位大佬带来个Demo，展示了Flink如何使用Hive和Flink的dialect分别按流式和批式跑任务。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">为了方便查看，笔者手动敲出来了：</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>流式<span style="display: none;"></span></h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">建表：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">--创建目标表<br  />create&nbsp;table&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;not&nbsp;exists&nbsp;dwd_category_by_day(<br  />&nbsp;`i_category`&nbsp;string,<br  />&nbsp;`cate_sales`&nbsp;double,<br  />&nbsp;`cayehory_day_order_cnt`&nbsp;bigint<br  />)&nbsp;<br  />partitioned&nbsp;by&nbsp;(<br  />&nbsp;`year`&nbsp;bigint,<br  />&nbsp;`day`&nbsp;bigint<br  />)<br  />TBLPROPERTIES(<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'sink.partition-commit.policy.kind'</span>=<span style="color: #98c379;line-height: 26px;">'metastore,success-file'</span><br  />)<br  />;<br  /><br  />--创建源表<br  /><span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;table.sql-dialect=default;<br  /><br  />create&nbsp;table&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;not&nbsp;exists&nbsp;s_dwd_store_sales(<br  />&nbsp;`ss_item_sk`&nbsp;bigint,<br  />&nbsp;`i_brand`&nbsp;string,<br  />&nbsp;`i_class`&nbsp;string,<br  />&nbsp;`i_category`&nbsp;string,<br  />&nbsp;`ss_sales_price`&nbsp;double,<br  />&nbsp;`d_date`&nbsp;date,<br  />&nbsp;`d_timestamp`&nbsp;as&nbsp;cast(d_date&nbsp;as&nbsp;timestamp(3)),<br  />&nbsp;watermark&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;`d_timestamp`&nbsp;as&nbsp;`d_timestamp`<br  />)&nbsp;with&nbsp;(<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'connector'</span>=<span style="color: #98c379;line-height: 26px;">'kafka'</span>,<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'topic'</span>=<span style="color: #98c379;line-height: 26px;">'dwd_store_sales'</span>,<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'properties.bootstrap.servers'</span>=<span style="color: #98c379;line-height: 26px;">'192.168.88.101:9092,192.168.88.102:9092,192.168.88.103:9092'</span>,<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'properties.group.id'</span>=<span style="color: #98c379;line-height: 26px;">'FFA'</span>,<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'key.fields'</span>=<span style="color: #98c379;line-height: 26px;">'ss_item_sk'</span>,<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'scan.startup_mode'</span>=<span style="color: #98c379;line-height: 26px;">'earlist-offset'</span>,<br  />&nbsp;<span style="color: #98c379;line-height: 26px;">'key.format'</span>=<span style="color: #98c379;line-height: 26px;">'json'</span>,<br  />)<br  />;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">根据Demo的建表DDL，可以看出按照Hive语法建表时，Flink需要设置表的属性。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">而使用传统Flink的语法建流式表时，反倒需要手动指定dialect。说明默认的dialect其实是：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;table.sql-dialect=hive;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">每日类销量以及订单数统计:</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;table.sql-dialect=default;<br  /><span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;execution.runtime-mode=streaming;<br  /><span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;table.cml-sync=<span style="color: #56b6c2;line-height: 26px;">false</span>;--异步提交作业<br  /><br  />--开启检查点<br  /><span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;execution.checkpointing.interval=30s;<br  /><br  />insert&nbsp;into&nbsp;dwd_category_by_day<br  />select<br  />&nbsp;i_category,<br  />&nbsp;sum(ss_sales_price)&nbsp;as&nbsp;month_sales,<br  />&nbsp;count(1)&nbsp;as&nbsp;order_cnt,<br  />&nbsp;year(window_start)&nbsp;as&nbsp;`year`,<br  />&nbsp;dayofyear(window_start)&nbsp;as&nbsp;`day`<br  />from&nbsp;TABLE(<br  />&nbsp;TUMBLE(<br  />&nbsp;&nbsp;TABLE&nbsp;s_dwd_store_sales,DESCRIPTOR(d_timestamp),INTERVAL&nbsp;<span style="color: #98c379;line-height: 26px;">'1'</span>&nbsp;DAY<br  />&nbsp;)<br  />)<br  />group&nbsp;by<br  />&nbsp;window_start,<br  />&nbsp;window_end,<br  />&nbsp;i_category<br  />;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">流式的SQL需要设置滑动的时间窗口，貌似没啥子毛病。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">销量最佳Top3：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #e6c07b;line-height: 26px;">set</span>&nbsp;table.sql_dialect=default;<br  /><br  />select<br  />&nbsp;i_category,<br  />&nbsp;categoru_day_order_cnt,<br  />&nbsp;rownum<br  />from(<br  />&nbsp;select<br  />&nbsp;&nbsp;i_category,<br  />&nbsp;&nbsp;categoru_day_order_cnt,<br  />&nbsp;&nbsp;row_number()&nbsp;over&nbsp;(order&nbsp;by&nbsp;categoru_day_order_cnt&nbsp;desc)&nbsp;as&nbsp;rownum<br  />&nbsp;from<br  />&nbsp;&nbsp;dwd_category_by_day<br  />)<br  /><span style="color: #e6c07b;line-height: 26px;">where</span><br  />&nbsp;rownum&lt;=3<br  />;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Flink的SQL不用像Hive的SQL那样每个子查询都要起别名【Spark SQL也不用】，太棒了！</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以看到流式的SQL任务，开发成本肯定比Java和Scala写DataStreaming算子低！！！利好SQL Boy。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>批式<span style="display: none;"></span></h5><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">desc&nbsp;tpcds_bin_orc_2.dwd_store_sales;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这个表2位大佬已经灌过数据，根据表结构，笔者大概知道大概也是长这样：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">create&nbsp;table&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;not&nbsp;exists&nbsp;tpcds_bin_orc_2.dwd_store_sales(<br  />&nbsp;`ss_item_sk`&nbsp;bigint,<br  />&nbsp;`i_brand`&nbsp;string,<br  />&nbsp;`i_class`&nbsp;string,<br  />&nbsp;`i_category`&nbsp;string,<br  />&nbsp;`ss_sales_price`&nbsp;double<br  />)<br  />partitioned&nbsp;by&nbsp;(<br  />&nbsp;`d_date`&nbsp;date<br  />)<br  />;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">每日大类销量以及订单数统计：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">insert&nbsp;overwrite&nbsp;dwd_category_by_day<br  />select<br  />&nbsp;i_category,<br  />&nbsp;sum(ss_sales_price)&nbsp;as&nbsp;month_sales,<br  />&nbsp;count(1)&nbsp;as&nbsp;order_cnt,<br  />&nbsp;year(d_date)&nbsp;as&nbsp;`year`,<br  />&nbsp;datediff(d_date,concat(year(d_date)-1,<span style="color: #98c379;line-height: 26px;">'-12-31'</span>))<br  />from<br  />&nbsp;tpcds_bin_orc_2.dwd_store_sales<br  />group&nbsp;by<br  />&nbsp;year(d_date),<br  />&nbsp;datediff(d_date,concat(year(d_date)-1,<span style="color: #98c379;line-height: 26px;">'-12-31'</span>)),<br  />&nbsp;i_category<br  />;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">销量最佳Top3：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">select<br  />&nbsp;i_category,<br  />&nbsp;categoru_day_order_cnt,<br  />&nbsp;rownum<br  />from(<br  />&nbsp;select<br  />&nbsp;&nbsp;i_category,<br  />&nbsp;&nbsp;categoru_day_order_cnt,<br  />&nbsp;&nbsp;row_number()&nbsp;over&nbsp;(order&nbsp;by&nbsp;categoru_day_order_cnt&nbsp;desc)&nbsp;as&nbsp;rownum<br  />&nbsp;from<br  />&nbsp;&nbsp;dwd_category_by_day<br  />)<br  /><span style="color: #e6c07b;line-height: 26px;">where</span><br  />&nbsp;rownum&lt;=3<br  />;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以看到批式的SQL任务由于数据不会在运算时发生变化，不用考虑各种事件时间和水位线还有滑动时间窗口，直接替换即可，更简单！</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">宣传的97%HQL任务可以不加改动，直接迁移到Flink，还算有希望的。不过底层做了什么惊天地泣鬼神的大事，对于只会写业务脚本的SQL Boy们来说，也无关痛痒。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>Github参考资料<span style="display: none;"></span></h3><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">Flink sql Gateway有个Github地址：https://github.com/ververica/flink-sql-gateway<br  />作者Ververica：https://www.ververica.com/</p></blockquote><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.4097307221542228" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/17_EnC4PLfial0MCvIJppD4iaM7jOYWyg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLF4wPCib5XkICtPmSECg4nds8ApLOEnC4PLfial0MCvIJppD4iaM7jOYWyg/640?wx_fmt=png'" data-type="png" data-w="3268" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">它就是Flink的公司。</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Github的这个Flink sql Gateway貌似很久没有更新了。但是它毕竟只是与BE交互的FE，还是可以参考。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>启动Gateway<span style="display: none;"></span></h5><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">./bin/sql-gateway.sh&nbsp;-h<br  /><br  />The&nbsp;following&nbsp;options&nbsp;are&nbsp;available:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-d,--defaults&nbsp;&lt;default&nbsp;configuration&nbsp;file&gt;&nbsp;&nbsp;&nbsp;The&nbsp;properties&nbsp;with&nbsp;<span style="color: #e6c07b;line-height: 26px;">which</span>&nbsp;every&nbsp;new&nbsp;session&nbsp;is&nbsp;initialized.&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Properties&nbsp;might&nbsp;be&nbsp;overwritten&nbsp;by&nbsp;session&nbsp;properties.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-h,--<span style="color: #e6c07b;line-height: 26px;">help</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Show&nbsp;the&nbsp;<span style="color: #e6c07b;line-height: 26px;">help</span>&nbsp;message&nbsp;with&nbsp;descriptions&nbsp;of&nbsp;all&nbsp;options.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-j,--jar&nbsp;&lt;JAR&nbsp;file&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;JAR&nbsp;file&nbsp;to&nbsp;be&nbsp;imported&nbsp;into&nbsp;the&nbsp;session.&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;file&nbsp;might&nbsp;contain&nbsp;user-defined&nbsp;classes&nbsp;needed&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statements&nbsp;such&nbsp;as&nbsp;<span style="color: #e6c07b;line-height: 26px;">functions</span>,&nbsp;the&nbsp;execution&nbsp;of&nbsp;table&nbsp;sources,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;sinks.&nbsp;Can&nbsp;be&nbsp;used&nbsp;multiple&nbsp;<span style="color: #e6c07b;line-height: 26px;">times</span>.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-l,--library&nbsp;&lt;JAR&nbsp;directory&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;JAR&nbsp;file&nbsp;directory&nbsp;with&nbsp;<span style="color: #e6c07b;line-height: 26px;">which</span>&nbsp;every&nbsp;new&nbsp;session&nbsp;is&nbsp;initialized.&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;files&nbsp;might&nbsp;contain&nbsp;user-defined&nbsp;classes&nbsp;needed&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;execution&nbsp;of&nbsp;statements&nbsp;such&nbsp;as&nbsp;<span style="color: #e6c07b;line-height: 26px;">functions</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;sources,&nbsp;or&nbsp;sinks.&nbsp;Can&nbsp;be&nbsp;used&nbsp;multiple&nbsp;<span style="color: #e6c07b;line-height: 26px;">times</span>.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-p,--port&nbsp;&lt;service&nbsp;port&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;port&nbsp;to&nbsp;<span style="color: #e6c07b;line-height: 26px;">which</span>&nbsp;the&nbsp;REST&nbsp;client&nbsp;connects&nbsp;to.<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">下Flink集群有这个角标。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>典型的yaml<span style="display: none;"></span></h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">默认的配置文件：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Define&nbsp;server&nbsp;properties.</span><br  /><br  />server:<br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">bind</span>-address:&nbsp;127.0.0.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;The&nbsp;address&nbsp;that&nbsp;the&nbsp;gateway&nbsp;binds&nbsp;itself&nbsp;(127.0.0.1&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;address:&nbsp;127.0.0.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;The&nbsp;address&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;by&nbsp;clients&nbsp;to&nbsp;connect&nbsp;to&nbsp;the&nbsp;gateway&nbsp;(127.0.0.1&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;port:&nbsp;8083&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;The&nbsp;port&nbsp;that&nbsp;the&nbsp;client&nbsp;connects&nbsp;to&nbsp;&nbsp;(8083&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;jvm_args:&nbsp;<span style="color: #98c379;line-height: 26px;">"-Xmx2018m&nbsp;-Xms1024m"</span>&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;The&nbsp;JVM&nbsp;args&nbsp;for&nbsp;SQL&nbsp;gateway&nbsp;process</span><br  /><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Define&nbsp;session&nbsp;properties.</span><br  /><br  />session:<br  />&nbsp;&nbsp;idle-timeout:&nbsp;1d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;Session&nbsp;will&nbsp;be&nbsp;closed&nbsp;when&nbsp;it's&nbsp;not&nbsp;accessed&nbsp;for&nbsp;this&nbsp;duration,&nbsp;which&nbsp;can&nbsp;be&nbsp;disabled&nbsp;by&nbsp;setting&nbsp;to&nbsp;zero.&nbsp;The&nbsp;minimum&nbsp;unit&nbsp;is&nbsp;in&nbsp;milliseconds.&nbsp;(1d&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;check-interval:&nbsp;1h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;The&nbsp;check&nbsp;interval&nbsp;for&nbsp;session&nbsp;idle&nbsp;timeout,&nbsp;which&nbsp;can&nbsp;be&nbsp;disabled&nbsp;by&nbsp;setting&nbsp;to&nbsp;zero.&nbsp;The&nbsp;minimum&nbsp;unit&nbsp;is&nbsp;in&nbsp;milliseconds.&nbsp;(1h&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;max-count:&nbsp;1000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;Max&nbsp;count&nbsp;of&nbsp;active&nbsp;sessions,&nbsp;which&nbsp;can&nbsp;be&nbsp;disabled&nbsp;by&nbsp;setting&nbsp;to&nbsp;zero.&nbsp;(1000000&nbsp;by&nbsp;default)</span><br  /><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Define&nbsp;tables&nbsp;here&nbsp;such&nbsp;as&nbsp;sources,&nbsp;sinks,&nbsp;views,&nbsp;or&nbsp;temporal&nbsp;tables.</span><br  /><br  />tables:<br  />&nbsp;&nbsp;-&nbsp;name:&nbsp;MyTableSource<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;<span style="color: #e6c07b;line-height: 26px;">source</span>-table<br  />&nbsp;&nbsp;&nbsp;&nbsp;update-mode:&nbsp;append<br  />&nbsp;&nbsp;&nbsp;&nbsp;connector:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;filesystem<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path:&nbsp;<span style="color: #98c379;line-height: 26px;">"/path/to/something.csv"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;format:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;csv<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;MyField1<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;INT<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;MyField2<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;VARCHAR<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;line-delimiter:&nbsp;<span style="color: #98c379;line-height: 26px;">"\n"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment-prefix:&nbsp;<span style="color: #98c379;line-height: 26px;">"#"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;schema:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;MyField1<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;INT<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;MyField2<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;VARCHAR<br  />&nbsp;&nbsp;-&nbsp;name:&nbsp;MyCustomView<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;view<br  />&nbsp;&nbsp;&nbsp;&nbsp;query:&nbsp;<span style="color: #98c379;line-height: 26px;">"SELECT&nbsp;MyField2&nbsp;FROM&nbsp;MyTableSource"</span><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Define&nbsp;user-defined&nbsp;functions&nbsp;here.</span><br  /><br  /><span style="color: #e6c07b;line-height: 26px;">functions</span>:<br  />&nbsp;&nbsp;-&nbsp;name:&nbsp;myUDF<br  />&nbsp;&nbsp;&nbsp;&nbsp;from:&nbsp;class<br  />&nbsp;&nbsp;&nbsp;&nbsp;class:&nbsp;foo.bar.AggregateUDF<br  />&nbsp;&nbsp;&nbsp;&nbsp;constructor:<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;7.6<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span style="color: #56b6c2;line-height: 26px;">false</span><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Define&nbsp;available&nbsp;catalogs</span><br  /><br  />catalogs:<br  />&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;catalog_1<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;hive<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property-version:&nbsp;1<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hive-conf-dir:&nbsp;...<br  />&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;catalog_2<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>:&nbsp;hive<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property-version:&nbsp;1<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default-database:&nbsp;mydb2<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hive-conf-dir:&nbsp;...<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hive-version:&nbsp;1.2.1<br  /><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Properties&nbsp;that&nbsp;change&nbsp;the&nbsp;fundamental&nbsp;execution&nbsp;behavior&nbsp;of&nbsp;a&nbsp;table&nbsp;program.</span><br  /><br  />execution:<br  />&nbsp;&nbsp;parallelism:&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;Flink's&nbsp;parallelism&nbsp;(1&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;max-parallelism:&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;Flink's&nbsp;maximum&nbsp;parallelism&nbsp;(128&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;current-catalog:&nbsp;catalog_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;name&nbsp;of&nbsp;the&nbsp;current&nbsp;catalog&nbsp;of&nbsp;the&nbsp;session&nbsp;('default_catalog'&nbsp;by&nbsp;default)</span><br  />&nbsp;&nbsp;current-database:&nbsp;mydb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;optional:&nbsp;name&nbsp;of&nbsp;the&nbsp;current&nbsp;database&nbsp;of&nbsp;the&nbsp;current&nbsp;catalog</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;&nbsp;&nbsp;(default&nbsp;database&nbsp;of&nbsp;the&nbsp;current&nbsp;catalog&nbsp;by&nbsp;default)</span><br  /><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Configuration&nbsp;options&nbsp;for&nbsp;adjusting&nbsp;and&nbsp;tuning&nbsp;table&nbsp;programs.</span><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;A&nbsp;full&nbsp;list&nbsp;of&nbsp;options&nbsp;and&nbsp;their&nbsp;default&nbsp;values&nbsp;can&nbsp;be&nbsp;found</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;on&nbsp;the&nbsp;dedicated&nbsp;"Configuration"&nbsp;page.</span><br  />configuration:<br  />&nbsp;&nbsp;table.optimizer.join-reorder-enabled:&nbsp;<span style="color: #56b6c2;line-height: 26px;">true</span><br  />&nbsp;&nbsp;table.exec.spill-compression.enabled:&nbsp;<span style="color: #56b6c2;line-height: 26px;">true</span><br  />&nbsp;&nbsp;table.exec.spill-compression.block-size:&nbsp;128kb<br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Properties&nbsp;that&nbsp;describe&nbsp;the&nbsp;cluster&nbsp;to&nbsp;which&nbsp;table&nbsp;programs&nbsp;are&nbsp;submitted&nbsp;to.</span><br  /><br  />deployment:<br  />&nbsp;&nbsp;response-timeout:&nbsp;5000<br  /></code></pre><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>支持的语法<span style="display: none;"></span></h5><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.9769585253456221" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/18_6sXSVDKAHPNIAlEsCTOYANuoMRfHvQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MZpHqyAXln8LZj3AZ2UhLFHnZBQUlNeDLhJ6MicWagCialyQ6sXSVDKAHPNIAlEsCTOYANuoMRfHvQ/640?wx_fmt=png'" data-type="png" data-w="651" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">功能还算齐全。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>Beeline<span style="display: none;"></span></h5><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">beeline&gt;&nbsp;!connect&nbsp;jdbc:flink://localhost:8083?planner=blink<br  /><br  />Beeline&nbsp;version&nbsp;2.2.0&nbsp;by&nbsp;Apache&nbsp;Hive<br  />beeline&gt;&nbsp;!connect&nbsp;jdbc:flink://localhost:8083?planner=blink<br  />Connecting&nbsp;to&nbsp;jdbc:flink://localhost:8083?planner=blink<br  />Enter&nbsp;username&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;jdbc:flink://localhost:8083?planner=blink:&nbsp;<br  />Enter&nbsp;password&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;jdbc:flink://localhost:8083?planner=blink:&nbsp;<br  />Connected&nbsp;to:&nbsp;Apache&nbsp;Flink&nbsp;(version&nbsp;1.10.0)<br  />Driver:&nbsp;Flink&nbsp;Driver&nbsp;(version&nbsp;0.1)<br  />Transaction&nbsp;isolation:&nbsp;TRANSACTION_REPEATABLE_READ<br  />0:&nbsp;jdbc:flink://localhost:8083&gt;&nbsp;CREATE&nbsp;TABLE&nbsp;T(<br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;&nbsp;&nbsp;a&nbsp;INT,<br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;&nbsp;&nbsp;b&nbsp;VARCHAR(10)<br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;)&nbsp;WITH&nbsp;(<br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'connector.type'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'filesystem'</span>,<br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'connector.path'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'file:///tmp/T.csv'</span>,<br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'format.type'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'csv'</span>,<br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">'format.derive-schema'</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">'true'</span><br  />.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&gt;&nbsp;);<br  />No&nbsp;rows&nbsp;affected&nbsp;(0.158&nbsp;seconds)<br  />0:&nbsp;jdbc:flink://localhost:8083&gt;&nbsp;INSERT&nbsp;INTO&nbsp;T&nbsp;VALUES&nbsp;(1,&nbsp;<span style="color: #98c379;line-height: 26px;">'Hi'</span>),&nbsp;(2,&nbsp;<span style="color: #98c379;line-height: 26px;">'Hello'</span>);<br  />No&nbsp;rows&nbsp;affected&nbsp;(4.747&nbsp;seconds)<br  />0:&nbsp;jdbc:flink://localhost:8083&gt;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;T;<br  />+----+--------+--+<br  />|&nbsp;a&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;|<br  />+----+--------+--+<br  />|&nbsp;1&nbsp;&nbsp;|&nbsp;Hi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br  />|&nbsp;2&nbsp;&nbsp;|&nbsp;Hello&nbsp;&nbsp;|<br  />+----+--------+--+<br  />2&nbsp;rows&nbsp;selected&nbsp;(0.994&nbsp;seconds)<br  />0:&nbsp;jdbc:flink://localhost:8083&gt;&nbsp;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">这是比较老的语法了，传统的Flink SQL。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>JDBC<span style="display: none;"></span></h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">当然可以使用Java走JDBC调用：</p><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">Jar包：https://github.com/ververica/flink-jdbc-driver/releases</p></blockquote><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">Demo：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">import&nbsp;java.sql.Connection;<br  />import&nbsp;java.sql.DriverManager;<br  />import&nbsp;java.sql.ResultSet;<br  />import&nbsp;java.sql.Statement;<br  /><br  />public&nbsp;class&nbsp;Sample&nbsp;{<br  />&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;args)&nbsp;throws&nbsp;Exception&nbsp;{<br  />&nbsp;&nbsp;Connection&nbsp;connection&nbsp;=&nbsp;DriverManager.getConnection(<span style="color: #98c379;line-height: 26px;">"jdbc:flink://localhost:8083?planner=blink"</span>);<br  />&nbsp;&nbsp;Statement&nbsp;statement&nbsp;=&nbsp;connection.createStatement();<br  /><br  />&nbsp;&nbsp;statement.executeUpdate(<span style="color: #98c379;line-height: 26px;">"CREATE&nbsp;TABLE&nbsp;T(\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;a&nbsp;INT,\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;b&nbsp;VARCHAR(10)\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">")&nbsp;WITH&nbsp;(\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;'connector.type'&nbsp;=&nbsp;'filesystem',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;'connector.path'&nbsp;=&nbsp;'file:///tmp/T.csv',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;'format.type'&nbsp;=&nbsp;'csv',\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;'format.derive-schema'&nbsp;=&nbsp;'true'\n"</span>&nbsp;+<br  />&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">")"</span>);<br  />&nbsp;&nbsp;statement.executeUpdate(<span style="color: #98c379;line-height: 26px;">"INSERT&nbsp;INTO&nbsp;T&nbsp;VALUES&nbsp;(1,&nbsp;'Hi'),&nbsp;(2,&nbsp;'Hello')"</span>);<br  />&nbsp;&nbsp;ResultSet&nbsp;rs&nbsp;=&nbsp;statement.executeQuery(<span style="color: #98c379;line-height: 26px;">"SELECT&nbsp;*&nbsp;FROM&nbsp;T"</span>);<br  />&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">while</span>&nbsp;(rs.next())&nbsp;{<br  />&nbsp;&nbsp;&nbsp;System.out.println(rs.getInt(1)&nbsp;+&nbsp;<span style="color: #98c379;line-height: 26px;">",&nbsp;"</span>&nbsp;+&nbsp;rs.getString(2));<br  />&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;statement.close();<br  />&nbsp;&nbsp;connection.close();<br  />&nbsp;}<br  />}<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">传统的Flink SQL就是这么写。相当古老了。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>Shell脚本<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">启动sql gateway的shell较新版本：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;"><span style="color: #c678dd;line-height: 26px;">function</span>&nbsp;<span style="line-height: 26px;"><span style="color: #61aeee;line-height: 26px;">usage</span></span>()&nbsp;{<br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"Usage:&nbsp;sql-gateway.sh&nbsp;[start|start-foreground|stop|stop-all]&nbsp;[args]"</span><br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;commands:"</span><br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Run&nbsp;a&nbsp;SQL&nbsp;Gateway&nbsp;as&nbsp;a&nbsp;daemon"</span><br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;start-foreground&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Run&nbsp;a&nbsp;SQL&nbsp;Gateway&nbsp;as&nbsp;a&nbsp;console&nbsp;application"</span><br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;stop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Stop&nbsp;the&nbsp;SQL&nbsp;Gateway&nbsp;daemon"</span><br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;stop-all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Stop&nbsp;all&nbsp;the&nbsp;SQL&nbsp;Gateway&nbsp;daemons"</span><br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"&nbsp;&nbsp;&nbsp;&nbsp;-h&nbsp;|&nbsp;--help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Show&nbsp;this&nbsp;help&nbsp;message"</span><br  />}<br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">################################################################################</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Adopted&nbsp;from&nbsp;"flink"&nbsp;bash&nbsp;script</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">################################################################################</span><br  /><br  />target=<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$0</span>"</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;For&nbsp;the&nbsp;case,&nbsp;the&nbsp;executable&nbsp;has&nbsp;been&nbsp;directly&nbsp;symlinked,&nbsp;figure&nbsp;out</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;the&nbsp;correct&nbsp;bin&nbsp;path&nbsp;by&nbsp;following&nbsp;its&nbsp;symlink&nbsp;up&nbsp;to&nbsp;an&nbsp;upper&nbsp;bound.</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Note:&nbsp;we&nbsp;can't&nbsp;use&nbsp;the&nbsp;readlink&nbsp;utility&nbsp;here&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;be&nbsp;POSIX</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;compatible.</span><br  />iteration=0<br  /><span style="color: #c678dd;line-height: 26px;">while</span>&nbsp;[&nbsp;-L&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$target</span>"</span>&nbsp;];&nbsp;<span style="color: #c678dd;line-height: 26px;">do</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;[&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$iteration</span>"</span>&nbsp;-gt&nbsp;100&nbsp;];&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">echo</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"Cannot&nbsp;resolve&nbsp;path:&nbsp;You&nbsp;have&nbsp;a&nbsp;cyclic&nbsp;symlink&nbsp;in&nbsp;<span style="color: #d19a66;line-height: 26px;">$target</span>."</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">break</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">fi</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;ls=`ls&nbsp;-ld&nbsp;--&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$target</span>"</span>`<br  />&nbsp;&nbsp;&nbsp;&nbsp;target=`expr&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$ls</span>"</span>&nbsp;:&nbsp;<span style="color: #98c379;line-height: 26px;">'.*&nbsp;-&gt;&nbsp;\(.*\)$'</span>`<br  />&nbsp;&nbsp;&nbsp;&nbsp;iteration=$((iteration&nbsp;+&nbsp;1))<br  /><span style="color: #c678dd;line-height: 26px;">done</span><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;Convert&nbsp;relative&nbsp;path&nbsp;to&nbsp;absolute&nbsp;path</span><br  />bin=`dirname&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$target</span>"</span>`<br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;get&nbsp;flink&nbsp;config</span><br  />.&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$bin</span>"</span>/config.sh<br  /><br  /><span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;[&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$FLINK_IDENT_STRING</span>"</span>&nbsp;=&nbsp;<span style="color: #98c379;line-height: 26px;">""</span>&nbsp;];&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FLINK_IDENT_STRING=<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$USER</span>"</span><br  /><span style="color: #c678dd;line-height: 26px;">fi</span><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">################################################################################</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;SQL&nbsp;gateway&nbsp;specific&nbsp;logic</span><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">################################################################################</span><br  /><br  />ENTRYPOINT=sql-gateway<br  /><br  /><span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;[[&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$1</span>"</span>&nbsp;=&nbsp;*--<span style="color: #e6c07b;line-height: 26px;">help</span>&nbsp;]]&nbsp;||&nbsp;[[&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$1</span>"</span>&nbsp;=&nbsp;*-h&nbsp;]];&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span><br  />&nbsp;&nbsp;usage<br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">exit</span>&nbsp;0<br  /><span style="color: #c678dd;line-height: 26px;">fi</span><br  /><br  />STARTSTOP=<span style="color: #d19a66;line-height: 26px;">$1</span><br  /><br  /><span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;[&nbsp;-z&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>"</span>&nbsp;];&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span><br  />&nbsp;&nbsp;STARTSTOP=<span style="color: #98c379;line-height: 26px;">"start"</span><br  /><span style="color: #c678dd;line-height: 26px;">fi</span><br  /><br  /><span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;[[&nbsp;<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>&nbsp;!=&nbsp;<span style="color: #98c379;line-height: 26px;">"start"</span>&nbsp;]]&nbsp;&amp;&amp;&nbsp;[[&nbsp;<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>&nbsp;!=&nbsp;<span style="color: #98c379;line-height: 26px;">"start-foreground"</span>&nbsp;]]&nbsp;&amp;&amp;&nbsp;[[&nbsp;<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>&nbsp;!=&nbsp;<span style="color: #98c379;line-height: 26px;">"stop"</span>&nbsp;]]&nbsp;&amp;&amp;&nbsp;[[&nbsp;<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>&nbsp;!=&nbsp;<span style="color: #98c379;line-height: 26px;">"stop-all"</span>&nbsp;]];&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span><br  />&nbsp;&nbsp;usage<br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">exit</span>&nbsp;1<br  /><span style="color: #c678dd;line-height: 26px;">fi</span><br  /><br  /><span style="color: #5c6370;font-style: italic;line-height: 26px;">#&nbsp;./sql-gateway.sh&nbsp;start&nbsp;--help,&nbsp;print&nbsp;the&nbsp;message&nbsp;to&nbsp;the&nbsp;console</span><br  /><span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;[[&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>"</span>&nbsp;=&nbsp;start*&nbsp;]]&nbsp;&amp;&amp;&nbsp;(&nbsp;[[&nbsp;<span style="color: #98c379;line-height: 26px;">"$*"</span>&nbsp;=&nbsp;*--<span style="color: #e6c07b;line-height: 26px;">help</span>*&nbsp;]]&nbsp;||&nbsp;[[&nbsp;<span style="color: #98c379;line-height: 26px;">"$*"</span>&nbsp;=&nbsp;*-h*&nbsp;]]&nbsp;);&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span><br  />&nbsp;&nbsp;FLINK_TM_CLASSPATH=`constructFlinkClassPath`<br  />&nbsp;&nbsp;SQL_GATEWAY_CLASSPATH=`findSqlGatewayJar`<br  />&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">$JAVA_RUN</span>"</span>&nbsp;&nbsp;-classpath&nbsp;<span style="color: #98c379;line-height: 26px;">"`manglePathList&nbsp;"</span><span style="color: #d19a66;line-height: 26px;">$FLINK_TM_CLASSPATH</span>:<span style="color: #d19a66;line-height: 26px;">$SQL_GATEWAY_CLASSPATH</span>:<span style="color: #d19a66;line-height: 26px;">$INTERNAL_HADOOP_CLASSPATHS</span><span style="color: #98c379;line-height: 26px;">"`"</span>&nbsp;org.apache.flink.table.gateway.SqlGateway&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">${@:2}</span>"</span><br  />&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">exit</span>&nbsp;0<br  /><span style="color: #c678dd;line-height: 26px;">fi</span><br  /><br  /><span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;[[&nbsp;<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>&nbsp;==&nbsp;<span style="color: #98c379;line-height: 26px;">"start-foreground"</span>&nbsp;]];&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">exec</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">${FLINK_BIN_DIR}</span>"</span>/flink-console.sh&nbsp;<span style="color: #d19a66;line-height: 26px;">$ENTRYPOINT</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">${@:2}</span>"</span><br  /><span style="color: #c678dd;line-height: 26px;">else</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">${FLINK_BIN_DIR}</span>"</span>/flink-daemon.sh&nbsp;<span style="color: #d19a66;line-height: 26px;">$STARTSTOP</span>&nbsp;<span style="color: #d19a66;line-height: 26px;">$ENTRYPOINT</span>&nbsp;<span style="color: #98c379;line-height: 26px;">"<span style="color: #d19a66;line-height: 26px;">${@:2}</span>"</span><br  /><span style="color: #c678dd;line-height: 26px;">fi</span><br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">有空的时候，可以从这个脚本找到入口类【org.apache.flink.table.gateway.SqlGateway】继续钻研。</p><h5 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;"><span style="display: none;"></span>Java类<span style="display: none;"></span></h5><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">入口类就是这个：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegrW1dLg6t3Pff2t9EmEfkRiarTf4S1iaRkpuxEPiblHgCiaOAWYM6bibx9JuIpLNB0xEdbkWA0u0ngmh2/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">package&nbsp;org.apache.flink.table.gateway;<br  /><br  />import&nbsp;org.apache.flink.annotation.VisibleForTesting;<br  />import&nbsp;org.apache.flink.configuration.ConfigurationUtils;<br  />import&nbsp;org.apache.flink.runtime.util.EnvironmentInformation;<br  />import&nbsp;org.apache.flink.runtime.util.JvmShutdownSafeguard;<br  />import&nbsp;org.apache.flink.runtime.util.SignalHandler;<br  />import&nbsp;org.apache.flink.table.gateway.api.SqlGatewayService;<br  />import&nbsp;org.apache.flink.table.gateway.api.endpoint.SqlGatewayEndpoint;<br  />import&nbsp;org.apache.flink.table.gateway.api.endpoint.SqlGatewayEndpointFactoryUtils;<br  />import&nbsp;org.apache.flink.table.gateway.api.utils.SqlGatewayException;<br  />import&nbsp;org.apache.flink.table.gateway.cli.SqlGatewayOptions;<br  />import&nbsp;org.apache.flink.table.gateway.cli.SqlGatewayOptionsParser;<br  />import&nbsp;org.apache.flink.table.gateway.service.SqlGatewayServiceImpl;<br  />import&nbsp;org.apache.flink.table.gateway.service.context.DefaultContext;<br  />import&nbsp;org.apache.flink.table.gateway.service.session.SessionManager;<br  /><br  />import&nbsp;org.slf4j.Logger;<br  />import&nbsp;org.slf4j.LoggerFactory;<br  /><br  />import&nbsp;java.io.PrintStream;<br  />import&nbsp;java.util.ArrayList;<br  />import&nbsp;java.util.List;<br  />import&nbsp;java.util.Properties;<br  />import&nbsp;java.util.concurrent.CountDownLatch;<br  /><br  />/**&nbsp;Main&nbsp;entry&nbsp;point&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;the&nbsp;SQL&nbsp;Gateway.&nbsp;*/<br  />public&nbsp;class&nbsp;SqlGateway&nbsp;{<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;Logger&nbsp;LOG&nbsp;=&nbsp;LoggerFactory.getLogger(SqlGateway.class);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&lt;SqlGatewayEndpoint&gt;&nbsp;endpoints;<br  />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Properties&nbsp;dynamicConfig;<br  />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;CountDownLatch&nbsp;latch;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;SessionManager&nbsp;sessionManager;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;SqlGateway(Properties&nbsp;dynamicConfig)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.endpoints&nbsp;=&nbsp;new&nbsp;ArrayList&lt;&gt;();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.dynamicConfig&nbsp;=&nbsp;dynamicConfig;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.latch&nbsp;=&nbsp;new&nbsp;CountDownLatch(1);<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;start()&nbsp;throws&nbsp;Exception&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DefaultContext&nbsp;context&nbsp;=<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DefaultContext.load(ConfigurationUtils.createConfiguration(dynamicConfig));<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionManager&nbsp;=&nbsp;new&nbsp;SessionManager(context);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionManager.start();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlGatewayService&nbsp;sqlGatewayService&nbsp;=&nbsp;new&nbsp;SqlGatewayServiceImpl(sessionManager);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endpoints.addAll(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlGatewayEndpointFactoryUtils.createSqlGatewayEndpoint(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlGatewayService,&nbsp;context.getFlinkConfig()));<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;(SqlGatewayEndpoint&nbsp;endpoint&nbsp;:&nbsp;endpoints)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endpoint.start();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Throwable&nbsp;t)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOG.error(<span style="color: #98c379;line-height: 26px;">"Failed&nbsp;to&nbsp;start&nbsp;the&nbsp;endpoints."</span>,&nbsp;t);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;SqlGatewayException(<span style="color: #98c379;line-height: 26px;">"Failed&nbsp;to&nbsp;start&nbsp;the&nbsp;endpoints."</span>,&nbsp;t);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;<span style="line-height: 26px;"><span style="color: #61aeee;line-height: 26px;">stop</span></span>()&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;(SqlGatewayEndpoint&nbsp;endpoint&nbsp;:&nbsp;endpoints)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopEndpointSilently(endpoint);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;(sessionManager&nbsp;!=&nbsp;null)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionManager.stop();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latch.countDown();<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;waitUntilStop()&nbsp;throws&nbsp;Exception&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latch.await();<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;args)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startSqlGateway(System.out,&nbsp;args);<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;@VisibleForTesting<br  />&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;void&nbsp;startSqlGateway(PrintStream&nbsp;stream,&nbsp;String[]&nbsp;args)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlGatewayOptions&nbsp;cliOptions&nbsp;=&nbsp;SqlGatewayOptionsParser.parseSqlGatewayOptions(args);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;(cliOptions.isPrintHelp())&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlGatewayOptionsParser.printHelpSqlGateway(stream);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">return</span>;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;startup&nbsp;checks&nbsp;and&nbsp;logging<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnvironmentInformation.logEnvironmentInfo(LOG,&nbsp;<span style="color: #98c379;line-height: 26px;">"SqlGateway"</span>,&nbsp;args);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SignalHandler.register(LOG);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JvmShutdownSafeguard.installAsShutdownHook(LOG);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlGateway&nbsp;gateway&nbsp;=&nbsp;new&nbsp;SqlGateway(cliOptions.getDynamicConfigs());<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runtime.getRuntime().addShutdownHook(new&nbsp;ShutdownThread(gateway));<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gateway.start();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gateway.waitUntilStop();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Throwable&nbsp;t)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;User&nbsp;uses&nbsp;ctrl&nbsp;+&nbsp;c&nbsp;to&nbsp;cancel&nbsp;the&nbsp;Gateway&nbsp;manually<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;(t&nbsp;instanceof&nbsp;InterruptedException)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOG.info(<span style="color: #98c379;line-height: 26px;">"Caught&nbsp;"</span>&nbsp;+&nbsp;t.getClass().getSimpleName()&nbsp;+&nbsp;<span style="color: #98c379;line-height: 26px;">".&nbsp;Shutting&nbsp;down."</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e6c07b;line-height: 26px;">return</span>;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;make&nbsp;space&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;terminal<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stream.println();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stream.println();<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c678dd;line-height: 26px;">if</span>&nbsp;(t&nbsp;instanceof&nbsp;SqlGatewayException)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Exception&nbsp;that&nbsp;the&nbsp;gateway&nbsp;can&nbsp;not&nbsp;handle.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;(SqlGatewayException)&nbsp;t;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color: #c678dd;line-height: 26px;">else</span>&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOG.error(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"SqlGateway&nbsp;must&nbsp;stop.&nbsp;Unexpected&nbsp;exception.&nbsp;This&nbsp;is&nbsp;a&nbsp;bug.&nbsp;Please&nbsp;consider&nbsp;filing&nbsp;an&nbsp;issue."</span>,<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;SqlGatewayException(<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #98c379;line-height: 26px;">"Unexpected&nbsp;exception.&nbsp;This&nbsp;is&nbsp;a&nbsp;bug.&nbsp;Please&nbsp;consider&nbsp;filing&nbsp;an&nbsp;issue."</span>,&nbsp;t);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gateway.stop();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;stopEndpointSilently(SqlGatewayEndpoint&nbsp;endpoint)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endpoint.stop();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Exception&nbsp;e)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOG.error(<span style="color: #98c379;line-height: 26px;">"Failed&nbsp;to&nbsp;stop&nbsp;the&nbsp;endpoint.&nbsp;Ignore."</span>,&nbsp;e);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;--------------------------------------------------------------------------------------------<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;class&nbsp;ShutdownThread&nbsp;extends&nbsp;Thread&nbsp;{<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;SqlGateway&nbsp;gateway;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ShutdownThread(SqlGateway&nbsp;gateway)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.gateway&nbsp;=&nbsp;gateway;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;<span style="line-height: 26px;"><span style="color: #61aeee;line-height: 26px;">run</span></span>()&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Shutdown&nbsp;the&nbsp;gateway<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span style="color: #98c379;line-height: 26px;">"\nShutting&nbsp;down&nbsp;the&nbsp;Flink&nbsp;SqlGateway..."</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOG.info(<span style="color: #98c379;line-height: 26px;">"Shutting&nbsp;down&nbsp;the&nbsp;Flink&nbsp;SqlGateway..."</span>);<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gateway.stop();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Exception&nbsp;e)&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOG.error(<span style="color: #98c379;line-height: 26px;">"Failed&nbsp;to&nbsp;shut&nbsp;down&nbsp;the&nbsp;Flink&nbsp;SqlGateway:&nbsp;"</span>&nbsp;+&nbsp;e.getMessage(),&nbsp;e);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span style="color: #98c379;line-height: 26px;">"Failed&nbsp;to&nbsp;shut&nbsp;down&nbsp;the&nbsp;Flink&nbsp;SqlGateway:&nbsp;"</span>&nbsp;+&nbsp;e.getMessage());<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOG.info(<span style="color: #98c379;line-height: 26px;">"Flink&nbsp;SqlGateway&nbsp;has&nbsp;been&nbsp;shutdown."</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span style="color: #98c379;line-height: 26px;">"Flink&nbsp;SqlGateway&nbsp;has&nbsp;been&nbsp;shutdown."</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  />}<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">等有空的时候再研究。</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>总结<span style="display: none;"></span></h3><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">从Flink1.16.0开始，就可以使用Hive On Flink了，SQL Boy们可以依旧只关心所谓的逻辑，只写几个Join。平台和组件二开人员可以尝试下Sql Gateway的方式了，简化Spark的Thrift Server和Hive的Hive Server2，架构简单化以后，组件运维起来应该要容易一些。暂时不清楚Hive On Flink和Spark SQL在性能上的区别，还停留在Flink1.13老版本不敢吃螃蟹的公司也可以先吃瓜，看看大白鼠们直接上生产环境的稳定性来判断这个特性是否GA。</p><blockquote data-tool="mdnice编辑器" style="border-top: none;border-right: none;border-bottom: none;font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;border-left-color: rgb(239, 112, 96);background: rgb(255, 249, 249);"><p style="font-size: 16px;padding-top: 8px;padding-bottom: 8px;color: black;line-height: 26px;">转载出处：https://lizhiyong.blog.csdn.net/article/details/128195438</p></blockquote></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;line-height: 1.6;letter-spacing: 0.034em;color: rgb(63, 63, 63);font-size: 16px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">如果这个文章对你有帮助，不要忘记&nbsp;</span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;outline: 0px;font-size: 15px;color: rgb(255, 104, 39);"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「在看」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「点赞」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「收藏」</strong></span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">&nbsp;三连啊喂！</span><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><p style="margin: 0px 0px 0em;padding: 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: center;"><img class="rich_pages wxw-img" data-ratio="1.6527777777777777" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/19_Zfh1Rf8hPd3euzJlYyfJq4081VB6Rg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PuHq9qaJwJpGeRJBMqMloibzfcYl12AoR2v9kgqyZz4CYuKZfh1Rf8hPd3euzJlYyfJq4081VB6Rg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" data-w="576" style="margin: 0px;padding: 0px;max-width: 100%;height: 380px;overflow-wrap: break-word !important;vertical-align: bottom;width: 230px;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;background-color: rgb(255, 255, 255);color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;"></span></p></section></section><section style="margin: 0px;padding: 0px;max-width: 100%;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="图片/大数据技术与架构_2023-01-03_Flink116 SQL Gateway 迁移Hive SQL任务实战/20_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="margin: 0px;padding: 0px;max-width: 100%;height: 42px;overflow-wrap: break-word !important;vertical-align: bottom;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;"></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">互联网最坏的时代可能真的来了</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">我在B站读大学，大数据专业</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Flink的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">193篇文章暴揍Flink，这个合集你需要关注一下</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Spark的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">在所有Spark模块中，我愿称SparkSQL为最强！</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">硬刚Hive | 4万字基础调优面试小总结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">数据治理方法论和实践小百科全书</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">标签体系下的用户画像建设小指南</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解析</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我写过的关于成长/面试/职场进阶的文章</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>