<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"Flink任务提交问题汇总","time":"2023-02-24 11:45:12","timeStamp":"1677210312"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247517178&idx=1&sn=46732d23b9570b81612740c4e7d34886&chksm=fd3ec56fca494c791c82d3be8178f88d317ca34503bc11bfb7c98dcf34c186e0cbd874951a83#rd" target="_blank">Flink任务提交问题汇总</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2023-02-24 11:45:12</em></div><content><div class="topic"><p>收录于话题</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzU3MzgwNTU2Mg==&action=getalbum&album_id=1369031183400747008#wechat_redirect" title="大数据成神之路" target="_blank">#大数据成神之路</a></p></div><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;outline: 0px;color: rgb(34, 34, 34);font-size: 14.875px;text-size-adjust: auto;letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 23.625px;visibility: visible;" data-mpa-powered-by="yiban.io"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-role="outer" label="Powered by 135editor.com" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tools="135编辑器" data-id="98469" mp-original-font-size="17" mp-original-line-height="27" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 23.625px;visibility: visible;font-size: 14.875px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 21.875px;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><blockquote data-tool="mdnice编辑器" mp-original-font-size="14.399999618530273" mp-original-line-height="23" style="margin: 20px 0px;padding: 10px 10px 10px 20px;border-left: 3px solid rgb(239, 112, 96);color: rgb(106, 115, 125);line-height: 20.125px;font-size: 12.6px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;border-top-style: none;border-right-style: none;border-bottom-style: none;overflow: auto;background-color: rgb(255, 249, 249);visibility: visible;"><p mp-original-font-size="16" mp-original-line-height="26" style="margin: 0px;padding: 8px 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-size: 14px;color: black;line-height: 22.75px;visibility: visible;"><span mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: normal;orphans: 2;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;color: rgb(89, 89, 89);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;letter-spacing: 0.544px;text-align: left;font-size: 12.25px;visibility: visible;line-height: 22.75px;"><strong mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;visibility: visible;font-size: 12.25px;line-height: 22.75px;"><img class="rich_pages wxw-img" data-ratio="1" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/1_6VyhjNCMic3DGmPLZocTtEmtWBJKsQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2OP8CL6Mmrc9shxR4OiamrPMlRCKiaicf2n4JLNDRcyH1jfEKxo6VyhjNCMic3DGmPLZocTtEmtWBJKsQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" data-type="png" data-w="20" style="margin: 0px;padding: 0px;max-width: 100%;height: auto !important;overflow-wrap: break-word !important;vertical-align: text-bottom;outline: 0px;display: inline-block;font-size: 10.7188px;line-height: 19.9062px;box-sizing: border-box !important;visibility: visible !important;width: 20px !important;"  /><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247514568&amp;idx=1&amp;sn=659d7464a3b61ebf8397d2597069f4ab&amp;chksm=fd3eff5dca49764beef9ab14400e96715b86b3394f05e161181c03424fa579cdbc242a401411&amp;scene=21#wechat_redirect" textvalue="全网最全大数据面试提升手册！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" mp-original-font-size="14" mp-original-line-height="26" style="margin: 0px;padding: 0px;color: rgb(255, 41, 65);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: left;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;background-color: rgb(255, 249, 249);font-size: 14px;"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-size: 14px;color: rgb(255, 41, 65);">全网最全大数据面试提升手册！</span></strong></a></strong></span></p></blockquote></section></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px;color: black;padding-right: 10px;padding-left: 10px;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;"><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>flink 任务提交问题汇总<span style="display: none;"></span></h3><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">1. 提交flink自带任务WordCount.jar遇到的问题：</section><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">2. 提交flink 批处理任务时遇到的问题</section><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">3. flink定时任务，mysql连接超时问题</section><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">4. flink checkpoint 恢复失败</section><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">5. yarn 增加并行任务数量配置</section><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">6. 流处理flink程序在hadoop集群跑了一段时间莫名挂掉</section><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>1. 提交flink自带任务WordCount.jar遇到的问题：<span style="display: none;"></span></h3><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>问题描述：</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">最近在提交flink项目example下WordCount.jar批处理任务时遇到以下问题：</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">The main method caused an error: org.apache.flink.runtime.concurrent.FutureUtils$RetryException: Could not complete the operation. Number of retries has been exhausted.</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">之后就是拒绝连接等异常详细内容如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.511655708308428" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/2_9zlS01XkSWGRDmibUG7pLoEBVFUaRA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHyawPB4Zd9fNCk9Jqia8icec334E9zlS01XkSWGRDmibUG7pLoEBVFUaRA/640?wx_fmt=png'" data-type="png" data-w="1673" style="display: block;margin-right: auto;margin-left: auto;"></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">yarn 资源管理器，flink页面这样显示：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.48802083333333335" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/3_FuKzXlTtLYhRnicjfLibgoCX8CBZwQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHMkjdPYGTqEmTQkicAvY5N75wP9VFuKzXlTtLYhRnicjfLibgoCX8CBZwQ/640?wx_fmt=png'" data-type="png" data-w="1920" style="display: block;margin-right: auto;margin-left: auto;"></figure><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>原因分析：</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">之后我重启了zk，hadoop，重新提交flink任务，但还是不行</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">之后看到flink页面的内容.Service temporarily unavailable due to an ongoing leader election. Please refresh，让我想到之前提交任务也遇到过这种情况。于是考虑了 以下两个问题：</p><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">1. 在yarn提交批处理任务的时候都是同一个任务，会不会产生冲突</p><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">2. 结果输出会不会冲突</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">在yarn提交任务是不可能冲突的，任务之间是独立的，所以排除了第一种情况，然后就是输出问题，我提交任务的时候都是在同一个文件输出，这时候问题就来了如果结果都输出到同一个文件那不就乱了，flink好像也预知了这样的问题，因此报了上面的错误</p><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>解决方案：</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">更改批处理的输出路径</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">如果你第一次是这样提交:</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">bin/flink&nbsp;run&nbsp;-m&nbsp;yarn-cluster&nbsp;-yjm&nbsp;1024&nbsp;-ytm&nbsp;1024&nbsp;./examples/batch/WordCount.jar&nbsp;-input&nbsp;hdfs://hadoop01:9000/<span style="color: #e6c07b;line-height: 26px;">test</span>/word&nbsp;-output&nbsp;hdfs://hadoop01:9000/<span style="color: #e6c07b;line-height: 26px;">test</span>/result1<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">第二次就这样提交：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">bin/flink&nbsp;run&nbsp;-m&nbsp;yarn-cluster&nbsp;-yjm&nbsp;1024&nbsp;-ytm&nbsp;1024&nbsp;./examples/batch/WordCount.jar&nbsp;-input&nbsp;hdfs://hadoop01:9000/<span style="color: #e6c07b;line-height: 26px;">test</span>/word&nbsp;-output&nbsp;hdfs://hadoop01:9000/<span style="color: #e6c07b;line-height: 26px;">test</span>/result2<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>2. 提交flink 批处理任务时遇到的问题<span style="display: none;"></span></h3><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>问题描述</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">最近写了一个flink批处理程序， 目的是读取hdfs文件，将文件数据写入到hbase</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">项目是在idea中开发的 pom 文件如下：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">&lt;?xml&nbsp;version=<span style="color: #98c379;line-height: 26px;">"1.0"</span>&nbsp;encoding=<span style="color: #98c379;line-height: 26px;">"UTF-8"</span>?&gt;<br  />&lt;project&nbsp;xmlns=<span style="color: #98c379;line-height: 26px;">"http://maven.apache.org/POM/4.0.0"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlns:xsi=<span style="color: #98c379;line-height: 26px;">"http://www.w3.org/2001/XMLSchema-instance"</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xsi:schemaLocation=<span style="color: #98c379;line-height: 26px;">"http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.example&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hdfs-flink&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;properties&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;flink.version&gt;1.11.2&lt;/flink.version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;scala.binary.version&gt;2.12&lt;/scala.binary.version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/properties&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependencies&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.slf4j&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;2.0.0-alpha1&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;3.1.4&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;flink-hadoop-compatibility_2.11&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;1.11.2&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;flink-java&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;<span style="color: #d19a66;line-height: 26px;">${flink.version}</span>&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;flink-streaming-java_<span style="color: #d19a66;line-height: 26px;">${scala.binary.version}</span>&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;<span style="color: #d19a66;line-height: 26px;">${flink.version}</span>&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.flink&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;flink-clients_<span style="color: #d19a66;line-height: 26px;">${scala.binary.version}</span>&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;<span style="color: #d19a66;line-height: 26px;">${flink.version}</span>&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;lombok&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;1.18.18&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;mysql&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;8.0.17&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hbase-client&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;2.2.6&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependencies&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;build&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;plugins&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;plugin&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;3.6.0&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;configuration&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<span style="color: #e6c07b;line-height: 26px;">source</span>&gt;1.8&lt;/<span style="color: #e6c07b;line-height: 26px;">source</span>&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;target&gt;1.8&lt;/target&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/configuration&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plugin&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;&nbsp;指定模块打包--&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;plugin&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;3.1.1&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;configuration&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactSet&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;excludes&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclude&gt;com.google.code.findbugs:jsr305&lt;/exclude&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclude&gt;org.slf4j:*&lt;/exclude&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclude&gt;log4j:*&lt;/exclude&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/excludes&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/artifactSet&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filters&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifact&gt;*:*&lt;/artifact&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;excludes&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--需要加入编译信息过滤，不然不知名错误--&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/excludes&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/filter&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/filters&gt;<br  /><br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transformers&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transformer&nbsp;implementation=<span style="color: #98c379;line-height: 26px;">"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"</span>&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mainClass&gt;xxx.Format&lt;/mainClass&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/transformer&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/transformers&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/configuration&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;executions&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;execution&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;phase&gt;package&lt;/phase&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;goals&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;goal&gt;shade&lt;/goal&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/goals&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/execution&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/executions&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plugin&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plugins&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/build&gt;<br  />&lt;/project&gt;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">将代码写完之后发现在idea中运行是没有问题，但是将项目打包后上传到集群，使用Job方式提交任务的时候报错，控制台的详细信息如下：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">SLF4J:&nbsp;Class&nbsp;path&nbsp;contains&nbsp;multiple&nbsp;SLF4J&nbsp;bindings.<br  />SLF4J:&nbsp;Found&nbsp;binding&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;[jar:file:/usr/lib/flink/flink-1.11.2/lib/log4j-slf4j-impl-2.12.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]<br  />SLF4J:&nbsp;Found&nbsp;binding&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;[jar:file:/usr/lib/hadoop/hadoop-3.1.4/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]<br  />SLF4J:&nbsp;See&nbsp;http://www.slf4j.org/codes.html<span style="color: #5c6370;font-style: italic;line-height: 26px;">#multiple_bindings&nbsp;for&nbsp;an&nbsp;explanation.</span><br  />SLF4J:&nbsp;Actual&nbsp;binding&nbsp;is&nbsp;of&nbsp;<span style="color: #e6c07b;line-height: 26px;">type</span>&nbsp;[org.apache.logging.slf4j.Log4jLoggerFactory]<br  />2021-02-24&nbsp;13:52:11,153&nbsp;WARN&nbsp;&nbsp;org.apache.flink.yarn.configuration.YarnLogConfigUtil&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;The&nbsp;configuration&nbsp;directory&nbsp;(<span style="color: #98c379;line-height: 26px;">'/usr/lib/flink/flink-1.11.2/conf'</span>)&nbsp;already&nbsp;contains&nbsp;a&nbsp;LOG4J&nbsp;config&nbsp;file.If&nbsp;you&nbsp;want&nbsp;to&nbsp;use&nbsp;logback,&nbsp;<span style="color: #c678dd;line-height: 26px;">then</span>&nbsp;please&nbsp;delete&nbsp;or&nbsp;rename&nbsp;the&nbsp;<span style="color: #e6c07b;line-height: 26px;">log</span>&nbsp;configuration&nbsp;file.<br  />2021-02-24&nbsp;13:52:11,179&nbsp;INFO&nbsp;&nbsp;org.apache.hadoop.yarn.client.RMProxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Connecting&nbsp;to&nbsp;ResourceManager&nbsp;at&nbsp;hadoop01/192.168.1.82:8032<br  />2021-02-24&nbsp;13:52:11,306&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;No&nbsp;path&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;the&nbsp;flink&nbsp;jar&nbsp;passed.&nbsp;Using&nbsp;the&nbsp;location&nbsp;of&nbsp;class&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;to&nbsp;locate&nbsp;the&nbsp;jar<br  />2021-02-24&nbsp;13:52:11,372&nbsp;INFO&nbsp;&nbsp;org.apache.hadoop.conf.Configuration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;resource-types.xml&nbsp;not&nbsp;found<br  />2021-02-24&nbsp;13:52:11,372&nbsp;INFO&nbsp;&nbsp;org.apache.hadoop.yarn.util.resource.ResourceUtils&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Unable&nbsp;to&nbsp;find&nbsp;<span style="color: #98c379;line-height: 26px;">'resource-types.xml'</span>.<br  />2021-02-24&nbsp;13:52:11,410&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Cluster&nbsp;specification:&nbsp;ClusterSpecification{masterMemoryMB=1024,&nbsp;taskManagerMemoryMB=1024,&nbsp;slotsPerTaskManager=1}<br  />2021-02-24&nbsp;13:52:14,619&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Submitting&nbsp;application&nbsp;master&nbsp;application_1614083574571_0023<br  />2021-02-24&nbsp;13:52:14,653&nbsp;INFO&nbsp;&nbsp;org.apache.hadoop.yarn.client.api.impl.YarnClientImpl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Submitted&nbsp;application&nbsp;application_1614083574571_0023<br  />2021-02-24&nbsp;13:52:14,653&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Waiting&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;the&nbsp;cluster&nbsp;to&nbsp;be&nbsp;allocated<br  />2021-02-24&nbsp;13:52:14,654&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Deploying&nbsp;cluster,&nbsp;current&nbsp;state&nbsp;ACCEPTED<br  />org.apache.flink.client.deployment.ClusterDeploymentException:&nbsp;Could&nbsp;not&nbsp;deploy&nbsp;Yarn&nbsp;job&nbsp;cluster.<br  />&nbsp;at&nbsp;org.apache.flink.yarn.YarnClusterDescriptor.deployJobCluster(YarnClusterDescriptor.java:431)<br  />&nbsp;at&nbsp;org.apache.flink.client.deployment.executors.AbstractJobClusterExecutor.execute(AbstractJobClusterExecutor.java:70)<br  />&nbsp;at&nbsp;org.apache.flink.api.java.ExecutionEnvironment.executeAsync(ExecutionEnvironment.java:973)<br  />&nbsp;at&nbsp;org.apache.flink.client.program.ContextEnvironment.executeAsync(ContextEnvironment.java:124)<br  />&nbsp;at&nbsp;org.apache.flink.client.program.ContextEnvironment.execute(ContextEnvironment.java:72)<br  />&nbsp;at&nbsp;com.spaceon.hys.argos.set.Format.main(Format.java:66)<br  />&nbsp;at&nbsp;sun.reflect.NativeMethodAccessorImpl.invoke0(Native&nbsp;Method)<br  />&nbsp;at&nbsp;sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br  />&nbsp;at&nbsp;sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br  />&nbsp;at&nbsp;java.lang.reflect.Method.invoke(Method.java:497)<br  />&nbsp;at&nbsp;org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:288)<br  />&nbsp;at&nbsp;org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:198)<br  />&nbsp;at&nbsp;org.apache.flink.client.ClientUtils.executeProgram(ClientUtils.java:149)<br  />&nbsp;at&nbsp;org.apache.flink.client.cli.CliFrontend.executeProgram(CliFrontend.java:699)<br  />&nbsp;at&nbsp;org.apache.flink.client.cli.CliFrontend.run(CliFrontend.java:232)<br  />&nbsp;at&nbsp;org.apache.flink.client.cli.CliFrontend.parseParameters(CliFrontend.java:916)<br  />&nbsp;at&nbsp;org.apache.flink.client.cli.CliFrontend.lambda<span style="color: #d19a66;line-height: 26px;">$main</span><span style="color: #d19a66;line-height: 26px;">$10</span>(CliFrontend.java:992)<br  />&nbsp;at&nbsp;java.security.AccessController.doPrivileged(Native&nbsp;Method)<br  />&nbsp;at&nbsp;javax.security.auth.Subject.doAs(Subject.java:422)<br  />&nbsp;at&nbsp;org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1729)<br  />&nbsp;at&nbsp;org.apache.flink.runtime.security.contexts.HadoopSecurityContext.runSecured(HadoopSecurityContext.java:41)<br  />&nbsp;at&nbsp;org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:992)<br  />Caused&nbsp;by:&nbsp;org.apache.flink.yarn.YarnClusterDescriptor<span style="color: #d19a66;line-height: 26px;">$YarnDeploymentException</span>:&nbsp;The&nbsp;YARN&nbsp;application&nbsp;unexpectedly&nbsp;switched&nbsp;to&nbsp;state&nbsp;FAILED&nbsp;during&nbsp;deployment.&nbsp;<br  />Diagnostics&nbsp;from&nbsp;YARN:&nbsp;Application&nbsp;application_1614083574571_0023&nbsp;failed&nbsp;4&nbsp;<span style="color: #e6c07b;line-height: 26px;">times</span>&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;previous&nbsp;10000&nbsp;milliseconds&nbsp;due&nbsp;to&nbsp;AM&nbsp;Container&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;appattempt_1614083574571_0023_000004&nbsp;exited&nbsp;with&nbsp;&nbsp;exitCode:&nbsp;1<br  />Failing&nbsp;this&nbsp;attempt.Diagnostics:&nbsp;[2021-02-24&nbsp;13:52:25.722]Exception&nbsp;from&nbsp;container-launch.<br  />Container&nbsp;id:&nbsp;container_1614083574571_0023_04_000001<br  />Exit&nbsp;code:&nbsp;1<br  /><br  />[2021-02-24&nbsp;13:52:25.723]Container&nbsp;exited&nbsp;with&nbsp;a&nbsp;non-zero&nbsp;<span style="color: #e6c07b;line-height: 26px;">exit</span>&nbsp;code&nbsp;1.&nbsp;Error&nbsp;file:&nbsp;prelaunch.err.<br  />Last&nbsp;4096&nbsp;bytes&nbsp;of&nbsp;prelaunch.err&nbsp;:<br  /><br  />[2021-02-24&nbsp;13:52:25.724]Container&nbsp;exited&nbsp;with&nbsp;a&nbsp;non-zero&nbsp;<span style="color: #e6c07b;line-height: 26px;">exit</span>&nbsp;code&nbsp;1.&nbsp;Error&nbsp;file:&nbsp;prelaunch.err.<br  />Last&nbsp;4096&nbsp;bytes&nbsp;of&nbsp;prelaunch.err&nbsp;:<br  /><br  />For&nbsp;more&nbsp;detailed&nbsp;output,&nbsp;check&nbsp;the&nbsp;application&nbsp;tracking&nbsp;page:&nbsp;http://hadoop01:8088/cluster/app/application_1614083574571_0023&nbsp;Then&nbsp;click&nbsp;on&nbsp;links&nbsp;to&nbsp;logs&nbsp;of&nbsp;each&nbsp;attempt.<br  />.&nbsp;Failing&nbsp;the&nbsp;application.<br  />If&nbsp;<span style="color: #e6c07b;line-height: 26px;">log</span>&nbsp;aggregation&nbsp;is&nbsp;enabled&nbsp;on&nbsp;your&nbsp;cluster,&nbsp;use&nbsp;this&nbsp;<span style="color: #e6c07b;line-height: 26px;">command</span>&nbsp;to&nbsp;further&nbsp;investigate&nbsp;the&nbsp;issue:<br  />yarn&nbsp;logs&nbsp;-applicationId&nbsp;application_1614083574571_0023<br  />&nbsp;at&nbsp;org.apache.flink.yarn.YarnClusterDescriptor.startAppMaster(YarnClusterDescriptor.java:1021)<br  />&nbsp;at&nbsp;org.apache.flink.yarn.YarnClusterDescriptor.deployInternal(YarnClusterDescriptor.java:524)<br  />&nbsp;at&nbsp;org.apache.flink.yarn.YarnClusterDescriptor.deployJobCluster(YarnClusterDescriptor.java:424)<br  />&nbsp;...&nbsp;21&nbsp;more<br  />2021-02-24&nbsp;13:52:26,086&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Cancelling&nbsp;deployment&nbsp;from&nbsp;Deployment&nbsp;Failure&nbsp;Hook<br  />2021-02-24&nbsp;13:52:26,087&nbsp;INFO&nbsp;&nbsp;org.apache.hadoop.yarn.client.RMProxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Connecting&nbsp;to&nbsp;ResourceManager&nbsp;at&nbsp;hadoop01/192.168.1.82:8032<br  />2021-02-24&nbsp;13:52:26,088&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Killing&nbsp;YARN&nbsp;application<br  />2021-02-24&nbsp;13:52:26,097&nbsp;INFO&nbsp;&nbsp;org.apache.hadoop.yarn.client.api.impl.YarnClientImpl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Killed&nbsp;application&nbsp;application_1614083574571_0023<br  />2021-02-24&nbsp;13:52:26,097&nbsp;INFO&nbsp;&nbsp;org.apache.flink.yarn.YarnClusterDescriptor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&nbsp;Deleting&nbsp;files&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;hdfs://hadoop01:9000/user/root/.flink/application_1614083574571_0023.<br  /><br  /></code></pre><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>原因分析：</strong></section><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">1. 从控制台的日志好像发现不了什么关键的问题，只是报了一个 Container 加载失败，然后让你去yarn的首页去查看日志，之后我也查看了相关日志信息，但都没有发现什么有价值的信息。</p><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">2. 于是考虑是不是自己jar包的问题，之后使用各种打包的方式都没能解决问题。</p><p style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">3. 最后就只能逐个排除出问题的jar包，最后发现去掉 hbase-client 的包后程序正常执行，经过查看hbase-client 的依赖发现 hbase-client 包里使用的hadoop相关的依赖都是2.8.x，但是我的hadoop集群是3.1.4 版本。于是判断可能是hadoop版本冲突了。</p><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>解决方案：</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">去除hbase-client的包里 hadoop 相关依赖，其中有些包在 hadoop-client 中是包含的，但是不能覆盖hbase-client里的，通过 maven-shade-plugin打包也是不能解决的</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">具体操作在 pom 文件修改hbase-client 依赖：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hbase-server&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;2.4.1&lt;/version&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclusions&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hadoop-annotations&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hadoop-auth&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hadoop-mapreduce-client-core&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/exclusion&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/exclusions&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;<br  /><br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>3. flink定时任务，mysql连接超时问题<span style="display: none;"></span></h3><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>问题描述</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">前一天将flink任务提交到集群，第二天在web界面发现如下异常：</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">2021-07-01&nbsp;09:11:40<br  />com.mysql.cj.jdbc.exceptions.CommunicationsException:&nbsp;The&nbsp;last&nbsp;packet&nbsp;successfully&nbsp;received&nbsp;from&nbsp;the&nbsp;server&nbsp;was&nbsp;63,745,201&nbsp;milliseconds&nbsp;ago.&nbsp;&nbsp;The&nbsp;last&nbsp;packet&nbsp;sent&nbsp;successfully&nbsp;to&nbsp;the&nbsp;server&nbsp;was&nbsp;63,745,201&nbsp;milliseconds&nbsp;ago.&nbsp;is&nbsp;longer&nbsp;than&nbsp;the&nbsp;server&nbsp;configured&nbsp;value&nbsp;of&nbsp;<span style="color: #98c379;line-height: 26px;">'wait_timeout'</span>.&nbsp;You&nbsp;should&nbsp;consider&nbsp;either&nbsp;expiring&nbsp;and/or&nbsp;testing&nbsp;connection&nbsp;validity&nbsp;before&nbsp;use&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;your&nbsp;application,&nbsp;increasing&nbsp;the&nbsp;server&nbsp;configured&nbsp;values&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;client&nbsp;timeouts,&nbsp;or&nbsp;using&nbsp;the&nbsp;Connector/J&nbsp;connection&nbsp;property&nbsp;<span style="color: #98c379;line-height: 26px;">'autoReconnect=true'</span>&nbsp;to&nbsp;avoid&nbsp;this&nbsp;problem.<br  />&nbsp;at&nbsp;com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)<br  />&nbsp;at&nbsp;com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)<br  />&nbsp;at&nbsp;com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1412)<br  />&nbsp;at&nbsp;com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1390)<br  />&nbsp;at&nbsp;com.mysql.cj.jdbc.ClientPreparedStatement.executeBatchInternal(ClientPreparedStatement.java:403)<br  />&nbsp;at&nbsp;com.mysql.cj.jdbc.StatementImpl.executeBatch(StatementImpl.java:796)<br  />&nbsp;at&nbsp;com.spaceon.hys.quality.function.sink.SinkQualityResult.invoke(SinkQualityResult.java:74)<br  />&nbsp;at&nbsp;com.spaceon.hys.quality.function.sink.SinkQualityResult.invoke(SinkQualityResult.java:22)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.api.operators.StreamSink.processElement(StreamSink.java:56)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.OneInputStreamTask<span style="color: #d19a66;line-height: 26px;">$StreamTaskNetworkOutput</span>.emitRecord(OneInputStreamTask.java:161)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.io.StreamTaskNetworkInput.processElement(StreamTaskNetworkInput.java:178)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.io.StreamTaskNetworkInput.emitNext(StreamTaskNetworkInput.java:153)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:67)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:351)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxStep(MailboxProcessor.java:191)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:181)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:566)<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:536)<br  />&nbsp;at&nbsp;org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:721)<br  />&nbsp;at&nbsp;org.apache.flink.runtime.taskmanager.Task.run(Task.java:546)<br  />&nbsp;at&nbsp;java.lang.Thread.run(Thread.java:745)<br  />Caused&nbsp;by:&nbsp;com.mysql.cj.exceptions.CJCommunicationsException:&nbsp;The&nbsp;last&nbsp;packet&nbsp;successfully&nbsp;received&nbsp;from&nbsp;the&nbsp;server&nbsp;was&nbsp;63,745,201&nbsp;milliseconds&nbsp;ago.&nbsp;&nbsp;The&nbsp;last&nbsp;packet&nbsp;sent&nbsp;successfully&nbsp;to&nbsp;the&nbsp;server&nbsp;was&nbsp;63,745,201&nbsp;milliseconds&nbsp;ago.&nbsp;is&nbsp;longer&nbsp;than&nbsp;the&nbsp;server&nbsp;configured&nbsp;value&nbsp;of&nbsp;<span style="color: #98c379;line-height: 26px;">'wait_timeout'</span>.&nbsp;You&nbsp;should&nbsp;consider&nbsp;either&nbsp;expiring&nbsp;and/or&nbsp;testing&nbsp;connection&nbsp;validity&nbsp;before&nbsp;use&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;your&nbsp;application,&nbsp;increasing&nbsp;the&nbsp;server&nbsp;configured&nbsp;values&nbsp;<span style="color: #c678dd;line-height: 26px;">for</span>&nbsp;client&nbsp;timeouts,&nbsp;or&nbsp;using&nbsp;the&nbsp;Connector/J&nbsp;connection&nbsp;property&nbsp;<span style="color: #98c379;line-height: 26px;">'autoReconnect=true'</span>&nbsp;to&nbsp;avoid&nbsp;this&nbsp;problem.<br  />&nbsp;at&nbsp;sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native&nbsp;Method)<br  />&nbsp;at&nbsp;sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)<br  />&nbsp;at&nbsp;sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)<br  />&nbsp;at&nbsp;java.lang.reflect.Constructor.newInstance(Constructor.java:422)<br  />&nbsp;at&nbsp;com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)<br  />&nbsp;at&nbsp;com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)<br  />&nbsp;at&nbsp;com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)<br  />&nbsp;at&nbsp;com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)<br  />&nbsp;at&nbsp;com.mysql.cj.protocol.a.NativeProtocol.send(NativeProtocol.java:572)<br  />&nbsp;at&nbsp;com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:633)<br  />&nbsp;at&nbsp;com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:130)<br  />&nbsp;at&nbsp;com.mysql.cj.NativeSession.sendCommand(NativeSession.java:317)<br  />&nbsp;at&nbsp;com.mysql.cj.NativeSession.queryServerVariable(NativeSession.java:1046)<br  />&nbsp;at&nbsp;com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1398)<br  />&nbsp;...&nbsp;18&nbsp;more<br  />Caused&nbsp;by:&nbsp;java.net.SocketException:&nbsp;Broken&nbsp;pipe<br  />&nbsp;at&nbsp;java.net.SocketOutputStream.socketWrite0(Native&nbsp;Method)<br  />&nbsp;at&nbsp;java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)<br  />&nbsp;at&nbsp;java.net.SocketOutputStream.write(SocketOutputStream.java:153)<br  />&nbsp;at&nbsp;java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)<br  />&nbsp;at&nbsp;java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)<br  />&nbsp;at&nbsp;com.mysql.cj.protocol.a.SimplePacketSender.send(SimplePacketSender.java:55)<br  />&nbsp;at&nbsp;com.mysql.cj.protocol.a.TimeTrackingPacketSender.send(TimeTrackingPacketSender.java:50)<br  />&nbsp;at&nbsp;com.mysql.cj.protocol.a.NativeProtocol.send(NativeProtocol.java:563)<br  />&nbsp;...&nbsp;23&nbsp;more<br  /></code></pre><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>原因分析</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">因为在flink任务里有一个按天统计功能，通过flink的定时器完成每天输出一个统计结果，但是在初始化mysql连接的后，也就是启动flink任务后，过24小时才会有该链接的更新操作，但mysql默认的连接等待时长为8小时，在建立连接后过8小时候没有进行任何查询操作，mysql将自动关闭连接，这才导致mysql连接失效</p><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>解决方案</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">网上的解决方案大致两种</p><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">1. 更新mysql的配置，重新设置连接的等待时间</section><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.9575070821529745" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/4_ia4H0eukZZ8O5ad4RdHbPR3icMFiaA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHlBOO0JNzCKUJv8RE7O2ZM6fyVxFia4H0eukZZ8O5ad4RdHbPR3icMFiaA/640?wx_fmt=png'" data-type="png" data-w="353" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);">2. 连接加&amp;autoReconnect=true属性（mysql5.x无效，亲测）</section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">我是通过代码层来重新建立连接的</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">因为不想再去动mysql的默认配置，直接catch CommunicationsException ，若抛此异常表示连接断开了，然后重新建立连接</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execUpdate(value);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span style="color: #98c379;line-height: 26px;">"mysql&nbsp;连接未断开更新"</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}catch&nbsp;(CommunicationsException&nbsp;e){<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;=&nbsp;ConnectionUtil.getConnection();<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execUpdate(value);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span style="color: #98c379;line-height: 26px;">"mysql&nbsp;连接断开重连更新"</span>);<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>4. flink checkpoint 恢复失败<span style="display: none;"></span></h3><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>异常信息：</strong></section><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">org.apache.flink.util.StateMigrationException:&nbsp;For&nbsp;heap&nbsp;backends,&nbsp;the&nbsp;new&nbsp;state&nbsp;serializer&nbsp;must&nbsp;not&nbsp;be&nbsp;incompatible.<br  />&nbsp;at&nbsp;org.apache.flink.runtime.state.heap.HeapKeyedStateBackend.tryRegisterStateTable(HeapKeyedStateBackend.java:230)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.runtime.state.heap.HeapKeyedStateBackend.createInternalState(HeapKeyedStateBackend.java:273)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.runtime.state.KeyedStateFactory.createInternalState(KeyedStateFactory.java:47)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.runtime.state.ttl.TtlStateFactory.createStateAndWrapWithTtlIfEnabled(TtlStateFactory.java:72)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.runtime.state.AbstractKeyedStateBackend.getOrCreateKeyedState(AbstractKeyedStateBackend.java:279)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.api.operators.StreamOperatorStateHandler.getOrCreateKeyedState(StreamOperatorStateHandler.java:245)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.api.operators.AbstractStreamOperator.getOrCreateKeyedState(AbstractStreamOperator.java:435)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.operators.windowing.WindowOperator.open(WindowOperator.java:240)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.OperatorChain.initializeStateAndOpenOperators(OperatorChain.java:291)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.StreamTask.lambda<span style="color: #d19a66;line-height: 26px;">$beforeInvoke</span><span style="color: #d19a66;line-height: 26px;">$0</span>(StreamTask.java:479)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor<span style="color: #d19a66;line-height: 26px;">$1</span>.runThrowing(StreamTaskActionExecutor.java:47)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.StreamTask.beforeInvoke(StreamTask.java:475)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:528)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:721)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;org.apache.flink.runtime.taskmanager.Task.run(Task.java:546)&nbsp;~[preprocessing-flink-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]<br  />&nbsp;at&nbsp;java.lang.Thread.run(Thread.java:745)&nbsp;~[?:1.8.0_65]<br  /></code></pre><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>解决方案</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">先看 cheackpoint 页面信息</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.48478488982161594" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/5_Yx9dibC4RrXViaOrMLQb25Pra4UMEA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHE6HB1CoV6WDicjMzsTkGJyhxd6JYx9dibC4RrXViaOrMLQb25Pra4UMEA/640?wx_fmt=png'" data-type="png" data-w="1906" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">再查看hdfs，会发现只有最近的一条checkpoint被保留下来，所以恢复的参数必须是最后一条存在的checkpoint记录</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">/usr/lib/flink/flink/bin/flink&nbsp;run&nbsp;-d&nbsp;-m&nbsp;yarn-cluster&nbsp;-yjm&nbsp;1024&nbsp;-ytm&nbsp;1024&nbsp;-s&nbsp;hdfs://hadoop01:9000/flink/checkpoints/preprocess/60366092809bbc2b5785591f8014f759/chk-815&nbsp;/usr/lib/flink/jars/<span style="color: #e6c07b;line-height: 26px;">test</span>/xxx.jar<br  /></code></pre><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>5. yarn 增加并行任务数量配置<span style="display: none;"></span></h3><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>问题描述</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">由于项目的要求，需要在yarn集群运行三个以上的flink流处理程序，外加一部分批处理程序，今天测试的时候发现部署了三个flink流处理程序后，内存，cpu资源都没有占满还有大部分的空间，但是提交flink批处理程序的时候，批处理程序一直处于挂起状态，不执行，大概想了一下应该就是资源分配的问题</p><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>解决方案</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">修改hadoop配置文件：capacity-scheduler.xml</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">yarn.scheduler.capacity.maximum-am-resource-percent</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">&nbsp;&nbsp;&lt;property&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;yarn.scheduler.capacity.maximum-am-resource-percent&lt;/name&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #5c6370;font-style: italic;line-height: 26px;">#该值默认为0.1，将其修改为0.2</span><br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;value&gt;0.2&lt;/value&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maximum&nbsp;percent&nbsp;of&nbsp;resources&nbsp;<span style="color: #c678dd;line-height: 26px;">in</span>&nbsp;the&nbsp;cluster&nbsp;<span style="color: #e6c07b;line-height: 26px;">which</span>&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;run<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;masters&nbsp;i.e.&nbsp;controls&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;running<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applications.<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/description&gt;<br  />&nbsp;&nbsp;&lt;/property&gt;<br  /></code></pre><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">该值的描述信息意为，群集中可用于运行应用程序主机的资源的最大百分比，即控制并发运行的应用程序的数量</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">根据应用场景适当的增大该值即可提高应用的并发数量</p><h3 data-tool="mdnice编辑器" style="margin-top: 30px;margin-bottom: 15px;font-weight: bold;font-size: 20px;"><span style="display: none;"></span>6. 流处理flink程序在hadoop集群跑了一段时间莫名挂掉<span style="display: none;"></span></h3><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>问题描述</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">一个左右前在hadoop集群跑了一个flink流处理任务，有一天检查的时候发现挂掉了，信息如下：</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.04683972911963882" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/6_VseQkrjUsElDfQ5WIuvOIRaBIkKNVg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRH5xoCH7rYHYCdnjX8WLYiaaGBPVseQkrjUsElDfQ5WIuvOIRaBIkKNVg/640?wx_fmt=png'" data-type="png" data-w="1772" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">点进去</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5046875" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/7_c4fFS4EJztOCK4HoPX3xNKSd8hcxzQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHlPZCL8l5SZYd5tCicYgtnkIvRc4fFS4EJztOCK4HoPX3xNKSd8hcxzQ/640?wx_fmt=png'" data-type="png" data-w="1920" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">查看日志</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5046875" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/8_YspFvrrV5icmspj7yhd8IUXJ5UNS3g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHvfXXSWVQbQha5york621185SJYspFvrrV5icmspj7yhd8IUXJ5UNS3g/640?wx_fmt=png'" data-type="png" data-w="1920" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">发现flink所有的运行日志随hadoop的容器消失了</p><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>原因分析</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">第一时间想到查看hadoop的日志，大概会有些帮助，进而定位问题，先后查看了namenode日志，datanode日志发现并无异常，然后查看nodemanager的日志时发现了端倪</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.33998920669185106" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/9_p9hvvqAruDwafHYLFSkjiaALAB3vdA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHGH4E2VkR2j6Ofs3vmZS2mCSBfp9hvvqAruDwafHYLFSkjiaALAB3vdA/640?wx_fmt=png'" data-type="png" data-w="1853" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">（由于日志文件比较大在linux终端查看不方便所以下载下来，使用Notepad++查看，查看时在hadoop任务界面找到任务失败的时间，下载该时间点的日志文件，就可以找到对应日志信息）</p><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">从日志信息可以发现，由于找不到进程id，所以容器直接关掉了退出了，于是根据日志进去查看了linux系统下的tmp目录，最后发现果然有/tmp/hadoop-root/*一系列目录，对于hadoop容器的进程id这么重要的东西怎么能放在/tmp目录呢，tmp目录众所周知在文件不修改的情况下，默认30天会被清理，那么问题大概就出现在这里了，运行flink任务的container 的进程id被系统清理了</p><section style="margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><strong>解决方案</strong></section><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">通过分析后，查看了一下hadoop临时目录的配置</p><figure data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><img class="rich_pages wxw-img" data-ratio="0.5046875" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/10_TfiaXwQjGFnnqEAxJwCtnyAib4n4hw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PgoUFYqbV3VnMC9F7BNnRHudZAoWb0exibwJId6qlZN1VbI1mTfiaXwQjGFnnqEAxJwCtnyAib4n4hw/640?wx_fmt=png'" data-type="png" data-w="1920" style="display: block;margin-right: auto;margin-left: auto;"  /></figure><p data-tool="mdnice编辑器" style="padding-top: 8px;padding-bottom: 8px;line-height: 26px;">可以发现用到该配置的地方竟然有13处之多，当然也包含了container的进程id的信息存放，因此只需将hadoop.tmp.dir的配置更改一下就可以了，更改时修改core-site.xml文件，添加该配置项，具体的目录根据自己系统空间去配置</p><pre data-tool="mdnice编辑器" style="margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block;background: url(&quot;https://mmbiz.qpic.cn/mmbiz_svg/I1YzhXxW8YCSNmqxE3YegkmfHOQppW37v38hUzFnI0yFjkHLIna4Hicr9rwHQyU6ImYJ4z2MGRrXbsFoiaXYKz01ARJ5Hyo9Uia/640?wx_fmt=svg&quot;) 10px 10px / 40px no-repeat rgb(40, 44, 52);height: 30px;width: 100%;margin-bottom: -7px;border-radius: 5px;"></span><code style="overflow-x: auto;padding: 16px;color: #abb2bf;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #282c34;border-radius: 5px;">&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;value&gt;/home/hadoop/tmp&lt;/value&gt;<br  />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/property&gt;</code></pre></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;line-height: 1.6;letter-spacing: 0.034em;color: rgb(63, 63, 63);font-size: 16px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">如果这个文章对你有帮助，不要忘记&nbsp;</span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;outline: 0px;font-size: 15px;color: rgb(255, 104, 39);"><strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「在看」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「点赞」</strong>&nbsp;<strong style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;line-height: 1.75em;">「收藏」</strong></span><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">&nbsp;三连啊喂！</span><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><p style="margin: 0px 0px 0em;padding: 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: center;"><img class="rich_pages wxw-img" data-ratio="1.6527777777777777" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/11_Zfh1Rf8hPd3euzJlYyfJq4081VB6Rg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PuHq9qaJwJpGeRJBMqMloibzfcYl12AoR2v9kgqyZz4CYuKZfh1Rf8hPd3euzJlYyfJq4081VB6Rg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" data-w="576" style="margin: 0px;padding: 0px;max-width: 100%;height: 380px;overflow-wrap: break-word !important;vertical-align: bottom;width: 230px;"  /><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;background-color: rgb(255, 255, 255);color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;"></span></p></section></section><section style="margin: 0px;padding: 0px;max-width: 100%;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="图片/大数据技术与架构_2023-02-24_Flink任务提交问题汇总/12_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="margin: 0px;padding: 0px;max-width: 100%;height: 42px;overflow-wrap: break-word !important;vertical-align: bottom;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">互联网最坏的时代可能真的来了</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">我在B站读大学，大数据专业</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Flink的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">193篇文章暴揍Flink，这个合集你需要关注一下</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Spark的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">在所有Spark模块中，我愿称SparkSQL为最强！</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">硬刚Hive | 4万字基础调优面试小总结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">数据治理方法论和实践小百科全书</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">标签体系下的用户画像建设小指南</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解析</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我写过的关于成长/面试/职场进阶的文章</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>