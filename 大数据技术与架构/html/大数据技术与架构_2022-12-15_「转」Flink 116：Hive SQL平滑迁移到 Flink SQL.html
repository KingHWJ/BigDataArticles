<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"Flink 1.16：Hive SQL平滑迁移到 Flink SQL","time":"2022-12-15 19:07:57","timeStamp":"1671102477"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247516612&idx=1&sn=ed6efc886a3ced84e510faee94d050a2&chksm=fd3ec751ca494e479dc6c2c1621cb1693bd842c5a4c7e30226145db6df9e327919be03e0ae03#rd" target="_blank">Flink 1.16：Hive SQL平滑迁移到 Flink SQL</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">伍翀@阿里&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2022-12-15 19:07:57</em></div><content><div class="reprint"><p>转自公众号：Apache Flink<br><a href="http://mp.weixin.qq.com/s?__biz=MzU3Mzg4OTMyNQ==&mid=2247501433&idx=1&sn=d5024af2f9ad7cb5c95acb52c92678e5" target="_blank" title="阅读原文">http://mp.weixin.qq.com/s?__biz=MzU3Mzg4OTMyNQ==&mid=2247501433&idx=1&sn=d5024af2f9ad7cb5c95acb52c92678e5</a></p></div><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;color: rgb(34, 34, 34);letter-spacing: 0.544px;white-space: normal;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 27.2px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;margin-bottom: 24px;" data-mpa-powered-by="yiban.io"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section donone="shifuMouseDownCard(&#39;shifu_c_008&#39;)" label="Copyright Reserved by PLAYHUDONG." style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section donone="shifuMouseDownCard(&#39;shifu_c_008&#39;)" label="Copyright Reserved by PLAYHUDONG." style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;color: rgb(34, 34, 34);letter-spacing: 0.544px;white-space: normal;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 27.2px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section donone="shifuMouseDownCard(&#39;shifu_c_008&#39;)" label="Copyright Reserved by PLAYHUDONG." style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section donone="shifuMouseDownCard(&#39;shifu_c_008&#39;)" label="Copyright Reserved by PLAYHUDONG." style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section powered-by="xiumi.us" style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section donone="shifuMouseDownCard(&#39;shifu_c_008&#39;)" label="Copyright Reserved by PLAYHUDONG." style="margin-right: 0em;margin-left: 0em;padding: 0.5em 1em;outline: 0px;max-width: 100%;border-style: none;background-color: rgb(245, 245, 245);visibility: visible;text-align: left;box-sizing: border-box !important;overflow-wrap: break-word !important;"><p style="outline: 0px;max-width: 100%;visibility: visible;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;font-size: 14px;color: rgb(89, 89, 89);visibility: visible;letter-spacing: 0.5px;box-sizing: border-box !important;overflow-wrap: break-word !important;">摘要：本文整理自&nbsp;</span><span style="outline: 0px;max-width: 100%;color: rgb(89, 89, 89);font-size: 14px;letter-spacing: 0.5px;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">Apache Flink PMC&amp;Committer 伍翀（云邪）在 9 月 24 日 Apache Flink Meetup 的演讲。主要内容包括：</span></p><p style="outline: 0px;max-width: 100%;visibility: visible;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;visibility: visible;font-size: 14px;color: rgb(89, 89, 89);letter-spacing: 0.5px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><br style="outline: 0px;max-width: 100%;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"  /></span></p><ol class="list-paddingleft-1" style="padding-left: 1.5em;outline: 0px;max-width: 100%;width: 543.453px;visibility: visible;overflow-wrap: break-word !important;"><li style="outline: none;max-width: 100%;box-sizing: border-box;list-style: inherit;font-size: 14px;line-height: 26px;color: rgb(89, 89, 89);letter-spacing: 0.5px;visibility: visible;overflow-wrap: break-word !important;"><p style="outline: 0px;max-width: 100%;line-height: 1.75em;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">Hive SQL 迁移的动机</p></li><li style="margin-top: 0.25em;outline: none;max-width: 100%;box-sizing: border-box;list-style: inherit;font-size: 14px;line-height: 26px;color: rgb(89, 89, 89);letter-spacing: 0.5px;visibility: visible;overflow-wrap: break-word !important;"><p style="outline: 0px;max-width: 100%;line-height: 1.75em;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">Hive SQL 迁移的挑战</p></li><li style="margin-top: 0.25em;outline: none;max-width: 100%;box-sizing: border-box;list-style: inherit;font-size: 14px;line-height: 26px;color: rgb(89, 89, 89);letter-spacing: 0.5px;visibility: visible;overflow-wrap: break-word !important;"><p style="outline: 0px;max-width: 100%;line-height: 1.75em;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">Hive SQL 迁移的实践</p></li><li style="margin-top: 0.25em;outline: none;max-width: 100%;box-sizing: border-box;list-style: inherit;font-size: 14px;line-height: 26px;color: rgb(89, 89, 89);letter-spacing: 0.5px;visibility: visible;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;line-height: 1.75em;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">Hive SQL 迁移的演示</section></li><li style="margin-top: 0.25em;outline: none;max-width: 100%;box-sizing: border-box;list-style: inherit;font-size: 14px;line-height: 26px;color: rgb(89, 89, 89);letter-spacing: 0.5px;visibility: visible;overflow-wrap: break-word !important;"><section style="outline: 0px;max-width: 100%;line-height: 1.75em;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;">未来规划</section></li></ol><section style="outline: 0px;max-width: 100%;clear: both;min-height: 1em;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: normal;visibility: visible;line-height: 1.75em;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;letter-spacing: 0.5px;font-size: 14px;color: rgb(89, 89, 89);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><section mp-original-font-size="17" mp-original-line-height="27" style="margin-bottom: 0px;white-space: normal;outline: 0px;color: rgb(34, 34, 34);font-size: 14.875px;text-size-adjust: auto;letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;background-color: rgb(255, 255, 255);line-height: 23.625px;visibility: visible;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;visibility: visible;"><section mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;visibility: visible;"><section powered-by="xiumi.us" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;visibility: visible;"><section data-role="outer" label="Powered by 135editor.com" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;visibility: visible;"><section data-tools="135编辑器" data-id="98469" mp-original-font-size="17" mp-original-line-height="27" style="outline: 0px;line-height: 23.625px;visibility: visible;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25" style="padding-right: 10px;padding-left: 10px;outline: 0px;font-size: 14px;color: black;line-height: 21.875px;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;visibility: visible;"><blockquote data-tool="mdnice编辑器" mp-original-font-size="14.399999618530273" mp-original-line-height="23" style="margin-top: 20px;margin-bottom: 20px;padding: 10px 10px 10px 20px;border-left-color: rgb(239, 112, 96);color: rgb(106, 115, 125);line-height: 20.125px;font-size: 12.6px;outline: 0px;border-top-style: none;border-right-style: none;border-bottom-style: none;overflow: auto;background-color: rgb(255, 249, 249);visibility: visible;"><p mp-original-font-size="16" mp-original-line-height="26" style="padding-top: 8px;padding-bottom: 8px;outline: 0px;font-size: 14px;color: black;line-height: 22.75px;visibility: visible;"><span mp-original-font-size="14" mp-original-line-height="26" style="outline: 0px;color: rgb(89, 89, 89);letter-spacing: 0.544px;font-size: 12.25px;visibility: visible;line-height: 22.75px;"><strong mp-original-font-size="14" mp-original-line-height="26" style="outline: 0px;visibility: visible;line-height: 22.75px;"><img class="rich_pages wxw-img" data-ratio="1" data-type="png" data-w="20" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/1_6VyhjNCMic3DGmPLZocTtEmtWBJKsQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2OP8CL6Mmrc9shxR4OiamrPMlRCKiaicf2n4JLNDRcyH1jfEKxo6VyhjNCMic3DGmPLZocTtEmtWBJKsQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" style="vertical-align: text-bottom;outline: 0px;display: inline-block;font-size: 10.7188px;line-height: 19.9062px;box-sizing: border-box !important;visibility: visible !important;width: 20px !important;"  /><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247514568&amp;idx=1&amp;sn=659d7464a3b61ebf8397d2597069f4ab&amp;chksm=fd3eff5dca49764beef9ab14400e96715b86b3394f05e161181c03424fa579cdbc242a401411&amp;scene=21#wechat_redirect" textvalue="全网最全大数据面试提升手册！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" mp-original-font-size="14" mp-original-line-height="26" style="color: rgb(255, 41, 65);font-weight: 400;letter-spacing: normal;font-size: 14px;"><strong>全网最全大数据面试提升手册！</strong></a></strong></span></p></blockquote></section></section></section></section></section></section></section><section style="box-sizing: border-box;font-size: 16px;margin-bottom: 24px;"><section style="will-change: transform;box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;"><section style="text-align: left;justify-content: flex-start;display: flex;flex-flow: row nowrap;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;align-self: flex-start;flex: 0 0 auto;box-sizing: border-box;"><section style="text-align: center;opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;width: 300px;height: 60px;vertical-align: top;overflow: hidden;padding-right: 10px;padding-left: 10px;box-sizing: border-box;"><section style="margin-top: -12px;margin-bottom: -12px;transform: scale(0.8);-webkit-transform: scale(0.8);-moz-transform: scale(0.8);-o-transform: scale(0.8);transform-origin: center center;-webkit-transform-origin: center center;-moz-transform-origin: center center;-o-transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="opacity: 0.5;box-sizing: border-box;"><section style="font-size: 120px;color: rgb(216, 78, 106);line-height: 1;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">01</strong></p></section></section></section></section></section><section style="transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="text-align: center;justify-content: center;display: flex;flex-flow: row nowrap;opacity: 1;box-sizing: border-box;"><section style="display: inline-block;width: auto;vertical-align: top;border-top: 1px solid rgb(229, 229, 229);border-top-left-radius: 0px;border-bottom: 1px solid rgb(229, 229, 229);border-bottom-right-radius: 0px;box-shadow: rgb(0, 0, 0) 0px 0px 0px;padding: 15px;align-self: flex-start;flex: 100 100 0%;height: auto;box-sizing: border-box;"><section style="opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="font-size: 18px;color: rgb(62, 62, 62);letter-spacing: 0.5px;line-height: 1.7;box-sizing: border-box;"><p cid="n208" mdtype="heading" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Hive SQL 迁移的动机</strong></p></section></section></section></section></section></section></section></section></section><p cid="n4" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/2_ekYXPkXn3ib4Z1quWpt9yAcpC8rrog.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkRvlBqO27LjuO88RDyNCcJCYBVekYXPkXn3ib4Z1quWpt9yAcpC8rrog/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;"></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: left;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">Flink 已经是流计算的事实标准，当前国内外做实时计算或流计算一般都会选择 Flink 和 Flink SQL。另外，Flink 也是是家喻户晓的流批一体大数据计算引擎。</span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: left;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">然而，目前 Flink 也面临着挑战。比如虽然现在大规模应用都以流计算为主，但 Flink 批计算的应用并不广泛，想要进一步推动真正意义上的流批一体落地，需要推动业界更多地落地 Flink 批计算，需要更积极地拥抱现有的离线生态。当前业界离线生态主要以 Hive 为主，因此我们在过去版本中做了很多与 Hive 相关的集成，包括 Hive Catalog、Hive 语法兼容、Hive UDF 兼容、流式写入 Hive 等。在 Flink 1.16 版本中，我们进一步提升了 HiveSQL 的兼容度，还支持了 HiveServer2 的协议兼容。</span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><br  /></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">所以，为什么 Flink 要去支持 Hive SQL 的迁移？一方面，我们希望吸引更多的 Hive 离线数仓用户，通过用户来不断打磨批计算引擎，对齐主流批计算引擎。另一方面，通过兼容 Hive SQL，来降低现有离线用户使用 Flink 开发离线业务的门槛。除此之外，另外，生态是开源产品的最大门槛。Flink 已经拥有非常丰富的实时生态工具，但离线生态依然较为欠缺。通过兼容 Hive 生态可以快速融入 Hive 离线生态工具和平台，降低用户接入的成本。最后，这也是实现流批一体的重要一环，我们希望推动业界尝试统一的流计算和批计算引擎，再统一流计算和批计算 SQL。</span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></p><p cid="n12" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/3_JNlW2Nomf6JRJicu3wvGicpPMHzBKQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkpGTgShvQoOVNnJQqRZJmjD0vxSJNlW2Nomf6JRJicu3wvGicpPMHzBKQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;"></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;color: rgb(89, 89, 89);letter-spacing: 0.5px;">从用户角度来看，Hive SQL 为什么要迁移到 Flink SQL 上？<br  /></span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">对于平台方而言，统一流批计算引擎，只需维护一套 Flink 引擎，可以降低维护成本，提升团队研发效率。另外，可以利用 Flink + Gateway+ HiveSQL 兼容，快速建设一套 OLAP 系统。Flink 的另一优势是拥有丰富的 connector 生态，可以借助 Flink 丰富的数据源实现强大的联邦查询。比如不仅可以在 Hive 数仓里做 ad-hoc 查询，也可以将 Hive 表数据与 MySQL、HBase、Iceberg、Hudi 等数据源做联邦查询等。</span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">对于离线数仓用户而言，可以用 Hive SQL 写流计算作业，极大降低实时化改造成本。使用的依然是以前的 HiveSQL 语法，但是可以运行在 streaming 模式下。在此基础之上也可以进一步探索流批一体 SQL 层以及流批一体数仓层的建设。</span></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="box-sizing: border-box;font-size: 16px;margin-bottom: 24px;"><section style="will-change: transform;box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;"><section style="text-align: left;justify-content: flex-start;display: flex;flex-flow: row nowrap;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;align-self: flex-start;flex: 0 0 auto;box-sizing: border-box;"><section style="text-align: center;opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;width: 300px;height: 60px;vertical-align: top;overflow: hidden;padding-right: 10px;padding-left: 10px;box-sizing: border-box;"><section style="margin-top: -12px;margin-bottom: -12px;transform: scale(0.8);-webkit-transform: scale(0.8);-moz-transform: scale(0.8);-o-transform: scale(0.8);transform-origin: center center;-webkit-transform-origin: center center;-moz-transform-origin: center center;-o-transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="opacity: 0.5;box-sizing: border-box;"><section style="font-size: 120px;color: rgb(216, 78, 106);line-height: 1;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">02</strong></p></section></section></section></section></section><section style="transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="text-align: center;justify-content: center;display: flex;flex-flow: row nowrap;opacity: 1;box-sizing: border-box;"><section style="display: inline-block;width: auto;vertical-align: top;border-top: 1px solid rgb(229, 229, 229);border-top-left-radius: 0px;border-bottom: 1px solid rgb(229, 229, 229);border-bottom-right-radius: 0px;box-shadow: rgb(0, 0, 0) 0px 0px 0px;padding: 15px;align-self: flex-start;flex: 100 100 0%;height: auto;box-sizing: border-box;"><section style="opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="font-size: 18px;color: rgb(62, 62, 62);letter-spacing: 0.5px;line-height: 1.7;box-sizing: border-box;"><p cid="n208" mdtype="heading" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Hive SQL 迁移的挑战</strong></p></section></section></section></section></section></section></section></section></section><p cid="n22" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/4_T5hBvtsoicdEXdDtk4AbrgAPJh43Ug.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkX6bXB0WtqcaP7ibO1jThbjRjuBT5hBvtsoicdEXdDtk4AbrgAPJh43Ug/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;"></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><br  /></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">但是 Flink 支持 HiveSQL 的迁移面临着很多挑战，主要有以下三个方面：</span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></p><ul class="list-paddingleft-1" style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><li style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">兼容：包括离线数仓作业和Hive平台工具的兼容。主要对应用户层的兼容和平台方的兼容。</span></p></li></ul><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><br  /></p><ul class="list-paddingleft-1" style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><li style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">稳定性：迁移后的作业首先要保证生产的稳定性。我们在1.16中也做了很多这方面的工作，包括FLIP-168 预测执行和Adaptive Hash Join。后续我们会发表更多的文章来介绍这方面的工作。</span></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><br  /></p></li><li style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">性能：最后性能也是很重要的，在1.16中我们也做了很多这方面的工作，包括Dynamic Partition Pruning（DPP）、元数据访问加速等，后续也会发表更多文章来介绍这方面的工作。</span></p></li></ul><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><br  /></p><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">接下来我们重点讲解下 Hive 兼容相关的工作。</span></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n34" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-ratio="0.5885129819040126" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/5_2oLe6KgspJ4tgWc04w2yjDbXwELkRg.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTk3mCicGNaqdwZvH7Nxpnw9Ad0d2oLe6KgspJ4tgWc04w2yjDbXwELkRg/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1271" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;"></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">Hive 语法的兼容并没有完全造出一套新的 SQL 引擎，而是复用了 Flink SQL 的很多核心流程和代码。我们抽象出了可插拔的 parser 层来支持和扩展不同的语法。Flink SQL 会经过 Flink Parser 转换成 Flink RelNode，再经过 Logical Plan 优化为 Physical Plan，最后转换为 Job Graph 提交执行。为了支持 Hive 语法兼容，我们引入了 Hive Parser 组件，来将 Hive SQL 转化成 Flink RelNode。这个过程中，复用了大部分 Hive 现有的 SQL 解析逻辑，保证语法层的兼容（均基于 Calcite）。之后 RelNode 复用同样的流程和代码转化成 LogicalPlan、Physical Plan、JobGraph，最后提交执行。</span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n38" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="322" data-backw="572" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/6_yoOfvry5yQplxfeJwrW1icUW41qvNw.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkvRiceAmBpySjjjjuaLHK9X0lGPyoOfvry5yQplxfeJwrW1icUW41qvNw/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;color: rgb(89, 89, 89);letter-spacing: 0.5px;">从架构上看，Hive 语法兼容并不复杂，但这是一个“魔鬼在细节”的工作。上图为部分 Flink1.16 版本里 Flink Hive 兼容相关的 issue，涉及 query 兼容、类型系统、语义、行为、DDL、DML、辅助查询命令等非常多语法功能。累计完成的 issue 数达近百个。<br  /></span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><br  /></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">Flink1.16 版本将 Hive 兼容度从 85% 提升至 94.1%。兼容度测试主要依靠 Hive qtest 测试集，其中包含 12,000 多个测试 case，覆盖了 Hive 目前所有主流语法功能。没有兼容的一部分包括 ACID 功能（业界使用较少），如果除去 ACID 功能，兼容度已达 97%以上。</span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n45" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="338" data-backw="572" data-ratio="0.5913461538461539" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/7_wAgkiavek2rSicV2N24rWLU9KHkKNA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkdTA6BYcRE8TkdYMvevNKX81iavMwAgkiavek2rSicV2N24rWLU9KHkKNA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="832" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">SQLGateway 是 Flink SQL 的 server 层组件，是单独的进程，对标 HiveServer2 组件。从 Flink 整体架构上看，SQLGateway 处于中间位置。<br  /></span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">向下，封装了用户 API 的 Flink SQL 和 Hive SQL。不管是 Flink SQL 还是 Hive SQL，都使用 Flink 流批一体的 Runtime 来执行，可以运行在批模式，也可以运行在流模式。Flink 的资源也可以部署运行在 YARN、K8S、Flink standalone 集群上。</span></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><br  /></section><section style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">向上，SQLGateway 提供了可插拔协议层 Endpoint，目前提供了 HiveServer2 和 REST 两种协议实现。通过 HiveServer2 Endpoint，用户可以将 Hive 生态的很多工具和组件（Zeppelin、Superset、Beeline、DBeaver 等）连接到 SQL Gateway，提供流批统一的 SQL 服务并兼容 Hive SQL。通过 REST 协议可以使用 Postman、curl 命令或自己通过 Python、Java 编程来访问，提供完善和灵活的流计算服务。将来，Endpoint 能力也会继续扩展，比如可以提供更高性能的 gRPC 协议或兼容 PG 协议。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="box-sizing: border-box;font-size: 16px;margin-bottom: 24px;"><section style="will-change: transform;box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;"><section style="text-align: left;justify-content: flex-start;display: flex;flex-flow: row nowrap;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;align-self: flex-start;flex: 0 0 auto;box-sizing: border-box;"><section style="text-align: center;opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;width: 300px;height: 60px;vertical-align: top;overflow: hidden;padding-right: 10px;padding-left: 10px;box-sizing: border-box;"><section style="margin-top: -12px;margin-bottom: -12px;transform: scale(0.8);-webkit-transform: scale(0.8);-moz-transform: scale(0.8);-o-transform: scale(0.8);transform-origin: center center;-webkit-transform-origin: center center;-moz-transform-origin: center center;-o-transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="opacity: 0.5;box-sizing: border-box;"><section style="font-size: 120px;color: rgb(216, 78, 106);line-height: 1;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">03</strong></p></section></section></section></section></section><section style="transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="text-align: center;justify-content: center;display: flex;flex-flow: row nowrap;opacity: 1;box-sizing: border-box;"><section style="display: inline-block;width: auto;vertical-align: top;border-top: 1px solid rgb(229, 229, 229);border-top-left-radius: 0px;border-bottom: 1px solid rgb(229, 229, 229);border-bottom-right-radius: 0px;box-shadow: rgb(0, 0, 0) 0px 0px 0px;padding: 15px;align-self: flex-start;flex: 100 100 0%;height: auto;box-sizing: border-box;"><section style="opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="font-size: 18px;color: rgb(62, 62, 62);letter-spacing: 0.5px;line-height: 1.7;box-sizing: border-box;"><p cid="n208" mdtype="heading" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Hive SQL 迁移的实践</strong></p></section></section></section></section></section></section></section></section></section><p cid="n54" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="322" data-backw="572" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/8_CoCQG5mPLd4rLHYXT8hRFOfiaRTE4g.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkk9WK0icuKDl3s3gu6Wx15a2foZCoCQG5mPLd4rLHYXT8hRFOfiaRTE4g/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><p style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><br  /></p><p style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">目前快手正在与 Flink 社区紧密合作，推进流批一体的落地。目前快手迁移 Hive SQL 作业到 Flink SQL 作业已经取得了初步的进展，已有上千个作业完成了迁移。快手的迁移主要策略为双跑平台，已有业务继续运行，双跑平台有智能路由组件，可以通过指定规则或 pattern 识别出作业，投递到 MapReduce、Spark 或 Flink 上运行。初期的运行较为谨慎，会通过白名单机制指定某些作业先运行在 Flink，观察其稳定性与性能，对比其结果一致性，后续逐步通过规则来放量。更多的实践经验与细节可以关注 Flink Forward Asia 2022 上分享的《Hive SQL 迁移到 Flink SQL 在快手的实践》。</span></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="box-sizing: border-box;font-size: 16px;margin-bottom: 24px;"><section style="will-change: transform;box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;"><section style="text-align: left;justify-content: flex-start;display: flex;flex-flow: row nowrap;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;align-self: flex-start;flex: 0 0 auto;box-sizing: border-box;"><section style="text-align: center;opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;width: 300px;height: 60px;vertical-align: top;overflow: hidden;padding-right: 10px;padding-left: 10px;box-sizing: border-box;"><section style="margin-top: -12px;margin-bottom: -12px;transform: scale(0.8);-webkit-transform: scale(0.8);-moz-transform: scale(0.8);-o-transform: scale(0.8);transform-origin: center center;-webkit-transform-origin: center center;-moz-transform-origin: center center;-o-transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="opacity: 0.5;box-sizing: border-box;"><section style="font-size: 120px;color: rgb(216, 78, 106);line-height: 1;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">04</strong></p></section></section></section></section></section><section style="transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="text-align: center;justify-content: center;display: flex;flex-flow: row nowrap;opacity: 1;box-sizing: border-box;"><section style="display: inline-block;width: auto;vertical-align: top;border-top: 1px solid rgb(229, 229, 229);border-top-left-radius: 0px;border-bottom: 1px solid rgb(229, 229, 229);border-bottom-right-radius: 0px;box-shadow: rgb(0, 0, 0) 0px 0px 0px;padding: 15px;align-self: flex-start;flex: 100 100 0%;height: auto;box-sizing: border-box;"><section style="opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="font-size: 18px;color: rgb(62, 62, 62);letter-spacing: 0.5px;line-height: 1.7;box-sizing: border-box;"><p cid="n208" mdtype="heading" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Hive SQL 迁移的演示</strong></p></section></section></section></section></section></section></section></section></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 16px;"><strong><span style="letter-spacing: 0.5px;color: rgb(216, 78, 106);">Demo1：Hive SQL 如何迁移到 Flink SQL</span></strong></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n61" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="322" data-backw="572" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/9_VYonoLibxHg3GoIT4Xu38ulPgAaFwQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTk2yWATYlvpOHwcgtL8qcrlu5d7VYonoLibxHg3GoIT4Xu38ulPgAaFwQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-bottom: 0px;margin-top: 0px;"><span style="letter-spacing: 0.5px;"><span style="font-size: 15px;color: rgb(89, 89, 89);">接下来演示一下 Hive SQL 如何迁移到 Flink SQL。我们已经搭建好一个 YARN 集群，以及 Hive 相关组件，包括 HiveServer2 的服务。我们使用 Zeppelin 做数据可视化和 SQL 查询。我们将演示 Hive SQL 迁移到 Flink SQL 只需改一行地址，Zeppelin 体验并无二致，SQL 也无需修改。完整的 Demo 视频请观看完整的演讲视频：</span><span style="color: rgb(136, 136, 136);font-size: 12px;">https://www.bilibili.com/video/BV1BV4y1T7d4</span></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n65" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="322" data-backw="572" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/10_255tgBiaVoBYriaLoKFic9VdSaSHXQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkXOu42iaBkyV5GDicVYTqe8mGIqibRJ255tgBiaVoBYriaLoKFic9VdSaSHXQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">首先在 Zeppelin 中配置 Hive Interpreter，填入 HiveServer2 的 JDBC 地址和端口、用户名密码、Driver 等信息。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-backh="272" data-backw="572" data-ratio="0.47596153846153844" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/11_jetvRTTGlHgiavuAzQP3ibHeFccERg.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkkLbsCcKWQSBNG1PZicm23ibevvu5jetvRTTGlHgiavuAzQP3ibHeFccERg/640?wx_fmt=jpeg'" data-type="jpeg" data-w="832" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: inline-block;width: 100%;height: auto;"></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-backh="151" data-backw="572" data-ratio="0.2644230769230769" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/12_5eW1Sh7jldQnwACibd3d0QxvutEt3g.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTk3MSeL26vAWzwNib8niad4eJlzVX5eW1Sh7jldQnwACibd3d0QxvutEt3g/640?wx_fmt=jpeg'" data-type="jpeg" data-w="832" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: inline-block;width: 100%;height: auto;"  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">使用当前的 Hive Interpreter，我们可以通过 Hive DDL 命令创建一张打宽的 store_sale_detail 表。使用 Hive SQL 语法关联 store_sales、date_dim、store 三张表，打成一张宽表写到 store_sale_detail。执行该 INSERT INTO 语句后，便能在 Hadoop 平台上看到运行起来的 MapReduce 任务。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n73" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="228" data-backw="572" data-ratio="0.39903846153846156" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/13_ZDO43fkwjOKuSOgdZBRnDy3ibJZmOA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkicBnD5DFXvJDSFMTZhJ7W90O4eZDO43fkwjOKuSOgdZBRnDy3ibJZmOA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="832" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">store_sale_detail 明细宽表生产完后，我们就可以进行查询分析，比如查看星期天每个店铺的销量。运行完后可通过饼图等多种形式展示结果。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n77" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="120" data-backw="572" data-ratio="0.2091346153846154" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/14_5WZhUQgCKQkIcBNZJJ6J0picdeHOuA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkPoO7UZ91ezAEAuNXXyHVRhl5B5WZhUQgCKQkIcBNZJJ6J0picdeHOuA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="832" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><p cid="n78" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-backh="276" data-backw="572" data-ratio="0.4831730769230769" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/15_Cc8MB2oChC5UpySm9E2IRxmz9ad8lA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkL4eLkkUxHDfcu55cLfoF8NVQCc8MB2oChC5UpySm9E2IRxmz9ad8lA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="832" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;width: 100%;height: auto;"></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><p style="text-align: left;margin-bottom: 0px;margin-top: 0px;line-height: 1.75em;"><span style="color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;">上面简单演示了使用 Hive 进行数据生产和数据分析，其中计算引擎使用的是 Hive 原生的 Hadoop MapReduce 作业，作业运行在 YARN 集群上。接下来我们开始迁移到 Flink SQL，作业仍然运行在 YARN 集群上。</span></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-backh="316" data-backw="572" data-ratio="0.5528846153846154" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/16_jEEs3ebc0ABs9KySaZoFlUFCLCwPsA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkVFthVmPgFcIweQexF3oKJ4oGjEEs3ebc0ABs9KySaZoFlUFCLCwPsA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="832" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: inline-block;width: 100%;height: auto;"></section><p style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><br  /></p><p style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">首先搭建 Flink SQL 集群以及启动 SQLGateway。我们已经下载并解压了 Flink 1.16 版本。其中 lib 文件夹下也已经提前准备 Hive connector、JDBC connector 和 MySQL Driver。另外，还需要将 flink-table-planner-loader 与 opt/ 目录下的 flink-table-planner JAR 包做个替换，然后启动 YARN session 集群。Session 集群启动后，可在 yarn 上看到 Flink 的 session application。</span></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-backh="283" data-backw="578" data-galleryid="" data-ratio="0.49038461538461536" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/17_NgmicX37fNycrKLfs2DQOWtuVn2IAA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkPQdgFDB8Q0uba7ib4XPdA9Mm1HNgmicX37fNycrKLfs2DQOWtuVn2IAA/640?wx_fmt=png'" data-type="png" data-w="832" style="width: 100%;height: auto;"></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">在启动 SQLGateway 之前，需要先修改配置，主要配置 HiveServer2 Endpoint 相关的信息。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.4622356495468278" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/18_OtnlaIic1dUC9O7A8DHlzNtBLMd5sQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkFibvjZ8ULw5P1OxsswZ266p0b8OtnlaIic1dUC9O7A8DHlzNtBLMd5sQ/640?wx_fmt=png'" data-type="png" data-w="662" style=""></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-backh="65" data-backw="578" data-galleryid="" data-ratio="0.11298076923076923" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/19_D3cQKGI3RtP1NnYpMWou3gyibpwksA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkOFqBGlr6sImt3rzHial72NavRSD3cQKGI3RtP1NnYpMWou3gyibpwksA/640?wx_fmt=png'" data-type="png" data-w="832" style="width: 100%;height: auto;"  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">此处 SQLGateway 的 endpoint type 是 HiveServer2，以及需要额外设置三个配置：</span><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;">HiveServer2 的 hive-conf-dir、thrift.host 以及 thrift.port。</span><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;">这里注意我们启动的端口号是 20002。</span><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;">然后通过 sql-gateway.sh start 命令启动 SQL Gateway 服务。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><p cid="n99" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-ratio="0.4972462627852085" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/20_TYlzX90RfaSwosTyJHdOSUvrLNWBKg.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTk0ibfbRhJjAYdftnYKDwPHPWVFTYlzX90RfaSwosTyJHdOSUvrLNWBKg/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1271" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;"></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(89, 89, 89);">启动后便可以进行迁移。因为 HiveServer2 运行在同一台机器上，因此只需修改端口号即可。将此处 10000 端口号改为刚刚启动的 20002 端口号，即 Flink SQLGateway 的端口，无需进行任何其他改动。重启 interpreter，迁移完成！</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">接着我们可以在 Zeppelin 中重新执行一遍刚刚的 Hive SQL 语句，可以发现结果都是一致的。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.5504807692307693" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/21_MruVHzhOvmnJA4KIUbFUsiabc4g1eg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkyvWycE4EBficGPHXIeLOHRAVhHMruVHzhOvmnJA4KIUbFUsiabc4g1eg/640?wx_fmt=png'" data-type="png" data-w="832" style=""></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.5504807692307693" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/22_65Pat6qobjlduG3seGweoGHWBKUGpQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkQk2KqpFO3zE3klYbuJmAYzIQ65Pat6qobjlduG3seGweoGHWBKUGpQ/640?wx_fmt=png'" data-type="png" data-w="832" style=""></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">如上图所示，是查询每个商店在周日的销售总额的结果，其饼图结果与使用 Hive 引擎查询的结果完全一致，不同的是这次的查询是运行在 Flink 引擎之上。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="color: rgb(89, 89, 89);font-size: 15px;letter-spacing: 0.5px;font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Hive SQL 迁移到 Flink SQL 后不仅能获得更好的性能，还能获得 Flink SQL 提供的额外能力，包括更丰富的联邦查询和流批一体能力。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-backh="317" data-backw="578" data-galleryid="" data-ratio="0.5480769230769231" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/23_apYHlMN5FddgG7pGtcHlu0YVSXVKJQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkU5uTrrakfAeI4oSa6B4S3vvbapYHlMN5FddgG7pGtcHlu0YVSXVKJQ/640?wx_fmt=png'" data-type="png" data-w="832" style="width: 100%;height: auto;"></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(89, 89, 89);">我们可以用 Flink DDL 创建新的 catalog，比如 MySQL 表里还有新的额外的维度信息，不在 Hive 中，希望关联它做新数据的探查。只需使用 Flink 的 CREATE CATALOG 语句创建 MySQL catalog，即可实现联邦查询。同时，Flink 会将能下推的 projection、filter 等都下推到 MySQL 进行裁剪。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.31490384615384615" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/24_yG6sXKufxCmWNWq7ia5tnZlka7R0GA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkJO1z46CsLLfhxSoM3b5FY7fMqyG6sXKufxCmWNWq7ia5tnZlka7R0GA/640?wx_fmt=png'" data-type="png" data-w="832" style=""></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">除此之外，也可以使用 Hive SQL 体验流计算的能力。使用 Flink 语法创建一张 datagen 表，该表会源源不断产生随机数据。再切回 Hive 语法创建一张 Hive 结果表 sink。将运行模式改为 streaming，执行 insert into 语句，便提交了一个流作业，该作业会源源不断地将 datagen 中生成的数据流式地写入 Hive。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.21394230769230768" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/25_pkCNGhFp7xlAmibfssLBpBXrT6Y0Aw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkT3T8XXqPwe2ZOQsd0K6BSpKBCpkCNGhFp7xlAmibfssLBpBXrT6Y0Aw/640?wx_fmt=png'" data-type="png" data-w="832" style=""  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.25240384615384615" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/26_hLic1GcTXNeeLBfvkyoldRVibR8icw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkGyPAnwIrFlHDTUXichBv4195myZdhLic1GcTXNeeLBfvkyoldRVibR8icw/640?wx_fmt=png'" data-type="png" data-w="832" style=""></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.20432692307692307" data-s="300,640" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/27_ByImSMG8QSsLmg5ibxeNeE3AIboSIw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTk3nK25z8Edmbniba7zbsBjvjUCVByImSMG8QSsLmg5ibxeNeE3AIboSIw/640?wx_fmt=png'" data-type="png" data-w="832" style=""  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">为了验证 Hive 结果表一直在被流作业写入数据，我们也可以用 Hive 语法查询写入的表。如上图所示，通过不断执行 count(*) 语句，可以看到该表一直在写入数据，因此查询结果会不断变化。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="box-sizing: border-box;font-size: 16px;margin-bottom: 24px;"><section style="will-change: transform;box-sizing: border-box;margin-top: 0px;margin-bottom: 0px;"><section style="text-align: left;justify-content: flex-start;display: flex;flex-flow: row nowrap;box-sizing: border-box;"><section style="display: inline-block;width: 100%;vertical-align: top;align-self: flex-start;flex: 0 0 auto;box-sizing: border-box;"><section style="text-align: center;opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="display: inline-block;width: 300px;height: 60px;vertical-align: top;overflow: hidden;padding-right: 10px;padding-left: 10px;box-sizing: border-box;"><section style="margin-top: -12px;margin-bottom: -12px;transform: scale(0.8);-webkit-transform: scale(0.8);-moz-transform: scale(0.8);-o-transform: scale(0.8);transform-origin: center center;-webkit-transform-origin: center center;-moz-transform-origin: center center;-o-transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="opacity: 0.5;box-sizing: border-box;"><section style="font-size: 120px;color: rgb(216, 78, 106);line-height: 1;box-sizing: border-box;"><p style="box-sizing: border-box;"><strong style="box-sizing: border-box;">05</strong></p></section></section></section></section></section><section style="transform-origin: center center;box-sizing: border-box;" powered-by="xiumi.us"><section style="text-align: center;justify-content: center;display: flex;flex-flow: row nowrap;opacity: 1;box-sizing: border-box;"><section style="display: inline-block;width: auto;vertical-align: top;border-top: 1px solid rgb(229, 229, 229);border-top-left-radius: 0px;border-bottom: 1px solid rgb(229, 229, 229);border-bottom-right-radius: 0px;box-shadow: rgb(0, 0, 0) 0px 0px 0px;padding: 15px;align-self: flex-start;flex: 100 100 0%;height: auto;box-sizing: border-box;"><section style="opacity: 1;box-sizing: border-box;" powered-by="xiumi.us"><section style="font-size: 18px;color: rgb(62, 62, 62);letter-spacing: 0.5px;line-height: 1.7;box-sizing: border-box;"><p cid="n208" mdtype="heading" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">未来规划</strong></p></section></section></section></section></section></section></section></section></section><p cid="n128" mdtype="paragraph" style="margin-bottom: 24px;"><img class="rich_pages wxw-img" data-ratio="0.5625" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/28_vh3FyZMWw4WiaMJY3BlgBpXrd8BE4w.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu6IgSpUMpzpLgvdyRuLmiaTkODROboZWJ3JfwvELp3ibiauRd7Rvh3FyZMWw4WiaMJY3BlgBpXrd8BE4w/640?wx_fmt=jpeg'" data-type="jpeg" data-w="960" style="box-sizing: border-box;border-width: 0px 4px 0px 2px;border-right-style: solid;border-left-style: solid;border-right-color: transparent;border-left-color: transparent;vertical-align: middle;image-orientation: from-image;cursor: default;display: block;margin: auto;"></p><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">未来，Flink 将在以下三个方面持续演进：</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><ul class="list-paddingleft-1" style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;"><li style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">第一，持续在 batch 上做更多尝试和投入，提升 batch 的稳定性和性能，目标是短期内能够追齐主流的批计算引擎。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section></li><li style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">第二，完善数据湖的分析，比如更高效的批式数据湖读写、查询优化下推、列存上的读写优化，Iceberg、Hudi 以及 Flink Table Store 的支持等。另外，也会提供丰富的湖上数据查询和管理功能，比如查询快照版本的能力、查询元数据、更丰富的 DML 语法（UPDATE、DELETE、MERGE INTO）以及管理湖上数据 CALL 命令等。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section></li><li style="text-align: left;margin-top: 0px;margin-bottom: 0px;line-height: 1.75em;font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">第三，Flink Batch 生态建设，包括进一步完善 Remote Shuffle Service、血缘管理等。</span></section></li></ul><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="color: rgb(216, 78, 106);font-size: 16px;"><strong><span style="letter-spacing: 0.5px;">Q&amp;A</span></strong></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;"><br  /></span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(0, 122, 170);">Q：Hive 写通过 Flink 执行，如果 Hive 数据量特别大，是否会出现内存不足、OOM 等报错？</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">A：目前 Flink 执行 batch 模式下，基本所有算子里都有内存管理机制。数据不是以 Java 对象的方式存在 Flink，而是在 Java 内存里面开辟了单独的内存空间供其使用。如果内存满，则会做落盘、spill，速度可能会略微下降，但一般不会发生内存 OOM。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(0, 122, 170);">Q：Flink 是否支持 Hive 自定义 UDF 函数？迁移成本如何？</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">A：支持，可直接迁移。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(0, 122, 170);">Q：现有的离线数仓从 Hive 迁到 Flink 是否存在风险？平滑迁移的注意点有哪些？</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">A：平滑迁移目前大多使用双跑平台，通过机制挑选出部分作业先进行迁移，迁移的作业在两个平台同时运行，因此需要验证行为、结果是否一致，然后逐渐将老平台的作业下线，变为单跑。整个过程需要循序渐进，通常需要半年至一年的时间。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(0, 122, 170);">Q：Demo 中有一个 SQL 查询使用了 Hive on MR 引擎，迁移之后是走 Flink SQLGateway 还是 Hive on MR 模式?</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">A：迁移后，因为配置的端口是 Flink SQL Gateway 的端口，所以 SQL 请求走的是 Flink SQL Gateway，Gateway 会将 Hive SQL 编译成 Flink 作业提交到 YARN 集群上运行。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(0, 122, 170);">Q：Flink 运行批量任务时，TaskManager 个数是我们指定还是自动生成？</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">A：对于 standalone 模式，包括运行在 k8s 上的 standalone 模式，TM 数量由用户指定。其他模式下，TM 数量都由 Flink 自己决定和拉起，包括 yarn/k8s application 模式，yarn session 模式, yarn per-job 模式，native k8s session 模式。拉起的 TM 数量和作业请求的 slot 数相关，taskmanager.numberOfTaskSlots 参数决定了 slot 与 TM 个数的映射关系，slot 数量则和被调度的作业节点的并发度相关。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(0, 122, 170);">Q：Flink 运行在 K8S 上时，如果启用了动态资源分配，shuffle 数据会一直保存在 POD 磁盘上吗？</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">A：可以选择，可以 on TM 也可以 on RemoteShuffleService。</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><br  /></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;letter-spacing: 0.5px;color: rgb(0, 122, 170);">Q：离线作业迁移后，是否还支持 with as 语法以及 partition by 语法？</span></section><section style="text-align: left;line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 15px;color: rgb(89, 89, 89);letter-spacing: 0.5px;">A：WITH AS 语法依然支持，CREATE TABLE 中的 PARTITIONED BY 语法也仍然支持。</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px 10px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;line-height: 1.6;letter-spacing: 0.034em;color: rgb(63, 63, 63);font-size: 16px;"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: center;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;"><span style="letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;"><br  /></span></section><section mp-original-font-size="14" mp-original-line-height="24.5" style="margin: 0px;padding: 0px;max-width: 100%;outline: 0px;font-style: normal;font-variant-caps: normal;font-weight: normal;letter-spacing: 0.476px;text-indent: 0px;text-transform: none;white-space: normal;word-spacing: 0px;text-size-adjust: auto;-webkit-text-stroke: 0px rgb(178, 178, 178);font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.25px;font-family: &quot;Helvetica Neue&quot;;text-align: left;color: rgb(178, 178, 178);background-color: rgb(255, 255, 255);line-height: 21.4375px;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><span style="letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">如果这个文章对你有帮助，不要忘记&nbsp;</span><span style="letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;outline: 0px;font-size: 15px;color: rgb(255, 104, 39);"><strong style="outline: 0px;line-height: 1.75em;">「在看」</strong>&nbsp;<strong style="outline: 0px;line-height: 1.75em;">「点赞」</strong>&nbsp;<strong style="outline: 0px;line-height: 1.75em;">「收藏」</strong></span><span style="letter-spacing: 0.544px;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;color: rgb(74, 74, 74);font-size: 15px;">&nbsp;三连啊喂！</span><br  /></section><p style="margin: 0px 0px 0em;padding: 0px;clear: both;min-height: 1em;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;text-align: center;"><img class="rich_pages wxw-img" data-ratio="1.6527777777777777" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/29_Zfh1Rf8hPd3euzJlYyfJq4081VB6Rg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2PuHq9qaJwJpGeRJBMqMloibzfcYl12AoR2v9kgqyZz4CYuKZfh1Rf8hPd3euzJlYyfJq4081VB6Rg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1'" data-w="576" style="margin: 0px;padding: 0px;max-width: 100%;height: 380px;overflow-wrap: break-word !important;vertical-align: bottom;width: 230px;"><span style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;background-color: rgb(255, 255, 255);color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;"></span></p></section></section><section style="margin: 0px;padding: 0px;max-width: 100%;color: rgb(51, 51, 51);font-family: mp-quote, -apple-system-font, &quot;system-ui&quot;, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="图片/大数据技术与架构_2022-12-15_「转」Flink 116：Hive SQL平滑迁移到 Flink SQL/30_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="margin: 0px;padding: 0px;max-width: 100%;height: 42px;overflow-wrap: break-word !important;vertical-align: bottom;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">互联网最坏的时代可能真的来了</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">我在B站读大学，大数据专业</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Flink的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">193篇文章暴揍Flink，这个合集你需要关注一下</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我们在学习Spark的时候，到底在学习什么？</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;letter-spacing: 0.544px;">在所有Spark模块中，我愿称SparkSQL为最强！</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">硬刚Hive | 4万字基础调优面试小总结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">数据治理方法论和实践小百科全书</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">标签体系下的用户画像建设小指南</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解析</a><br style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">我写过的关于成长/面试/职场进阶的文章</a></section><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="margin: 0px;padding: 0px;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="margin: 0px;padding: 0px;color: rgb(87, 107, 149);text-decoration: none;max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><section style="outline: 0px;max-width: 100%;color: rgb(34, 34, 34);letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);font-family: system-ui, -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 16px;text-align: left;margin-top: 0px;margin-bottom: 0px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="outline: 0px;max-width: 100%;letter-spacing: 0.544px;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;color: rgb(217, 78, 106);font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif, Tahoma, &quot;Segoe UI SymbolMyanmar Text&quot;, 微软雅黑;font-size: 12px;white-space: pre-wrap;letter-spacing: 0.5px;box-sizing: border-box !important;overflow-wrap: break-word !important;"></span></strong></section><section style="line-height: 1.75em;margin-top: 0px;margin-bottom: 0px;"><section style="display: none;text-align: left;margin-top: 0px;"><br  /></section></section><section style="margin-bottom: 0px;"><section style="display: none;margin-top: 0px;"><br  /></section></section><p style="display: none;margin-bottom: 24px;"><mp-style-type data-value="3"></mp-style-type></p></content>
</div>
</body>
</html>