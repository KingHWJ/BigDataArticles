<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head><script>
var data={"mp":"大数据技术与架构","title":"如何利用 Flink CDC 实现数据增量备份到 Clickhouse","time":"2022-02-16 12:44:05","timeStamp":"1644986645"};
</script>
<body>
<div class="rich_media"><h1 class="rich_media_title" id="activity-name"><a href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&mid=2247510496&idx=2&sn=85ae06216df390d4cd392e88a9639680&chksm=fd3eef75ca4966637757a5a75bc7d4de6fbf93271fd37bd4490c2378ffbcd3744c5486c752f6#rd" target="_blank">如何利用 Flink CDC 实现数据增量备份到 Clickhouse</a></h1><div id="meta_content" class="rich_media_meta_list"><span class="rich_media_meta rich_media_meta_text">dafei1288&nbsp;&nbsp;</span><span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);" class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">大数据技术与架构&nbsp;&nbsp;</a></span><em id="publish_time" class="rich_media_meta rich_media_meta_text">2022-02-16 12:44:05</em></div><content><div class="reprint"><p>转自公众号：麒思妙想<br><a href="http://mp.weixin.qq.com/s?__biz=MzI3MDU3OTc1Nw==&mid=2247485379&idx=1&sn=49638a6bd0612029649930700f2eed3b" target="_blank" title="阅读原文">http://mp.weixin.qq.com/s?__biz=MzI3MDU3OTc1Nw==&mid=2247485379&idx=1&sn=49638a6bd0612029649930700f2eed3b</a></p></div><section class="mp_profile_iframe_wrp" data-mpa-powered-by="yiban.io"><mpprofile class="js_uneditable custom_select_card mp_profile_iframe" data-pluginname="mpprofile" data-id="MzU3MzgwNTU2Mg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/UdK9ByfMT2MrfCUBgMwsXeyxKKIxY5GNfl3g0zm1ibib46XO7tlIEs8ncmlp3Zzq8JJs0ibLbHdL4AWox8hSUIMDw/0?wx_fmt=png" data-nickname="大数据技术与架构" data-alias="import_bigdata" data-signature="大数据开发、大数据面试、大数据框架、大数据实时计算、大数据离线计算Flink/Spark/Hadoop/数仓开发，干货，面试，资料下载，源码解读等" data-from="0"></mpprofile></section><p cid="n5" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">挖了很久的CDC坑，今天打算填一填了。本文我们首先来介绍什么是CDC，以及CDC工具选型，接下来我们来介绍如何通过Flink CDC抓取mysql中的数据，并把他汇入Clickhouse里，最后我们还将介绍Flink SQL CDC的方式。</span></p><p mdtype="paragraph" cid="n76" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><h1 cid="n132" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">CDC</span></h1><p cid="n128" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">首先什么是CDC ？它是Change Data Capture的缩写,即变更数据捕捉的简称，使用CDC我们可以从数据库中获取已提交的更改并将这些更改发送到下游，供下游使用。这些变更可以包括INSERT,DELETE,UPDATE等操作。</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.6022044088176353" data-s="300,640" src="图片/大数据技术与架构_2022-02-16_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/1_bbjVLwWtK1qYPgm6kIfmJUribucwyw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcfxQ2VYayibticMadBpaOkiciaESdVibbjVLwWtK1qYPgm6kIfmJUribucwyw/640?wx_fmt=png'" data-type="png" data-w="998" style=""  /></p><p cid="n128" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;"></span><br  /></p><p cid="n126" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">其主要的应用场景：</span></p><ul class="list-paddingleft-2" cid="n146" mdtype="list" data-mark="-" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n135" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">异构数据库之间的数据同步或备份 / 建立数据分析计算平台</span></p></li><li style="box-sizing: border-box;"><p cid="n138" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">微服务之间共享数据状态</span></p></li><li style="box-sizing: border-box;"><p cid="n141" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">更新缓存 / CQRS 的 Query 视图更新</span></p></li></ul><p cid="n124" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">CDC 它是一个比较广义的概念，只要能捕获变更的数据，我们都可以称为 CDC 。业界主要有基于查询的 CDC 和基于日志的 CDC ，可以从下面表格对比他们功能和差异点。</span></p><figure cid="n11" mdtype="table" style="box-sizing: border-box;margin-top: 1.2em;margin-bottom: 1.2em;overflow-x: auto;cursor: default;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><table width="1140" style="width: 768px;"><thead style="box-sizing: border-box;background-color: rgb(248, 248, 248);"><tr cid="n12" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><th style="box-sizing: border-box;padding: 6px 13px;border-top-width: 1px;border-bottom: 0px;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-left-color: rgb(223, 226, 229);text-align: left;"><br  /></th><th style="box-sizing: border-box;padding: 6px 13px;border-top-width: 1px;border-bottom: 0px;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-left-color: rgb(223, 226, 229);text-align: left;"><span cid="n14" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">基于查询的 CDC</span></span></th><th style="box-sizing: border-box;padding: 6px 13px;border-top-width: 1px;border-bottom: 0px;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-left-color: rgb(223, 226, 229);"><span cid="n15" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">基于日志的 CDC</span></span></th></tr></thead><tbody style="box-sizing: border-box;"><tr cid="n16" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n17" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">概念</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n18" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">每次捕获变更发起 Select 查询进行全表扫描，过滤出查询之间变更的数据</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n19" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">读取数据存储系统的 log ，例如 MySQL 里面的 binlog持续监控</span></span></td></tr><tr cid="n20" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n21" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">开源产品</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n22" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">Sqoop, Kafka JDBC Source</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n23" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">Canal, Maxwell, Debezium</span></span></td></tr><tr cid="n24" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n25" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">执行模式</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n26" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">Batch</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n27" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">Streaming</span></span></td></tr><tr cid="n28" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n29" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">捕获所有数据的变化</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n30" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">❌</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n31" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">✅</span></span></td></tr><tr cid="n32" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n33" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">低延迟，不增加数据库负载</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n34" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">❌</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n35" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">✅</span></span></td></tr><tr cid="n36" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n37" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">不侵入业务（LastUpdated字段）</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n38" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">❌</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n39" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">✅</span></span></td></tr><tr cid="n40" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n41" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">捕获删除事件和旧记录的状态</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n42" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">❌</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n43" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">✅</span></span></td></tr><tr cid="n44" mdtype="table_row" style="box-sizing: border-box;break-inside: avoid;break-after: auto;border-width: 1px;border-style: solid;border-color: rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n45" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 209px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">捕获旧记录的状态</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n46" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 456px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">❌</span></span></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(223, 226, 229);min-width: 32px;"><span cid="n47" mdtype="table_cell" style="box-sizing: border-box;display: inline-block;min-width: 1ch;width: 393px;min-height: 10px;"><span md-inline="plain" style="box-sizing: border-box;">✅</span></span></td></tr></tbody></table></figure><p cid="n48" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n160" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><h1 cid="n161" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Debezium</span></h1><p cid="n162" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;"> Debezium是一个开源项目，为捕获数据更改(change data capture,CDC)提供了一个低延迟的流式处理平台。你可以安装并且配置Debezium去监控你的数据库，然后你的应用就可以消费对数据库的每一个行级别(row-level)的更改。只有已提交的更改才是可见的，所以你的应用不用担心事务(transaction)或者更改被回滚(roll back)。Debezium为所有的数据库更改事件提供了一个统一的模型，所以你的应用不用担心每一种数据库管理系统的错综复杂性。另外，由于Debezium用持久化的、有副本备份的日志来记录数据库数据变化的历史，因此，你的应用可以随时停止再重启，而不会错过它停止运行时发生的事件，保证了所有的事件都能被正确地、完全地处理掉。</span></p><blockquote cid="n163" mdtype="blockquote" style="box-sizing: border-box;margin-top: 0.8em;margin-bottom: 0.8em;border-left-width: 4px;border-left-color: rgb(223, 226, 229);padding-top: 0px;padding-right: 15px;padding-left: 15px;color: rgb(119, 119, 119);font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><p cid="n164" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">Debezium is an open source distributed platform for change data capture. Start it up, point it at your databases, and your apps can start responding to all of the inserts, updates, and deletes that other apps commit to your databases. Debezium is durable and fast, so your apps can respond quickly and never miss an event, even when things go wrong</span></p></blockquote><p cid="n165" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n173" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Why debezium? &nbsp;这里就放一张和网易大佬的聊天截图，说明吧</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.52890625" data-s="300,640" src="图片/大数据技术与架构_2022-02-16_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/2_nzGl8qsBG40R17qf5XY8t2tdbYneLQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcAEAlS45FZODav6VMliazOAdQTnzGl8qsBG40R17qf5XY8t2tdbYneLQ/640?wx_fmt=png'" data-type="png" data-w="1280" style=""  /></p><p cid="n971" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: right;"><span style="box-sizing: border-box;font-size: 14px;"><strong style="box-sizing: border-box;"><em style="box-sizing: border-box;">鸣谢，简佬，同意出镜</em></strong></span><br  /></p><p cid="n973" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><h1 cid="n205" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">ClickHouse</span></h1><p cid="n213" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">实时数据分析数据库，俄罗斯的谷歌开发的，推荐OLAP场景使用</span></p><p cid="n215" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n270" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="strong" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Clickhouse的优点.</strong></span></p><ol class="list-paddingleft-2" cid="n216" mdtype="list" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n218" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">真正的面向列的 DBMS</span></p><p cid="n219" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">ClickHouse 是一个 DBMS，而不是一个单一的数据库。它允许在运行时创建表和数据库、加载数据和运行</span></p><p cid="n220" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">查询，而无需重新配置和重新启动服务器。</span></p></li><li style="box-sizing: border-box;"><p cid="n222" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">数据压缩</span></p><p cid="n223" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">一些面向列的 DBMS（InfiniDB CE 和 MonetDB）不使用数据压缩。但是，数据压缩确实提高了性能。</span></p></li><li style="box-sizing: border-box;"><p cid="n225" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">磁盘存储的数据</span></p></li><li style="box-sizing: border-box;"><p cid="n227" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">在多个服务器上分布式处理</span></p></li><li style="box-sizing: border-box;"><p cid="n229" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">SQL支持</span></p></li><li style="box-sizing: border-box;"><p cid="n231" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">数据不仅按列存储，而且由矢量 - 列的部分进行处理，这使开发者能够实现高 CPU 性能</span></p></li></ol><p cid="n235" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n260" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;"> </span><span md-inline="strong" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">Clickhouse的缺点</strong></span></p><ol class="list-paddingleft-2" cid="n236" mdtype="list" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n238" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">没有完整的事务支持，</span></p></li><li style="box-sizing: border-box;"><p cid="n240" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">缺少完整的Update/Delete操作，缺少高频率、低延迟的修改或删除已存在数据的能力，仅能用于批量删</span></p><p cid="n241" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.5rem;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">除或修改数据</span></p></li><li style="box-sizing: border-box;"><p cid="n243" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">聚合结果必须小于一台机器的内存大小：</span></p></li><li style="box-sizing: border-box;"><p cid="n245" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">不适合key-value存储，</span></p></li></ol><p cid="n246" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n264" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="strong" style="box-sizing: border-box;"><strong style="box-sizing: border-box;">什么时候不可以用Clickhouse?</strong></span></p><ol class="list-paddingleft-2" cid="n247" mdtype="list" style="margin-top: 0.8em;margin-bottom: 0.8em;padding-left: 30px;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;white-space: normal;"><li style="box-sizing: border-box;"><p cid="n249" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">事物性工作（OLTP）</span></p></li><li style="box-sizing: border-box;"><p cid="n251" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">高并发的键值访问</span></p></li><li style="box-sizing: border-box;"><p cid="n253" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">Blob或者文档存储</span></p></li><li style="box-sizing: border-box;"><p cid="n255" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-bottom: 0.5rem;white-space: pre-wrap;"><span md-inline="plain" style="box-sizing: border-box;">超标准化的数据</span></p></li></ol><p cid="n211" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n207" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><h1 cid="n167" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Flink CDC</span></h1><p cid="n97" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Flink cdc connector 消费 Debezium 里的数据，经过处理再sink出来，这个流程还是相对比较简单的</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.4175675675675676" data-s="300,640" src="图片/大数据技术与架构_2022-02-16_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/3_7zhNl2FXKRia5XWtACHe00TI8klXoQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcVCgAHpA3z2xKIQvTT2IozrQ7M7zhNl2FXKRia5XWtACHe00TI8klXoQ/640?wx_fmt=png'" data-type="png" data-w="740" style=""  /></p><p cid="n84" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">首先创建 Source 和 Sink（对应的依赖引用，在文末）</span><br  /></p><pre spellcheck="false" lang="java" cid="n277" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span style="box-sizing: border-box;color: rgb(0, 0, 0);">SourceFunction</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceFunction</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">MySQLSource</span>.<span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span><span style="box-sizing: border-box;color: rgb(0, 0, 255);">builder</span>()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hostname</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"localhost"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">port</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">3306</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">databaseList</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">username</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"flinkcdc"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">password</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"dafei1288"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">deserializer</span>(<span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">JsonDebeziumDeserializationSchema</span>())</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">build</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 添加 source</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">addSource</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceFunction</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 添加 sink</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">addSink</span>(<span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">ClickhouseSink</span>());</span></pre><p cid="n275" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">这里用到的JsonDebeziumDeserializationSchema，是我们自定义的一个序列化类，用于将Debezium输出的数据，序列化</span></p><pre spellcheck="false" lang="java" cid="n288" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 将cdc数据反序列化</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">static</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">JsonDebeziumDeserializationSchema</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">implements</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">DebeziumDeserializationSchema</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">deserialize</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">SourceRecord</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Collector</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">collector</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">jsstr</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>, <span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;&gt;</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">topic</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">topic</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>[] <span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">topic</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"[.]"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span>[<span style="box-sizing: border-box;color: rgb(17, 102, 68);">1</span>];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span>[<span style="box-sizing: border-box;color: rgb(17, 102, 68);">2</span>];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"database"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"table"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">//获取操作类型</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Envelope</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Operation</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">operation</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Envelope</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">operationFor</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">//获取数据本身</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Struct</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">struct</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Struct</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Struct</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">struct</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">getStruct</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"after"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">!=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Schema</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">schema</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">schema</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>, <span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">afhs</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;&gt;</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">for</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Field</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">field</span> : <span style="box-sizing: border-box;color: rgb(0, 0, 0);">schema</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">fields</span>()) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">afhs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">field</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span>(), <span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">field</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span>()));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"data"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">afhs</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">operation</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">toString</span>().<span style="box-sizing: border-box;color: rgb(0, 0, 0);">toLowerCase</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span> (<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"create"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span>)) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"type"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">collector</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">collect</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">jsstr</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">toJson</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">TypeInformation</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">getProducedType</span>() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">return</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">BasicTypeInfo</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">STRING_TYPE_INFO</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span></pre><p cid="n286" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">这里是将数据序列化成如下Json格式</span></p><pre spellcheck="false" lang="json" cid="n294" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">{<span style="box-sizing: border-box;color: rgb(0, 0, 0);">"database"</span>:<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">"data"</span>:{<span style="box-sizing: border-box;color: rgb(0, 0, 0);">"name"</span>:<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"jacky"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">"description"</span>:<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"fffff"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">"id"</span>:<span style="box-sizing: border-box;color: rgb(17, 102, 68);">8</span>},<span style="box-sizing: border-box;color: rgb(0, 0, 0);">"type"</span>:<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">"table"</span>:<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test_cdc"</span>}</span></pre><p cid="n284" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">接下来就是要创建Sink，将数据变化存入Clickhouse中，这里我们仅以insert为例</span></p><pre spellcheck="false" lang="java" cid="n299" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">static</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">ClickhouseSink</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">extends</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">RichSinkFunction</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span>{</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Connection</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">PreparedStatement</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">private</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Connection</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">getConnection</span>() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Connection</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">conn</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">try</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Class</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">forName</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"ru.yandex.clickhouse.ClickHouseDriver"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">url</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"jdbc:clickhouse://localhost:8123/default"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">conn</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">DriverManager</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">getConnection</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">url</span>,<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"default"</span>,<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"dafei1288"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  } <span style="box-sizing: border-box;color: rgb(119, 0, 136);">catch</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">e</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">e</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">printStackTrace</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">return</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">conn</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">open</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Configuration</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">parameters</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">super</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">open</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">parameters</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">getConnection</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sql</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert into sink_ch_test(id,name,description) values (?,?,?)"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">prepareStatement</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sql</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 每条记录插入时调用一次</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">invoke</span>(<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Context</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">context</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">//{"database":"test","data":{"name":"jacky","description":"fffff","id":8},"type":"insert","table":"test_cdc"}</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">t</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>,<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">t</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">fromJson</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span>.<span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"database"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"table"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"type"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span>) <span style="box-sizing: border-box;color: rgb(152, 26, 26);">&amp;&amp;</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test_cdc"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span>)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">System</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">out</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">println</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert =&gt; "</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span><span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">LinkedTreeMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>,<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">LinkedTreeMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>,<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"data"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"name"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">description</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"description"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Double</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">id</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Double</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"id"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 未前面的占位符赋值</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setInt</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">1</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">id</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">intValue</span>());</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setString</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">2</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setString</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">3</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">description</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">executeUpdate</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>() <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">super</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">!=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">!=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span></pre><p cid="n280" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n86" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">完整代码案例：</span></p><pre spellcheck="false" lang="java" cid="n49" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">package</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">name</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">lijiaqi</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">cdc</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">com</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">alibaba</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">ververica</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">cdc</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">debezium</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">DebeziumDeserializationSchema</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">com</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">google</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">gson</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">com</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">google</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">gson</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">internal</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">LinkedTreeMap</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">io</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">debezium</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Envelope</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">common</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">typeinfo</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">BasicTypeInfo</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">common</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">typeinfo</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">TypeInformation</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">configuration</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Configuration</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">streaming</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">environment</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamExecutionEnvironment</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">streaming</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">functions</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">RichSinkFunction</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">streaming</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">functions</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">source</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">SourceFunction</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">com</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">alibaba</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">ververica</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">cdc</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connectors</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">mysql</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">MySQLSource</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">util</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Collector</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">kafka</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connect</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">source</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">SourceRecord</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">kafka</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connect</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Field</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">kafka</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connect</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Schema</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">kafka</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connect</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Struct</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">java</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sql</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Connection</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">java</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sql</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">DriverManager</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">java</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sql</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">PreparedStatement</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">java</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">util</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">MySqlBinlogSourceExample</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">static</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">main</span>(<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>[] <span style="box-sizing: border-box;color: rgb(0, 0, 0);">args</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">SourceFunction</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceFunction</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">MySQLSource</span>.<span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span><span style="box-sizing: border-box;color: rgb(0, 0, 0);">builder</span>()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hostname</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"localhost"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">port</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">3306</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">databaseList</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">username</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"flinkcdc"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">password</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"dafei1288"</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">deserializer</span>(<span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">JsonDebeziumDeserializationSchema</span>())</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">build</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamExecutionEnvironment</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamExecutionEnvironment</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">getExecutionEnvironment</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 添加 source</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">addSource</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceFunction</span>)</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 添加 sink</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">addSink</span>(<span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">ClickhouseSink</span>());</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">execute</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"mysql2clickhouse"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 将cdc数据反序列化</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">static</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">JsonDebeziumDeserializationSchema</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">implements</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">DebeziumDeserializationSchema</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">deserialize</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">SourceRecord</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Collector</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">collector</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">jsstr</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>, <span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;&gt;</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">topic</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">topic</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>[] <span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">topic</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"[.]"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span>[<span style="box-sizing: border-box;color: rgb(17, 102, 68);">1</span>];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">split</span>[<span style="box-sizing: border-box;color: rgb(17, 102, 68);">2</span>];</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"database"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"table"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">//获取操作类型</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Envelope</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Operation</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">operation</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Envelope</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">operationFor</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">//获取数据本身</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Struct</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">struct</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Struct</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceRecord</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Struct</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">struct</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">getStruct</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"after"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">!=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Schema</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">schema</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">schema</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>, <span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">afhs</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;&gt;</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">for</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Field</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">field</span> : <span style="box-sizing: border-box;color: rgb(0, 0, 0);">schema</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">fields</span>()) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">afhs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">field</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span>(), <span style="box-sizing: border-box;color: rgb(0, 0, 0);">after</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">field</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span>()));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"data"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">afhs</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">operation</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">toString</span>().<span style="box-sizing: border-box;color: rgb(0, 0, 0);">toLowerCase</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span> (<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"create"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span>)) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">put</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"type"</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">collector</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">collect</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">jsstr</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">toJson</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>));</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">TypeInformation</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">getProducedType</span>() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">return</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">BasicTypeInfo</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">STRING_TYPE_INFO</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">static</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">ClickhouseSink</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">extends</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">RichSinkFunction</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span>{</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Connection</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">PreparedStatement</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">private</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Connection</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">getConnection</span>() {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Connection</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">conn</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">try</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Class</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">forName</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"ru.yandex.clickhouse.ClickHouseDriver"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">url</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"jdbc:clickhouse://localhost:8123/default"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">conn</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">DriverManager</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">getConnection</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">url</span>,<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"default"</span>,<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"dafei1288"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  } <span style="box-sizing: border-box;color: rgb(119, 0, 136);">catch</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">e</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">e</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">printStackTrace</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">return</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">conn</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">open</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Configuration</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">parameters</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">super</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">open</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">parameters</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">getConnection</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sql</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert into sink_ch_test(id,name,description) values (?,?,?)"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">prepareStatement</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sql</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 每条记录插入时调用一次</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">invoke</span>(<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Context</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">context</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">//{"database":"test","data":{"name":"jacky","description":"fffff","id":8},"type":"insert","table":"test_cdc"}</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">t</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">new</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Gson</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>,<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">t</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">fromJson</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>,<span style="box-sizing: border-box;color: rgb(0, 0, 0);">HashMap</span>.<span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"database"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"table"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"type"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">database</span>) <span style="box-sizing: border-box;color: rgb(152, 26, 26);">&amp;&amp;</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test_cdc"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert"</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">equals</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">type</span>)){</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">System</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">out</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">println</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert =&gt; "</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span><span style="box-sizing: border-box;color: rgb(0, 0, 0);">value</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">LinkedTreeMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>,<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 0, 0);">LinkedTreeMap</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&lt;</span><span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>,<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Object</span><span style="box-sizing: border-box;color: rgb(152, 26, 26);">&gt;</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">hs</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"data"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"name"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">description</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"description"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Double</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">id</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> (<span style="box-sizing: border-box;color: rgb(0, 136, 85);">Double</span>)<span style="box-sizing: border-box;color: rgb(0, 0, 0);">data</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">get</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"id"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 未前面的占位符赋值</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setInt</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">1</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">id</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">intValue</span>());</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setString</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">2</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">name</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setString</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">3</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">description</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">executeUpdate</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(85, 85, 85);">@Override</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>() <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">super</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">!=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">pstmt</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">if</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">!=</span> <span style="box-sizing: border-box;color: rgb(34, 17, 153);">null</span>) {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">connection</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">close</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">}</span></pre><p cid="n50" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n51" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">执行查看结果</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.23089840470193115" data-s="300,640" src="图片/大数据技术与架构_2022-02-16_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/4_PAIZUZk1bfU3rNIRIPzBCWD6FL8Lzw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcpgsAqKUcENpA1ZJBUs3uO0icvPAIZUZk1bfU3rNIRIPzBCWD6FL8Lzw/640?wx_fmt=png'" data-type="png" data-w="1191" style=""  /></p><p cid="n55" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">数据成功汇入</span></p><p cid="n56" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.894937917860554" data-s="300,640" src="图片/大数据技术与架构_2022-02-16_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/5_sDVxZ0hsX8QJtl2ABolO7bmibgWpZg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOciaFTHYl1vOkhbtx0QfPFVaAicmXsDVxZ0hsX8QJtl2ABolO7bmibgWpZg/640?wx_fmt=png'" data-type="png" data-w="1047"  /><br  /></p><p cid="n57" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="image" src="result.png" style="box-sizing: border-box;min-width: 10px;min-height: 10px;word-break: break-all;font-family: monospace;vertical-align: top;display: inline-block;width: 1140px;"></span></p><p cid="n58" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n59" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n177" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><h1 cid="n179" mdtype="heading" style="box-sizing: border-box;break-after: avoid-page;break-inside: avoid;orphans: 4;font-size: 2.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.2;cursor: text;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">Flink SQL CDC</span></h1><p cid="n181" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">接下来，我们看一下如何通过Flink SQL实现CDC ，只需3条SQL语句即可。</span></p><p cid="n60" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">创建数据源表</span></p><pre spellcheck="false" lang="java" cid="n314" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 数据源表</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceDDL</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"CREATE TABLE mysql_binlog (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" id INT NOT NULL,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" name STRING,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" description STRING\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">") WITH (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'connector' = 'mysql-cdc',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'hostname' = 'localhost',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'port' = '3306',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'username' = 'flinkcdc',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'password' = 'dafei1288',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'database-name' = 'test',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'table-name' = 'test_cdc'\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">")"</span>;</span></pre><p cid="n310" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">创建输出表</span></p><pre spellcheck="false" lang="java" cid="n319" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> <span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 输出目标表</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sinkDDL</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"CREATE TABLE test_cdc_sink (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" id INT NOT NULL,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" name STRING,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" description STRING,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" PRIMARY KEY (id) NOT ENFORCED \n "</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">") WITH (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'connector' = 'jdbc',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'driver' = 'com.mysql.jdbc.Driver',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'url' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">url</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'username' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">userName</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'password' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">password</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'table-name' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">mysqlSinkTable</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"'\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">")"</span>;</span></pre><p cid="n312" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">这里我们直接将数据汇入</span></p><pre spellcheck="false" lang="java" cid="n324" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 简单的聚合处理</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">transformSQL</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert into test_cdc_sink select * from mysql_binlog"</span>;</span></pre><p cid="n308" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><br  /></p><p cid="n327" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">完整参考代码</span></p><pre spellcheck="false" lang="Java" cid="n187" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">package</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">name</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">lijiaqi</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">cdc</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">streaming</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">environment</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamExecutionEnvironment</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">EnvironmentSettings</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">SqlDialect</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">TableResult</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">import</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">org</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">apache</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">flink</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">table</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">api</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">bridge</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">java</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamTableEnvironment</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">class</span> <span style="box-sizing: border-box;color: rgb(0, 0, 255);">MysqlToMysqlMain</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(119, 0, 136);">public</span> <span style="box-sizing: border-box;color: rgb(119, 0, 136);">static</span> <span style="box-sizing: border-box;color: rgb(0, 136, 85);">void</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">main</span>(<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span>[] <span style="box-sizing: border-box;color: rgb(0, 0, 0);">args</span>) <span style="box-sizing: border-box;color: rgb(119, 0, 136);">throws</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">Exception</span> {</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">EnvironmentSettings</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">fsSettings</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">EnvironmentSettings</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">newInstance</span>()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">useBlinkPlanner</span>()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">inStreamingMode</span>()</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span style="box-sizing: border-box;color: rgb(0, 0, 0);">build</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamExecutionEnvironment</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamExecutionEnvironment</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">getExecutionEnvironment</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setParallelism</span>(<span style="box-sizing: border-box;color: rgb(17, 102, 68);">1</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamTableEnvironment</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">tableEnv</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">StreamTableEnvironment</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">create</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span>, <span style="box-sizing: border-box;color: rgb(0, 0, 0);">fsSettings</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">tableEnv</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">getConfig</span>().<span style="box-sizing: border-box;color: rgb(0, 0, 0);">setSqlDialect</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">SqlDialect</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">DEFAULT</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 数据源表</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceDDL</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"CREATE TABLE mysql_binlog (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" id INT NOT NULL,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" name STRING,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" description STRING\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">") WITH (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'connector' = 'mysql-cdc',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'hostname' = 'localhost',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'port' = '3306',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'username' = 'flinkcdc',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'password' = 'dafei1288',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'database-name' = 'test',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'table-name' = 'test_cdc'\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">")"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">url</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"jdbc:mysql://127.0.0.1:3306/test"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">userName</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"root"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">password</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"dafei1288"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">mysqlSinkTable</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"test_cdc_sink"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 输出目标表</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">sinkDDL</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"CREATE TABLE test_cdc_sink (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" id INT NOT NULL,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" name STRING,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" description STRING,\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" PRIMARY KEY (id) NOT ENFORCED \n "</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">") WITH (\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'connector' = 'jdbc',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'driver' = 'com.mysql.jdbc.Driver',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'url' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">url</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'username' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">userName</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'password' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">password</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"',\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">" 'table-name' = '"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">mysqlSinkTable</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span> <span style="box-sizing: border-box;color: rgb(170, 17, 17);">"'\n"</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">+</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">")"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 简单的聚合处理</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 136, 85);">String</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">transformSQL</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"insert into test_cdc_sink select * from mysql_binlog"</span>;</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">tableEnv</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">executeSql</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sourceDDL</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">tableEnv</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">executeSql</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">sinkDDL</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">TableResult</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">result</span> <span style="box-sizing: border-box;color: rgb(152, 26, 26);">=</span> <span style="box-sizing: border-box;color: rgb(0, 0, 0);">tableEnv</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">executeSql</span>(<span style="box-sizing: border-box;color: rgb(0, 0, 0);">transformSQL</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">// 等待flink-cdc完成快照</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">result</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">print</span>();</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(0, 0, 0);">env</span>.<span style="box-sizing: border-box;color: rgb(0, 0, 0);">execute</span>(<span style="box-sizing: border-box;color: rgb(170, 17, 17);">"sync-flink-cdc"</span>);</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp;  }</span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;">}</span></pre><p cid="n185" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">查看执行结果</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg wxw-img" data-ratio="0.5522041763341067" data-s="300,640" src="图片/大数据技术与架构_2022-02-16_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/6_KGWicicgj8qicbicdTz1UpsHQWJVjA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/8uJ0ic6nAagibib6zAzLyTNZa5TCIZn3mOcw3dKBbKwc8ZA73s8s30tBiaibsM9iaeKGWicicgj8qicbicdTz1UpsHQWJVjA/640?wx_fmt=png'" data-type="png" data-w="862" style=""  /></p><p cid="n196" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span md-inline="plain" style="box-sizing: border-box;">添加依赖</span></p><pre spellcheck="false" lang="xml" cid="n202" mdtype="fences" style="box-sizing: border-box;overflow: visible;font-family: var(--monospace);font-size: 0.9em;break-inside: avoid;text-align: left;white-space: normal;background-image: inherit;background-position: inherit;background-size: inherit;background-repeat: inherit;background-attachment: inherit;background-origin: inherit;background-clip: inherit;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(231, 234, 237);border-radius: 3px;padding: 8px 4px 6px;margin-bottom: 15px;margin-top: 15px;width: inherit;"><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependencies</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(170, 85, 0);">&lt;!-- https://mvnrepository.com/artifact/org.apache.flink/flink-core --&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-core<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-streaming-java_2.12<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(170, 85, 0);">&lt;!-- &nbsp; &nbsp; &nbsp;  &lt;dependency&gt;--&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(170, 85, 0);">&lt;!-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;--&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(170, 85, 0);">&lt;!-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;artifactId&gt;flink-jdbc_2.12&lt;/artifactId&gt;--&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(170, 85, 0);">&lt;!-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;version&gt;1.10.3&lt;/version&gt;--&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"><span style="box-sizing: border-box;color: rgb(170, 85, 0);">&lt;!-- &nbsp; &nbsp; &nbsp;  &lt;/dependency&gt;--&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-connector-jdbc_2.12<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-java<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-clients_2.12<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-table-api-java-bridge_2.12<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-table-common<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-table-planner_2.12<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-table-planner-blink_2.12<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>org.apache.flink<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-table-planner-blink_2.12<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.13.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">type</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>test-jar<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">type</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>com.alibaba.ververica<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-connector-mysql-cdc<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.4.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>com.aliyun<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>flink-connector-clickhouse<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>1.12.0<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>ru.yandex.clickhouse<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>clickhouse-jdbc<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>0.2.6<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>com.google.code.gson<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">groupId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>gson<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">artifactId</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span>2.8.6<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">version</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependency</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span><br  /><span role="presentation" style="box-sizing: border-box;padding-right: 0.1px;"> &nbsp; &nbsp;<span style="box-sizing: border-box;color: rgb(17, 119, 0);">&lt;/</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">dependencies</span><span style="box-sizing: border-box;color: rgb(17, 119, 0);">&gt;</span></span></pre><p cid="n331" mdtype="paragraph" style="box-sizing: border-box;line-height: inherit;orphans: 4;margin-top: 0.8em;margin-bottom: 0.8em;white-space: pre-wrap;font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size: 16px;text-align: start;"><span style="color: rgb(74, 74, 74);letter-spacing: 0.544px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 15px;background-color: rgb(255, 255, 255);">如果这个文章对你有帮助，不要忘记&nbsp;</span><span style="letter-spacing: 0.544px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;outline: 0px;font-size: 15px;background-color: rgb(255, 255, 255);color: rgb(255, 104, 39);"><strong style="outline: 0px;line-height: 1.75em;">「在看」</strong>&nbsp;<strong style="outline: 0px;line-height: 1.75em;">「点赞」</strong>&nbsp;<strong style="outline: 0px;line-height: 1.75em;">「收藏」</strong></span><span style="color: rgb(74, 74, 74);letter-spacing: 0.544px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 15px;background-color: rgb(255, 255, 255);">&nbsp;三连啊喂！</span></p><section style="max-width: 100%;white-space: normal;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="padding-right: 0.5em;padding-left: 0.5em;max-width: 100%;text-align: left;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;line-height: normal;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><br  /></section><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><img class="rich_pages wxw-img" data-ratio="0.10979228486646884" src="图片/大数据技术与架构_2022-02-16_「转」如何利用 Flink CDC 实现数据增量备份到 Clickhouse/7_zrkyKUN5kNeUFicVC3bMP1GEqKz1OQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/BSBqCXrZtzAicMToibKuIysLrB62M5A5YaLhZg6z86tI7ZeEZqTLLYyNrmlzrkyKUN5kNeUFicVC3bMP1GEqKz1OQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1011" style="height: 42px;color: rgb(136, 136, 136);font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 1px;-webkit-text-stroke-color: rgb(136, 136, 136);box-sizing: border-box;width: 384px;overflow-wrap: break-word !important;"  /></section><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504680&amp;idx=1&amp;sn=9f2547b40316b8dc8a748bbc8b6b6015&amp;chksm=fd3e95bdca491cab9e0badbd7a1144f7511638ae80db684fd5383c771129a16bb08ba5e72515&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247510040&amp;idx=1&amp;sn=aa335f25965975731173916f012d56f4&amp;chksm=fd3eee8dca49679b82f632048fb64d21fac01497d1a0fe33917edb01e194caf0f9a1930a55ce&amp;scene=21#wechat_redirect" textvalue="2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="font-family: &quot;Helvetica Neue&quot;;font-size: 13px;letter-spacing: 0.544px;text-align: left;white-space: normal;-webkit-text-stroke-color: rgb(136, 136, 136);">2022年全网首发|大数据专家级技能模型与学习指南(胜天半子篇)</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247508317&amp;idx=1&amp;sn=0bcb7fb6997b42306994b890eaa0d47f&amp;chksm=fd3ee7c8ca496ede347a2971002c6ea68dcfd70abeeb90b43c8b02a2a60ebc7cec3a87ef7d52&amp;scene=21#wechat_redirect" textvalue="互联网最坏的时代可能真的来了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" data-linktype="2">互联网最坏的时代可能真的来了</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247507860&amp;idx=1&amp;sn=807ac5003762f29c127bc4071dcebe33&amp;chksm=fd3e9901ca4910178cfc816043ea86c29f881f70cd943d252de9ae2e21cb7e8ba80bff162e1b&amp;scene=21#wechat_redirect" textvalue="我在B站读大学，大数据专业" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" data-linktype="2">我在B站读大学，大数据专业</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247499604&amp;idx=1&amp;sn=d938dfb30d221774704982d2938b30c1&amp;chksm=fd3eb9c1ca4930d76a391241333de461ca22d2aa27472eab3cffab1564872ae37f1b48fe2d3c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">我们在学习Flink的时候，到底在学习什么？</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504856&amp;idx=2&amp;sn=6f62e2a0c756ce56773eed253d2f41ee&amp;chksm=fd3e954dca491c5b732b7e2aa46db32efbc3f690e528522098659bb3c6e78e1582ab4529b5dc&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">193篇文章暴揍Flink，这个合集你需要关注一下</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504742&amp;idx=1&amp;sn=8765c198d8ad66219a7bcabb221e4a23&amp;chksm=fd3e95f3ca491ce52d0724b9e4154a47af0f5ea349e1e184c8fbc65aa17c0000242aa9b58429&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">Flink生产环境TOP难题与优化，阿里巴巴藏经阁YYDS</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504813&amp;idx=1&amp;sn=f5cd6ae2aa2b1e30f87a5ae55971c514&amp;chksm=fd3e9538ca491c2eb191677d070f2c7e4f1098eece00e256d6205b8a5d21b21c1e74f875f16f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;letter-spacing: 0.544px;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">Flink CDC我吃定了耶稣也留不住他！| Flink CDC线上问题小盘点</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=1&amp;sn=1f693e549f76622725b936041ff8896e&amp;chksm=e9bff2fbdec87bedecbdeed4547d7d612c72fc8d4918614a26a4e31666cf0128fd57b537f347&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">我们在学习Spark的时候，到底在学习什么？</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504834&amp;idx=1&amp;sn=46ca1a3924b8fdb89ac1c2acb0319d6c&amp;chksm=fd3e9557ca491c41d837b917639ea62007ea16d3c2cc6c0c02d1f8a8c6e44318f5183b787c46&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;letter-spacing: 0.544px;overflow-wrap: break-word !important;box-sizing: border-box !important;">在所有Spark模块中，我愿称SparkSQL为最强！</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247502750&amp;idx=1&amp;sn=bd9a9173d060dc4e4ebd49c8efc6acfe&amp;chksm=fd3e8d0bca49041dea84da93910e5efdc4935e520525c09887c986691377aeb48e5cf7fb5667&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">硬刚Hive | 4万字基础调优面试小总结</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504382&amp;idx=2&amp;sn=550b78802acfe727e0e77cd9195f8784&amp;chksm=fd3e976bca491e7db2b8b2446d231736df01bbf13653804d680ac4390597ec17fa466ad4ae83&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">数据治理方法论和实践小百科全书</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503741&amp;idx=1&amp;sn=e5039be93123f2e337013756a818bfc3&amp;chksm=fd3e89e8ca4900fe603b63c5722a6fb8a32bd63d6ba23e0028851948a71b877eb1f742d95087&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">标签体系下的用户画像建设小指南</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247503675&amp;idx=1&amp;sn=3ee6af64d0126c78b48cad219308f81e&amp;chksm=fd3e89aeca4900b8b8954e9569ee3c0877881fac8c792bfafc22e7e9d3e8524da8eb860d33d8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;">4万字长文 | ClickHouse基础&amp;实践&amp;调优全视角解析</a><br style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"  /></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0NjU2NDkzMQ==&amp;mid=2247492567&amp;idx=2&amp;sn=57ecc77718f1b6f2f262d62e8318dcc9&amp;chksm=e9bff2fbdec87bedb1986765bfae7dbabb9aece45b0b2af147bbad1ac5d79ebc934c64df40ea&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">【面试&amp;个人成长】2021年过半，社招和校招的经验之谈</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504478&amp;idx=1&amp;sn=14efef3868ba42bd044f9618745a7fdc&amp;chksm=fd3e94cbca491dddb961b7b8b93105b2869c5bcf4c03f9f0dc83ad62be0dce4c124b52ed0ba3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">大数据方向另一个十年开启 |《硬刚系列》第一版完结</a></section><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);background-color: rgb(255, 255, 255);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504410&amp;idx=1&amp;sn=7e81ab5a324395eb0f12397c40247ca1&amp;chksm=fd3e948fca491d9946456acbd93b2d651ae4d7a7d0127a211981e08f50f377e60d1b7c0d7b3a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">我写过的关于成长/面试/职场进阶的文章</a></section><section style="max-width: 100%;font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section powered-by="xiumi.us" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section data-tools="135编辑器" data-id="98469" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section hm_fix="349:393" style="max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><section style="max-width: 100%;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 13px;font-family: &quot;Helvetica Neue&quot;;letter-spacing: 0.544px;-webkit-text-stroke-color: rgb(136, 136, 136);text-align: left;color: rgb(136, 136, 136);line-height: 3em;margin-left: 0px;margin-right: 0px;overflow-wrap: break-word !important;box-sizing: border-box !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU3MzgwNTU2Mg==&amp;mid=2247504783&amp;idx=1&amp;sn=72aed147a459368ed934a007a2df3bc9&amp;chksm=fd3e951aca491c0cade212390011eca7d8a68951fee6aa2844b8f4d14bcbd5b3ed26305d69dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="max-width: 100%;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;overflow-wrap: break-word !important;box-sizing: border-box !important;">当我们在学习Hive的时候在学习什么？「硬刚Hive续集」</a></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></content>
</div>
</body>
</html>